var g_=n=>{throw TypeError(n)};var vp=(n,e,t)=>e.has(n)||g_("Cannot "+t);var jt=(n,e,t)=>(vp(n,e,"read from private field"),t?t.call(n):e.get(n)),xr=(n,e,t)=>e.has(n)?g_("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),si=(n,e,t,i)=>(vp(n,e,"write to private field"),i?i.call(n,t):e.set(n,t),t),wr=(n,e,t)=>(vp(n,e,"access private method"),t);var m_=(n,e,t,i)=>({set _(r){si(n,e,r,t)},get _(){return jt(n,e,i)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(r){if(r.ep)return;r.ep=!0;const a=t(r);fetch(r.href,a)}})();var yp={exports:{}},cc={};var v_;function t2(){if(v_)return cc;v_=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,r,a){var o=null;if(a!==void 0&&(o=""+a),r.key!==void 0&&(o=""+r.key),"key"in r){a={};for(var c in r)c!=="key"&&(a[c]=r[c])}else a=r;return r=a.ref,{$$typeof:n,type:i,key:o,ref:r!==void 0?r:null,props:a}}return cc.Fragment=e,cc.jsx=t,cc.jsxs=t,cc}var y_;function n2(){return y_||(y_=1,yp.exports=t2()),yp.exports}var C=n2(),_p={exports:{}},qe={};var __;function i2(){if(__)return qe;__=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),m=Symbol.iterator;function y(V){return V===null||typeof V!="object"?null:(V=m&&V[m]||V["@@iterator"],typeof V=="function"?V:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,b={};function E(V,N,z){this.props=V,this.context=N,this.refs=b,this.updater=z||w}E.prototype.isReactComponent={},E.prototype.setState=function(V,N){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,N,"setState")},E.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function T(){}T.prototype=E.prototype;function S(V,N,z){this.props=V,this.context=N,this.refs=b,this.updater=z||w}var k=S.prototype=new T;k.constructor=S,_(k,E.prototype),k.isPureReactComponent=!0;var P=Array.isArray;function F(){}var O={H:null,A:null,T:null,S:null},G=Object.prototype.hasOwnProperty;function M(V,N,z){var H=z.ref;return{$$typeof:n,type:V,key:N,ref:H!==void 0?H:null,props:z}}function W(V,N){return M(V.type,N,V.props)}function Y(V){return typeof V=="object"&&V!==null&&V.$$typeof===n}function ce(V){var N={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(z){return N[z]})}var ve=/\/+/g;function Ce(V,N){return typeof V=="object"&&V!==null&&V.key!=null?ce(""+V.key):N.toString(36)}function ke(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(F,F):(V.status="pending",V.then(function(N){V.status==="pending"&&(V.status="fulfilled",V.value=N)},function(N){V.status==="pending"&&(V.status="rejected",V.reason=N)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function J(V,N,z,H,q){var oe=typeof V;(oe==="undefined"||oe==="boolean")&&(V=null);var me=!1;if(V===null)me=!0;else switch(oe){case"bigint":case"string":case"number":me=!0;break;case"object":switch(V.$$typeof){case n:case e:me=!0;break;case p:return me=V._init,J(me(V._payload),N,z,H,q)}}if(me)return q=q(V),me=H===""?"."+Ce(V,0):H,P(q)?(z="",me!=null&&(z=me.replace(ve,"$&/")+"/"),J(q,N,z,"",function(Te){return Te})):q!=null&&(Y(q)&&(q=W(q,z+(q.key==null||V&&V.key===q.key?"":(""+q.key).replace(ve,"$&/")+"/")+me)),N.push(q)),1;me=0;var Re=H===""?".":H+":";if(P(V))for(var be=0;be<V.length;be++)H=V[be],oe=Re+Ce(H,be),me+=J(H,N,z,oe,q);else if(be=y(V),typeof be=="function")for(V=be.call(V),be=0;!(H=V.next()).done;)H=H.value,oe=Re+Ce(H,be++),me+=J(H,N,z,oe,q);else if(oe==="object"){if(typeof V.then=="function")return J(ke(V),N,z,H,q);throw N=String(V),Error("Objects are not valid as a React child (found: "+(N==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":N)+"). If you meant to render a collection of children, use an array instead.")}return me}function ae(V,N,z){if(V==null)return V;var H=[],q=0;return J(V,H,"","",function(oe){return N.call(z,oe,q++)}),H}function we(V){if(V._status===-1){var N=V._result;N=N(),N.then(function(z){(V._status===0||V._status===-1)&&(V._status=1,V._result=z)},function(z){(V._status===0||V._status===-1)&&(V._status=2,V._result=z)}),V._status===-1&&(V._status=0,V._result=N)}if(V._status===1)return V._result.default;throw V._result}var Pe=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var N=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(N))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)},$e={map:ae,forEach:function(V,N,z){ae(V,function(){N.apply(this,arguments)},z)},count:function(V){var N=0;return ae(V,function(){N++}),N},toArray:function(V){return ae(V,function(N){return N})||[]},only:function(V){if(!Y(V))throw Error("React.Children.only expected to receive a single React element child.");return V}};return qe.Activity=g,qe.Children=$e,qe.Component=E,qe.Fragment=t,qe.Profiler=r,qe.PureComponent=S,qe.StrictMode=i,qe.Suspense=h,qe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,qe.__COMPILER_RUNTIME={__proto__:null,c:function(V){return O.H.useMemoCache(V)}},qe.cache=function(V){return function(){return V.apply(null,arguments)}},qe.cacheSignal=function(){return null},qe.cloneElement=function(V,N,z){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var H=_({},V.props),q=V.key;if(N!=null)for(oe in N.key!==void 0&&(q=""+N.key),N)!G.call(N,oe)||oe==="key"||oe==="__self"||oe==="__source"||oe==="ref"&&N.ref===void 0||(H[oe]=N[oe]);var oe=arguments.length-2;if(oe===1)H.children=z;else if(1<oe){for(var me=Array(oe),Re=0;Re<oe;Re++)me[Re]=arguments[Re+2];H.children=me}return M(V.type,q,H)},qe.createContext=function(V){return V={$$typeof:o,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:a,_context:V},V},qe.createElement=function(V,N,z){var H,q={},oe=null;if(N!=null)for(H in N.key!==void 0&&(oe=""+N.key),N)G.call(N,H)&&H!=="key"&&H!=="__self"&&H!=="__source"&&(q[H]=N[H]);var me=arguments.length-2;if(me===1)q.children=z;else if(1<me){for(var Re=Array(me),be=0;be<me;be++)Re[be]=arguments[be+2];q.children=Re}if(V&&V.defaultProps)for(H in me=V.defaultProps,me)q[H]===void 0&&(q[H]=me[H]);return M(V,oe,q)},qe.createRef=function(){return{current:null}},qe.forwardRef=function(V){return{$$typeof:c,render:V}},qe.isValidElement=Y,qe.lazy=function(V){return{$$typeof:p,_payload:{_status:-1,_result:V},_init:we}},qe.memo=function(V,N){return{$$typeof:f,type:V,compare:N===void 0?null:N}},qe.startTransition=function(V){var N=O.T,z={};O.T=z;try{var H=V(),q=O.S;q!==null&&q(z,H),typeof H=="object"&&H!==null&&typeof H.then=="function"&&H.then(F,Pe)}catch(oe){Pe(oe)}finally{N!==null&&z.types!==null&&(N.types=z.types),O.T=N}},qe.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},qe.use=function(V){return O.H.use(V)},qe.useActionState=function(V,N,z){return O.H.useActionState(V,N,z)},qe.useCallback=function(V,N){return O.H.useCallback(V,N)},qe.useContext=function(V){return O.H.useContext(V)},qe.useDebugValue=function(){},qe.useDeferredValue=function(V,N){return O.H.useDeferredValue(V,N)},qe.useEffect=function(V,N){return O.H.useEffect(V,N)},qe.useEffectEvent=function(V){return O.H.useEffectEvent(V)},qe.useId=function(){return O.H.useId()},qe.useImperativeHandle=function(V,N,z){return O.H.useImperativeHandle(V,N,z)},qe.useInsertionEffect=function(V,N){return O.H.useInsertionEffect(V,N)},qe.useLayoutEffect=function(V,N){return O.H.useLayoutEffect(V,N)},qe.useMemo=function(V,N){return O.H.useMemo(V,N)},qe.useOptimistic=function(V,N){return O.H.useOptimistic(V,N)},qe.useReducer=function(V,N,z){return O.H.useReducer(V,N,z)},qe.useRef=function(V){return O.H.useRef(V)},qe.useState=function(V){return O.H.useState(V)},qe.useSyncExternalStore=function(V,N,z){return O.H.useSyncExternalStore(V,N,z)},qe.useTransition=function(){return O.H.useTransition()},qe.version="19.2.3",qe}var x_;function Lg(){return x_||(x_=1,_p.exports=i2()),_p.exports}var Z=Lg(),xp={exports:{}},uc={},wp={exports:{}},bp={};var w_;function r2(){return w_||(w_=1,(function(n){function e(J,ae){var we=J.length;J.push(ae);e:for(;0<we;){var Pe=we-1>>>1,$e=J[Pe];if(0<r($e,ae))J[Pe]=ae,J[we]=$e,we=Pe;else break e}}function t(J){return J.length===0?null:J[0]}function i(J){if(J.length===0)return null;var ae=J[0],we=J.pop();if(we!==ae){J[0]=we;e:for(var Pe=0,$e=J.length,V=$e>>>1;Pe<V;){var N=2*(Pe+1)-1,z=J[N],H=N+1,q=J[H];if(0>r(z,we))H<$e&&0>r(q,z)?(J[Pe]=q,J[H]=we,Pe=H):(J[Pe]=z,J[N]=we,Pe=N);else if(H<$e&&0>r(q,we))J[Pe]=q,J[H]=we,Pe=H;else break e}}return ae}function r(J,ae){var we=J.sortIndex-ae.sortIndex;return we!==0?we:J.id-ae.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var o=Date,c=o.now();n.unstable_now=function(){return o.now()-c}}var h=[],f=[],p=1,g=null,m=3,y=!1,w=!1,_=!1,b=!1,E=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function k(J){for(var ae=t(f);ae!==null;){if(ae.callback===null)i(f);else if(ae.startTime<=J)i(f),ae.sortIndex=ae.expirationTime,e(h,ae);else break;ae=t(f)}}function P(J){if(_=!1,k(J),!w)if(t(h)!==null)w=!0,F||(F=!0,ce());else{var ae=t(f);ae!==null&&ke(P,ae.startTime-J)}}var F=!1,O=-1,G=5,M=-1;function W(){return b?!0:!(n.unstable_now()-M<G)}function Y(){if(b=!1,F){var J=n.unstable_now();M=J;var ae=!0;try{e:{w=!1,_&&(_=!1,T(O),O=-1),y=!0;var we=m;try{t:{for(k(J),g=t(h);g!==null&&!(g.expirationTime>J&&W());){var Pe=g.callback;if(typeof Pe=="function"){g.callback=null,m=g.priorityLevel;var $e=Pe(g.expirationTime<=J);if(J=n.unstable_now(),typeof $e=="function"){g.callback=$e,k(J),ae=!0;break t}g===t(h)&&i(h),k(J)}else i(h);g=t(h)}if(g!==null)ae=!0;else{var V=t(f);V!==null&&ke(P,V.startTime-J),ae=!1}}break e}finally{g=null,m=we,y=!1}ae=void 0}}finally{ae?ce():F=!1}}}var ce;if(typeof S=="function")ce=function(){S(Y)};else if(typeof MessageChannel<"u"){var ve=new MessageChannel,Ce=ve.port2;ve.port1.onmessage=Y,ce=function(){Ce.postMessage(null)}}else ce=function(){E(Y,0)};function ke(J,ae){O=E(function(){J(n.unstable_now())},ae)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(J){J.callback=null},n.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<J?Math.floor(1e3/J):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_next=function(J){switch(m){case 1:case 2:case 3:var ae=3;break;default:ae=m}var we=m;m=ae;try{return J()}finally{m=we}},n.unstable_requestPaint=function(){b=!0},n.unstable_runWithPriority=function(J,ae){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var we=m;m=J;try{return ae()}finally{m=we}},n.unstable_scheduleCallback=function(J,ae,we){var Pe=n.unstable_now();switch(typeof we=="object"&&we!==null?(we=we.delay,we=typeof we=="number"&&0<we?Pe+we:Pe):we=Pe,J){case 1:var $e=-1;break;case 2:$e=250;break;case 5:$e=1073741823;break;case 4:$e=1e4;break;default:$e=5e3}return $e=we+$e,J={id:p++,callback:ae,priorityLevel:J,startTime:we,expirationTime:$e,sortIndex:-1},we>Pe?(J.sortIndex=we,e(f,J),t(h)===null&&J===t(f)&&(_?(T(O),O=-1):_=!0,ke(P,we-Pe))):(J.sortIndex=$e,e(h,J),w||y||(w=!0,F||(F=!0,ce()))),J},n.unstable_shouldYield=W,n.unstable_wrapCallback=function(J){var ae=m;return function(){var we=m;m=ae;try{return J.apply(this,arguments)}finally{m=we}}}})(bp)),bp}var b_;function s2(){return b_||(b_=1,wp.exports=r2()),wp.exports}var Ep={exports:{}},Un={};var E_;function a2(){if(E_)return Un;E_=1;var n=Lg();function e(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)f+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function a(h,f,p){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:g==null?null:""+g,children:h,containerInfo:f,implementation:p}}var o=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(h,f){if(h==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Un.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Un.createPortal=function(h,f){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return a(h,f,null,p)},Un.flushSync=function(h){var f=o.T,p=i.p;try{if(o.T=null,i.p=2,h)return h()}finally{o.T=f,i.p=p,i.d.f()}},Un.preconnect=function(h,f){typeof h=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,i.d.C(h,f))},Un.prefetchDNS=function(h){typeof h=="string"&&i.d.D(h)},Un.preinit=function(h,f){if(typeof h=="string"&&f&&typeof f.as=="string"){var p=f.as,g=c(p,f.crossOrigin),m=typeof f.integrity=="string"?f.integrity:void 0,y=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;p==="style"?i.d.S(h,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:g,integrity:m,fetchPriority:y}):p==="script"&&i.d.X(h,{crossOrigin:g,integrity:m,fetchPriority:y,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Un.preinitModule=function(h,f){if(typeof h=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var p=c(f.as,f.crossOrigin);i.d.M(h,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&i.d.M(h)},Un.preload=function(h,f){if(typeof h=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var p=f.as,g=c(p,f.crossOrigin);i.d.L(h,p,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Un.preloadModule=function(h,f){if(typeof h=="string")if(f){var p=c(f.as,f.crossOrigin);i.d.m(h,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else i.d.m(h)},Un.requestFormReset=function(h){i.d.r(h)},Un.unstable_batchedUpdates=function(h,f){return h(f)},Un.useFormState=function(h,f,p){return o.H.useFormState(h,f,p)},Un.useFormStatus=function(){return o.H.useHostTransitionStatus()},Un.version="19.2.3",Un}var S_;function o2(){if(S_)return Ep.exports;S_=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Ep.exports=a2(),Ep.exports}var A_;function l2(){if(A_)return uc;A_=1;var n=s2(),e=Lg(),t=o2();function i(s){var l="https://react.dev/errors/"+s;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)l+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function a(s){var l=s,u=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,(l.flags&4098)!==0&&(u=l.return),s=l.return;while(s)}return l.tag===3?u:null}function o(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function c(s){if(s.tag===31){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function h(s){if(a(s)!==s)throw Error(i(188))}function f(s){var l=s.alternate;if(!l){if(l=a(s),l===null)throw Error(i(188));return l!==s?null:s}for(var u=s,d=l;;){var v=u.return;if(v===null)break;var x=v.alternate;if(x===null){if(d=v.return,d!==null){u=d;continue}break}if(v.child===x.child){for(x=v.child;x;){if(x===u)return h(v),s;if(x===d)return h(v),l;x=x.sibling}throw Error(i(188))}if(u.return!==d.return)u=v,d=x;else{for(var A=!1,D=v.child;D;){if(D===u){A=!0,u=v,d=x;break}if(D===d){A=!0,d=v,u=x;break}D=D.sibling}if(!A){for(D=x.child;D;){if(D===u){A=!0,u=x,d=v;break}if(D===d){A=!0,d=x,u=v;break}D=D.sibling}if(!A)throw Error(i(189))}}if(u.alternate!==d)throw Error(i(190))}if(u.tag!==3)throw Error(i(188));return u.stateNode.current===u?s:l}function p(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s;for(s=s.child;s!==null;){if(l=p(s),l!==null)return l;s=s.sibling}return null}var g=Object.assign,m=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),T=Symbol.for("react.consumer"),S=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),F=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),G=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),W=Symbol.for("react.memo_cache_sentinel"),Y=Symbol.iterator;function ce(s){return s===null||typeof s!="object"?null:(s=Y&&s[Y]||s["@@iterator"],typeof s=="function"?s:null)}var ve=Symbol.for("react.client.reference");function Ce(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===ve?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case _:return"Fragment";case E:return"Profiler";case b:return"StrictMode";case P:return"Suspense";case F:return"SuspenseList";case M:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case w:return"Portal";case S:return s.displayName||"Context";case T:return(s._context.displayName||"Context")+".Consumer";case k:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case O:return l=s.displayName||null,l!==null?l:Ce(s.type)||"Memo";case G:l=s._payload,s=s._init;try{return Ce(s(l))}catch{}}return null}var ke=Array.isArray,J=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,we={pending:!1,data:null,method:null,action:null},Pe=[],$e=-1;function V(s){return{current:s}}function N(s){0>$e||(s.current=Pe[$e],Pe[$e]=null,$e--)}function z(s,l){$e++,Pe[$e]=s.current,s.current=l}var H=V(null),q=V(null),oe=V(null),me=V(null);function Re(s,l){switch(z(oe,l),z(q,s),z(H,null),l.nodeType){case 9:case 11:s=(s=l.documentElement)&&(s=s.namespaceURI)?By(s):0;break;default:if(s=l.tagName,l=l.namespaceURI)l=By(l),s=Uy(l,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}N(H),z(H,s)}function be(){N(H),N(q),N(oe)}function Te(s){s.memoizedState!==null&&z(me,s);var l=H.current,u=Uy(l,s.type);l!==u&&(z(q,s),z(H,u))}function it(s){q.current===s&&(N(H),N(q)),me.current===s&&(N(me),sc._currentValue=we)}var Je,Qt;function Ze(s){if(Je===void 0)try{throw Error()}catch(u){var l=u.stack.trim().match(/\n( *(at )?)/);Je=l&&l[1]||"",Qt=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Je+s+Qt}var hi=!1;function kt(s,l){if(!s||hi)return"";hi=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(l){var ge=function(){throw Error()};if(Object.defineProperty(ge.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ge,[])}catch(ue){var se=ue}Reflect.construct(s,[],ge)}else{try{ge.call()}catch(ue){se=ue}s.call(ge.prototype)}}else{try{throw Error()}catch(ue){se=ue}(ge=s())&&typeof ge.catch=="function"&&ge.catch(function(){})}}catch(ue){if(ue&&se&&typeof ue.stack=="string")return[ue.stack,se.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var v=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");v&&v.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=d.DetermineComponentFrameRoot(),A=x[0],D=x[1];if(A&&D){var X=A.split(`
`),te=D.split(`
`);for(v=d=0;d<X.length&&!X[d].includes("DetermineComponentFrameRoot");)d++;for(;v<te.length&&!te[v].includes("DetermineComponentFrameRoot");)v++;if(d===X.length||v===te.length)for(d=X.length-1,v=te.length-1;1<=d&&0<=v&&X[d]!==te[v];)v--;for(;1<=d&&0<=v;d--,v--)if(X[d]!==te[v]){if(d!==1||v!==1)do if(d--,v--,0>v||X[d]!==te[v]){var fe=`
`+X[d].replace(" at new "," at ");return s.displayName&&fe.includes("<anonymous>")&&(fe=fe.replace("<anonymous>",s.displayName)),fe}while(1<=d&&0<=v);break}}}finally{hi=!1,Error.prepareStackTrace=u}return(u=s?s.displayName||s.name:"")?Ze(u):""}function Le(s,l){switch(s.tag){case 26:case 27:case 5:return Ze(s.type);case 16:return Ze("Lazy");case 13:return s.child!==l&&l!==null?Ze("Suspense Fallback"):Ze("Suspense");case 19:return Ze("SuspenseList");case 0:case 15:return kt(s.type,!1);case 11:return kt(s.type.render,!1);case 1:return kt(s.type,!0);case 31:return Ze("Activity");default:return""}}function $n(s){try{var l="",u=null;do l+=Le(s,u),u=s,s=s.return;while(s);return l}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}var fi=Object.prototype.hasOwnProperty,Qi=n.unstable_scheduleCallback,pr=n.unstable_cancelCallback,xu=n.unstable_shouldYield,ml=n.unstable_requestPaint,Pt=n.unstable_now,za=n.unstable_getCurrentPriorityLevel,$a=n.unstable_ImmediatePriority,Ga=n.unstable_UserBlockingPriority,Di=n.unstable_NormalPriority,ad=n.unstable_LowPriority,vl=n.unstable_IdlePriority,wu=n.log,bu=n.unstable_setDisableYieldValue,cs=null,Bn=null;function Zi(s){if(typeof wu=="function"&&bu(s),Bn&&typeof Bn.setStrictMode=="function")try{Bn.setStrictMode(cs,s)}catch{}}var Gn=Math.clz32?Math.clz32:Su,od=Math.log,Eu=Math.LN2;function Su(s){return s>>>=0,s===0?32:31-(od(s)/Eu|0)|0}var Ks=256,Va=262144,qa=4194304;function Ni(s){var l=s&42;if(l!==0)return l;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Wa(s,l,u){var d=s.pendingLanes;if(d===0)return 0;var v=0,x=s.suspendedLanes,A=s.pingedLanes;s=s.warmLanes;var D=d&134217727;return D!==0?(d=D&~x,d!==0?v=Ni(d):(A&=D,A!==0?v=Ni(A):u||(u=D&~s,u!==0&&(v=Ni(u))))):(D=d&~x,D!==0?v=Ni(D):A!==0?v=Ni(A):u||(u=d&~s,u!==0&&(v=Ni(u)))),v===0?0:l!==0&&l!==v&&(l&x)===0&&(x=v&-v,u=l&-l,x>=u||x===32&&(u&4194048)!==0)?l:v}function Js(s,l){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&l)===0}function ld(s,l){switch(s){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Au(){var s=qa;return qa<<=1,(qa&62914560)===0&&(qa=4194304),s}function yl(s){for(var l=[],u=0;31>u;u++)l.push(s);return l}function Qs(s,l){s.pendingLanes|=l,l!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function cd(s,l,u,d,v,x){var A=s.pendingLanes;s.pendingLanes=u,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=u,s.entangledLanes&=u,s.errorRecoveryDisabledLanes&=u,s.shellSuspendCounter=0;var D=s.entanglements,X=s.expirationTimes,te=s.hiddenUpdates;for(u=A&~u;0<u;){var fe=31-Gn(u),ge=1<<fe;D[fe]=0,X[fe]=-1;var se=te[fe];if(se!==null)for(te[fe]=null,fe=0;fe<se.length;fe++){var ue=se[fe];ue!==null&&(ue.lane&=-536870913)}u&=~ge}d!==0&&Tu(s,d,0),x!==0&&v===0&&s.tag!==0&&(s.suspendedLanes|=x&~(A&~l))}function Tu(s,l,u){s.pendingLanes|=l,s.suspendedLanes&=~l;var d=31-Gn(l);s.entangledLanes|=l,s.entanglements[d]=s.entanglements[d]|1073741824|u&261930}function Xa(s,l){var u=s.entangledLanes|=l;for(s=s.entanglements;u;){var d=31-Gn(u),v=1<<d;v&l|s[d]&l&&(s[d]|=l),u&=~v}}function Cu(s,l){var u=l&-l;return u=(u&42)!==0?1:_l(u),(u&(s.suspendedLanes|l))!==0?0:u}function _l(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function xl(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function R(){var s=ae.p;return s!==0?s:(s=window.event,s===void 0?32:l_(s.type))}function U(s,l){var u=ae.p;try{return ae.p=s,l()}finally{ae.p=u}}var L=Math.random().toString(36).slice(2),I="__reactFiber$"+L,B="__reactProps$"+L,j="__reactContainer$"+L,ne="__reactEvents$"+L,de="__reactListeners$"+L,ie="__reactHandles$"+L,re="__reactResources$"+L,le="__reactMarker$"+L;function _e(s){delete s[I],delete s[B],delete s[ne],delete s[de],delete s[ie]}function Ee(s){var l=s[I];if(l)return l;for(var u=s.parentNode;u;){if(l=u[j]||u[I]){if(u=l.alternate,l.child!==null||u!==null&&u.child!==null)for(s=qy(s);s!==null;){if(u=s[I])return u;s=qy(s)}return l}s=u,u=s.parentNode}return null}function De(s){if(s=s[I]||s[j]){var l=s.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return s}return null}function xe(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s.stateNode;throw Error(i(33))}function Oe(s){var l=s[re];return l||(l=s[re]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Ie(s){s[le]=!0}var Dt=new Set,Nt={};function Bt(s,l){Mi(s,l),Mi(s+"Capture",l)}function Mi(s,l){for(Nt[s]=l,s=0;s<l.length;s++)Dt.add(l[s])}var Zs=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),us={},gr={};function wl(s){return fi.call(gr,s)?!0:fi.call(us,s)?!1:Zs.test(s)?gr[s]=!0:(us[s]=!0,!1)}function Qn(s,l,u){if(wl(l))if(u===null)s.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":s.removeAttribute(l);return;case"boolean":var d=l.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){s.removeAttribute(l);return}}s.setAttribute(l,""+u)}}function Ru(s,l,u){if(u===null)s.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttribute(l,""+u)}}function Nr(s,l,u,d){if(d===null)s.removeAttribute(u);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(u);return}s.setAttributeNS(l,u,""+d)}}function Li(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function km(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function XS(s,l,u){var d=Object.getOwnPropertyDescriptor(s.constructor.prototype,l);if(!s.hasOwnProperty(l)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var v=d.get,x=d.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return v.call(this)},set:function(A){u=""+A,x.call(this,A)}}),Object.defineProperty(s,l,{enumerable:d.enumerable}),{getValue:function(){return u},setValue:function(A){u=""+A},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function ud(s){if(!s._valueTracker){var l=km(s)?"checked":"value";s._valueTracker=XS(s,l,""+s[l])}}function Dm(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var u=l.getValue(),d="";return s&&(d=km(s)?s.checked?"true":"false":s.value),s=d,s!==u?(l.setValue(s),!0):!1}function Ou(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var YS=/[\n"\\]/g;function Fi(s){return s.replace(YS,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function hd(s,l,u,d,v,x,A,D){s.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?s.type=A:s.removeAttribute("type"),l!=null?A==="number"?(l===0&&s.value===""||s.value!=l)&&(s.value=""+Li(l)):s.value!==""+Li(l)&&(s.value=""+Li(l)):A!=="submit"&&A!=="reset"||s.removeAttribute("value"),l!=null?fd(s,A,Li(l)):u!=null?fd(s,A,Li(u)):d!=null&&s.removeAttribute("value"),v==null&&x!=null&&(s.defaultChecked=!!x),v!=null&&(s.checked=v&&typeof v!="function"&&typeof v!="symbol"),D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?s.name=""+Li(D):s.removeAttribute("name")}function Nm(s,l,u,d,v,x,A,D){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(s.type=x),l!=null||u!=null){if(!(x!=="submit"&&x!=="reset"||l!=null)){ud(s);return}u=u!=null?""+Li(u):"",l=l!=null?""+Li(l):u,D||l===s.value||(s.value=l),s.defaultValue=l}d=d??v,d=typeof d!="function"&&typeof d!="symbol"&&!!d,s.checked=D?s.checked:!!d,s.defaultChecked=!!d,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(s.name=A),ud(s)}function fd(s,l,u){l==="number"&&Ou(s.ownerDocument)===s||s.defaultValue===""+u||(s.defaultValue=""+u)}function Ya(s,l,u,d){if(s=s.options,l){l={};for(var v=0;v<u.length;v++)l["$"+u[v]]=!0;for(u=0;u<s.length;u++)v=l.hasOwnProperty("$"+s[u].value),s[u].selected!==v&&(s[u].selected=v),v&&d&&(s[u].defaultSelected=!0)}else{for(u=""+Li(u),l=null,v=0;v<s.length;v++){if(s[v].value===u){s[v].selected=!0,d&&(s[v].defaultSelected=!0);return}l!==null||s[v].disabled||(l=s[v])}l!==null&&(l.selected=!0)}}function Mm(s,l,u){if(l!=null&&(l=""+Li(l),l!==s.value&&(s.value=l),u==null)){s.defaultValue!==l&&(s.defaultValue=l);return}s.defaultValue=u!=null?""+Li(u):""}function Lm(s,l,u,d){if(l==null){if(d!=null){if(u!=null)throw Error(i(92));if(ke(d)){if(1<d.length)throw Error(i(93));d=d[0]}u=d}u==null&&(u=""),l=u}u=Li(l),s.defaultValue=u,d=s.textContent,d===u&&d!==""&&d!==null&&(s.value=d),ud(s)}function Ka(s,l){if(l){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=l;return}}s.textContent=l}var KS=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Fm(s,l,u){var d=l.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?d?s.setProperty(l,""):l==="float"?s.cssFloat="":s[l]="":d?s.setProperty(l,u):typeof u!="number"||u===0||KS.has(l)?l==="float"?s.cssFloat=u:s[l]=(""+u).trim():s[l]=u+"px"}function Im(s,l,u){if(l!=null&&typeof l!="object")throw Error(i(62));if(s=s.style,u!=null){for(var d in u)!u.hasOwnProperty(d)||l!=null&&l.hasOwnProperty(d)||(d.indexOf("--")===0?s.setProperty(d,""):d==="float"?s.cssFloat="":s[d]="");for(var v in l)d=l[v],l.hasOwnProperty(v)&&u[v]!==d&&Fm(s,v,d)}else for(var x in l)l.hasOwnProperty(x)&&Fm(s,x,l[x])}function dd(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var JS=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),QS=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ku(s){return QS.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Mr(){}var pd=null;function gd(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Ja=null,Qa=null;function Pm(s){var l=De(s);if(l&&(s=l.stateNode)){var u=s[B]||null;e:switch(s=l.stateNode,l.type){case"input":if(hd(s,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),l=u.name,u.type==="radio"&&l!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Fi(""+l)+'"][type="radio"]'),l=0;l<u.length;l++){var d=u[l];if(d!==s&&d.form===s.form){var v=d[B]||null;if(!v)throw Error(i(90));hd(d,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name)}}for(l=0;l<u.length;l++)d=u[l],d.form===s.form&&Dm(d)}break e;case"textarea":Mm(s,u.value,u.defaultValue);break e;case"select":l=u.value,l!=null&&Ya(s,!!u.multiple,l,!1)}}}var md=!1;function Bm(s,l,u){if(md)return s(l,u);md=!0;try{var d=s(l);return d}finally{if(md=!1,(Ja!==null||Qa!==null)&&(vh(),Ja&&(l=Ja,s=Qa,Qa=Ja=null,Pm(l),s)))for(l=0;l<s.length;l++)Pm(s[l])}}function bl(s,l){var u=s.stateNode;if(u===null)return null;var d=u[B]||null;if(d===null)return null;u=d[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(s=s.type,d=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!d;break e;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(i(231,l,typeof u));return u}var Lr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vd=!1;if(Lr)try{var El={};Object.defineProperty(El,"passive",{get:function(){vd=!0}}),window.addEventListener("test",El,El),window.removeEventListener("test",El,El)}catch{vd=!1}var hs=null,yd=null,Du=null;function Um(){if(Du)return Du;var s,l=yd,u=l.length,d,v="value"in hs?hs.value:hs.textContent,x=v.length;for(s=0;s<u&&l[s]===v[s];s++);var A=u-s;for(d=1;d<=A&&l[u-d]===v[x-d];d++);return Du=v.slice(s,1<d?1-d:void 0)}function Nu(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function Mu(){return!0}function jm(){return!1}function Zn(s){function l(u,d,v,x,A){this._reactName=u,this._targetInst=v,this.type=d,this.nativeEvent=x,this.target=A,this.currentTarget=null;for(var D in s)s.hasOwnProperty(D)&&(u=s[D],this[D]=u?u(x):x[D]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?Mu:jm,this.isPropagationStopped=jm,this}return g(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Mu)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Mu)},persist:function(){},isPersistent:Mu}),l}var ea={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Lu=Zn(ea),Sl=g({},ea,{view:0,detail:0}),ZS=Zn(Sl),_d,xd,Al,Fu=g({},Sl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bd,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Al&&(Al&&s.type==="mousemove"?(_d=s.screenX-Al.screenX,xd=s.screenY-Al.screenY):xd=_d=0,Al=s),_d)},movementY:function(s){return"movementY"in s?s.movementY:xd}}),Hm=Zn(Fu),eA=g({},Fu,{dataTransfer:0}),tA=Zn(eA),nA=g({},Sl,{relatedTarget:0}),wd=Zn(nA),iA=g({},ea,{animationName:0,elapsedTime:0,pseudoElement:0}),rA=Zn(iA),sA=g({},ea,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),aA=Zn(sA),oA=g({},ea,{data:0}),zm=Zn(oA),lA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},uA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hA(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=uA[s])?!!l[s]:!1}function bd(){return hA}var fA=g({},Sl,{key:function(s){if(s.key){var l=lA[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=Nu(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?cA[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bd,charCode:function(s){return s.type==="keypress"?Nu(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Nu(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),dA=Zn(fA),pA=g({},Fu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$m=Zn(pA),gA=g({},Sl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bd}),mA=Zn(gA),vA=g({},ea,{propertyName:0,elapsedTime:0,pseudoElement:0}),yA=Zn(vA),_A=g({},Fu,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),xA=Zn(_A),wA=g({},ea,{newState:0,oldState:0}),bA=Zn(wA),EA=[9,13,27,32],Ed=Lr&&"CompositionEvent"in window,Tl=null;Lr&&"documentMode"in document&&(Tl=document.documentMode);var SA=Lr&&"TextEvent"in window&&!Tl,Gm=Lr&&(!Ed||Tl&&8<Tl&&11>=Tl),Vm=" ",qm=!1;function Wm(s,l){switch(s){case"keyup":return EA.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xm(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Za=!1;function AA(s,l){switch(s){case"compositionend":return Xm(l);case"keypress":return l.which!==32?null:(qm=!0,Vm);case"textInput":return s=l.data,s===Vm&&qm?null:s;default:return null}}function TA(s,l){if(Za)return s==="compositionend"||!Ed&&Wm(s,l)?(s=Um(),Du=yd=hs=null,Za=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Gm&&l.locale!=="ko"?null:l.data;default:return null}}var CA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ym(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!CA[s.type]:l==="textarea"}function Km(s,l,u,d){Ja?Qa?Qa.push(d):Qa=[d]:Ja=d,l=Sh(l,"onChange"),0<l.length&&(u=new Lu("onChange","change",null,u,d),s.push({event:u,listeners:l}))}var Cl=null,Rl=null;function RA(s){Ny(s,0)}function Iu(s){var l=xe(s);if(Dm(l))return s}function Jm(s,l){if(s==="change")return l}var Qm=!1;if(Lr){var Sd;if(Lr){var Ad="oninput"in document;if(!Ad){var Zm=document.createElement("div");Zm.setAttribute("oninput","return;"),Ad=typeof Zm.oninput=="function"}Sd=Ad}else Sd=!1;Qm=Sd&&(!document.documentMode||9<document.documentMode)}function ev(){Cl&&(Cl.detachEvent("onpropertychange",tv),Rl=Cl=null)}function tv(s){if(s.propertyName==="value"&&Iu(Rl)){var l=[];Km(l,Rl,s,gd(s)),Bm(RA,l)}}function OA(s,l,u){s==="focusin"?(ev(),Cl=l,Rl=u,Cl.attachEvent("onpropertychange",tv)):s==="focusout"&&ev()}function kA(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Iu(Rl)}function DA(s,l){if(s==="click")return Iu(l)}function NA(s,l){if(s==="input"||s==="change")return Iu(l)}function MA(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var di=typeof Object.is=="function"?Object.is:MA;function Ol(s,l){if(di(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var u=Object.keys(s),d=Object.keys(l);if(u.length!==d.length)return!1;for(d=0;d<u.length;d++){var v=u[d];if(!fi.call(l,v)||!di(s[v],l[v]))return!1}return!0}function nv(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function iv(s,l){var u=nv(s);s=0;for(var d;u;){if(u.nodeType===3){if(d=s+u.textContent.length,s<=l&&d>=l)return{node:u,offset:l-s};s=d}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=nv(u)}}function rv(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?rv(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function sv(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var l=Ou(s.document);l instanceof s.HTMLIFrameElement;){try{var u=typeof l.contentWindow.location.href=="string"}catch{u=!1}if(u)s=l.contentWindow;else break;l=Ou(s.document)}return l}function Td(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}var LA=Lr&&"documentMode"in document&&11>=document.documentMode,eo=null,Cd=null,kl=null,Rd=!1;function av(s,l,u){var d=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Rd||eo==null||eo!==Ou(d)||(d=eo,"selectionStart"in d&&Td(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),kl&&Ol(kl,d)||(kl=d,d=Sh(Cd,"onSelect"),0<d.length&&(l=new Lu("onSelect","select",null,l,u),s.push({event:l,listeners:d}),l.target=eo)))}function ta(s,l){var u={};return u[s.toLowerCase()]=l.toLowerCase(),u["Webkit"+s]="webkit"+l,u["Moz"+s]="moz"+l,u}var to={animationend:ta("Animation","AnimationEnd"),animationiteration:ta("Animation","AnimationIteration"),animationstart:ta("Animation","AnimationStart"),transitionrun:ta("Transition","TransitionRun"),transitionstart:ta("Transition","TransitionStart"),transitioncancel:ta("Transition","TransitionCancel"),transitionend:ta("Transition","TransitionEnd")},Od={},ov={};Lr&&(ov=document.createElement("div").style,"AnimationEvent"in window||(delete to.animationend.animation,delete to.animationiteration.animation,delete to.animationstart.animation),"TransitionEvent"in window||delete to.transitionend.transition);function na(s){if(Od[s])return Od[s];if(!to[s])return s;var l=to[s],u;for(u in l)if(l.hasOwnProperty(u)&&u in ov)return Od[s]=l[u];return s}var lv=na("animationend"),cv=na("animationiteration"),uv=na("animationstart"),FA=na("transitionrun"),IA=na("transitionstart"),PA=na("transitioncancel"),hv=na("transitionend"),fv=new Map,kd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");kd.push("scrollEnd");function er(s,l){fv.set(s,l),Bt(l,[s])}var Pu=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Ii=[],no=0,Dd=0;function Bu(){for(var s=no,l=Dd=no=0;l<s;){var u=Ii[l];Ii[l++]=null;var d=Ii[l];Ii[l++]=null;var v=Ii[l];Ii[l++]=null;var x=Ii[l];if(Ii[l++]=null,d!==null&&v!==null){var A=d.pending;A===null?v.next=v:(v.next=A.next,A.next=v),d.pending=v}x!==0&&dv(u,v,x)}}function Uu(s,l,u,d){Ii[no++]=s,Ii[no++]=l,Ii[no++]=u,Ii[no++]=d,Dd|=d,s.lanes|=d,s=s.alternate,s!==null&&(s.lanes|=d)}function Nd(s,l,u,d){return Uu(s,l,u,d),ju(s)}function ia(s,l){return Uu(s,null,null,l),ju(s)}function dv(s,l,u){s.lanes|=u;var d=s.alternate;d!==null&&(d.lanes|=u);for(var v=!1,x=s.return;x!==null;)x.childLanes|=u,d=x.alternate,d!==null&&(d.childLanes|=u),x.tag===22&&(s=x.stateNode,s===null||s._visibility&1||(v=!0)),s=x,x=x.return;return s.tag===3?(x=s.stateNode,v&&l!==null&&(v=31-Gn(u),s=x.hiddenUpdates,d=s[v],d===null?s[v]=[l]:d.push(l),l.lane=u|536870912),x):null}function ju(s){if(50<Ql)throw Ql=0,H0=null,Error(i(185));for(var l=s.return;l!==null;)s=l,l=s.return;return s.tag===3?s.stateNode:null}var io={};function BA(s,l,u,d){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pi(s,l,u,d){return new BA(s,l,u,d)}function Md(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Fr(s,l){var u=s.alternate;return u===null?(u=pi(s.tag,l,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=l,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&65011712,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,l=s.dependencies,u.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u.refCleanup=s.refCleanup,u}function pv(s,l){s.flags&=65011714;var u=s.alternate;return u===null?(s.childLanes=0,s.lanes=l,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,l=u.dependencies,s.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),s}function Hu(s,l,u,d,v,x){var A=0;if(d=s,typeof s=="function")Md(s)&&(A=1);else if(typeof s=="string")A=$T(s,u,H.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case M:return s=pi(31,u,l,v),s.elementType=M,s.lanes=x,s;case _:return ra(u.children,v,x,l);case b:A=8,v|=24;break;case E:return s=pi(12,u,l,v|2),s.elementType=E,s.lanes=x,s;case P:return s=pi(13,u,l,v),s.elementType=P,s.lanes=x,s;case F:return s=pi(19,u,l,v),s.elementType=F,s.lanes=x,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case S:A=10;break e;case T:A=9;break e;case k:A=11;break e;case O:A=14;break e;case G:A=16,d=null;break e}A=29,u=Error(i(130,s===null?"null":typeof s,"")),d=null}return l=pi(A,u,l,v),l.elementType=s,l.type=d,l.lanes=x,l}function ra(s,l,u,d){return s=pi(7,s,d,l),s.lanes=u,s}function Ld(s,l,u){return s=pi(6,s,null,l),s.lanes=u,s}function gv(s){var l=pi(18,null,null,0);return l.stateNode=s,l}function Fd(s,l,u){return l=pi(4,s.children!==null?s.children:[],s.key,l),l.lanes=u,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}var mv=new WeakMap;function Pi(s,l){if(typeof s=="object"&&s!==null){var u=mv.get(s);return u!==void 0?u:(l={value:s,source:l,stack:$n(l)},mv.set(s,l),l)}return{value:s,source:l,stack:$n(l)}}var ro=[],so=0,zu=null,Dl=0,Bi=[],Ui=0,fs=null,mr=1,vr="";function Ir(s,l){ro[so++]=Dl,ro[so++]=zu,zu=s,Dl=l}function vv(s,l,u){Bi[Ui++]=mr,Bi[Ui++]=vr,Bi[Ui++]=fs,fs=s;var d=mr;s=vr;var v=32-Gn(d)-1;d&=~(1<<v),u+=1;var x=32-Gn(l)+v;if(30<x){var A=v-v%5;x=(d&(1<<A)-1).toString(32),d>>=A,v-=A,mr=1<<32-Gn(l)+v|u<<v|d,vr=x+s}else mr=1<<x|u<<v|d,vr=s}function Id(s){s.return!==null&&(Ir(s,1),vv(s,1,0))}function Pd(s){for(;s===zu;)zu=ro[--so],ro[so]=null,Dl=ro[--so],ro[so]=null;for(;s===fs;)fs=Bi[--Ui],Bi[Ui]=null,vr=Bi[--Ui],Bi[Ui]=null,mr=Bi[--Ui],Bi[Ui]=null}function yv(s,l){Bi[Ui++]=mr,Bi[Ui++]=vr,Bi[Ui++]=fs,mr=l.id,vr=l.overflow,fs=s}var Sn=null,Lt=null,at=!1,ds=null,ji=!1,Bd=Error(i(519));function ps(s){var l=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Nl(Pi(l,s)),Bd}function _v(s){var l=s.stateNode,u=s.type,d=s.memoizedProps;switch(l[I]=s,l[B]=d,u){case"dialog":nt("cancel",l),nt("close",l);break;case"iframe":case"object":case"embed":nt("load",l);break;case"video":case"audio":for(u=0;u<ec.length;u++)nt(ec[u],l);break;case"source":nt("error",l);break;case"img":case"image":case"link":nt("error",l),nt("load",l);break;case"details":nt("toggle",l);break;case"input":nt("invalid",l),Nm(l,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0);break;case"select":nt("invalid",l);break;case"textarea":nt("invalid",l),Lm(l,d.value,d.defaultValue,d.children)}u=d.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||l.textContent===""+u||d.suppressHydrationWarning===!0||Iy(l.textContent,u)?(d.popover!=null&&(nt("beforetoggle",l),nt("toggle",l)),d.onScroll!=null&&nt("scroll",l),d.onScrollEnd!=null&&nt("scrollend",l),d.onClick!=null&&(l.onclick=Mr),l=!0):l=!1,l||ps(s,!0)}function xv(s){for(Sn=s.return;Sn;)switch(Sn.tag){case 5:case 31:case 13:ji=!1;return;case 27:case 3:ji=!0;return;default:Sn=Sn.return}}function ao(s){if(s!==Sn)return!1;if(!at)return xv(s),at=!0,!1;var l=s.tag,u;if((u=l!==3&&l!==27)&&((u=l===5)&&(u=s.type,u=!(u!=="form"&&u!=="button")||np(s.type,s.memoizedProps)),u=!u),u&&Lt&&ps(s),xv(s),l===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Lt=Vy(s)}else if(l===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Lt=Vy(s)}else l===27?(l=Lt,Rs(s.type)?(s=op,op=null,Lt=s):Lt=l):Lt=Sn?zi(s.stateNode.nextSibling):null;return!0}function sa(){Lt=Sn=null,at=!1}function Ud(){var s=ds;return s!==null&&(ii===null?ii=s:ii.push.apply(ii,s),ds=null),s}function Nl(s){ds===null?ds=[s]:ds.push(s)}var jd=V(null),aa=null,Pr=null;function gs(s,l,u){z(jd,l._currentValue),l._currentValue=u}function Br(s){s._currentValue=jd.current,N(jd)}function Hd(s,l,u){for(;s!==null;){var d=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,d!==null&&(d.childLanes|=l)):d!==null&&(d.childLanes&l)!==l&&(d.childLanes|=l),s===u)break;s=s.return}}function zd(s,l,u,d){var v=s.child;for(v!==null&&(v.return=s);v!==null;){var x=v.dependencies;if(x!==null){var A=v.child;x=x.firstContext;e:for(;x!==null;){var D=x;x=v;for(var X=0;X<l.length;X++)if(D.context===l[X]){x.lanes|=u,D=x.alternate,D!==null&&(D.lanes|=u),Hd(x.return,u,s),d||(A=null);break e}x=D.next}}else if(v.tag===18){if(A=v.return,A===null)throw Error(i(341));A.lanes|=u,x=A.alternate,x!==null&&(x.lanes|=u),Hd(A,u,s),A=null}else A=v.child;if(A!==null)A.return=v;else for(A=v;A!==null;){if(A===s){A=null;break}if(v=A.sibling,v!==null){v.return=A.return,A=v;break}A=A.return}v=A}}function oo(s,l,u,d){s=null;for(var v=l,x=!1;v!==null;){if(!x){if((v.flags&524288)!==0)x=!0;else if((v.flags&262144)!==0)break}if(v.tag===10){var A=v.alternate;if(A===null)throw Error(i(387));if(A=A.memoizedProps,A!==null){var D=v.type;di(v.pendingProps.value,A.value)||(s!==null?s.push(D):s=[D])}}else if(v===me.current){if(A=v.alternate,A===null)throw Error(i(387));A.memoizedState.memoizedState!==v.memoizedState.memoizedState&&(s!==null?s.push(sc):s=[sc])}v=v.return}s!==null&&zd(l,s,u,d),l.flags|=262144}function $u(s){for(s=s.firstContext;s!==null;){if(!di(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function oa(s){aa=s,Pr=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function An(s){return wv(aa,s)}function Gu(s,l){return aa===null&&oa(s),wv(s,l)}function wv(s,l){var u=l._currentValue;if(l={context:l,memoizedValue:u,next:null},Pr===null){if(s===null)throw Error(i(308));Pr=l,s.dependencies={lanes:0,firstContext:l},s.flags|=524288}else Pr=Pr.next=l;return u}var UA=typeof AbortController<"u"?AbortController:function(){var s=[],l=this.signal={aborted:!1,addEventListener:function(u,d){s.push(d)}};this.abort=function(){l.aborted=!0,s.forEach(function(u){return u()})}},jA=n.unstable_scheduleCallback,HA=n.unstable_NormalPriority,nn={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function $d(){return{controller:new UA,data:new Map,refCount:0}}function Ml(s){s.refCount--,s.refCount===0&&jA(HA,function(){s.controller.abort()})}var Ll=null,Gd=0,lo=0,co=null;function zA(s,l){if(Ll===null){var u=Ll=[];Gd=0,lo=W0(),co={status:"pending",value:void 0,then:function(d){u.push(d)}}}return Gd++,l.then(bv,bv),l}function bv(){if(--Gd===0&&Ll!==null){co!==null&&(co.status="fulfilled");var s=Ll;Ll=null,lo=0,co=null;for(var l=0;l<s.length;l++)(0,s[l])()}}function $A(s,l){var u=[],d={status:"pending",value:null,reason:null,then:function(v){u.push(v)}};return s.then(function(){d.status="fulfilled",d.value=l;for(var v=0;v<u.length;v++)(0,u[v])(l)},function(v){for(d.status="rejected",d.reason=v,v=0;v<u.length;v++)(0,u[v])(void 0)}),d}var Ev=J.S;J.S=function(s,l){ay=Pt(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&zA(s,l),Ev!==null&&Ev(s,l)};var la=V(null);function Vd(){var s=la.current;return s!==null?s:Ct.pooledCache}function Vu(s,l){l===null?z(la,la.current):z(la,l.pool)}function Sv(){var s=Vd();return s===null?null:{parent:nn._currentValue,pool:s}}var uo=Error(i(460)),qd=Error(i(474)),qu=Error(i(542)),Wu={then:function(){}};function Av(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Tv(s,l,u){switch(u=s[u],u===void 0?s.push(l):u!==l&&(l.then(Mr,Mr),l=u),l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,Rv(s),s;default:if(typeof l.status=="string")l.then(Mr,Mr);else{if(s=Ct,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=l,s.status="pending",s.then(function(d){if(l.status==="pending"){var v=l;v.status="fulfilled",v.value=d}},function(d){if(l.status==="pending"){var v=l;v.status="rejected",v.reason=d}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,Rv(s),s}throw ua=l,uo}}function ca(s){try{var l=s._init;return l(s._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(ua=u,uo):u}}var ua=null;function Cv(){if(ua===null)throw Error(i(459));var s=ua;return ua=null,s}function Rv(s){if(s===uo||s===qu)throw Error(i(483))}var ho=null,Fl=0;function Xu(s){var l=Fl;return Fl+=1,ho===null&&(ho=[]),Tv(ho,s,l)}function Il(s,l){l=l.props.ref,s.ref=l!==void 0?l:null}function Yu(s,l){throw l.$$typeof===m?Error(i(525)):(s=Object.prototype.toString.call(l),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s)))}function Ov(s){function l(Q,K){if(s){var ee=Q.deletions;ee===null?(Q.deletions=[K],Q.flags|=16):ee.push(K)}}function u(Q,K){if(!s)return null;for(;K!==null;)l(Q,K),K=K.sibling;return null}function d(Q){for(var K=new Map;Q!==null;)Q.key!==null?K.set(Q.key,Q):K.set(Q.index,Q),Q=Q.sibling;return K}function v(Q,K){return Q=Fr(Q,K),Q.index=0,Q.sibling=null,Q}function x(Q,K,ee){return Q.index=ee,s?(ee=Q.alternate,ee!==null?(ee=ee.index,ee<K?(Q.flags|=67108866,K):ee):(Q.flags|=67108866,K)):(Q.flags|=1048576,K)}function A(Q){return s&&Q.alternate===null&&(Q.flags|=67108866),Q}function D(Q,K,ee,pe){return K===null||K.tag!==6?(K=Ld(ee,Q.mode,pe),K.return=Q,K):(K=v(K,ee),K.return=Q,K)}function X(Q,K,ee,pe){var je=ee.type;return je===_?fe(Q,K,ee.props.children,pe,ee.key):K!==null&&(K.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===G&&ca(je)===K.type)?(K=v(K,ee.props),Il(K,ee),K.return=Q,K):(K=Hu(ee.type,ee.key,ee.props,null,Q.mode,pe),Il(K,ee),K.return=Q,K)}function te(Q,K,ee,pe){return K===null||K.tag!==4||K.stateNode.containerInfo!==ee.containerInfo||K.stateNode.implementation!==ee.implementation?(K=Fd(ee,Q.mode,pe),K.return=Q,K):(K=v(K,ee.children||[]),K.return=Q,K)}function fe(Q,K,ee,pe,je){return K===null||K.tag!==7?(K=ra(ee,Q.mode,pe,je),K.return=Q,K):(K=v(K,ee),K.return=Q,K)}function ge(Q,K,ee){if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return K=Ld(""+K,Q.mode,ee),K.return=Q,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case y:return ee=Hu(K.type,K.key,K.props,null,Q.mode,ee),Il(ee,K),ee.return=Q,ee;case w:return K=Fd(K,Q.mode,ee),K.return=Q,K;case G:return K=ca(K),ge(Q,K,ee)}if(ke(K)||ce(K))return K=ra(K,Q.mode,ee,null),K.return=Q,K;if(typeof K.then=="function")return ge(Q,Xu(K),ee);if(K.$$typeof===S)return ge(Q,Gu(Q,K),ee);Yu(Q,K)}return null}function se(Q,K,ee,pe){var je=K!==null?K.key:null;if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return je!==null?null:D(Q,K,""+ee,pe);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case y:return ee.key===je?X(Q,K,ee,pe):null;case w:return ee.key===je?te(Q,K,ee,pe):null;case G:return ee=ca(ee),se(Q,K,ee,pe)}if(ke(ee)||ce(ee))return je!==null?null:fe(Q,K,ee,pe,null);if(typeof ee.then=="function")return se(Q,K,Xu(ee),pe);if(ee.$$typeof===S)return se(Q,K,Gu(Q,ee),pe);Yu(Q,ee)}return null}function ue(Q,K,ee,pe,je){if(typeof pe=="string"&&pe!==""||typeof pe=="number"||typeof pe=="bigint")return Q=Q.get(ee)||null,D(K,Q,""+pe,je);if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case y:return Q=Q.get(pe.key===null?ee:pe.key)||null,X(K,Q,pe,je);case w:return Q=Q.get(pe.key===null?ee:pe.key)||null,te(K,Q,pe,je);case G:return pe=ca(pe),ue(Q,K,ee,pe,je)}if(ke(pe)||ce(pe))return Q=Q.get(ee)||null,fe(K,Q,pe,je,null);if(typeof pe.then=="function")return ue(Q,K,ee,Xu(pe),je);if(pe.$$typeof===S)return ue(Q,K,ee,Gu(K,pe),je);Yu(K,pe)}return null}function Fe(Q,K,ee,pe){for(var je=null,ct=null,Be=K,Qe=K=0,st=null;Be!==null&&Qe<ee.length;Qe++){Be.index>Qe?(st=Be,Be=null):st=Be.sibling;var ut=se(Q,Be,ee[Qe],pe);if(ut===null){Be===null&&(Be=st);break}s&&Be&&ut.alternate===null&&l(Q,Be),K=x(ut,K,Qe),ct===null?je=ut:ct.sibling=ut,ct=ut,Be=st}if(Qe===ee.length)return u(Q,Be),at&&Ir(Q,Qe),je;if(Be===null){for(;Qe<ee.length;Qe++)Be=ge(Q,ee[Qe],pe),Be!==null&&(K=x(Be,K,Qe),ct===null?je=Be:ct.sibling=Be,ct=Be);return at&&Ir(Q,Qe),je}for(Be=d(Be);Qe<ee.length;Qe++)st=ue(Be,Q,Qe,ee[Qe],pe),st!==null&&(s&&st.alternate!==null&&Be.delete(st.key===null?Qe:st.key),K=x(st,K,Qe),ct===null?je=st:ct.sibling=st,ct=st);return s&&Be.forEach(function(Ms){return l(Q,Ms)}),at&&Ir(Q,Qe),je}function ze(Q,K,ee,pe){if(ee==null)throw Error(i(151));for(var je=null,ct=null,Be=K,Qe=K=0,st=null,ut=ee.next();Be!==null&&!ut.done;Qe++,ut=ee.next()){Be.index>Qe?(st=Be,Be=null):st=Be.sibling;var Ms=se(Q,Be,ut.value,pe);if(Ms===null){Be===null&&(Be=st);break}s&&Be&&Ms.alternate===null&&l(Q,Be),K=x(Ms,K,Qe),ct===null?je=Ms:ct.sibling=Ms,ct=Ms,Be=st}if(ut.done)return u(Q,Be),at&&Ir(Q,Qe),je;if(Be===null){for(;!ut.done;Qe++,ut=ee.next())ut=ge(Q,ut.value,pe),ut!==null&&(K=x(ut,K,Qe),ct===null?je=ut:ct.sibling=ut,ct=ut);return at&&Ir(Q,Qe),je}for(Be=d(Be);!ut.done;Qe++,ut=ee.next())ut=ue(Be,Q,Qe,ut.value,pe),ut!==null&&(s&&ut.alternate!==null&&Be.delete(ut.key===null?Qe:ut.key),K=x(ut,K,Qe),ct===null?je=ut:ct.sibling=ut,ct=ut);return s&&Be.forEach(function(e2){return l(Q,e2)}),at&&Ir(Q,Qe),je}function St(Q,K,ee,pe){if(typeof ee=="object"&&ee!==null&&ee.type===_&&ee.key===null&&(ee=ee.props.children),typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case y:e:{for(var je=ee.key;K!==null;){if(K.key===je){if(je=ee.type,je===_){if(K.tag===7){u(Q,K.sibling),pe=v(K,ee.props.children),pe.return=Q,Q=pe;break e}}else if(K.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===G&&ca(je)===K.type){u(Q,K.sibling),pe=v(K,ee.props),Il(pe,ee),pe.return=Q,Q=pe;break e}u(Q,K);break}else l(Q,K);K=K.sibling}ee.type===_?(pe=ra(ee.props.children,Q.mode,pe,ee.key),pe.return=Q,Q=pe):(pe=Hu(ee.type,ee.key,ee.props,null,Q.mode,pe),Il(pe,ee),pe.return=Q,Q=pe)}return A(Q);case w:e:{for(je=ee.key;K!==null;){if(K.key===je)if(K.tag===4&&K.stateNode.containerInfo===ee.containerInfo&&K.stateNode.implementation===ee.implementation){u(Q,K.sibling),pe=v(K,ee.children||[]),pe.return=Q,Q=pe;break e}else{u(Q,K);break}else l(Q,K);K=K.sibling}pe=Fd(ee,Q.mode,pe),pe.return=Q,Q=pe}return A(Q);case G:return ee=ca(ee),St(Q,K,ee,pe)}if(ke(ee))return Fe(Q,K,ee,pe);if(ce(ee)){if(je=ce(ee),typeof je!="function")throw Error(i(150));return ee=je.call(ee),ze(Q,K,ee,pe)}if(typeof ee.then=="function")return St(Q,K,Xu(ee),pe);if(ee.$$typeof===S)return St(Q,K,Gu(Q,ee),pe);Yu(Q,ee)}return typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint"?(ee=""+ee,K!==null&&K.tag===6?(u(Q,K.sibling),pe=v(K,ee),pe.return=Q,Q=pe):(u(Q,K),pe=Ld(ee,Q.mode,pe),pe.return=Q,Q=pe),A(Q)):u(Q,K)}return function(Q,K,ee,pe){try{Fl=0;var je=St(Q,K,ee,pe);return ho=null,je}catch(Be){if(Be===uo||Be===qu)throw Be;var ct=pi(29,Be,null,Q.mode);return ct.lanes=pe,ct.return=Q,ct}}}var ha=Ov(!0),kv=Ov(!1),ms=!1;function Wd(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Xd(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function vs(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function ys(s,l,u){var d=s.updateQueue;if(d===null)return null;if(d=d.shared,(ft&2)!==0){var v=d.pending;return v===null?l.next=l:(l.next=v.next,v.next=l),d.pending=l,l=ju(s),dv(s,null,u),l}return Uu(s,d,l,u),ju(s)}function Pl(s,l,u){if(l=l.updateQueue,l!==null&&(l=l.shared,(u&4194048)!==0)){var d=l.lanes;d&=s.pendingLanes,u|=d,l.lanes=u,Xa(s,u)}}function Yd(s,l){var u=s.updateQueue,d=s.alternate;if(d!==null&&(d=d.updateQueue,u===d)){var v=null,x=null;if(u=u.firstBaseUpdate,u!==null){do{var A={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};x===null?v=x=A:x=x.next=A,u=u.next}while(u!==null);x===null?v=x=l:x=x.next=l}else v=x=l;u={baseState:d.baseState,firstBaseUpdate:v,lastBaseUpdate:x,shared:d.shared,callbacks:d.callbacks},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=l:s.next=l,u.lastBaseUpdate=l}var Kd=!1;function Bl(){if(Kd){var s=co;if(s!==null)throw s}}function Ul(s,l,u,d){Kd=!1;var v=s.updateQueue;ms=!1;var x=v.firstBaseUpdate,A=v.lastBaseUpdate,D=v.shared.pending;if(D!==null){v.shared.pending=null;var X=D,te=X.next;X.next=null,A===null?x=te:A.next=te,A=X;var fe=s.alternate;fe!==null&&(fe=fe.updateQueue,D=fe.lastBaseUpdate,D!==A&&(D===null?fe.firstBaseUpdate=te:D.next=te,fe.lastBaseUpdate=X))}if(x!==null){var ge=v.baseState;A=0,fe=te=X=null,D=x;do{var se=D.lane&-536870913,ue=se!==D.lane;if(ue?(rt&se)===se:(d&se)===se){se!==0&&se===lo&&(Kd=!0),fe!==null&&(fe=fe.next={lane:0,tag:D.tag,payload:D.payload,callback:null,next:null});e:{var Fe=s,ze=D;se=l;var St=u;switch(ze.tag){case 1:if(Fe=ze.payload,typeof Fe=="function"){ge=Fe.call(St,ge,se);break e}ge=Fe;break e;case 3:Fe.flags=Fe.flags&-65537|128;case 0:if(Fe=ze.payload,se=typeof Fe=="function"?Fe.call(St,ge,se):Fe,se==null)break e;ge=g({},ge,se);break e;case 2:ms=!0}}se=D.callback,se!==null&&(s.flags|=64,ue&&(s.flags|=8192),ue=v.callbacks,ue===null?v.callbacks=[se]:ue.push(se))}else ue={lane:se,tag:D.tag,payload:D.payload,callback:D.callback,next:null},fe===null?(te=fe=ue,X=ge):fe=fe.next=ue,A|=se;if(D=D.next,D===null){if(D=v.shared.pending,D===null)break;ue=D,D=ue.next,ue.next=null,v.lastBaseUpdate=ue,v.shared.pending=null}}while(!0);fe===null&&(X=ge),v.baseState=X,v.firstBaseUpdate=te,v.lastBaseUpdate=fe,x===null&&(v.shared.lanes=0),Es|=A,s.lanes=A,s.memoizedState=ge}}function Dv(s,l){if(typeof s!="function")throw Error(i(191,s));s.call(l)}function Nv(s,l){var u=s.callbacks;if(u!==null)for(s.callbacks=null,s=0;s<u.length;s++)Dv(u[s],l)}var fo=V(null),Ku=V(0);function Mv(s,l){s=Wr,z(Ku,s),z(fo,l),Wr=s|l.baseLanes}function Jd(){z(Ku,Wr),z(fo,fo.current)}function Qd(){Wr=Ku.current,N(fo),N(Ku)}var gi=V(null),Hi=null;function _s(s){var l=s.alternate;z(Zt,Zt.current&1),z(gi,s),Hi===null&&(l===null||fo.current!==null||l.memoizedState!==null)&&(Hi=s)}function Zd(s){z(Zt,Zt.current),z(gi,s),Hi===null&&(Hi=s)}function Lv(s){s.tag===22?(z(Zt,Zt.current),z(gi,s),Hi===null&&(Hi=s)):xs()}function xs(){z(Zt,Zt.current),z(gi,gi.current)}function mi(s){N(gi),Hi===s&&(Hi=null),N(Zt)}var Zt=V(0);function Ju(s){for(var l=s;l!==null;){if(l.tag===13){var u=l.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||sp(u)||ap(u)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var Ur=0,Ke=null,bt=null,rn=null,Qu=!1,po=!1,fa=!1,Zu=0,jl=0,go=null,GA=0;function qt(){throw Error(i(321))}function e0(s,l){if(l===null)return!1;for(var u=0;u<l.length&&u<s.length;u++)if(!di(s[u],l[u]))return!1;return!0}function t0(s,l,u,d,v,x){return Ur=x,Ke=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,J.H=s===null||s.memoizedState===null?v1:m0,fa=!1,x=u(d,v),fa=!1,po&&(x=Iv(l,u,d,v)),Fv(s),x}function Fv(s){J.H=$l;var l=bt!==null&&bt.next!==null;if(Ur=0,rn=bt=Ke=null,Qu=!1,jl=0,go=null,l)throw Error(i(300));s===null||sn||(s=s.dependencies,s!==null&&$u(s)&&(sn=!0))}function Iv(s,l,u,d){Ke=s;var v=0;do{if(po&&(go=null),jl=0,po=!1,25<=v)throw Error(i(301));if(v+=1,rn=bt=null,s.updateQueue!=null){var x=s.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}J.H=y1,x=l(u,d)}while(po);return x}function VA(){var s=J.H,l=s.useState()[0];return l=typeof l.then=="function"?Hl(l):l,s=s.useState()[0],(bt!==null?bt.memoizedState:null)!==s&&(Ke.flags|=1024),l}function n0(){var s=Zu!==0;return Zu=0,s}function i0(s,l,u){l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~u}function r0(s){if(Qu){for(s=s.memoizedState;s!==null;){var l=s.queue;l!==null&&(l.pending=null),s=s.next}Qu=!1}Ur=0,rn=bt=Ke=null,po=!1,jl=Zu=0,go=null}function Vn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rn===null?Ke.memoizedState=rn=s:rn=rn.next=s,rn}function en(){if(bt===null){var s=Ke.alternate;s=s!==null?s.memoizedState:null}else s=bt.next;var l=rn===null?Ke.memoizedState:rn.next;if(l!==null)rn=l,bt=s;else{if(s===null)throw Ke.alternate===null?Error(i(467)):Error(i(310));bt=s,s={memoizedState:bt.memoizedState,baseState:bt.baseState,baseQueue:bt.baseQueue,queue:bt.queue,next:null},rn===null?Ke.memoizedState=rn=s:rn=rn.next=s}return rn}function eh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Hl(s){var l=jl;return jl+=1,go===null&&(go=[]),s=Tv(go,s,l),l=Ke,(rn===null?l.memoizedState:rn.next)===null&&(l=l.alternate,J.H=l===null||l.memoizedState===null?v1:m0),s}function th(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Hl(s);if(s.$$typeof===S)return An(s)}throw Error(i(438,String(s)))}function s0(s){var l=null,u=Ke.updateQueue;if(u!==null&&(l=u.memoCache),l==null){var d=Ke.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(l={data:d.data.map(function(v){return v.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),u===null&&(u=eh(),Ke.updateQueue=u),u.memoCache=l,u=l.data[l.index],u===void 0)for(u=l.data[l.index]=Array(s),d=0;d<s;d++)u[d]=W;return l.index++,u}function jr(s,l){return typeof l=="function"?l(s):l}function nh(s){var l=en();return a0(l,bt,s)}function a0(s,l,u){var d=s.queue;if(d===null)throw Error(i(311));d.lastRenderedReducer=u;var v=s.baseQueue,x=d.pending;if(x!==null){if(v!==null){var A=v.next;v.next=x.next,x.next=A}l.baseQueue=v=x,d.pending=null}if(x=s.baseState,v===null)s.memoizedState=x;else{l=v.next;var D=A=null,X=null,te=l,fe=!1;do{var ge=te.lane&-536870913;if(ge!==te.lane?(rt&ge)===ge:(Ur&ge)===ge){var se=te.revertLane;if(se===0)X!==null&&(X=X.next={lane:0,revertLane:0,gesture:null,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null}),ge===lo&&(fe=!0);else if((Ur&se)===se){te=te.next,se===lo&&(fe=!0);continue}else ge={lane:0,revertLane:te.revertLane,gesture:null,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null},X===null?(D=X=ge,A=x):X=X.next=ge,Ke.lanes|=se,Es|=se;ge=te.action,fa&&u(x,ge),x=te.hasEagerState?te.eagerState:u(x,ge)}else se={lane:ge,revertLane:te.revertLane,gesture:te.gesture,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null},X===null?(D=X=se,A=x):X=X.next=se,Ke.lanes|=ge,Es|=ge;te=te.next}while(te!==null&&te!==l);if(X===null?A=x:X.next=D,!di(x,s.memoizedState)&&(sn=!0,fe&&(u=co,u!==null)))throw u;s.memoizedState=x,s.baseState=A,s.baseQueue=X,d.lastRenderedState=x}return v===null&&(d.lanes=0),[s.memoizedState,d.dispatch]}function o0(s){var l=en(),u=l.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=s;var d=u.dispatch,v=u.pending,x=l.memoizedState;if(v!==null){u.pending=null;var A=v=v.next;do x=s(x,A.action),A=A.next;while(A!==v);di(x,l.memoizedState)||(sn=!0),l.memoizedState=x,l.baseQueue===null&&(l.baseState=x),u.lastRenderedState=x}return[x,d]}function Pv(s,l,u){var d=Ke,v=en(),x=at;if(x){if(u===void 0)throw Error(i(407));u=u()}else u=l();var A=!di((bt||v).memoizedState,u);if(A&&(v.memoizedState=u,sn=!0),v=v.queue,u0(jv.bind(null,d,v,s),[s]),v.getSnapshot!==l||A||rn!==null&&rn.memoizedState.tag&1){if(d.flags|=2048,mo(9,{destroy:void 0},Uv.bind(null,d,v,u,l),null),Ct===null)throw Error(i(349));x||(Ur&127)!==0||Bv(d,l,u)}return u}function Bv(s,l,u){s.flags|=16384,s={getSnapshot:l,value:u},l=Ke.updateQueue,l===null?(l=eh(),Ke.updateQueue=l,l.stores=[s]):(u=l.stores,u===null?l.stores=[s]:u.push(s))}function Uv(s,l,u,d){l.value=u,l.getSnapshot=d,Hv(l)&&zv(s)}function jv(s,l,u){return u(function(){Hv(l)&&zv(s)})}function Hv(s){var l=s.getSnapshot;s=s.value;try{var u=l();return!di(s,u)}catch{return!0}}function zv(s){var l=ia(s,2);l!==null&&ri(l,s,2)}function l0(s){var l=Vn();if(typeof s=="function"){var u=s;if(s=u(),fa){Zi(!0);try{u()}finally{Zi(!1)}}}return l.memoizedState=l.baseState=s,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:jr,lastRenderedState:s},l}function $v(s,l,u,d){return s.baseState=u,a0(s,bt,typeof d=="function"?d:jr)}function qA(s,l,u,d,v){if(sh(s))throw Error(i(485));if(s=l.action,s!==null){var x={payload:v,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){x.listeners.push(A)}};J.T!==null?u(!0):x.isTransition=!1,d(x),u=l.pending,u===null?(x.next=l.pending=x,Gv(l,x)):(x.next=u.next,l.pending=u.next=x)}}function Gv(s,l){var u=l.action,d=l.payload,v=s.state;if(l.isTransition){var x=J.T,A={};J.T=A;try{var D=u(v,d),X=J.S;X!==null&&X(A,D),Vv(s,l,D)}catch(te){c0(s,l,te)}finally{x!==null&&A.types!==null&&(x.types=A.types),J.T=x}}else try{x=u(v,d),Vv(s,l,x)}catch(te){c0(s,l,te)}}function Vv(s,l,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(d){qv(s,l,d)},function(d){return c0(s,l,d)}):qv(s,l,u)}function qv(s,l,u){l.status="fulfilled",l.value=u,Wv(l),s.state=u,l=s.pending,l!==null&&(u=l.next,u===l?s.pending=null:(u=u.next,l.next=u,Gv(s,u)))}function c0(s,l,u){var d=s.pending;if(s.pending=null,d!==null){d=d.next;do l.status="rejected",l.reason=u,Wv(l),l=l.next;while(l!==d)}s.action=null}function Wv(s){s=s.listeners;for(var l=0;l<s.length;l++)(0,s[l])()}function Xv(s,l){return l}function Yv(s,l){if(at){var u=Ct.formState;if(u!==null){e:{var d=Ke;if(at){if(Lt){t:{for(var v=Lt,x=ji;v.nodeType!==8;){if(!x){v=null;break t}if(v=zi(v.nextSibling),v===null){v=null;break t}}x=v.data,v=x==="F!"||x==="F"?v:null}if(v){Lt=zi(v.nextSibling),d=v.data==="F!";break e}}ps(d)}d=!1}d&&(l=u[0])}}return u=Vn(),u.memoizedState=u.baseState=l,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xv,lastRenderedState:l},u.queue=d,u=p1.bind(null,Ke,d),d.dispatch=u,d=l0(!1),x=g0.bind(null,Ke,!1,d.queue),d=Vn(),v={state:l,dispatch:null,action:s,pending:null},d.queue=v,u=qA.bind(null,Ke,v,x,u),v.dispatch=u,d.memoizedState=s,[l,u,!1]}function Kv(s){var l=en();return Jv(l,bt,s)}function Jv(s,l,u){if(l=a0(s,l,Xv)[0],s=nh(jr)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var d=Hl(l)}catch(A){throw A===uo?qu:A}else d=l;l=en();var v=l.queue,x=v.dispatch;return u!==l.memoizedState&&(Ke.flags|=2048,mo(9,{destroy:void 0},WA.bind(null,v,u),null)),[d,x,s]}function WA(s,l){s.action=l}function Qv(s){var l=en(),u=bt;if(u!==null)return Jv(l,u,s);en(),l=l.memoizedState,u=en();var d=u.queue.dispatch;return u.memoizedState=s,[l,d,!1]}function mo(s,l,u,d){return s={tag:s,create:u,deps:d,inst:l,next:null},l=Ke.updateQueue,l===null&&(l=eh(),Ke.updateQueue=l),u=l.lastEffect,u===null?l.lastEffect=s.next=s:(d=u.next,u.next=s,s.next=d,l.lastEffect=s),s}function Zv(){return en().memoizedState}function ih(s,l,u,d){var v=Vn();Ke.flags|=s,v.memoizedState=mo(1|l,{destroy:void 0},u,d===void 0?null:d)}function rh(s,l,u,d){var v=en();d=d===void 0?null:d;var x=v.memoizedState.inst;bt!==null&&d!==null&&e0(d,bt.memoizedState.deps)?v.memoizedState=mo(l,x,u,d):(Ke.flags|=s,v.memoizedState=mo(1|l,x,u,d))}function e1(s,l){ih(8390656,8,s,l)}function u0(s,l){rh(2048,8,s,l)}function XA(s){Ke.flags|=4;var l=Ke.updateQueue;if(l===null)l=eh(),Ke.updateQueue=l,l.events=[s];else{var u=l.events;u===null?l.events=[s]:u.push(s)}}function t1(s){var l=en().memoizedState;return XA({ref:l,nextImpl:s}),function(){if((ft&2)!==0)throw Error(i(440));return l.impl.apply(void 0,arguments)}}function n1(s,l){return rh(4,2,s,l)}function i1(s,l){return rh(4,4,s,l)}function r1(s,l){if(typeof l=="function"){s=s();var u=l(s);return function(){typeof u=="function"?u():l(null)}}if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function s1(s,l,u){u=u!=null?u.concat([s]):null,rh(4,4,r1.bind(null,l,s),u)}function h0(){}function a1(s,l){var u=en();l=l===void 0?null:l;var d=u.memoizedState;return l!==null&&e0(l,d[1])?d[0]:(u.memoizedState=[s,l],s)}function o1(s,l){var u=en();l=l===void 0?null:l;var d=u.memoizedState;if(l!==null&&e0(l,d[1]))return d[0];if(d=s(),fa){Zi(!0);try{s()}finally{Zi(!1)}}return u.memoizedState=[d,l],d}function f0(s,l,u){return u===void 0||(Ur&1073741824)!==0&&(rt&261930)===0?s.memoizedState=l:(s.memoizedState=u,s=ly(),Ke.lanes|=s,Es|=s,u)}function l1(s,l,u,d){return di(u,l)?u:fo.current!==null?(s=f0(s,u,d),di(s,l)||(sn=!0),s):(Ur&42)===0||(Ur&1073741824)!==0&&(rt&261930)===0?(sn=!0,s.memoizedState=u):(s=ly(),Ke.lanes|=s,Es|=s,l)}function c1(s,l,u,d,v){var x=ae.p;ae.p=x!==0&&8>x?x:8;var A=J.T,D={};J.T=D,g0(s,!1,l,u);try{var X=v(),te=J.S;if(te!==null&&te(D,X),X!==null&&typeof X=="object"&&typeof X.then=="function"){var fe=$A(X,d);zl(s,l,fe,_i(s))}else zl(s,l,d,_i(s))}catch(ge){zl(s,l,{then:function(){},status:"rejected",reason:ge},_i())}finally{ae.p=x,A!==null&&D.types!==null&&(A.types=D.types),J.T=A}}function YA(){}function d0(s,l,u,d){if(s.tag!==5)throw Error(i(476));var v=u1(s).queue;c1(s,v,l,we,u===null?YA:function(){return h1(s),u(d)})}function u1(s){var l=s.memoizedState;if(l!==null)return l;l={memoizedState:we,baseState:we,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:jr,lastRenderedState:we},next:null};var u={};return l.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:jr,lastRenderedState:u},next:null},s.memoizedState=l,s=s.alternate,s!==null&&(s.memoizedState=l),l}function h1(s){var l=u1(s);l.next===null&&(l=s.alternate.memoizedState),zl(s,l.next.queue,{},_i())}function p0(){return An(sc)}function f1(){return en().memoizedState}function d1(){return en().memoizedState}function KA(s){for(var l=s.return;l!==null;){switch(l.tag){case 24:case 3:var u=_i();s=vs(u);var d=ys(l,s,u);d!==null&&(ri(d,l,u),Pl(d,l,u)),l={cache:$d()},s.payload=l;return}l=l.return}}function JA(s,l,u){var d=_i();u={lane:d,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},sh(s)?g1(l,u):(u=Nd(s,l,u,d),u!==null&&(ri(u,s,d),m1(u,l,d)))}function p1(s,l,u){var d=_i();zl(s,l,u,d)}function zl(s,l,u,d){var v={lane:d,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(sh(s))g1(l,v);else{var x=s.alternate;if(s.lanes===0&&(x===null||x.lanes===0)&&(x=l.lastRenderedReducer,x!==null))try{var A=l.lastRenderedState,D=x(A,u);if(v.hasEagerState=!0,v.eagerState=D,di(D,A))return Uu(s,l,v,0),Ct===null&&Bu(),!1}catch{}if(u=Nd(s,l,v,d),u!==null)return ri(u,s,d),m1(u,l,d),!0}return!1}function g0(s,l,u,d){if(d={lane:2,revertLane:W0(),gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},sh(s)){if(l)throw Error(i(479))}else l=Nd(s,u,d,2),l!==null&&ri(l,s,2)}function sh(s){var l=s.alternate;return s===Ke||l!==null&&l===Ke}function g1(s,l){po=Qu=!0;var u=s.pending;u===null?l.next=l:(l.next=u.next,u.next=l),s.pending=l}function m1(s,l,u){if((u&4194048)!==0){var d=l.lanes;d&=s.pendingLanes,u|=d,l.lanes=u,Xa(s,u)}}var $l={readContext:An,use:th,useCallback:qt,useContext:qt,useEffect:qt,useImperativeHandle:qt,useLayoutEffect:qt,useInsertionEffect:qt,useMemo:qt,useReducer:qt,useRef:qt,useState:qt,useDebugValue:qt,useDeferredValue:qt,useTransition:qt,useSyncExternalStore:qt,useId:qt,useHostTransitionStatus:qt,useFormState:qt,useActionState:qt,useOptimistic:qt,useMemoCache:qt,useCacheRefresh:qt};$l.useEffectEvent=qt;var v1={readContext:An,use:th,useCallback:function(s,l){return Vn().memoizedState=[s,l===void 0?null:l],s},useContext:An,useEffect:e1,useImperativeHandle:function(s,l,u){u=u!=null?u.concat([s]):null,ih(4194308,4,r1.bind(null,l,s),u)},useLayoutEffect:function(s,l){return ih(4194308,4,s,l)},useInsertionEffect:function(s,l){ih(4,2,s,l)},useMemo:function(s,l){var u=Vn();l=l===void 0?null:l;var d=s();if(fa){Zi(!0);try{s()}finally{Zi(!1)}}return u.memoizedState=[d,l],d},useReducer:function(s,l,u){var d=Vn();if(u!==void 0){var v=u(l);if(fa){Zi(!0);try{u(l)}finally{Zi(!1)}}}else v=l;return d.memoizedState=d.baseState=v,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:v},d.queue=s,s=s.dispatch=JA.bind(null,Ke,s),[d.memoizedState,s]},useRef:function(s){var l=Vn();return s={current:s},l.memoizedState=s},useState:function(s){s=l0(s);var l=s.queue,u=p1.bind(null,Ke,l);return l.dispatch=u,[s.memoizedState,u]},useDebugValue:h0,useDeferredValue:function(s,l){var u=Vn();return f0(u,s,l)},useTransition:function(){var s=l0(!1);return s=c1.bind(null,Ke,s.queue,!0,!1),Vn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,l,u){var d=Ke,v=Vn();if(at){if(u===void 0)throw Error(i(407));u=u()}else{if(u=l(),Ct===null)throw Error(i(349));(rt&127)!==0||Bv(d,l,u)}v.memoizedState=u;var x={value:u,getSnapshot:l};return v.queue=x,e1(jv.bind(null,d,x,s),[s]),d.flags|=2048,mo(9,{destroy:void 0},Uv.bind(null,d,x,u,l),null),u},useId:function(){var s=Vn(),l=Ct.identifierPrefix;if(at){var u=vr,d=mr;u=(d&~(1<<32-Gn(d)-1)).toString(32)+u,l="_"+l+"R_"+u,u=Zu++,0<u&&(l+="H"+u.toString(32)),l+="_"}else u=GA++,l="_"+l+"r_"+u.toString(32)+"_";return s.memoizedState=l},useHostTransitionStatus:p0,useFormState:Yv,useActionState:Yv,useOptimistic:function(s){var l=Vn();l.memoizedState=l.baseState=s;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=u,l=g0.bind(null,Ke,!0,u),u.dispatch=l,[s,l]},useMemoCache:s0,useCacheRefresh:function(){return Vn().memoizedState=KA.bind(null,Ke)},useEffectEvent:function(s){var l=Vn(),u={impl:s};return l.memoizedState=u,function(){if((ft&2)!==0)throw Error(i(440));return u.impl.apply(void 0,arguments)}}},m0={readContext:An,use:th,useCallback:a1,useContext:An,useEffect:u0,useImperativeHandle:s1,useInsertionEffect:n1,useLayoutEffect:i1,useMemo:o1,useReducer:nh,useRef:Zv,useState:function(){return nh(jr)},useDebugValue:h0,useDeferredValue:function(s,l){var u=en();return l1(u,bt.memoizedState,s,l)},useTransition:function(){var s=nh(jr)[0],l=en().memoizedState;return[typeof s=="boolean"?s:Hl(s),l]},useSyncExternalStore:Pv,useId:f1,useHostTransitionStatus:p0,useFormState:Kv,useActionState:Kv,useOptimistic:function(s,l){var u=en();return $v(u,bt,s,l)},useMemoCache:s0,useCacheRefresh:d1};m0.useEffectEvent=t1;var y1={readContext:An,use:th,useCallback:a1,useContext:An,useEffect:u0,useImperativeHandle:s1,useInsertionEffect:n1,useLayoutEffect:i1,useMemo:o1,useReducer:o0,useRef:Zv,useState:function(){return o0(jr)},useDebugValue:h0,useDeferredValue:function(s,l){var u=en();return bt===null?f0(u,s,l):l1(u,bt.memoizedState,s,l)},useTransition:function(){var s=o0(jr)[0],l=en().memoizedState;return[typeof s=="boolean"?s:Hl(s),l]},useSyncExternalStore:Pv,useId:f1,useHostTransitionStatus:p0,useFormState:Qv,useActionState:Qv,useOptimistic:function(s,l){var u=en();return bt!==null?$v(u,bt,s,l):(u.baseState=s,[s,u.queue.dispatch])},useMemoCache:s0,useCacheRefresh:d1};y1.useEffectEvent=t1;function v0(s,l,u,d){l=s.memoizedState,u=u(d,l),u=u==null?l:g({},l,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var y0={enqueueSetState:function(s,l,u){s=s._reactInternals;var d=_i(),v=vs(d);v.payload=l,u!=null&&(v.callback=u),l=ys(s,v,d),l!==null&&(ri(l,s,d),Pl(l,s,d))},enqueueReplaceState:function(s,l,u){s=s._reactInternals;var d=_i(),v=vs(d);v.tag=1,v.payload=l,u!=null&&(v.callback=u),l=ys(s,v,d),l!==null&&(ri(l,s,d),Pl(l,s,d))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var u=_i(),d=vs(u);d.tag=2,l!=null&&(d.callback=l),l=ys(s,d,u),l!==null&&(ri(l,s,u),Pl(l,s,u))}};function _1(s,l,u,d,v,x,A){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(d,x,A):l.prototype&&l.prototype.isPureReactComponent?!Ol(u,d)||!Ol(v,x):!0}function x1(s,l,u,d){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(u,d),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(u,d),l.state!==s&&y0.enqueueReplaceState(l,l.state,null)}function da(s,l){var u=l;if("ref"in l){u={};for(var d in l)d!=="ref"&&(u[d]=l[d])}if(s=s.defaultProps){u===l&&(u=g({},u));for(var v in s)u[v]===void 0&&(u[v]=s[v])}return u}function w1(s){Pu(s)}function b1(s){console.error(s)}function E1(s){Pu(s)}function ah(s,l){try{var u=s.onUncaughtError;u(l.value,{componentStack:l.stack})}catch(d){setTimeout(function(){throw d})}}function S1(s,l,u){try{var d=s.onCaughtError;d(u.value,{componentStack:u.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(v){setTimeout(function(){throw v})}}function _0(s,l,u){return u=vs(u),u.tag=3,u.payload={element:null},u.callback=function(){ah(s,l)},u}function A1(s){return s=vs(s),s.tag=3,s}function T1(s,l,u,d){var v=u.type.getDerivedStateFromError;if(typeof v=="function"){var x=d.value;s.payload=function(){return v(x)},s.callback=function(){S1(l,u,d)}}var A=u.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(s.callback=function(){S1(l,u,d),typeof v!="function"&&(Ss===null?Ss=new Set([this]):Ss.add(this));var D=d.stack;this.componentDidCatch(d.value,{componentStack:D!==null?D:""})})}function QA(s,l,u,d,v){if(u.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(l=u.alternate,l!==null&&oo(l,u,v,!0),u=gi.current,u!==null){switch(u.tag){case 31:case 13:return Hi===null?yh():u.alternate===null&&Wt===0&&(Wt=3),u.flags&=-257,u.flags|=65536,u.lanes=v,d===Wu?u.flags|=16384:(l=u.updateQueue,l===null?u.updateQueue=new Set([d]):l.add(d),G0(s,d,v)),!1;case 22:return u.flags|=65536,d===Wu?u.flags|=16384:(l=u.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([d])},u.updateQueue=l):(u=l.retryQueue,u===null?l.retryQueue=new Set([d]):u.add(d)),G0(s,d,v)),!1}throw Error(i(435,u.tag))}return G0(s,d,v),yh(),!1}if(at)return l=gi.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=v,d!==Bd&&(s=Error(i(422),{cause:d}),Nl(Pi(s,u)))):(d!==Bd&&(l=Error(i(423),{cause:d}),Nl(Pi(l,u))),s=s.current.alternate,s.flags|=65536,v&=-v,s.lanes|=v,d=Pi(d,u),v=_0(s.stateNode,d,v),Yd(s,v),Wt!==4&&(Wt=2)),!1;var x=Error(i(520),{cause:d});if(x=Pi(x,u),Jl===null?Jl=[x]:Jl.push(x),Wt!==4&&(Wt=2),l===null)return!0;d=Pi(d,u),u=l;do{switch(u.tag){case 3:return u.flags|=65536,s=v&-v,u.lanes|=s,s=_0(u.stateNode,d,s),Yd(u,s),!1;case 1:if(l=u.type,x=u.stateNode,(u.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Ss===null||!Ss.has(x))))return u.flags|=65536,v&=-v,u.lanes|=v,v=A1(v),T1(v,s,u,d),Yd(u,v),!1}u=u.return}while(u!==null);return!1}var x0=Error(i(461)),sn=!1;function Tn(s,l,u,d){l.child=s===null?kv(l,null,u,d):ha(l,s.child,u,d)}function C1(s,l,u,d,v){u=u.render;var x=l.ref;if("ref"in d){var A={};for(var D in d)D!=="ref"&&(A[D]=d[D])}else A=d;return oa(l),d=t0(s,l,u,A,x,v),D=n0(),s!==null&&!sn?(i0(s,l,v),Hr(s,l,v)):(at&&D&&Id(l),l.flags|=1,Tn(s,l,d,v),l.child)}function R1(s,l,u,d,v){if(s===null){var x=u.type;return typeof x=="function"&&!Md(x)&&x.defaultProps===void 0&&u.compare===null?(l.tag=15,l.type=x,O1(s,l,x,d,v)):(s=Hu(u.type,null,d,l,l.mode,v),s.ref=l.ref,s.return=l,l.child=s)}if(x=s.child,!R0(s,v)){var A=x.memoizedProps;if(u=u.compare,u=u!==null?u:Ol,u(A,d)&&s.ref===l.ref)return Hr(s,l,v)}return l.flags|=1,s=Fr(x,d),s.ref=l.ref,s.return=l,l.child=s}function O1(s,l,u,d,v){if(s!==null){var x=s.memoizedProps;if(Ol(x,d)&&s.ref===l.ref)if(sn=!1,l.pendingProps=d=x,R0(s,v))(s.flags&131072)!==0&&(sn=!0);else return l.lanes=s.lanes,Hr(s,l,v)}return w0(s,l,u,d,v)}function k1(s,l,u,d){var v=d.children,x=s!==null?s.memoizedState:null;if(s===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.mode==="hidden"){if((l.flags&128)!==0){if(x=x!==null?x.baseLanes|u:u,s!==null){for(d=l.child=s.child,v=0;d!==null;)v=v|d.lanes|d.childLanes,d=d.sibling;d=v&~x}else d=0,l.child=null;return D1(s,l,x,u,d)}if((u&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},s!==null&&Vu(l,x!==null?x.cachePool:null),x!==null?Mv(l,x):Jd(),Lv(l);else return d=l.lanes=536870912,D1(s,l,x!==null?x.baseLanes|u:u,u,d)}else x!==null?(Vu(l,x.cachePool),Mv(l,x),xs(),l.memoizedState=null):(s!==null&&Vu(l,null),Jd(),xs());return Tn(s,l,v,u),l.child}function Gl(s,l){return s!==null&&s.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function D1(s,l,u,d,v){var x=Vd();return x=x===null?null:{parent:nn._currentValue,pool:x},l.memoizedState={baseLanes:u,cachePool:x},s!==null&&Vu(l,null),Jd(),Lv(l),s!==null&&oo(s,l,d,!0),l.childLanes=v,null}function oh(s,l){return l=ch({mode:l.mode,children:l.children},s.mode),l.ref=s.ref,s.child=l,l.return=s,l}function N1(s,l,u){return ha(l,s.child,null,u),s=oh(l,l.pendingProps),s.flags|=2,mi(l),l.memoizedState=null,s}function ZA(s,l,u){var d=l.pendingProps,v=(l.flags&128)!==0;if(l.flags&=-129,s===null){if(at){if(d.mode==="hidden")return s=oh(l,d),l.lanes=536870912,Gl(null,s);if(Zd(l),(s=Lt)?(s=Gy(s,ji),s=s!==null&&s.data==="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:fs!==null?{id:mr,overflow:vr}:null,retryLane:536870912,hydrationErrors:null},u=gv(s),u.return=l,l.child=u,Sn=l,Lt=null)):s=null,s===null)throw ps(l);return l.lanes=536870912,null}return oh(l,d)}var x=s.memoizedState;if(x!==null){var A=x.dehydrated;if(Zd(l),v)if(l.flags&256)l.flags&=-257,l=N1(s,l,u);else if(l.memoizedState!==null)l.child=s.child,l.flags|=128,l=null;else throw Error(i(558));else if(sn||oo(s,l,u,!1),v=(u&s.childLanes)!==0,sn||v){if(d=Ct,d!==null&&(A=Cu(d,u),A!==0&&A!==x.retryLane))throw x.retryLane=A,ia(s,A),ri(d,s,A),x0;yh(),l=N1(s,l,u)}else s=x.treeContext,Lt=zi(A.nextSibling),Sn=l,at=!0,ds=null,ji=!1,s!==null&&yv(l,s),l=oh(l,d),l.flags|=4096;return l}return s=Fr(s.child,{mode:d.mode,children:d.children}),s.ref=l.ref,l.child=s,s.return=l,s}function lh(s,l){var u=l.ref;if(u===null)s!==null&&s.ref!==null&&(l.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(i(284));(s===null||s.ref!==u)&&(l.flags|=4194816)}}function w0(s,l,u,d,v){return oa(l),u=t0(s,l,u,d,void 0,v),d=n0(),s!==null&&!sn?(i0(s,l,v),Hr(s,l,v)):(at&&d&&Id(l),l.flags|=1,Tn(s,l,u,v),l.child)}function M1(s,l,u,d,v,x){return oa(l),l.updateQueue=null,u=Iv(l,d,u,v),Fv(s),d=n0(),s!==null&&!sn?(i0(s,l,x),Hr(s,l,x)):(at&&d&&Id(l),l.flags|=1,Tn(s,l,u,x),l.child)}function L1(s,l,u,d,v){if(oa(l),l.stateNode===null){var x=io,A=u.contextType;typeof A=="object"&&A!==null&&(x=An(A)),x=new u(d,x),l.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=y0,l.stateNode=x,x._reactInternals=l,x=l.stateNode,x.props=d,x.state=l.memoizedState,x.refs={},Wd(l),A=u.contextType,x.context=typeof A=="object"&&A!==null?An(A):io,x.state=l.memoizedState,A=u.getDerivedStateFromProps,typeof A=="function"&&(v0(l,u,A,d),x.state=l.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(A=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),A!==x.state&&y0.enqueueReplaceState(x,x.state,null),Ul(l,d,x,v),Bl(),x.state=l.memoizedState),typeof x.componentDidMount=="function"&&(l.flags|=4194308),d=!0}else if(s===null){x=l.stateNode;var D=l.memoizedProps,X=da(u,D);x.props=X;var te=x.context,fe=u.contextType;A=io,typeof fe=="object"&&fe!==null&&(A=An(fe));var ge=u.getDerivedStateFromProps;fe=typeof ge=="function"||typeof x.getSnapshotBeforeUpdate=="function",D=l.pendingProps!==D,fe||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(D||te!==A)&&x1(l,x,d,A),ms=!1;var se=l.memoizedState;x.state=se,Ul(l,d,x,v),Bl(),te=l.memoizedState,D||se!==te||ms?(typeof ge=="function"&&(v0(l,u,ge,d),te=l.memoizedState),(X=ms||_1(l,u,X,d,se,te,A))?(fe||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(l.flags|=4194308)):(typeof x.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=d,l.memoizedState=te),x.props=d,x.state=te,x.context=A,d=X):(typeof x.componentDidMount=="function"&&(l.flags|=4194308),d=!1)}else{x=l.stateNode,Xd(s,l),A=l.memoizedProps,fe=da(u,A),x.props=fe,ge=l.pendingProps,se=x.context,te=u.contextType,X=io,typeof te=="object"&&te!==null&&(X=An(te)),D=u.getDerivedStateFromProps,(te=typeof D=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(A!==ge||se!==X)&&x1(l,x,d,X),ms=!1,se=l.memoizedState,x.state=se,Ul(l,d,x,v),Bl();var ue=l.memoizedState;A!==ge||se!==ue||ms||s!==null&&s.dependencies!==null&&$u(s.dependencies)?(typeof D=="function"&&(v0(l,u,D,d),ue=l.memoizedState),(fe=ms||_1(l,u,fe,d,se,ue,X)||s!==null&&s.dependencies!==null&&$u(s.dependencies))?(te||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(d,ue,X),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(d,ue,X)),typeof x.componentDidUpdate=="function"&&(l.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof x.componentDidUpdate!="function"||A===s.memoizedProps&&se===s.memoizedState||(l.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||A===s.memoizedProps&&se===s.memoizedState||(l.flags|=1024),l.memoizedProps=d,l.memoizedState=ue),x.props=d,x.state=ue,x.context=X,d=fe):(typeof x.componentDidUpdate!="function"||A===s.memoizedProps&&se===s.memoizedState||(l.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||A===s.memoizedProps&&se===s.memoizedState||(l.flags|=1024),d=!1)}return x=d,lh(s,l),d=(l.flags&128)!==0,x||d?(x=l.stateNode,u=d&&typeof u.getDerivedStateFromError!="function"?null:x.render(),l.flags|=1,s!==null&&d?(l.child=ha(l,s.child,null,v),l.child=ha(l,null,u,v)):Tn(s,l,u,v),l.memoizedState=x.state,s=l.child):s=Hr(s,l,v),s}function F1(s,l,u,d){return sa(),l.flags|=256,Tn(s,l,u,d),l.child}var b0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function E0(s){return{baseLanes:s,cachePool:Sv()}}function S0(s,l,u){return s=s!==null?s.childLanes&~u:0,l&&(s|=yi),s}function I1(s,l,u){var d=l.pendingProps,v=!1,x=(l.flags&128)!==0,A;if((A=x)||(A=s!==null&&s.memoizedState===null?!1:(Zt.current&2)!==0),A&&(v=!0,l.flags&=-129),A=(l.flags&32)!==0,l.flags&=-33,s===null){if(at){if(v?_s(l):xs(),(s=Lt)?(s=Gy(s,ji),s=s!==null&&s.data!=="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:fs!==null?{id:mr,overflow:vr}:null,retryLane:536870912,hydrationErrors:null},u=gv(s),u.return=l,l.child=u,Sn=l,Lt=null)):s=null,s===null)throw ps(l);return ap(s)?l.lanes=32:l.lanes=536870912,null}var D=d.children;return d=d.fallback,v?(xs(),v=l.mode,D=ch({mode:"hidden",children:D},v),d=ra(d,v,u,null),D.return=l,d.return=l,D.sibling=d,l.child=D,d=l.child,d.memoizedState=E0(u),d.childLanes=S0(s,A,u),l.memoizedState=b0,Gl(null,d)):(_s(l),A0(l,D))}var X=s.memoizedState;if(X!==null&&(D=X.dehydrated,D!==null)){if(x)l.flags&256?(_s(l),l.flags&=-257,l=T0(s,l,u)):l.memoizedState!==null?(xs(),l.child=s.child,l.flags|=128,l=null):(xs(),D=d.fallback,v=l.mode,d=ch({mode:"visible",children:d.children},v),D=ra(D,v,u,null),D.flags|=2,d.return=l,D.return=l,d.sibling=D,l.child=d,ha(l,s.child,null,u),d=l.child,d.memoizedState=E0(u),d.childLanes=S0(s,A,u),l.memoizedState=b0,l=Gl(null,d));else if(_s(l),ap(D)){if(A=D.nextSibling&&D.nextSibling.dataset,A)var te=A.dgst;A=te,d=Error(i(419)),d.stack="",d.digest=A,Nl({value:d,source:null,stack:null}),l=T0(s,l,u)}else if(sn||oo(s,l,u,!1),A=(u&s.childLanes)!==0,sn||A){if(A=Ct,A!==null&&(d=Cu(A,u),d!==0&&d!==X.retryLane))throw X.retryLane=d,ia(s,d),ri(A,s,d),x0;sp(D)||yh(),l=T0(s,l,u)}else sp(D)?(l.flags|=192,l.child=s.child,l=null):(s=X.treeContext,Lt=zi(D.nextSibling),Sn=l,at=!0,ds=null,ji=!1,s!==null&&yv(l,s),l=A0(l,d.children),l.flags|=4096);return l}return v?(xs(),D=d.fallback,v=l.mode,X=s.child,te=X.sibling,d=Fr(X,{mode:"hidden",children:d.children}),d.subtreeFlags=X.subtreeFlags&65011712,te!==null?D=Fr(te,D):(D=ra(D,v,u,null),D.flags|=2),D.return=l,d.return=l,d.sibling=D,l.child=d,Gl(null,d),d=l.child,D=s.child.memoizedState,D===null?D=E0(u):(v=D.cachePool,v!==null?(X=nn._currentValue,v=v.parent!==X?{parent:X,pool:X}:v):v=Sv(),D={baseLanes:D.baseLanes|u,cachePool:v}),d.memoizedState=D,d.childLanes=S0(s,A,u),l.memoizedState=b0,Gl(s.child,d)):(_s(l),u=s.child,s=u.sibling,u=Fr(u,{mode:"visible",children:d.children}),u.return=l,u.sibling=null,s!==null&&(A=l.deletions,A===null?(l.deletions=[s],l.flags|=16):A.push(s)),l.child=u,l.memoizedState=null,u)}function A0(s,l){return l=ch({mode:"visible",children:l},s.mode),l.return=s,s.child=l}function ch(s,l){return s=pi(22,s,null,l),s.lanes=0,s}function T0(s,l,u){return ha(l,s.child,null,u),s=A0(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function P1(s,l,u){s.lanes|=l;var d=s.alternate;d!==null&&(d.lanes|=l),Hd(s.return,l,u)}function C0(s,l,u,d,v,x){var A=s.memoizedState;A===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:d,tail:u,tailMode:v,treeForkCount:x}:(A.isBackwards=l,A.rendering=null,A.renderingStartTime=0,A.last=d,A.tail=u,A.tailMode=v,A.treeForkCount=x)}function B1(s,l,u){var d=l.pendingProps,v=d.revealOrder,x=d.tail;d=d.children;var A=Zt.current,D=(A&2)!==0;if(D?(A=A&1|2,l.flags|=128):A&=1,z(Zt,A),Tn(s,l,d,u),d=at?Dl:0,!D&&s!==null&&(s.flags&128)!==0)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&P1(s,u,l);else if(s.tag===19)P1(s,u,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(v){case"forwards":for(u=l.child,v=null;u!==null;)s=u.alternate,s!==null&&Ju(s)===null&&(v=u),u=u.sibling;u=v,u===null?(v=l.child,l.child=null):(v=u.sibling,u.sibling=null),C0(l,!1,v,u,x,d);break;case"backwards":case"unstable_legacy-backwards":for(u=null,v=l.child,l.child=null;v!==null;){if(s=v.alternate,s!==null&&Ju(s)===null){l.child=v;break}s=v.sibling,v.sibling=u,u=v,v=s}C0(l,!0,u,null,x,d);break;case"together":C0(l,!1,null,null,void 0,d);break;default:l.memoizedState=null}return l.child}function Hr(s,l,u){if(s!==null&&(l.dependencies=s.dependencies),Es|=l.lanes,(u&l.childLanes)===0)if(s!==null){if(oo(s,l,u,!1),(u&l.childLanes)===0)return null}else return null;if(s!==null&&l.child!==s.child)throw Error(i(153));if(l.child!==null){for(s=l.child,u=Fr(s,s.pendingProps),l.child=u,u.return=l;s.sibling!==null;)s=s.sibling,u=u.sibling=Fr(s,s.pendingProps),u.return=l;u.sibling=null}return l.child}function R0(s,l){return(s.lanes&l)!==0?!0:(s=s.dependencies,!!(s!==null&&$u(s)))}function eT(s,l,u){switch(l.tag){case 3:Re(l,l.stateNode.containerInfo),gs(l,nn,s.memoizedState.cache),sa();break;case 27:case 5:Te(l);break;case 4:Re(l,l.stateNode.containerInfo);break;case 10:gs(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,Zd(l),null;break;case 13:var d=l.memoizedState;if(d!==null)return d.dehydrated!==null?(_s(l),l.flags|=128,null):(u&l.child.childLanes)!==0?I1(s,l,u):(_s(l),s=Hr(s,l,u),s!==null?s.sibling:null);_s(l);break;case 19:var v=(s.flags&128)!==0;if(d=(u&l.childLanes)!==0,d||(oo(s,l,u,!1),d=(u&l.childLanes)!==0),v){if(d)return B1(s,l,u);l.flags|=128}if(v=l.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),z(Zt,Zt.current),d)break;return null;case 22:return l.lanes=0,k1(s,l,u,l.pendingProps);case 24:gs(l,nn,s.memoizedState.cache)}return Hr(s,l,u)}function U1(s,l,u){if(s!==null)if(s.memoizedProps!==l.pendingProps)sn=!0;else{if(!R0(s,u)&&(l.flags&128)===0)return sn=!1,eT(s,l,u);sn=(s.flags&131072)!==0}else sn=!1,at&&(l.flags&1048576)!==0&&vv(l,Dl,l.index);switch(l.lanes=0,l.tag){case 16:e:{var d=l.pendingProps;if(s=ca(l.elementType),l.type=s,typeof s=="function")Md(s)?(d=da(s,d),l.tag=1,l=L1(null,l,s,d,u)):(l.tag=0,l=w0(null,l,s,d,u));else{if(s!=null){var v=s.$$typeof;if(v===k){l.tag=11,l=C1(null,l,s,d,u);break e}else if(v===O){l.tag=14,l=R1(null,l,s,d,u);break e}}throw l=Ce(s)||s,Error(i(306,l,""))}}return l;case 0:return w0(s,l,l.type,l.pendingProps,u);case 1:return d=l.type,v=da(d,l.pendingProps),L1(s,l,d,v,u);case 3:e:{if(Re(l,l.stateNode.containerInfo),s===null)throw Error(i(387));d=l.pendingProps;var x=l.memoizedState;v=x.element,Xd(s,l),Ul(l,d,null,u);var A=l.memoizedState;if(d=A.cache,gs(l,nn,d),d!==x.cache&&zd(l,[nn],u,!0),Bl(),d=A.element,x.isDehydrated)if(x={element:d,isDehydrated:!1,cache:A.cache},l.updateQueue.baseState=x,l.memoizedState=x,l.flags&256){l=F1(s,l,d,u);break e}else if(d!==v){v=Pi(Error(i(424)),l),Nl(v),l=F1(s,l,d,u);break e}else for(s=l.stateNode.containerInfo,s.nodeType===9?s=s.body:s=s.nodeName==="HTML"?s.ownerDocument.body:s,Lt=zi(s.firstChild),Sn=l,at=!0,ds=null,ji=!0,u=kv(l,null,d,u),l.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(sa(),d===v){l=Hr(s,l,u);break e}Tn(s,l,d,u)}l=l.child}return l;case 26:return lh(s,l),s===null?(u=Ky(l.type,null,l.pendingProps,null))?l.memoizedState=u:at||(u=l.type,s=l.pendingProps,d=Ah(oe.current).createElement(u),d[I]=l,d[B]=s,Cn(d,u,s),Ie(d),l.stateNode=d):l.memoizedState=Ky(l.type,s.memoizedProps,l.pendingProps,s.memoizedState),null;case 27:return Te(l),s===null&&at&&(d=l.stateNode=Wy(l.type,l.pendingProps,oe.current),Sn=l,ji=!0,v=Lt,Rs(l.type)?(op=v,Lt=zi(d.firstChild)):Lt=v),Tn(s,l,l.pendingProps.children,u),lh(s,l),s===null&&(l.flags|=4194304),l.child;case 5:return s===null&&at&&((v=d=Lt)&&(d=kT(d,l.type,l.pendingProps,ji),d!==null?(l.stateNode=d,Sn=l,Lt=zi(d.firstChild),ji=!1,v=!0):v=!1),v||ps(l)),Te(l),v=l.type,x=l.pendingProps,A=s!==null?s.memoizedProps:null,d=x.children,np(v,x)?d=null:A!==null&&np(v,A)&&(l.flags|=32),l.memoizedState!==null&&(v=t0(s,l,VA,null,null,u),sc._currentValue=v),lh(s,l),Tn(s,l,d,u),l.child;case 6:return s===null&&at&&((s=u=Lt)&&(u=DT(u,l.pendingProps,ji),u!==null?(l.stateNode=u,Sn=l,Lt=null,s=!0):s=!1),s||ps(l)),null;case 13:return I1(s,l,u);case 4:return Re(l,l.stateNode.containerInfo),d=l.pendingProps,s===null?l.child=ha(l,null,d,u):Tn(s,l,d,u),l.child;case 11:return C1(s,l,l.type,l.pendingProps,u);case 7:return Tn(s,l,l.pendingProps,u),l.child;case 8:return Tn(s,l,l.pendingProps.children,u),l.child;case 12:return Tn(s,l,l.pendingProps.children,u),l.child;case 10:return d=l.pendingProps,gs(l,l.type,d.value),Tn(s,l,d.children,u),l.child;case 9:return v=l.type._context,d=l.pendingProps.children,oa(l),v=An(v),d=d(v),l.flags|=1,Tn(s,l,d,u),l.child;case 14:return R1(s,l,l.type,l.pendingProps,u);case 15:return O1(s,l,l.type,l.pendingProps,u);case 19:return B1(s,l,u);case 31:return ZA(s,l,u);case 22:return k1(s,l,u,l.pendingProps);case 24:return oa(l),d=An(nn),s===null?(v=Vd(),v===null&&(v=Ct,x=$d(),v.pooledCache=x,x.refCount++,x!==null&&(v.pooledCacheLanes|=u),v=x),l.memoizedState={parent:d,cache:v},Wd(l),gs(l,nn,v)):((s.lanes&u)!==0&&(Xd(s,l),Ul(l,null,null,u),Bl()),v=s.memoizedState,x=l.memoizedState,v.parent!==d?(v={parent:d,cache:d},l.memoizedState=v,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=v),gs(l,nn,d)):(d=x.cache,gs(l,nn,d),d!==v.cache&&zd(l,[nn],u,!0))),Tn(s,l,l.pendingProps.children,u),l.child;case 29:throw l.pendingProps}throw Error(i(156,l.tag))}function zr(s){s.flags|=4}function O0(s,l,u,d,v){if((l=(s.mode&32)!==0)&&(l=!1),l){if(s.flags|=16777216,(v&335544128)===v)if(s.stateNode.complete)s.flags|=8192;else if(fy())s.flags|=8192;else throw ua=Wu,qd}else s.flags&=-16777217}function j1(s,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!t_(l))if(fy())s.flags|=8192;else throw ua=Wu,qd}function uh(s,l){l!==null&&(s.flags|=4),s.flags&16384&&(l=s.tag!==22?Au():536870912,s.lanes|=l,xo|=l)}function Vl(s,l){if(!at)switch(s.tailMode){case"hidden":l=s.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var d=null;u!==null;)u.alternate!==null&&(d=u),u=u.sibling;d===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:d.sibling=null}}function Ft(s){var l=s.alternate!==null&&s.alternate.child===s.child,u=0,d=0;if(l)for(var v=s.child;v!==null;)u|=v.lanes|v.childLanes,d|=v.subtreeFlags&65011712,d|=v.flags&65011712,v.return=s,v=v.sibling;else for(v=s.child;v!==null;)u|=v.lanes|v.childLanes,d|=v.subtreeFlags,d|=v.flags,v.return=s,v=v.sibling;return s.subtreeFlags|=d,s.childLanes=u,l}function tT(s,l,u){var d=l.pendingProps;switch(Pd(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ft(l),null;case 1:return Ft(l),null;case 3:return u=l.stateNode,d=null,s!==null&&(d=s.memoizedState.cache),l.memoizedState.cache!==d&&(l.flags|=2048),Br(nn),be(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(s===null||s.child===null)&&(ao(l)?zr(l):s===null||s.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Ud())),Ft(l),null;case 26:var v=l.type,x=l.memoizedState;return s===null?(zr(l),x!==null?(Ft(l),j1(l,x)):(Ft(l),O0(l,v,null,d,u))):x?x!==s.memoizedState?(zr(l),Ft(l),j1(l,x)):(Ft(l),l.flags&=-16777217):(s=s.memoizedProps,s!==d&&zr(l),Ft(l),O0(l,v,s,d,u)),null;case 27:if(it(l),u=oe.current,v=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==d&&zr(l);else{if(!d){if(l.stateNode===null)throw Error(i(166));return Ft(l),null}s=H.current,ao(l)?_v(l):(s=Wy(v,d,u),l.stateNode=s,zr(l))}return Ft(l),null;case 5:if(it(l),v=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==d&&zr(l);else{if(!d){if(l.stateNode===null)throw Error(i(166));return Ft(l),null}if(x=H.current,ao(l))_v(l);else{var A=Ah(oe.current);switch(x){case 1:x=A.createElementNS("http://www.w3.org/2000/svg",v);break;case 2:x=A.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;default:switch(v){case"svg":x=A.createElementNS("http://www.w3.org/2000/svg",v);break;case"math":x=A.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;case"script":x=A.createElement("div"),x.innerHTML="<script><\/script>",x=x.removeChild(x.firstChild);break;case"select":x=typeof d.is=="string"?A.createElement("select",{is:d.is}):A.createElement("select"),d.multiple?x.multiple=!0:d.size&&(x.size=d.size);break;default:x=typeof d.is=="string"?A.createElement(v,{is:d.is}):A.createElement(v)}}x[I]=l,x[B]=d;e:for(A=l.child;A!==null;){if(A.tag===5||A.tag===6)x.appendChild(A.stateNode);else if(A.tag!==4&&A.tag!==27&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===l)break e;for(;A.sibling===null;){if(A.return===null||A.return===l)break e;A=A.return}A.sibling.return=A.return,A=A.sibling}l.stateNode=x;e:switch(Cn(x,v,d),v){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}d&&zr(l)}}return Ft(l),O0(l,l.type,s===null?null:s.memoizedProps,l.pendingProps,u),null;case 6:if(s&&l.stateNode!=null)s.memoizedProps!==d&&zr(l);else{if(typeof d!="string"&&l.stateNode===null)throw Error(i(166));if(s=oe.current,ao(l)){if(s=l.stateNode,u=l.memoizedProps,d=null,v=Sn,v!==null)switch(v.tag){case 27:case 5:d=v.memoizedProps}s[I]=l,s=!!(s.nodeValue===u||d!==null&&d.suppressHydrationWarning===!0||Iy(s.nodeValue,u)),s||ps(l,!0)}else s=Ah(s).createTextNode(d),s[I]=l,l.stateNode=s}return Ft(l),null;case 31:if(u=l.memoizedState,s===null||s.memoizedState!==null){if(d=ao(l),u!==null){if(s===null){if(!d)throw Error(i(318));if(s=l.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[I]=l}else sa(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Ft(l),s=!1}else u=Ud(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=u),s=!0;if(!s)return l.flags&256?(mi(l),l):(mi(l),null);if((l.flags&128)!==0)throw Error(i(558))}return Ft(l),null;case 13:if(d=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(v=ao(l),d!==null&&d.dehydrated!==null){if(s===null){if(!v)throw Error(i(318));if(v=l.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(i(317));v[I]=l}else sa(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Ft(l),v=!1}else v=Ud(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=v),v=!0;if(!v)return l.flags&256?(mi(l),l):(mi(l),null)}return mi(l),(l.flags&128)!==0?(l.lanes=u,l):(u=d!==null,s=s!==null&&s.memoizedState!==null,u&&(d=l.child,v=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(v=d.alternate.memoizedState.cachePool.pool),x=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(x=d.memoizedState.cachePool.pool),x!==v&&(d.flags|=2048)),u!==s&&u&&(l.child.flags|=8192),uh(l,l.updateQueue),Ft(l),null);case 4:return be(),s===null&&J0(l.stateNode.containerInfo),Ft(l),null;case 10:return Br(l.type),Ft(l),null;case 19:if(N(Zt),d=l.memoizedState,d===null)return Ft(l),null;if(v=(l.flags&128)!==0,x=d.rendering,x===null)if(v)Vl(d,!1);else{if(Wt!==0||s!==null&&(s.flags&128)!==0)for(s=l.child;s!==null;){if(x=Ju(s),x!==null){for(l.flags|=128,Vl(d,!1),s=x.updateQueue,l.updateQueue=s,uh(l,s),l.subtreeFlags=0,s=u,u=l.child;u!==null;)pv(u,s),u=u.sibling;return z(Zt,Zt.current&1|2),at&&Ir(l,d.treeForkCount),l.child}s=s.sibling}d.tail!==null&&Pt()>gh&&(l.flags|=128,v=!0,Vl(d,!1),l.lanes=4194304)}else{if(!v)if(s=Ju(x),s!==null){if(l.flags|=128,v=!0,s=s.updateQueue,l.updateQueue=s,uh(l,s),Vl(d,!0),d.tail===null&&d.tailMode==="hidden"&&!x.alternate&&!at)return Ft(l),null}else 2*Pt()-d.renderingStartTime>gh&&u!==536870912&&(l.flags|=128,v=!0,Vl(d,!1),l.lanes=4194304);d.isBackwards?(x.sibling=l.child,l.child=x):(s=d.last,s!==null?s.sibling=x:l.child=x,d.last=x)}return d.tail!==null?(s=d.tail,d.rendering=s,d.tail=s.sibling,d.renderingStartTime=Pt(),s.sibling=null,u=Zt.current,z(Zt,v?u&1|2:u&1),at&&Ir(l,d.treeForkCount),s):(Ft(l),null);case 22:case 23:return mi(l),Qd(),d=l.memoizedState!==null,s!==null?s.memoizedState!==null!==d&&(l.flags|=8192):d&&(l.flags|=8192),d?(u&536870912)!==0&&(l.flags&128)===0&&(Ft(l),l.subtreeFlags&6&&(l.flags|=8192)):Ft(l),u=l.updateQueue,u!==null&&uh(l,u.retryQueue),u=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),d=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(d=l.memoizedState.cachePool.pool),d!==u&&(l.flags|=2048),s!==null&&N(la),null;case 24:return u=null,s!==null&&(u=s.memoizedState.cache),l.memoizedState.cache!==u&&(l.flags|=2048),Br(nn),Ft(l),null;case 25:return null;case 30:return null}throw Error(i(156,l.tag))}function nT(s,l){switch(Pd(l),l.tag){case 1:return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return Br(nn),be(),s=l.flags,(s&65536)!==0&&(s&128)===0?(l.flags=s&-65537|128,l):null;case 26:case 27:case 5:return it(l),null;case 31:if(l.memoizedState!==null){if(mi(l),l.alternate===null)throw Error(i(340));sa()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 13:if(mi(l),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(i(340));sa()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return N(Zt),null;case 4:return be(),null;case 10:return Br(l.type),null;case 22:case 23:return mi(l),Qd(),s!==null&&N(la),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 24:return Br(nn),null;case 25:return null;default:return null}}function H1(s,l){switch(Pd(l),l.tag){case 3:Br(nn),be();break;case 26:case 27:case 5:it(l);break;case 4:be();break;case 31:l.memoizedState!==null&&mi(l);break;case 13:mi(l);break;case 19:N(Zt);break;case 10:Br(l.type);break;case 22:case 23:mi(l),Qd(),s!==null&&N(la);break;case 24:Br(nn)}}function ql(s,l){try{var u=l.updateQueue,d=u!==null?u.lastEffect:null;if(d!==null){var v=d.next;u=v;do{if((u.tag&s)===s){d=void 0;var x=u.create,A=u.inst;d=x(),A.destroy=d}u=u.next}while(u!==v)}}catch(D){vt(l,l.return,D)}}function ws(s,l,u){try{var d=l.updateQueue,v=d!==null?d.lastEffect:null;if(v!==null){var x=v.next;d=x;do{if((d.tag&s)===s){var A=d.inst,D=A.destroy;if(D!==void 0){A.destroy=void 0,v=l;var X=u,te=D;try{te()}catch(fe){vt(v,X,fe)}}}d=d.next}while(d!==x)}}catch(fe){vt(l,l.return,fe)}}function z1(s){var l=s.updateQueue;if(l!==null){var u=s.stateNode;try{Nv(l,u)}catch(d){vt(s,s.return,d)}}}function $1(s,l,u){u.props=da(s.type,s.memoizedProps),u.state=s.memoizedState;try{u.componentWillUnmount()}catch(d){vt(s,l,d)}}function Wl(s,l){try{var u=s.ref;if(u!==null){switch(s.tag){case 26:case 27:case 5:var d=s.stateNode;break;case 30:d=s.stateNode;break;default:d=s.stateNode}typeof u=="function"?s.refCleanup=u(d):u.current=d}}catch(v){vt(s,l,v)}}function yr(s,l){var u=s.ref,d=s.refCleanup;if(u!==null)if(typeof d=="function")try{d()}catch(v){vt(s,l,v)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(v){vt(s,l,v)}else u.current=null}function G1(s){var l=s.type,u=s.memoizedProps,d=s.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":u.autoFocus&&d.focus();break e;case"img":u.src?d.src=u.src:u.srcSet&&(d.srcset=u.srcSet)}}catch(v){vt(s,s.return,v)}}function k0(s,l,u){try{var d=s.stateNode;ST(d,s.type,u,l),d[B]=l}catch(v){vt(s,s.return,v)}}function V1(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Rs(s.type)||s.tag===4}function D0(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||V1(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Rs(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function N0(s,l,u){var d=s.tag;if(d===5||d===6)s=s.stateNode,l?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(s,l):(l=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,l.appendChild(s),u=u._reactRootContainer,u!=null||l.onclick!==null||(l.onclick=Mr));else if(d!==4&&(d===27&&Rs(s.type)&&(u=s.stateNode,l=null),s=s.child,s!==null))for(N0(s,l,u),s=s.sibling;s!==null;)N0(s,l,u),s=s.sibling}function hh(s,l,u){var d=s.tag;if(d===5||d===6)s=s.stateNode,l?u.insertBefore(s,l):u.appendChild(s);else if(d!==4&&(d===27&&Rs(s.type)&&(u=s.stateNode),s=s.child,s!==null))for(hh(s,l,u),s=s.sibling;s!==null;)hh(s,l,u),s=s.sibling}function q1(s){var l=s.stateNode,u=s.memoizedProps;try{for(var d=s.type,v=l.attributes;v.length;)l.removeAttributeNode(v[0]);Cn(l,d,u),l[I]=s,l[B]=u}catch(x){vt(s,s.return,x)}}var $r=!1,an=!1,M0=!1,W1=typeof WeakSet=="function"?WeakSet:Set,yn=null;function iT(s,l){if(s=s.containerInfo,ep=Nh,s=sv(s),Td(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else e:{u=(u=s.ownerDocument)&&u.defaultView||window;var d=u.getSelection&&u.getSelection();if(d&&d.rangeCount!==0){u=d.anchorNode;var v=d.anchorOffset,x=d.focusNode;d=d.focusOffset;try{u.nodeType,x.nodeType}catch{u=null;break e}var A=0,D=-1,X=-1,te=0,fe=0,ge=s,se=null;t:for(;;){for(var ue;ge!==u||v!==0&&ge.nodeType!==3||(D=A+v),ge!==x||d!==0&&ge.nodeType!==3||(X=A+d),ge.nodeType===3&&(A+=ge.nodeValue.length),(ue=ge.firstChild)!==null;)se=ge,ge=ue;for(;;){if(ge===s)break t;if(se===u&&++te===v&&(D=A),se===x&&++fe===d&&(X=A),(ue=ge.nextSibling)!==null)break;ge=se,se=ge.parentNode}ge=ue}u=D===-1||X===-1?null:{start:D,end:X}}else u=null}u=u||{start:0,end:0}}else u=null;for(tp={focusedElem:s,selectionRange:u},Nh=!1,yn=l;yn!==null;)if(l=yn,s=l.child,(l.subtreeFlags&1028)!==0&&s!==null)s.return=l,yn=s;else for(;yn!==null;){switch(l=yn,x=l.alternate,s=l.flags,l.tag){case 0:if((s&4)!==0&&(s=l.updateQueue,s=s!==null?s.events:null,s!==null))for(u=0;u<s.length;u++)v=s[u],v.ref.impl=v.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&x!==null){s=void 0,u=l,v=x.memoizedProps,x=x.memoizedState,d=u.stateNode;try{var Fe=da(u.type,v);s=d.getSnapshotBeforeUpdate(Fe,x),d.__reactInternalSnapshotBeforeUpdate=s}catch(ze){vt(u,u.return,ze)}}break;case 3:if((s&1024)!==0){if(s=l.stateNode.containerInfo,u=s.nodeType,u===9)rp(s);else if(u===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":rp(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=l.sibling,s!==null){s.return=l.return,yn=s;break}yn=l.return}}function X1(s,l,u){var d=u.flags;switch(u.tag){case 0:case 11:case 15:Vr(s,u),d&4&&ql(5,u);break;case 1:if(Vr(s,u),d&4)if(s=u.stateNode,l===null)try{s.componentDidMount()}catch(A){vt(u,u.return,A)}else{var v=da(u.type,l.memoizedProps);l=l.memoizedState;try{s.componentDidUpdate(v,l,s.__reactInternalSnapshotBeforeUpdate)}catch(A){vt(u,u.return,A)}}d&64&&z1(u),d&512&&Wl(u,u.return);break;case 3:if(Vr(s,u),d&64&&(s=u.updateQueue,s!==null)){if(l=null,u.child!==null)switch(u.child.tag){case 27:case 5:l=u.child.stateNode;break;case 1:l=u.child.stateNode}try{Nv(s,l)}catch(A){vt(u,u.return,A)}}break;case 27:l===null&&d&4&&q1(u);case 26:case 5:Vr(s,u),l===null&&d&4&&G1(u),d&512&&Wl(u,u.return);break;case 12:Vr(s,u);break;case 31:Vr(s,u),d&4&&J1(s,u);break;case 13:Vr(s,u),d&4&&Q1(s,u),d&64&&(s=u.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(u=fT.bind(null,u),NT(s,u))));break;case 22:if(d=u.memoizedState!==null||$r,!d){l=l!==null&&l.memoizedState!==null||an,v=$r;var x=an;$r=d,(an=l)&&!x?qr(s,u,(u.subtreeFlags&8772)!==0):Vr(s,u),$r=v,an=x}break;case 30:break;default:Vr(s,u)}}function Y1(s){var l=s.alternate;l!==null&&(s.alternate=null,Y1(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&_e(l)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Ut=null,ei=!1;function Gr(s,l,u){for(u=u.child;u!==null;)K1(s,l,u),u=u.sibling}function K1(s,l,u){if(Bn&&typeof Bn.onCommitFiberUnmount=="function")try{Bn.onCommitFiberUnmount(cs,u)}catch{}switch(u.tag){case 26:an||yr(u,l),Gr(s,l,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:an||yr(u,l);var d=Ut,v=ei;Rs(u.type)&&(Ut=u.stateNode,ei=!1),Gr(s,l,u),nc(u.stateNode),Ut=d,ei=v;break;case 5:an||yr(u,l);case 6:if(d=Ut,v=ei,Ut=null,Gr(s,l,u),Ut=d,ei=v,Ut!==null)if(ei)try{(Ut.nodeType===9?Ut.body:Ut.nodeName==="HTML"?Ut.ownerDocument.body:Ut).removeChild(u.stateNode)}catch(x){vt(u,l,x)}else try{Ut.removeChild(u.stateNode)}catch(x){vt(u,l,x)}break;case 18:Ut!==null&&(ei?(s=Ut,zy(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,u.stateNode),Ro(s)):zy(Ut,u.stateNode));break;case 4:d=Ut,v=ei,Ut=u.stateNode.containerInfo,ei=!0,Gr(s,l,u),Ut=d,ei=v;break;case 0:case 11:case 14:case 15:ws(2,u,l),an||ws(4,u,l),Gr(s,l,u);break;case 1:an||(yr(u,l),d=u.stateNode,typeof d.componentWillUnmount=="function"&&$1(u,l,d)),Gr(s,l,u);break;case 21:Gr(s,l,u);break;case 22:an=(d=an)||u.memoizedState!==null,Gr(s,l,u),an=d;break;default:Gr(s,l,u)}}function J1(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Ro(s)}catch(u){vt(l,l.return,u)}}}function Q1(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Ro(s)}catch(u){vt(l,l.return,u)}}function rT(s){switch(s.tag){case 31:case 13:case 19:var l=s.stateNode;return l===null&&(l=s.stateNode=new W1),l;case 22:return s=s.stateNode,l=s._retryCache,l===null&&(l=s._retryCache=new W1),l;default:throw Error(i(435,s.tag))}}function fh(s,l){var u=rT(s);l.forEach(function(d){if(!u.has(d)){u.add(d);var v=dT.bind(null,s,d);d.then(v,v)}})}function ti(s,l){var u=l.deletions;if(u!==null)for(var d=0;d<u.length;d++){var v=u[d],x=s,A=l,D=A;e:for(;D!==null;){switch(D.tag){case 27:if(Rs(D.type)){Ut=D.stateNode,ei=!1;break e}break;case 5:Ut=D.stateNode,ei=!1;break e;case 3:case 4:Ut=D.stateNode.containerInfo,ei=!0;break e}D=D.return}if(Ut===null)throw Error(i(160));K1(x,A,v),Ut=null,ei=!1,x=v.alternate,x!==null&&(x.return=null),v.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)Z1(l,s),l=l.sibling}var tr=null;function Z1(s,l){var u=s.alternate,d=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:ti(l,s),ni(s),d&4&&(ws(3,s,s.return),ql(3,s),ws(5,s,s.return));break;case 1:ti(l,s),ni(s),d&512&&(an||u===null||yr(u,u.return)),d&64&&$r&&(s=s.updateQueue,s!==null&&(d=s.callbacks,d!==null&&(u=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=u===null?d:u.concat(d))));break;case 26:var v=tr;if(ti(l,s),ni(s),d&512&&(an||u===null||yr(u,u.return)),d&4){var x=u!==null?u.memoizedState:null;if(d=s.memoizedState,u===null)if(d===null)if(s.stateNode===null){e:{d=s.type,u=s.memoizedProps,v=v.ownerDocument||v;t:switch(d){case"title":x=v.getElementsByTagName("title")[0],(!x||x[le]||x[I]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=v.createElement(d),v.head.insertBefore(x,v.querySelector("head > title"))),Cn(x,d,u),x[I]=s,Ie(x),d=x;break e;case"link":var A=Zy("link","href",v).get(d+(u.href||""));if(A){for(var D=0;D<A.length;D++)if(x=A[D],x.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&x.getAttribute("rel")===(u.rel==null?null:u.rel)&&x.getAttribute("title")===(u.title==null?null:u.title)&&x.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){A.splice(D,1);break t}}x=v.createElement(d),Cn(x,d,u),v.head.appendChild(x);break;case"meta":if(A=Zy("meta","content",v).get(d+(u.content||""))){for(D=0;D<A.length;D++)if(x=A[D],x.getAttribute("content")===(u.content==null?null:""+u.content)&&x.getAttribute("name")===(u.name==null?null:u.name)&&x.getAttribute("property")===(u.property==null?null:u.property)&&x.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&x.getAttribute("charset")===(u.charSet==null?null:u.charSet)){A.splice(D,1);break t}}x=v.createElement(d),Cn(x,d,u),v.head.appendChild(x);break;default:throw Error(i(468,d))}x[I]=s,Ie(x),d=x}s.stateNode=d}else e_(v,s.type,s.stateNode);else s.stateNode=Qy(v,d,s.memoizedProps);else x!==d?(x===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):x.count--,d===null?e_(v,s.type,s.stateNode):Qy(v,d,s.memoizedProps)):d===null&&s.stateNode!==null&&k0(s,s.memoizedProps,u.memoizedProps)}break;case 27:ti(l,s),ni(s),d&512&&(an||u===null||yr(u,u.return)),u!==null&&d&4&&k0(s,s.memoizedProps,u.memoizedProps);break;case 5:if(ti(l,s),ni(s),d&512&&(an||u===null||yr(u,u.return)),s.flags&32){v=s.stateNode;try{Ka(v,"")}catch(Fe){vt(s,s.return,Fe)}}d&4&&s.stateNode!=null&&(v=s.memoizedProps,k0(s,v,u!==null?u.memoizedProps:v)),d&1024&&(M0=!0);break;case 6:if(ti(l,s),ni(s),d&4){if(s.stateNode===null)throw Error(i(162));d=s.memoizedProps,u=s.stateNode;try{u.nodeValue=d}catch(Fe){vt(s,s.return,Fe)}}break;case 3:if(Rh=null,v=tr,tr=Th(l.containerInfo),ti(l,s),tr=v,ni(s),d&4&&u!==null&&u.memoizedState.isDehydrated)try{Ro(l.containerInfo)}catch(Fe){vt(s,s.return,Fe)}M0&&(M0=!1,ey(s));break;case 4:d=tr,tr=Th(s.stateNode.containerInfo),ti(l,s),ni(s),tr=d;break;case 12:ti(l,s),ni(s);break;case 31:ti(l,s),ni(s),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,fh(s,d)));break;case 13:ti(l,s),ni(s),s.child.flags&8192&&s.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(ph=Pt()),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,fh(s,d)));break;case 22:v=s.memoizedState!==null;var X=u!==null&&u.memoizedState!==null,te=$r,fe=an;if($r=te||v,an=fe||X,ti(l,s),an=fe,$r=te,ni(s),d&8192)e:for(l=s.stateNode,l._visibility=v?l._visibility&-2:l._visibility|1,v&&(u===null||X||$r||an||pa(s)),u=null,l=s;;){if(l.tag===5||l.tag===26){if(u===null){X=u=l;try{if(x=X.stateNode,v)A=x.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{D=X.stateNode;var ge=X.memoizedProps.style,se=ge!=null&&ge.hasOwnProperty("display")?ge.display:null;D.style.display=se==null||typeof se=="boolean"?"":(""+se).trim()}}catch(Fe){vt(X,X.return,Fe)}}}else if(l.tag===6){if(u===null){X=l;try{X.stateNode.nodeValue=v?"":X.memoizedProps}catch(Fe){vt(X,X.return,Fe)}}}else if(l.tag===18){if(u===null){X=l;try{var ue=X.stateNode;v?$y(ue,!0):$y(X.stateNode,!1)}catch(Fe){vt(X,X.return,Fe)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===s)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break e;for(;l.sibling===null;){if(l.return===null||l.return===s)break e;u===l&&(u=null),l=l.return}u===l&&(u=null),l.sibling.return=l.return,l=l.sibling}d&4&&(d=s.updateQueue,d!==null&&(u=d.retryQueue,u!==null&&(d.retryQueue=null,fh(s,u))));break;case 19:ti(l,s),ni(s),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,fh(s,d)));break;case 30:break;case 21:break;default:ti(l,s),ni(s)}}function ni(s){var l=s.flags;if(l&2){try{for(var u,d=s.return;d!==null;){if(V1(d)){u=d;break}d=d.return}if(u==null)throw Error(i(160));switch(u.tag){case 27:var v=u.stateNode,x=D0(s);hh(s,x,v);break;case 5:var A=u.stateNode;u.flags&32&&(Ka(A,""),u.flags&=-33);var D=D0(s);hh(s,D,A);break;case 3:case 4:var X=u.stateNode.containerInfo,te=D0(s);N0(s,te,X);break;default:throw Error(i(161))}}catch(fe){vt(s,s.return,fe)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function ey(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var l=s;ey(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),s=s.sibling}}function Vr(s,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)X1(s,l.alternate,l),l=l.sibling}function pa(s){for(s=s.child;s!==null;){var l=s;switch(l.tag){case 0:case 11:case 14:case 15:ws(4,l,l.return),pa(l);break;case 1:yr(l,l.return);var u=l.stateNode;typeof u.componentWillUnmount=="function"&&$1(l,l.return,u),pa(l);break;case 27:nc(l.stateNode);case 26:case 5:yr(l,l.return),pa(l);break;case 22:l.memoizedState===null&&pa(l);break;case 30:pa(l);break;default:pa(l)}s=s.sibling}}function qr(s,l,u){for(u=u&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var d=l.alternate,v=s,x=l,A=x.flags;switch(x.tag){case 0:case 11:case 15:qr(v,x,u),ql(4,x);break;case 1:if(qr(v,x,u),d=x,v=d.stateNode,typeof v.componentDidMount=="function")try{v.componentDidMount()}catch(te){vt(d,d.return,te)}if(d=x,v=d.updateQueue,v!==null){var D=d.stateNode;try{var X=v.shared.hiddenCallbacks;if(X!==null)for(v.shared.hiddenCallbacks=null,v=0;v<X.length;v++)Dv(X[v],D)}catch(te){vt(d,d.return,te)}}u&&A&64&&z1(x),Wl(x,x.return);break;case 27:q1(x);case 26:case 5:qr(v,x,u),u&&d===null&&A&4&&G1(x),Wl(x,x.return);break;case 12:qr(v,x,u);break;case 31:qr(v,x,u),u&&A&4&&J1(v,x);break;case 13:qr(v,x,u),u&&A&4&&Q1(v,x);break;case 22:x.memoizedState===null&&qr(v,x,u),Wl(x,x.return);break;case 30:break;default:qr(v,x,u)}l=l.sibling}}function L0(s,l){var u=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),s=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(s=l.memoizedState.cachePool.pool),s!==u&&(s!=null&&s.refCount++,u!=null&&Ml(u))}function F0(s,l){s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&Ml(s))}function nr(s,l,u,d){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)ty(s,l,u,d),l=l.sibling}function ty(s,l,u,d){var v=l.flags;switch(l.tag){case 0:case 11:case 15:nr(s,l,u,d),v&2048&&ql(9,l);break;case 1:nr(s,l,u,d);break;case 3:nr(s,l,u,d),v&2048&&(s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&Ml(s)));break;case 12:if(v&2048){nr(s,l,u,d),s=l.stateNode;try{var x=l.memoizedProps,A=x.id,D=x.onPostCommit;typeof D=="function"&&D(A,l.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(X){vt(l,l.return,X)}}else nr(s,l,u,d);break;case 31:nr(s,l,u,d);break;case 13:nr(s,l,u,d);break;case 23:break;case 22:x=l.stateNode,A=l.alternate,l.memoizedState!==null?x._visibility&2?nr(s,l,u,d):Xl(s,l):x._visibility&2?nr(s,l,u,d):(x._visibility|=2,vo(s,l,u,d,(l.subtreeFlags&10256)!==0||!1)),v&2048&&L0(A,l);break;case 24:nr(s,l,u,d),v&2048&&F0(l.alternate,l);break;default:nr(s,l,u,d)}}function vo(s,l,u,d,v){for(v=v&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var x=s,A=l,D=u,X=d,te=A.flags;switch(A.tag){case 0:case 11:case 15:vo(x,A,D,X,v),ql(8,A);break;case 23:break;case 22:var fe=A.stateNode;A.memoizedState!==null?fe._visibility&2?vo(x,A,D,X,v):Xl(x,A):(fe._visibility|=2,vo(x,A,D,X,v)),v&&te&2048&&L0(A.alternate,A);break;case 24:vo(x,A,D,X,v),v&&te&2048&&F0(A.alternate,A);break;default:vo(x,A,D,X,v)}l=l.sibling}}function Xl(s,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var u=s,d=l,v=d.flags;switch(d.tag){case 22:Xl(u,d),v&2048&&L0(d.alternate,d);break;case 24:Xl(u,d),v&2048&&F0(d.alternate,d);break;default:Xl(u,d)}l=l.sibling}}var Yl=8192;function yo(s,l,u){if(s.subtreeFlags&Yl)for(s=s.child;s!==null;)ny(s,l,u),s=s.sibling}function ny(s,l,u){switch(s.tag){case 26:yo(s,l,u),s.flags&Yl&&s.memoizedState!==null&&GT(u,tr,s.memoizedState,s.memoizedProps);break;case 5:yo(s,l,u);break;case 3:case 4:var d=tr;tr=Th(s.stateNode.containerInfo),yo(s,l,u),tr=d;break;case 22:s.memoizedState===null&&(d=s.alternate,d!==null&&d.memoizedState!==null?(d=Yl,Yl=16777216,yo(s,l,u),Yl=d):yo(s,l,u));break;default:yo(s,l,u)}}function iy(s){var l=s.alternate;if(l!==null&&(s=l.child,s!==null)){l.child=null;do l=s.sibling,s.sibling=null,s=l;while(s!==null)}}function Kl(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var u=0;u<l.length;u++){var d=l[u];yn=d,sy(d,s)}iy(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)ry(s),s=s.sibling}function ry(s){switch(s.tag){case 0:case 11:case 15:Kl(s),s.flags&2048&&ws(9,s,s.return);break;case 3:Kl(s);break;case 12:Kl(s);break;case 22:var l=s.stateNode;s.memoizedState!==null&&l._visibility&2&&(s.return===null||s.return.tag!==13)?(l._visibility&=-3,dh(s)):Kl(s);break;default:Kl(s)}}function dh(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var u=0;u<l.length;u++){var d=l[u];yn=d,sy(d,s)}iy(s)}for(s=s.child;s!==null;){switch(l=s,l.tag){case 0:case 11:case 15:ws(8,l,l.return),dh(l);break;case 22:u=l.stateNode,u._visibility&2&&(u._visibility&=-3,dh(l));break;default:dh(l)}s=s.sibling}}function sy(s,l){for(;yn!==null;){var u=yn;switch(u.tag){case 0:case 11:case 15:ws(8,u,l);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var d=u.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:Ml(u.memoizedState.cache)}if(d=u.child,d!==null)d.return=u,yn=d;else e:for(u=s;yn!==null;){d=yn;var v=d.sibling,x=d.return;if(Y1(d),d===u){yn=null;break e}if(v!==null){v.return=x,yn=v;break e}yn=x}}}var sT={getCacheForType:function(s){var l=An(nn),u=l.data.get(s);return u===void 0&&(u=s(),l.data.set(s,u)),u},cacheSignal:function(){return An(nn).controller.signal}},aT=typeof WeakMap=="function"?WeakMap:Map,ft=0,Ct=null,tt=null,rt=0,mt=0,vi=null,bs=!1,_o=!1,I0=!1,Wr=0,Wt=0,Es=0,ga=0,P0=0,yi=0,xo=0,Jl=null,ii=null,B0=!1,ph=0,ay=0,gh=1/0,mh=null,Ss=null,dn=0,As=null,wo=null,Xr=0,U0=0,j0=null,oy=null,Ql=0,H0=null;function _i(){return(ft&2)!==0&&rt!==0?rt&-rt:J.T!==null?W0():R()}function ly(){if(yi===0)if((rt&536870912)===0||at){var s=Va;Va<<=1,(Va&3932160)===0&&(Va=262144),yi=s}else yi=536870912;return s=gi.current,s!==null&&(s.flags|=32),yi}function ri(s,l,u){(s===Ct&&(mt===2||mt===9)||s.cancelPendingCommit!==null)&&(bo(s,0),Ts(s,rt,yi,!1)),Qs(s,u),((ft&2)===0||s!==Ct)&&(s===Ct&&((ft&2)===0&&(ga|=u),Wt===4&&Ts(s,rt,yi,!1)),_r(s))}function cy(s,l,u){if((ft&6)!==0)throw Error(i(327));var d=!u&&(l&127)===0&&(l&s.expiredLanes)===0||Js(s,l),v=d?cT(s,l):$0(s,l,!0),x=d;do{if(v===0){_o&&!d&&Ts(s,l,0,!1);break}else{if(u=s.current.alternate,x&&!oT(u)){v=$0(s,l,!1),x=!1;continue}if(v===2){if(x=l,s.errorRecoveryDisabledLanes&x)var A=0;else A=s.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){l=A;e:{var D=s;v=Jl;var X=D.current.memoizedState.isDehydrated;if(X&&(bo(D,A).flags|=256),A=$0(D,A,!1),A!==2){if(I0&&!X){D.errorRecoveryDisabledLanes|=x,ga|=x,v=4;break e}x=ii,ii=v,x!==null&&(ii===null?ii=x:ii.push.apply(ii,x))}v=A}if(x=!1,v!==2)continue}}if(v===1){bo(s,0),Ts(s,l,0,!0);break}e:{switch(d=s,x=v,x){case 0:case 1:throw Error(i(345));case 4:if((l&4194048)!==l)break;case 6:Ts(d,l,yi,!bs);break e;case 2:ii=null;break;case 3:case 5:break;default:throw Error(i(329))}if((l&62914560)===l&&(v=ph+300-Pt(),10<v)){if(Ts(d,l,yi,!bs),Wa(d,0,!0)!==0)break e;Xr=l,d.timeoutHandle=jy(uy.bind(null,d,u,ii,mh,B0,l,yi,ga,xo,bs,x,"Throttled",-0,0),v);break e}uy(d,u,ii,mh,B0,l,yi,ga,xo,bs,x,null,-0,0)}}break}while(!0);_r(s)}function uy(s,l,u,d,v,x,A,D,X,te,fe,ge,se,ue){if(s.timeoutHandle=-1,ge=l.subtreeFlags,ge&8192||(ge&16785408)===16785408){ge={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Mr},ny(l,x,ge);var Fe=(x&62914560)===x?ph-Pt():(x&4194048)===x?ay-Pt():0;if(Fe=VT(ge,Fe),Fe!==null){Xr=x,s.cancelPendingCommit=Fe(yy.bind(null,s,l,x,u,d,v,A,D,X,fe,ge,null,se,ue)),Ts(s,x,A,!te);return}}yy(s,l,x,u,d,v,A,D,X)}function oT(s){for(var l=s;;){var u=l.tag;if((u===0||u===11||u===15)&&l.flags&16384&&(u=l.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var d=0;d<u.length;d++){var v=u[d],x=v.getSnapshot;v=v.value;try{if(!di(x(),v))return!1}catch{return!1}}if(u=l.child,l.subtreeFlags&16384&&u!==null)u.return=l,l=u;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Ts(s,l,u,d){l&=~P0,l&=~ga,s.suspendedLanes|=l,s.pingedLanes&=~l,d&&(s.warmLanes|=l),d=s.expirationTimes;for(var v=l;0<v;){var x=31-Gn(v),A=1<<x;d[x]=-1,v&=~A}u!==0&&Tu(s,u,l)}function vh(){return(ft&6)===0?(Zl(0),!1):!0}function z0(){if(tt!==null){if(mt===0)var s=tt.return;else s=tt,Pr=aa=null,r0(s),ho=null,Fl=0,s=tt;for(;s!==null;)H1(s.alternate,s),s=s.return;tt=null}}function bo(s,l){var u=s.timeoutHandle;u!==-1&&(s.timeoutHandle=-1,CT(u)),u=s.cancelPendingCommit,u!==null&&(s.cancelPendingCommit=null,u()),Xr=0,z0(),Ct=s,tt=u=Fr(s.current,null),rt=l,mt=0,vi=null,bs=!1,_o=Js(s,l),I0=!1,xo=yi=P0=ga=Es=Wt=0,ii=Jl=null,B0=!1,(l&8)!==0&&(l|=l&32);var d=s.entangledLanes;if(d!==0)for(s=s.entanglements,d&=l;0<d;){var v=31-Gn(d),x=1<<v;l|=s[v],d&=~x}return Wr=l,Bu(),u}function hy(s,l){Ke=null,J.H=$l,l===uo||l===qu?(l=Cv(),mt=3):l===qd?(l=Cv(),mt=4):mt=l===x0?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,vi=l,tt===null&&(Wt=1,ah(s,Pi(l,s.current)))}function fy(){var s=gi.current;return s===null?!0:(rt&4194048)===rt?Hi===null:(rt&62914560)===rt||(rt&536870912)!==0?s===Hi:!1}function dy(){var s=J.H;return J.H=$l,s===null?$l:s}function py(){var s=J.A;return J.A=sT,s}function yh(){Wt=4,bs||(rt&4194048)!==rt&&gi.current!==null||(_o=!0),(Es&134217727)===0&&(ga&134217727)===0||Ct===null||Ts(Ct,rt,yi,!1)}function $0(s,l,u){var d=ft;ft|=2;var v=dy(),x=py();(Ct!==s||rt!==l)&&(mh=null,bo(s,l)),l=!1;var A=Wt;e:do try{if(mt!==0&&tt!==null){var D=tt,X=vi;switch(mt){case 8:z0(),A=6;break e;case 3:case 2:case 9:case 6:gi.current===null&&(l=!0);var te=mt;if(mt=0,vi=null,Eo(s,D,X,te),u&&_o){A=0;break e}break;default:te=mt,mt=0,vi=null,Eo(s,D,X,te)}}lT(),A=Wt;break}catch(fe){hy(s,fe)}while(!0);return l&&s.shellSuspendCounter++,Pr=aa=null,ft=d,J.H=v,J.A=x,tt===null&&(Ct=null,rt=0,Bu()),A}function lT(){for(;tt!==null;)gy(tt)}function cT(s,l){var u=ft;ft|=2;var d=dy(),v=py();Ct!==s||rt!==l?(mh=null,gh=Pt()+500,bo(s,l)):_o=Js(s,l);e:do try{if(mt!==0&&tt!==null){l=tt;var x=vi;t:switch(mt){case 1:mt=0,vi=null,Eo(s,l,x,1);break;case 2:case 9:if(Av(x)){mt=0,vi=null,my(l);break}l=function(){mt!==2&&mt!==9||Ct!==s||(mt=7),_r(s)},x.then(l,l);break e;case 3:mt=7;break e;case 4:mt=5;break e;case 7:Av(x)?(mt=0,vi=null,my(l)):(mt=0,vi=null,Eo(s,l,x,7));break;case 5:var A=null;switch(tt.tag){case 26:A=tt.memoizedState;case 5:case 27:var D=tt;if(A?t_(A):D.stateNode.complete){mt=0,vi=null;var X=D.sibling;if(X!==null)tt=X;else{var te=D.return;te!==null?(tt=te,_h(te)):tt=null}break t}}mt=0,vi=null,Eo(s,l,x,5);break;case 6:mt=0,vi=null,Eo(s,l,x,6);break;case 8:z0(),Wt=6;break e;default:throw Error(i(462))}}uT();break}catch(fe){hy(s,fe)}while(!0);return Pr=aa=null,J.H=d,J.A=v,ft=u,tt!==null?0:(Ct=null,rt=0,Bu(),Wt)}function uT(){for(;tt!==null&&!xu();)gy(tt)}function gy(s){var l=U1(s.alternate,s,Wr);s.memoizedProps=s.pendingProps,l===null?_h(s):tt=l}function my(s){var l=s,u=l.alternate;switch(l.tag){case 15:case 0:l=M1(u,l,l.pendingProps,l.type,void 0,rt);break;case 11:l=M1(u,l,l.pendingProps,l.type.render,l.ref,rt);break;case 5:r0(l);default:H1(u,l),l=tt=pv(l,Wr),l=U1(u,l,Wr)}s.memoizedProps=s.pendingProps,l===null?_h(s):tt=l}function Eo(s,l,u,d){Pr=aa=null,r0(l),ho=null,Fl=0;var v=l.return;try{if(QA(s,v,l,u,rt)){Wt=1,ah(s,Pi(u,s.current)),tt=null;return}}catch(x){if(v!==null)throw tt=v,x;Wt=1,ah(s,Pi(u,s.current)),tt=null;return}l.flags&32768?(at||d===1?s=!0:_o||(rt&536870912)!==0?s=!1:(bs=s=!0,(d===2||d===9||d===3||d===6)&&(d=gi.current,d!==null&&d.tag===13&&(d.flags|=16384))),vy(l,s)):_h(l)}function _h(s){var l=s;do{if((l.flags&32768)!==0){vy(l,bs);return}s=l.return;var u=tT(l.alternate,l,Wr);if(u!==null){tt=u;return}if(l=l.sibling,l!==null){tt=l;return}tt=l=s}while(l!==null);Wt===0&&(Wt=5)}function vy(s,l){do{var u=nT(s.alternate,s);if(u!==null){u.flags&=32767,tt=u;return}if(u=s.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!l&&(s=s.sibling,s!==null)){tt=s;return}tt=s=u}while(s!==null);Wt=6,tt=null}function yy(s,l,u,d,v,x,A,D,X){s.cancelPendingCommit=null;do xh();while(dn!==0);if((ft&6)!==0)throw Error(i(327));if(l!==null){if(l===s.current)throw Error(i(177));if(x=l.lanes|l.childLanes,x|=Dd,cd(s,u,x,A,D,X),s===Ct&&(tt=Ct=null,rt=0),wo=l,As=s,Xr=u,U0=x,j0=v,oy=d,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,pT(Di,function(){return Ey(),null})):(s.callbackNode=null,s.callbackPriority=0),d=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||d){d=J.T,J.T=null,v=ae.p,ae.p=2,A=ft,ft|=4;try{iT(s,l,u)}finally{ft=A,ae.p=v,J.T=d}}dn=1,_y(),xy(),wy()}}function _y(){if(dn===1){dn=0;var s=As,l=wo,u=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||u){u=J.T,J.T=null;var d=ae.p;ae.p=2;var v=ft;ft|=4;try{Z1(l,s);var x=tp,A=sv(s.containerInfo),D=x.focusedElem,X=x.selectionRange;if(A!==D&&D&&D.ownerDocument&&rv(D.ownerDocument.documentElement,D)){if(X!==null&&Td(D)){var te=X.start,fe=X.end;if(fe===void 0&&(fe=te),"selectionStart"in D)D.selectionStart=te,D.selectionEnd=Math.min(fe,D.value.length);else{var ge=D.ownerDocument||document,se=ge&&ge.defaultView||window;if(se.getSelection){var ue=se.getSelection(),Fe=D.textContent.length,ze=Math.min(X.start,Fe),St=X.end===void 0?ze:Math.min(X.end,Fe);!ue.extend&&ze>St&&(A=St,St=ze,ze=A);var Q=iv(D,ze),K=iv(D,St);if(Q&&K&&(ue.rangeCount!==1||ue.anchorNode!==Q.node||ue.anchorOffset!==Q.offset||ue.focusNode!==K.node||ue.focusOffset!==K.offset)){var ee=ge.createRange();ee.setStart(Q.node,Q.offset),ue.removeAllRanges(),ze>St?(ue.addRange(ee),ue.extend(K.node,K.offset)):(ee.setEnd(K.node,K.offset),ue.addRange(ee))}}}}for(ge=[],ue=D;ue=ue.parentNode;)ue.nodeType===1&&ge.push({element:ue,left:ue.scrollLeft,top:ue.scrollTop});for(typeof D.focus=="function"&&D.focus(),D=0;D<ge.length;D++){var pe=ge[D];pe.element.scrollLeft=pe.left,pe.element.scrollTop=pe.top}}Nh=!!ep,tp=ep=null}finally{ft=v,ae.p=d,J.T=u}}s.current=l,dn=2}}function xy(){if(dn===2){dn=0;var s=As,l=wo,u=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||u){u=J.T,J.T=null;var d=ae.p;ae.p=2;var v=ft;ft|=4;try{X1(s,l.alternate,l)}finally{ft=v,ae.p=d,J.T=u}}dn=3}}function wy(){if(dn===4||dn===3){dn=0,ml();var s=As,l=wo,u=Xr,d=oy;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?dn=5:(dn=0,wo=As=null,by(s,s.pendingLanes));var v=s.pendingLanes;if(v===0&&(Ss=null),xl(u),l=l.stateNode,Bn&&typeof Bn.onCommitFiberRoot=="function")try{Bn.onCommitFiberRoot(cs,l,void 0,(l.current.flags&128)===128)}catch{}if(d!==null){l=J.T,v=ae.p,ae.p=2,J.T=null;try{for(var x=s.onRecoverableError,A=0;A<d.length;A++){var D=d[A];x(D.value,{componentStack:D.stack})}}finally{J.T=l,ae.p=v}}(Xr&3)!==0&&xh(),_r(s),v=s.pendingLanes,(u&261930)!==0&&(v&42)!==0?s===H0?Ql++:(Ql=0,H0=s):Ql=0,Zl(0)}}function by(s,l){(s.pooledCacheLanes&=l)===0&&(l=s.pooledCache,l!=null&&(s.pooledCache=null,Ml(l)))}function xh(){return _y(),xy(),wy(),Ey()}function Ey(){if(dn!==5)return!1;var s=As,l=U0;U0=0;var u=xl(Xr),d=J.T,v=ae.p;try{ae.p=32>u?32:u,J.T=null,u=j0,j0=null;var x=As,A=Xr;if(dn=0,wo=As=null,Xr=0,(ft&6)!==0)throw Error(i(331));var D=ft;if(ft|=4,ry(x.current),ty(x,x.current,A,u),ft=D,Zl(0,!1),Bn&&typeof Bn.onPostCommitFiberRoot=="function")try{Bn.onPostCommitFiberRoot(cs,x)}catch{}return!0}finally{ae.p=v,J.T=d,by(s,l)}}function Sy(s,l,u){l=Pi(u,l),l=_0(s.stateNode,l,2),s=ys(s,l,2),s!==null&&(Qs(s,2),_r(s))}function vt(s,l,u){if(s.tag===3)Sy(s,s,u);else for(;l!==null;){if(l.tag===3){Sy(l,s,u);break}else if(l.tag===1){var d=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Ss===null||!Ss.has(d))){s=Pi(u,s),u=A1(2),d=ys(l,u,2),d!==null&&(T1(u,d,l,s),Qs(d,2),_r(d));break}}l=l.return}}function G0(s,l,u){var d=s.pingCache;if(d===null){d=s.pingCache=new aT;var v=new Set;d.set(l,v)}else v=d.get(l),v===void 0&&(v=new Set,d.set(l,v));v.has(u)||(I0=!0,v.add(u),s=hT.bind(null,s,l,u),l.then(s,s))}function hT(s,l,u){var d=s.pingCache;d!==null&&d.delete(l),s.pingedLanes|=s.suspendedLanes&u,s.warmLanes&=~u,Ct===s&&(rt&u)===u&&(Wt===4||Wt===3&&(rt&62914560)===rt&&300>Pt()-ph?(ft&2)===0&&bo(s,0):P0|=u,xo===rt&&(xo=0)),_r(s)}function Ay(s,l){l===0&&(l=Au()),s=ia(s,l),s!==null&&(Qs(s,l),_r(s))}function fT(s){var l=s.memoizedState,u=0;l!==null&&(u=l.retryLane),Ay(s,u)}function dT(s,l){var u=0;switch(s.tag){case 31:case 13:var d=s.stateNode,v=s.memoizedState;v!==null&&(u=v.retryLane);break;case 19:d=s.stateNode;break;case 22:d=s.stateNode._retryCache;break;default:throw Error(i(314))}d!==null&&d.delete(l),Ay(s,u)}function pT(s,l){return Qi(s,l)}var wh=null,So=null,V0=!1,bh=!1,q0=!1,Cs=0;function _r(s){s!==So&&s.next===null&&(So===null?wh=So=s:So=So.next=s),bh=!0,V0||(V0=!0,mT())}function Zl(s,l){if(!q0&&bh){q0=!0;do for(var u=!1,d=wh;d!==null;){if(s!==0){var v=d.pendingLanes;if(v===0)var x=0;else{var A=d.suspendedLanes,D=d.pingedLanes;x=(1<<31-Gn(42|s)+1)-1,x&=v&~(A&~D),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(u=!0,Oy(d,x))}else x=rt,x=Wa(d,d===Ct?x:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(x&3)===0||Js(d,x)||(u=!0,Oy(d,x));d=d.next}while(u);q0=!1}}function gT(){Ty()}function Ty(){bh=V0=!1;var s=0;Cs!==0&&TT()&&(s=Cs);for(var l=Pt(),u=null,d=wh;d!==null;){var v=d.next,x=Cy(d,l);x===0?(d.next=null,u===null?wh=v:u.next=v,v===null&&(So=u)):(u=d,(s!==0||(x&3)!==0)&&(bh=!0)),d=v}dn!==0&&dn!==5||Zl(s),Cs!==0&&(Cs=0)}function Cy(s,l){for(var u=s.suspendedLanes,d=s.pingedLanes,v=s.expirationTimes,x=s.pendingLanes&-62914561;0<x;){var A=31-Gn(x),D=1<<A,X=v[A];X===-1?((D&u)===0||(D&d)!==0)&&(v[A]=ld(D,l)):X<=l&&(s.expiredLanes|=D),x&=~D}if(l=Ct,u=rt,u=Wa(s,s===l?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),d=s.callbackNode,u===0||s===l&&(mt===2||mt===9)||s.cancelPendingCommit!==null)return d!==null&&d!==null&&pr(d),s.callbackNode=null,s.callbackPriority=0;if((u&3)===0||Js(s,u)){if(l=u&-u,l===s.callbackPriority)return l;switch(d!==null&&pr(d),xl(u)){case 2:case 8:u=Ga;break;case 32:u=Di;break;case 268435456:u=vl;break;default:u=Di}return d=Ry.bind(null,s),u=Qi(u,d),s.callbackPriority=l,s.callbackNode=u,l}return d!==null&&d!==null&&pr(d),s.callbackPriority=2,s.callbackNode=null,2}function Ry(s,l){if(dn!==0&&dn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var u=s.callbackNode;if(xh()&&s.callbackNode!==u)return null;var d=rt;return d=Wa(s,s===Ct?d:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),d===0?null:(cy(s,d,l),Cy(s,Pt()),s.callbackNode!=null&&s.callbackNode===u?Ry.bind(null,s):null)}function Oy(s,l){if(xh())return null;cy(s,l,!0)}function mT(){RT(function(){(ft&6)!==0?Qi($a,gT):Ty()})}function W0(){if(Cs===0){var s=lo;s===0&&(s=Ks,Ks<<=1,(Ks&261888)===0&&(Ks=256)),Cs=s}return Cs}function ky(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:ku(""+s)}function Dy(s,l){var u=l.ownerDocument.createElement("input");return u.name=l.name,u.value=l.value,s.id&&u.setAttribute("form",s.id),l.parentNode.insertBefore(u,l),s=new FormData(s),u.parentNode.removeChild(u),s}function vT(s,l,u,d,v){if(l==="submit"&&u&&u.stateNode===v){var x=ky((v[B]||null).action),A=d.submitter;A&&(l=(l=A[B]||null)?ky(l.formAction):A.getAttribute("formAction"),l!==null&&(x=l,A=null));var D=new Lu("action","action",null,d,v);s.push({event:D,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(Cs!==0){var X=A?Dy(v,A):new FormData(v);d0(u,{pending:!0,data:X,method:v.method,action:x},null,X)}}else typeof x=="function"&&(D.preventDefault(),X=A?Dy(v,A):new FormData(v),d0(u,{pending:!0,data:X,method:v.method,action:x},x,X))},currentTarget:v}]})}}for(var X0=0;X0<kd.length;X0++){var Y0=kd[X0],yT=Y0.toLowerCase(),_T=Y0[0].toUpperCase()+Y0.slice(1);er(yT,"on"+_T)}er(lv,"onAnimationEnd"),er(cv,"onAnimationIteration"),er(uv,"onAnimationStart"),er("dblclick","onDoubleClick"),er("focusin","onFocus"),er("focusout","onBlur"),er(FA,"onTransitionRun"),er(IA,"onTransitionStart"),er(PA,"onTransitionCancel"),er(hv,"onTransitionEnd"),Mi("onMouseEnter",["mouseout","mouseover"]),Mi("onMouseLeave",["mouseout","mouseover"]),Mi("onPointerEnter",["pointerout","pointerover"]),Mi("onPointerLeave",["pointerout","pointerover"]),Bt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Bt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Bt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Bt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Bt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Bt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ec="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ec));function Ny(s,l){l=(l&4)!==0;for(var u=0;u<s.length;u++){var d=s[u],v=d.event;d=d.listeners;e:{var x=void 0;if(l)for(var A=d.length-1;0<=A;A--){var D=d[A],X=D.instance,te=D.currentTarget;if(D=D.listener,X!==x&&v.isPropagationStopped())break e;x=D,v.currentTarget=te;try{x(v)}catch(fe){Pu(fe)}v.currentTarget=null,x=X}else for(A=0;A<d.length;A++){if(D=d[A],X=D.instance,te=D.currentTarget,D=D.listener,X!==x&&v.isPropagationStopped())break e;x=D,v.currentTarget=te;try{x(v)}catch(fe){Pu(fe)}v.currentTarget=null,x=X}}}}function nt(s,l){var u=l[ne];u===void 0&&(u=l[ne]=new Set);var d=s+"__bubble";u.has(d)||(My(l,s,2,!1),u.add(d))}function K0(s,l,u){var d=0;l&&(d|=4),My(u,s,d,l)}var Eh="_reactListening"+Math.random().toString(36).slice(2);function J0(s){if(!s[Eh]){s[Eh]=!0,Dt.forEach(function(u){u!=="selectionchange"&&(xT.has(u)||K0(u,!1,s),K0(u,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[Eh]||(l[Eh]=!0,K0("selectionchange",!1,l))}}function My(s,l,u,d){switch(l_(l)){case 2:var v=XT;break;case 8:v=YT;break;default:v=fp}u=v.bind(null,l,u,s),v=void 0,!vd||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(v=!0),d?v!==void 0?s.addEventListener(l,u,{capture:!0,passive:v}):s.addEventListener(l,u,!0):v!==void 0?s.addEventListener(l,u,{passive:v}):s.addEventListener(l,u,!1)}function Q0(s,l,u,d,v){var x=d;if((l&1)===0&&(l&2)===0&&d!==null)e:for(;;){if(d===null)return;var A=d.tag;if(A===3||A===4){var D=d.stateNode.containerInfo;if(D===v)break;if(A===4)for(A=d.return;A!==null;){var X=A.tag;if((X===3||X===4)&&A.stateNode.containerInfo===v)return;A=A.return}for(;D!==null;){if(A=Ee(D),A===null)return;if(X=A.tag,X===5||X===6||X===26||X===27){d=x=A;continue e}D=D.parentNode}}d=d.return}Bm(function(){var te=x,fe=gd(u),ge=[];e:{var se=fv.get(s);if(se!==void 0){var ue=Lu,Fe=s;switch(s){case"keypress":if(Nu(u)===0)break e;case"keydown":case"keyup":ue=dA;break;case"focusin":Fe="focus",ue=wd;break;case"focusout":Fe="blur",ue=wd;break;case"beforeblur":case"afterblur":ue=wd;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ue=Hm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ue=tA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ue=mA;break;case lv:case cv:case uv:ue=rA;break;case hv:ue=yA;break;case"scroll":case"scrollend":ue=ZS;break;case"wheel":ue=xA;break;case"copy":case"cut":case"paste":ue=aA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ue=$m;break;case"toggle":case"beforetoggle":ue=bA}var ze=(l&4)!==0,St=!ze&&(s==="scroll"||s==="scrollend"),Q=ze?se!==null?se+"Capture":null:se;ze=[];for(var K=te,ee;K!==null;){var pe=K;if(ee=pe.stateNode,pe=pe.tag,pe!==5&&pe!==26&&pe!==27||ee===null||Q===null||(pe=bl(K,Q),pe!=null&&ze.push(tc(K,pe,ee))),St)break;K=K.return}0<ze.length&&(se=new ue(se,Fe,null,u,fe),ge.push({event:se,listeners:ze}))}}if((l&7)===0){e:{if(se=s==="mouseover"||s==="pointerover",ue=s==="mouseout"||s==="pointerout",se&&u!==pd&&(Fe=u.relatedTarget||u.fromElement)&&(Ee(Fe)||Fe[j]))break e;if((ue||se)&&(se=fe.window===fe?fe:(se=fe.ownerDocument)?se.defaultView||se.parentWindow:window,ue?(Fe=u.relatedTarget||u.toElement,ue=te,Fe=Fe?Ee(Fe):null,Fe!==null&&(St=a(Fe),ze=Fe.tag,Fe!==St||ze!==5&&ze!==27&&ze!==6)&&(Fe=null)):(ue=null,Fe=te),ue!==Fe)){if(ze=Hm,pe="onMouseLeave",Q="onMouseEnter",K="mouse",(s==="pointerout"||s==="pointerover")&&(ze=$m,pe="onPointerLeave",Q="onPointerEnter",K="pointer"),St=ue==null?se:xe(ue),ee=Fe==null?se:xe(Fe),se=new ze(pe,K+"leave",ue,u,fe),se.target=St,se.relatedTarget=ee,pe=null,Ee(fe)===te&&(ze=new ze(Q,K+"enter",Fe,u,fe),ze.target=ee,ze.relatedTarget=St,pe=ze),St=pe,ue&&Fe)t:{for(ze=wT,Q=ue,K=Fe,ee=0,pe=Q;pe;pe=ze(pe))ee++;pe=0;for(var je=K;je;je=ze(je))pe++;for(;0<ee-pe;)Q=ze(Q),ee--;for(;0<pe-ee;)K=ze(K),pe--;for(;ee--;){if(Q===K||K!==null&&Q===K.alternate){ze=Q;break t}Q=ze(Q),K=ze(K)}ze=null}else ze=null;ue!==null&&Ly(ge,se,ue,ze,!1),Fe!==null&&St!==null&&Ly(ge,St,Fe,ze,!0)}}e:{if(se=te?xe(te):window,ue=se.nodeName&&se.nodeName.toLowerCase(),ue==="select"||ue==="input"&&se.type==="file")var ct=Jm;else if(Ym(se))if(Qm)ct=NA;else{ct=kA;var Be=OA}else ue=se.nodeName,!ue||ue.toLowerCase()!=="input"||se.type!=="checkbox"&&se.type!=="radio"?te&&dd(te.elementType)&&(ct=Jm):ct=DA;if(ct&&(ct=ct(s,te))){Km(ge,ct,u,fe);break e}Be&&Be(s,se,te),s==="focusout"&&te&&se.type==="number"&&te.memoizedProps.value!=null&&fd(se,"number",se.value)}switch(Be=te?xe(te):window,s){case"focusin":(Ym(Be)||Be.contentEditable==="true")&&(eo=Be,Cd=te,kl=null);break;case"focusout":kl=Cd=eo=null;break;case"mousedown":Rd=!0;break;case"contextmenu":case"mouseup":case"dragend":Rd=!1,av(ge,u,fe);break;case"selectionchange":if(LA)break;case"keydown":case"keyup":av(ge,u,fe)}var Qe;if(Ed)e:{switch(s){case"compositionstart":var st="onCompositionStart";break e;case"compositionend":st="onCompositionEnd";break e;case"compositionupdate":st="onCompositionUpdate";break e}st=void 0}else Za?Wm(s,u)&&(st="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(st="onCompositionStart");st&&(Gm&&u.locale!=="ko"&&(Za||st!=="onCompositionStart"?st==="onCompositionEnd"&&Za&&(Qe=Um()):(hs=fe,yd="value"in hs?hs.value:hs.textContent,Za=!0)),Be=Sh(te,st),0<Be.length&&(st=new zm(st,s,null,u,fe),ge.push({event:st,listeners:Be}),Qe?st.data=Qe:(Qe=Xm(u),Qe!==null&&(st.data=Qe)))),(Qe=SA?AA(s,u):TA(s,u))&&(st=Sh(te,"onBeforeInput"),0<st.length&&(Be=new zm("onBeforeInput","beforeinput",null,u,fe),ge.push({event:Be,listeners:st}),Be.data=Qe)),vT(ge,s,te,u,fe)}Ny(ge,l)})}function tc(s,l,u){return{instance:s,listener:l,currentTarget:u}}function Sh(s,l){for(var u=l+"Capture",d=[];s!==null;){var v=s,x=v.stateNode;if(v=v.tag,v!==5&&v!==26&&v!==27||x===null||(v=bl(s,u),v!=null&&d.unshift(tc(s,v,x)),v=bl(s,l),v!=null&&d.push(tc(s,v,x))),s.tag===3)return d;s=s.return}return[]}function wT(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Ly(s,l,u,d,v){for(var x=l._reactName,A=[];u!==null&&u!==d;){var D=u,X=D.alternate,te=D.stateNode;if(D=D.tag,X!==null&&X===d)break;D!==5&&D!==26&&D!==27||te===null||(X=te,v?(te=bl(u,x),te!=null&&A.unshift(tc(u,te,X))):v||(te=bl(u,x),te!=null&&A.push(tc(u,te,X)))),u=u.return}A.length!==0&&s.push({event:l,listeners:A})}var bT=/\r\n?/g,ET=/\u0000|\uFFFD/g;function Fy(s){return(typeof s=="string"?s:""+s).replace(bT,`
`).replace(ET,"")}function Iy(s,l){return l=Fy(l),Fy(s)===l}function Et(s,l,u,d,v,x){switch(u){case"children":typeof d=="string"?l==="body"||l==="textarea"&&d===""||Ka(s,d):(typeof d=="number"||typeof d=="bigint")&&l!=="body"&&Ka(s,""+d);break;case"className":Ru(s,"class",d);break;case"tabIndex":Ru(s,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":Ru(s,u,d);break;case"style":Im(s,d,x);break;case"data":if(l!=="object"){Ru(s,"data",d);break}case"src":case"href":if(d===""&&(l!=="a"||u!=="href")){s.removeAttribute(u);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){s.removeAttribute(u);break}d=ku(""+d),s.setAttribute(u,d);break;case"action":case"formAction":if(typeof d=="function"){s.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(u==="formAction"?(l!=="input"&&Et(s,l,"name",v.name,v,null),Et(s,l,"formEncType",v.formEncType,v,null),Et(s,l,"formMethod",v.formMethod,v,null),Et(s,l,"formTarget",v.formTarget,v,null)):(Et(s,l,"encType",v.encType,v,null),Et(s,l,"method",v.method,v,null),Et(s,l,"target",v.target,v,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){s.removeAttribute(u);break}d=ku(""+d),s.setAttribute(u,d);break;case"onClick":d!=null&&(s.onclick=Mr);break;case"onScroll":d!=null&&nt("scroll",s);break;case"onScrollEnd":d!=null&&nt("scrollend",s);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(i(61));if(u=d.__html,u!=null){if(v.children!=null)throw Error(i(60));s.innerHTML=u}}break;case"multiple":s.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":s.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){s.removeAttribute("xlink:href");break}u=ku(""+d),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(u,""+d):s.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(u,""):s.removeAttribute(u);break;case"capture":case"download":d===!0?s.setAttribute(u,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(u,d):s.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?s.setAttribute(u,d):s.removeAttribute(u);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?s.removeAttribute(u):s.setAttribute(u,d);break;case"popover":nt("beforetoggle",s),nt("toggle",s),Qn(s,"popover",d);break;case"xlinkActuate":Nr(s,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":Nr(s,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":Nr(s,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":Nr(s,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":Nr(s,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":Nr(s,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":Nr(s,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":Nr(s,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":Nr(s,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":Qn(s,"is",d);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=JS.get(u)||u,Qn(s,u,d))}}function Z0(s,l,u,d,v,x){switch(u){case"style":Im(s,d,x);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(i(61));if(u=d.__html,u!=null){if(v.children!=null)throw Error(i(60));s.innerHTML=u}}break;case"children":typeof d=="string"?Ka(s,d):(typeof d=="number"||typeof d=="bigint")&&Ka(s,""+d);break;case"onScroll":d!=null&&nt("scroll",s);break;case"onScrollEnd":d!=null&&nt("scrollend",s);break;case"onClick":d!=null&&(s.onclick=Mr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Nt.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(v=u.endsWith("Capture"),l=u.slice(2,v?u.length-7:void 0),x=s[B]||null,x=x!=null?x[u]:null,typeof x=="function"&&s.removeEventListener(l,x,v),typeof d=="function")){typeof x!="function"&&x!==null&&(u in s?s[u]=null:s.hasAttribute(u)&&s.removeAttribute(u)),s.addEventListener(l,d,v);break e}u in s?s[u]=d:d===!0?s.setAttribute(u,""):Qn(s,u,d)}}}function Cn(s,l,u){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":nt("error",s),nt("load",s);var d=!1,v=!1,x;for(x in u)if(u.hasOwnProperty(x)){var A=u[x];if(A!=null)switch(x){case"src":d=!0;break;case"srcSet":v=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,l));default:Et(s,l,x,A,u,null)}}v&&Et(s,l,"srcSet",u.srcSet,u,null),d&&Et(s,l,"src",u.src,u,null);return;case"input":nt("invalid",s);var D=x=A=v=null,X=null,te=null;for(d in u)if(u.hasOwnProperty(d)){var fe=u[d];if(fe!=null)switch(d){case"name":v=fe;break;case"type":A=fe;break;case"checked":X=fe;break;case"defaultChecked":te=fe;break;case"value":x=fe;break;case"defaultValue":D=fe;break;case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(i(137,l));break;default:Et(s,l,d,fe,u,null)}}Nm(s,x,D,X,te,A,v,!1);return;case"select":nt("invalid",s),d=A=x=null;for(v in u)if(u.hasOwnProperty(v)&&(D=u[v],D!=null))switch(v){case"value":x=D;break;case"defaultValue":A=D;break;case"multiple":d=D;default:Et(s,l,v,D,u,null)}l=x,u=A,s.multiple=!!d,l!=null?Ya(s,!!d,l,!1):u!=null&&Ya(s,!!d,u,!0);return;case"textarea":nt("invalid",s),x=v=d=null;for(A in u)if(u.hasOwnProperty(A)&&(D=u[A],D!=null))switch(A){case"value":d=D;break;case"defaultValue":v=D;break;case"children":x=D;break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(i(91));break;default:Et(s,l,A,D,u,null)}Lm(s,d,v,x);return;case"option":for(X in u)u.hasOwnProperty(X)&&(d=u[X],d!=null)&&(X==="selected"?s.selected=d&&typeof d!="function"&&typeof d!="symbol":Et(s,l,X,d,u,null));return;case"dialog":nt("beforetoggle",s),nt("toggle",s),nt("cancel",s),nt("close",s);break;case"iframe":case"object":nt("load",s);break;case"video":case"audio":for(d=0;d<ec.length;d++)nt(ec[d],s);break;case"image":nt("error",s),nt("load",s);break;case"details":nt("toggle",s);break;case"embed":case"source":case"link":nt("error",s),nt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(te in u)if(u.hasOwnProperty(te)&&(d=u[te],d!=null))switch(te){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,l));default:Et(s,l,te,d,u,null)}return;default:if(dd(l)){for(fe in u)u.hasOwnProperty(fe)&&(d=u[fe],d!==void 0&&Z0(s,l,fe,d,u,void 0));return}}for(D in u)u.hasOwnProperty(D)&&(d=u[D],d!=null&&Et(s,l,D,d,u,null))}function ST(s,l,u,d){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var v=null,x=null,A=null,D=null,X=null,te=null,fe=null;for(ue in u){var ge=u[ue];if(u.hasOwnProperty(ue)&&ge!=null)switch(ue){case"checked":break;case"value":break;case"defaultValue":X=ge;default:d.hasOwnProperty(ue)||Et(s,l,ue,null,d,ge)}}for(var se in d){var ue=d[se];if(ge=u[se],d.hasOwnProperty(se)&&(ue!=null||ge!=null))switch(se){case"type":x=ue;break;case"name":v=ue;break;case"checked":te=ue;break;case"defaultChecked":fe=ue;break;case"value":A=ue;break;case"defaultValue":D=ue;break;case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(i(137,l));break;default:ue!==ge&&Et(s,l,se,ue,d,ge)}}hd(s,A,D,X,te,fe,x,v);return;case"select":ue=A=D=se=null;for(x in u)if(X=u[x],u.hasOwnProperty(x)&&X!=null)switch(x){case"value":break;case"multiple":ue=X;default:d.hasOwnProperty(x)||Et(s,l,x,null,d,X)}for(v in d)if(x=d[v],X=u[v],d.hasOwnProperty(v)&&(x!=null||X!=null))switch(v){case"value":se=x;break;case"defaultValue":D=x;break;case"multiple":A=x;default:x!==X&&Et(s,l,v,x,d,X)}l=D,u=A,d=ue,se!=null?Ya(s,!!u,se,!1):!!d!=!!u&&(l!=null?Ya(s,!!u,l,!0):Ya(s,!!u,u?[]:"",!1));return;case"textarea":ue=se=null;for(D in u)if(v=u[D],u.hasOwnProperty(D)&&v!=null&&!d.hasOwnProperty(D))switch(D){case"value":break;case"children":break;default:Et(s,l,D,null,d,v)}for(A in d)if(v=d[A],x=u[A],d.hasOwnProperty(A)&&(v!=null||x!=null))switch(A){case"value":se=v;break;case"defaultValue":ue=v;break;case"children":break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(i(91));break;default:v!==x&&Et(s,l,A,v,d,x)}Mm(s,se,ue);return;case"option":for(var Fe in u)se=u[Fe],u.hasOwnProperty(Fe)&&se!=null&&!d.hasOwnProperty(Fe)&&(Fe==="selected"?s.selected=!1:Et(s,l,Fe,null,d,se));for(X in d)se=d[X],ue=u[X],d.hasOwnProperty(X)&&se!==ue&&(se!=null||ue!=null)&&(X==="selected"?s.selected=se&&typeof se!="function"&&typeof se!="symbol":Et(s,l,X,se,d,ue));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ze in u)se=u[ze],u.hasOwnProperty(ze)&&se!=null&&!d.hasOwnProperty(ze)&&Et(s,l,ze,null,d,se);for(te in d)if(se=d[te],ue=u[te],d.hasOwnProperty(te)&&se!==ue&&(se!=null||ue!=null))switch(te){case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(i(137,l));break;default:Et(s,l,te,se,d,ue)}return;default:if(dd(l)){for(var St in u)se=u[St],u.hasOwnProperty(St)&&se!==void 0&&!d.hasOwnProperty(St)&&Z0(s,l,St,void 0,d,se);for(fe in d)se=d[fe],ue=u[fe],!d.hasOwnProperty(fe)||se===ue||se===void 0&&ue===void 0||Z0(s,l,fe,se,d,ue);return}}for(var Q in u)se=u[Q],u.hasOwnProperty(Q)&&se!=null&&!d.hasOwnProperty(Q)&&Et(s,l,Q,null,d,se);for(ge in d)se=d[ge],ue=u[ge],!d.hasOwnProperty(ge)||se===ue||se==null&&ue==null||Et(s,l,ge,se,d,ue)}function Py(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function AT(){if(typeof performance.getEntriesByType=="function"){for(var s=0,l=0,u=performance.getEntriesByType("resource"),d=0;d<u.length;d++){var v=u[d],x=v.transferSize,A=v.initiatorType,D=v.duration;if(x&&D&&Py(A)){for(A=0,D=v.responseEnd,d+=1;d<u.length;d++){var X=u[d],te=X.startTime;if(te>D)break;var fe=X.transferSize,ge=X.initiatorType;fe&&Py(ge)&&(X=X.responseEnd,A+=fe*(X<D?1:(D-te)/(X-te)))}if(--d,l+=8*(x+A)/(v.duration/1e3),s++,10<s)break}}if(0<s)return l/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var ep=null,tp=null;function Ah(s){return s.nodeType===9?s:s.ownerDocument}function By(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Uy(s,l){if(s===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&l==="foreignObject"?0:s}function np(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var ip=null;function TT(){var s=window.event;return s&&s.type==="popstate"?s===ip?!1:(ip=s,!0):(ip=null,!1)}var jy=typeof setTimeout=="function"?setTimeout:void 0,CT=typeof clearTimeout=="function"?clearTimeout:void 0,Hy=typeof Promise=="function"?Promise:void 0,RT=typeof queueMicrotask=="function"?queueMicrotask:typeof Hy<"u"?function(s){return Hy.resolve(null).then(s).catch(OT)}:jy;function OT(s){setTimeout(function(){throw s})}function Rs(s){return s==="head"}function zy(s,l){var u=l,d=0;do{var v=u.nextSibling;if(s.removeChild(u),v&&v.nodeType===8)if(u=v.data,u==="/$"||u==="/&"){if(d===0){s.removeChild(v),Ro(l);return}d--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")d++;else if(u==="html")nc(s.ownerDocument.documentElement);else if(u==="head"){u=s.ownerDocument.head,nc(u);for(var x=u.firstChild;x;){var A=x.nextSibling,D=x.nodeName;x[le]||D==="SCRIPT"||D==="STYLE"||D==="LINK"&&x.rel.toLowerCase()==="stylesheet"||u.removeChild(x),x=A}}else u==="body"&&nc(s.ownerDocument.body);u=v}while(u);Ro(l)}function $y(s,l){var u=s;s=0;do{var d=u.nextSibling;if(u.nodeType===1?l?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(l?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),d&&d.nodeType===8)if(u=d.data,u==="/$"){if(s===0)break;s--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||s++;u=d}while(u)}function rp(s){var l=s.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var u=l;switch(l=l.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":rp(u),_e(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}s.removeChild(u)}}function kT(s,l,u,d){for(;s.nodeType===1;){var v=u;if(s.nodeName.toLowerCase()!==l.toLowerCase()){if(!d&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(d){if(!s[le])switch(l){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(x=s.getAttribute("rel"),x==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(x!==v.rel||s.getAttribute("href")!==(v.href==null||v.href===""?null:v.href)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin)||s.getAttribute("title")!==(v.title==null?null:v.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(x=s.getAttribute("src"),(x!==(v.src==null?null:v.src)||s.getAttribute("type")!==(v.type==null?null:v.type)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin))&&x&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(l==="input"&&s.type==="hidden"){var x=v.name==null?null:""+v.name;if(v.type==="hidden"&&s.getAttribute("name")===x)return s}else return s;if(s=zi(s.nextSibling),s===null)break}return null}function DT(s,l,u){if(l==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!u||(s=zi(s.nextSibling),s===null))return null;return s}function Gy(s,l){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=zi(s.nextSibling),s===null))return null;return s}function sp(s){return s.data==="$?"||s.data==="$~"}function ap(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function NT(s,l){var u=s.ownerDocument;if(s.data==="$~")s._reactRetry=l;else if(s.data!=="$?"||u.readyState!=="loading")l();else{var d=function(){l(),u.removeEventListener("DOMContentLoaded",d)};u.addEventListener("DOMContentLoaded",d),s._reactRetry=d}}function zi(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return s}var op=null;function Vy(s){s=s.nextSibling;for(var l=0;s;){if(s.nodeType===8){var u=s.data;if(u==="/$"||u==="/&"){if(l===0)return zi(s.nextSibling);l--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||l++}s=s.nextSibling}return null}function qy(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(l===0)return s;l--}else u!=="/$"&&u!=="/&"||l++}s=s.previousSibling}return null}function Wy(s,l,u){switch(l=Ah(u),s){case"html":if(s=l.documentElement,!s)throw Error(i(452));return s;case"head":if(s=l.head,!s)throw Error(i(453));return s;case"body":if(s=l.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function nc(s){for(var l=s.attributes;l.length;)s.removeAttributeNode(l[0]);_e(s)}var $i=new Map,Xy=new Set;function Th(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Yr=ae.d;ae.d={f:MT,r:LT,D:FT,C:IT,L:PT,m:BT,X:jT,S:UT,M:HT};function MT(){var s=Yr.f(),l=vh();return s||l}function LT(s){var l=De(s);l!==null&&l.tag===5&&l.type==="form"?h1(l):Yr.r(s)}var Ao=typeof document>"u"?null:document;function Yy(s,l,u){var d=Ao;if(d&&typeof l=="string"&&l){var v=Fi(l);v='link[rel="'+s+'"][href="'+v+'"]',typeof u=="string"&&(v+='[crossorigin="'+u+'"]'),Xy.has(v)||(Xy.add(v),s={rel:s,crossOrigin:u,href:l},d.querySelector(v)===null&&(l=d.createElement("link"),Cn(l,"link",s),Ie(l),d.head.appendChild(l)))}}function FT(s){Yr.D(s),Yy("dns-prefetch",s,null)}function IT(s,l){Yr.C(s,l),Yy("preconnect",s,l)}function PT(s,l,u){Yr.L(s,l,u);var d=Ao;if(d&&s&&l){var v='link[rel="preload"][as="'+Fi(l)+'"]';l==="image"&&u&&u.imageSrcSet?(v+='[imagesrcset="'+Fi(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(v+='[imagesizes="'+Fi(u.imageSizes)+'"]')):v+='[href="'+Fi(s)+'"]';var x=v;switch(l){case"style":x=To(s);break;case"script":x=Co(s)}$i.has(x)||(s=g({rel:"preload",href:l==="image"&&u&&u.imageSrcSet?void 0:s,as:l},u),$i.set(x,s),d.querySelector(v)!==null||l==="style"&&d.querySelector(ic(x))||l==="script"&&d.querySelector(rc(x))||(l=d.createElement("link"),Cn(l,"link",s),Ie(l),d.head.appendChild(l)))}}function BT(s,l){Yr.m(s,l);var u=Ao;if(u&&s){var d=l&&typeof l.as=="string"?l.as:"script",v='link[rel="modulepreload"][as="'+Fi(d)+'"][href="'+Fi(s)+'"]',x=v;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=Co(s)}if(!$i.has(x)&&(s=g({rel:"modulepreload",href:s},l),$i.set(x,s),u.querySelector(v)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(rc(x)))return}d=u.createElement("link"),Cn(d,"link",s),Ie(d),u.head.appendChild(d)}}}function UT(s,l,u){Yr.S(s,l,u);var d=Ao;if(d&&s){var v=Oe(d).hoistableStyles,x=To(s);l=l||"default";var A=v.get(x);if(!A){var D={loading:0,preload:null};if(A=d.querySelector(ic(x)))D.loading=5;else{s=g({rel:"stylesheet",href:s,"data-precedence":l},u),(u=$i.get(x))&&lp(s,u);var X=A=d.createElement("link");Ie(X),Cn(X,"link",s),X._p=new Promise(function(te,fe){X.onload=te,X.onerror=fe}),X.addEventListener("load",function(){D.loading|=1}),X.addEventListener("error",function(){D.loading|=2}),D.loading|=4,Ch(A,l,d)}A={type:"stylesheet",instance:A,count:1,state:D},v.set(x,A)}}}function jT(s,l){Yr.X(s,l);var u=Ao;if(u&&s){var d=Oe(u).hoistableScripts,v=Co(s),x=d.get(v);x||(x=u.querySelector(rc(v)),x||(s=g({src:s,async:!0},l),(l=$i.get(v))&&cp(s,l),x=u.createElement("script"),Ie(x),Cn(x,"link",s),u.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},d.set(v,x))}}function HT(s,l){Yr.M(s,l);var u=Ao;if(u&&s){var d=Oe(u).hoistableScripts,v=Co(s),x=d.get(v);x||(x=u.querySelector(rc(v)),x||(s=g({src:s,async:!0,type:"module"},l),(l=$i.get(v))&&cp(s,l),x=u.createElement("script"),Ie(x),Cn(x,"link",s),u.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},d.set(v,x))}}function Ky(s,l,u,d){var v=(v=oe.current)?Th(v):null;if(!v)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(l=To(u.href),u=Oe(v).hoistableStyles,d=u.get(l),d||(d={type:"style",instance:null,count:0,state:null},u.set(l,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){s=To(u.href);var x=Oe(v).hoistableStyles,A=x.get(s);if(A||(v=v.ownerDocument||v,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(s,A),(x=v.querySelector(ic(s)))&&!x._p&&(A.instance=x,A.state.loading=5),$i.has(s)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},$i.set(s,u),x||zT(v,s,u,A.state))),l&&d===null)throw Error(i(528,""));return A}if(l&&d!==null)throw Error(i(529,""));return null;case"script":return l=u.async,u=u.src,typeof u=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=Co(u),u=Oe(v).hoistableScripts,d=u.get(l),d||(d={type:"script",instance:null,count:0,state:null},u.set(l,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function To(s){return'href="'+Fi(s)+'"'}function ic(s){return'link[rel="stylesheet"]['+s+"]"}function Jy(s){return g({},s,{"data-precedence":s.precedence,precedence:null})}function zT(s,l,u,d){s.querySelector('link[rel="preload"][as="style"]['+l+"]")?d.loading=1:(l=s.createElement("link"),d.preload=l,l.addEventListener("load",function(){return d.loading|=1}),l.addEventListener("error",function(){return d.loading|=2}),Cn(l,"link",u),Ie(l),s.head.appendChild(l))}function Co(s){return'[src="'+Fi(s)+'"]'}function rc(s){return"script[async]"+s}function Qy(s,l,u){if(l.count++,l.instance===null)switch(l.type){case"style":var d=s.querySelector('style[data-href~="'+Fi(u.href)+'"]');if(d)return l.instance=d,Ie(d),d;var v=g({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return d=(s.ownerDocument||s).createElement("style"),Ie(d),Cn(d,"style",v),Ch(d,u.precedence,s),l.instance=d;case"stylesheet":v=To(u.href);var x=s.querySelector(ic(v));if(x)return l.state.loading|=4,l.instance=x,Ie(x),x;d=Jy(u),(v=$i.get(v))&&lp(d,v),x=(s.ownerDocument||s).createElement("link"),Ie(x);var A=x;return A._p=new Promise(function(D,X){A.onload=D,A.onerror=X}),Cn(x,"link",d),l.state.loading|=4,Ch(x,u.precedence,s),l.instance=x;case"script":return x=Co(u.src),(v=s.querySelector(rc(x)))?(l.instance=v,Ie(v),v):(d=u,(v=$i.get(x))&&(d=g({},u),cp(d,v)),s=s.ownerDocument||s,v=s.createElement("script"),Ie(v),Cn(v,"link",d),s.head.appendChild(v),l.instance=v);case"void":return null;default:throw Error(i(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(d=l.instance,l.state.loading|=4,Ch(d,u.precedence,s));return l.instance}function Ch(s,l,u){for(var d=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),v=d.length?d[d.length-1]:null,x=v,A=0;A<d.length;A++){var D=d[A];if(D.dataset.precedence===l)x=D;else if(x!==v)break}x?x.parentNode.insertBefore(s,x.nextSibling):(l=u.nodeType===9?u.head:u,l.insertBefore(s,l.firstChild))}function lp(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.title==null&&(s.title=l.title)}function cp(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.integrity==null&&(s.integrity=l.integrity)}var Rh=null;function Zy(s,l,u){if(Rh===null){var d=new Map,v=Rh=new Map;v.set(u,d)}else v=Rh,d=v.get(u),d||(d=new Map,v.set(u,d));if(d.has(s))return d;for(d.set(s,null),u=u.getElementsByTagName(s),v=0;v<u.length;v++){var x=u[v];if(!(x[le]||x[I]||s==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var A=x.getAttribute(l)||"";A=s+A;var D=d.get(A);D?D.push(x):d.set(A,[x])}}return d}function e_(s,l,u){s=s.ownerDocument||s,s.head.insertBefore(u,l==="title"?s.querySelector("head > title"):null)}function $T(s,l,u){if(u===1||l.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;return l.rel==="stylesheet"?(s=l.disabled,typeof l.precedence=="string"&&s==null):!0;case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function t_(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function GT(s,l,u,d){if(u.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var v=To(d.href),x=l.querySelector(ic(v));if(x){l=x._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(s.count++,s=Oh.bind(s),l.then(s,s)),u.state.loading|=4,u.instance=x,Ie(x);return}x=l.ownerDocument||l,d=Jy(d),(v=$i.get(v))&&lp(d,v),x=x.createElement("link"),Ie(x);var A=x;A._p=new Promise(function(D,X){A.onload=D,A.onerror=X}),Cn(x,"link",d),u.instance=x}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(u,l),(l=u.state.preload)&&(u.state.loading&3)===0&&(s.count++,u=Oh.bind(s),l.addEventListener("load",u),l.addEventListener("error",u))}}var up=0;function VT(s,l){return s.stylesheets&&s.count===0&&Dh(s,s.stylesheets),0<s.count||0<s.imgCount?function(u){var d=setTimeout(function(){if(s.stylesheets&&Dh(s,s.stylesheets),s.unsuspend){var x=s.unsuspend;s.unsuspend=null,x()}},6e4+l);0<s.imgBytes&&up===0&&(up=62500*AT());var v=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Dh(s,s.stylesheets),s.unsuspend)){var x=s.unsuspend;s.unsuspend=null,x()}},(s.imgBytes>up?50:800)+l);return s.unsuspend=u,function(){s.unsuspend=null,clearTimeout(d),clearTimeout(v)}}:null}function Oh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Dh(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var kh=null;function Dh(s,l){s.stylesheets=null,s.unsuspend!==null&&(s.count++,kh=new Map,l.forEach(qT,s),kh=null,Oh.call(s))}function qT(s,l){if(!(l.state.loading&4)){var u=kh.get(s);if(u)var d=u.get(null);else{u=new Map,kh.set(s,u);for(var v=s.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<v.length;x++){var A=v[x];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(u.set(A.dataset.precedence,A),d=A)}d&&u.set(null,d)}v=l.instance,A=v.getAttribute("data-precedence"),x=u.get(A)||d,x===d&&u.set(null,v),u.set(A,v),this.count++,d=Oh.bind(this),v.addEventListener("load",d),v.addEventListener("error",d),x?x.parentNode.insertBefore(v,x.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(v,s.firstChild)),l.state.loading|=4}}var sc={$$typeof:S,Provider:null,Consumer:null,_currentValue:we,_currentValue2:we,_threadCount:0};function WT(s,l,u,d,v,x,A,D,X){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=yl(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yl(0),this.hiddenUpdates=yl(null),this.identifierPrefix=d,this.onUncaughtError=v,this.onCaughtError=x,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=X,this.incompleteTransitions=new Map}function n_(s,l,u,d,v,x,A,D,X,te,fe,ge){return s=new WT(s,l,u,A,X,te,fe,ge,D),l=1,x===!0&&(l|=24),x=pi(3,null,null,l),s.current=x,x.stateNode=s,l=$d(),l.refCount++,s.pooledCache=l,l.refCount++,x.memoizedState={element:d,isDehydrated:u,cache:l},Wd(x),s}function i_(s){return s?(s=io,s):io}function r_(s,l,u,d,v,x){v=i_(v),d.context===null?d.context=v:d.pendingContext=v,d=vs(l),d.payload={element:u},x=x===void 0?null:x,x!==null&&(d.callback=x),u=ys(s,d,l),u!==null&&(ri(u,s,l),Pl(u,s,l))}function s_(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<l?u:l}}function hp(s,l){s_(s,l),(s=s.alternate)&&s_(s,l)}function a_(s){if(s.tag===13||s.tag===31){var l=ia(s,67108864);l!==null&&ri(l,s,67108864),hp(s,67108864)}}function o_(s){if(s.tag===13||s.tag===31){var l=_i();l=_l(l);var u=ia(s,l);u!==null&&ri(u,s,l),hp(s,l)}}var Nh=!0;function XT(s,l,u,d){var v=J.T;J.T=null;var x=ae.p;try{ae.p=2,fp(s,l,u,d)}finally{ae.p=x,J.T=v}}function YT(s,l,u,d){var v=J.T;J.T=null;var x=ae.p;try{ae.p=8,fp(s,l,u,d)}finally{ae.p=x,J.T=v}}function fp(s,l,u,d){if(Nh){var v=dp(d);if(v===null)Q0(s,l,d,Mh,u),c_(s,d);else if(JT(v,s,l,u,d))d.stopPropagation();else if(c_(s,d),l&4&&-1<KT.indexOf(s)){for(;v!==null;){var x=De(v);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var A=Ni(x.pendingLanes);if(A!==0){var D=x;for(D.pendingLanes|=2,D.entangledLanes|=2;A;){var X=1<<31-Gn(A);D.entanglements[1]|=X,A&=~X}_r(x),(ft&6)===0&&(gh=Pt()+500,Zl(0))}}break;case 31:case 13:D=ia(x,2),D!==null&&ri(D,x,2),vh(),hp(x,2)}if(x=dp(d),x===null&&Q0(s,l,d,Mh,u),x===v)break;v=x}v!==null&&d.stopPropagation()}else Q0(s,l,d,null,u)}}function dp(s){return s=gd(s),pp(s)}var Mh=null;function pp(s){if(Mh=null,s=Ee(s),s!==null){var l=a(s);if(l===null)s=null;else{var u=l.tag;if(u===13){if(s=o(l),s!==null)return s;s=null}else if(u===31){if(s=c(l),s!==null)return s;s=null}else if(u===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null)}}return Mh=s,null}function l_(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(za()){case $a:return 2;case Ga:return 8;case Di:case ad:return 32;case vl:return 268435456;default:return 32}default:return 32}}var gp=!1,Os=null,ks=null,Ds=null,ac=new Map,oc=new Map,Ns=[],KT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function c_(s,l){switch(s){case"focusin":case"focusout":Os=null;break;case"dragenter":case"dragleave":ks=null;break;case"mouseover":case"mouseout":Ds=null;break;case"pointerover":case"pointerout":ac.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":oc.delete(l.pointerId)}}function lc(s,l,u,d,v,x){return s===null||s.nativeEvent!==x?(s={blockedOn:l,domEventName:u,eventSystemFlags:d,nativeEvent:x,targetContainers:[v]},l!==null&&(l=De(l),l!==null&&a_(l)),s):(s.eventSystemFlags|=d,l=s.targetContainers,v!==null&&l.indexOf(v)===-1&&l.push(v),s)}function JT(s,l,u,d,v){switch(l){case"focusin":return Os=lc(Os,s,l,u,d,v),!0;case"dragenter":return ks=lc(ks,s,l,u,d,v),!0;case"mouseover":return Ds=lc(Ds,s,l,u,d,v),!0;case"pointerover":var x=v.pointerId;return ac.set(x,lc(ac.get(x)||null,s,l,u,d,v)),!0;case"gotpointercapture":return x=v.pointerId,oc.set(x,lc(oc.get(x)||null,s,l,u,d,v)),!0}return!1}function u_(s){var l=Ee(s.target);if(l!==null){var u=a(l);if(u!==null){if(l=u.tag,l===13){if(l=o(u),l!==null){s.blockedOn=l,U(s.priority,function(){o_(u)});return}}else if(l===31){if(l=c(u),l!==null){s.blockedOn=l,U(s.priority,function(){o_(u)});return}}else if(l===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Lh(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var u=dp(s.nativeEvent);if(u===null){u=s.nativeEvent;var d=new u.constructor(u.type,u);pd=d,u.target.dispatchEvent(d),pd=null}else return l=De(u),l!==null&&a_(l),s.blockedOn=u,!1;l.shift()}return!0}function h_(s,l,u){Lh(s)&&u.delete(l)}function QT(){gp=!1,Os!==null&&Lh(Os)&&(Os=null),ks!==null&&Lh(ks)&&(ks=null),Ds!==null&&Lh(Ds)&&(Ds=null),ac.forEach(h_),oc.forEach(h_)}function Fh(s,l){s.blockedOn===l&&(s.blockedOn=null,gp||(gp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,QT)))}var Ih=null;function f_(s){Ih!==s&&(Ih=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Ih===s&&(Ih=null);for(var l=0;l<s.length;l+=3){var u=s[l],d=s[l+1],v=s[l+2];if(typeof d!="function"){if(pp(d||u)===null)continue;break}var x=De(u);x!==null&&(s.splice(l,3),l-=3,d0(x,{pending:!0,data:v,method:u.method,action:d},d,v))}}))}function Ro(s){function l(X){return Fh(X,s)}Os!==null&&Fh(Os,s),ks!==null&&Fh(ks,s),Ds!==null&&Fh(Ds,s),ac.forEach(l),oc.forEach(l);for(var u=0;u<Ns.length;u++){var d=Ns[u];d.blockedOn===s&&(d.blockedOn=null)}for(;0<Ns.length&&(u=Ns[0],u.blockedOn===null);)u_(u),u.blockedOn===null&&Ns.shift();if(u=(s.ownerDocument||s).$$reactFormReplay,u!=null)for(d=0;d<u.length;d+=3){var v=u[d],x=u[d+1],A=v[B]||null;if(typeof x=="function")A||f_(u);else if(A){var D=null;if(x&&x.hasAttribute("formAction")){if(v=x,A=x[B]||null)D=A.formAction;else if(pp(v)!==null)continue}else D=A.action;typeof D=="function"?u[d+1]=D:(u.splice(d,3),d-=3),f_(u)}}}function d_(){function s(x){x.canIntercept&&x.info==="react-transition"&&x.intercept({handler:function(){return new Promise(function(A){return v=A})},focusReset:"manual",scroll:"manual"})}function l(){v!==null&&(v(),v=null),d||setTimeout(u,20)}function u(){if(!d&&!navigation.transition){var x=navigation.currentEntry;x&&x.url!=null&&navigation.navigate(x.url,{state:x.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var d=!1,v=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(u,100),function(){d=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),v!==null&&(v(),v=null)}}}function mp(s){this._internalRoot=s}Ph.prototype.render=mp.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(i(409));var u=l.current,d=_i();r_(u,d,s,l,null,null)},Ph.prototype.unmount=mp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;r_(s.current,2,null,s,null,null),vh(),l[j]=null}};function Ph(s){this._internalRoot=s}Ph.prototype.unstable_scheduleHydration=function(s){if(s){var l=R();s={blockedOn:null,target:s,priority:l};for(var u=0;u<Ns.length&&l!==0&&l<Ns[u].priority;u++);Ns.splice(u,0,s),u===0&&u_(s)}};var p_=e.version;if(p_!=="19.2.3")throw Error(i(527,p_,"19.2.3"));ae.findDOMNode=function(s){var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=f(l),s=s!==null?p(s):null,s=s===null?null:s.stateNode,s};var ZT={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:J,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bh.isDisabled&&Bh.supportsFiber)try{cs=Bh.inject(ZT),Bn=Bh}catch{}}return uc.createRoot=function(s,l){if(!r(s))throw Error(i(299));var u=!1,d="",v=w1,x=b1,A=E1;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(d=l.identifierPrefix),l.onUncaughtError!==void 0&&(v=l.onUncaughtError),l.onCaughtError!==void 0&&(x=l.onCaughtError),l.onRecoverableError!==void 0&&(A=l.onRecoverableError)),l=n_(s,1,!1,null,null,u,d,null,v,x,A,d_),s[j]=l.current,J0(s),new mp(l)},uc.hydrateRoot=function(s,l,u){if(!r(s))throw Error(i(299));var d=!1,v="",x=w1,A=b1,D=E1,X=null;return u!=null&&(u.unstable_strictMode===!0&&(d=!0),u.identifierPrefix!==void 0&&(v=u.identifierPrefix),u.onUncaughtError!==void 0&&(x=u.onUncaughtError),u.onCaughtError!==void 0&&(A=u.onCaughtError),u.onRecoverableError!==void 0&&(D=u.onRecoverableError),u.formState!==void 0&&(X=u.formState)),l=n_(s,1,!0,l,u??null,d,v,X,x,A,D,d_),l.context=i_(null),u=l.current,d=_i(),d=_l(d),v=vs(d),v.callback=null,ys(u,v,d),u=d,l.current.lanes=u,Qs(l,u),_r(l),s[j]=l.current,J0(s),new Ph(l)},uc.version="19.2.3",uc}var T_;function c2(){if(T_)return xp.exports;T_=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),xp.exports=l2(),xp.exports}var u2=c2();var C_="popstate";function h2(n={}){function e(i,r){let{pathname:a,search:o,hash:c}=i.location;return tg("",{pathname:a,search:o,hash:c},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function t(i,r){return typeof r=="string"?r:Mc(r)}return d2(e,t,null,n)}function Gt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function fr(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function f2(){return Math.random().toString(36).substring(2,10)}function R_(n,e){return{usr:n.state,key:n.key,idx:e}}function tg(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?ul(e):e,state:t,key:e&&e.key||i||f2()}}function Mc({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function ul(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function d2(n,e,t,i={}){let{window:r=document.defaultView,v5Compat:a=!1}=i,o=r.history,c="POP",h=null,f=p();f==null&&(f=0,o.replaceState({...o.state,idx:f},""));function p(){return(o.state||{idx:null}).idx}function g(){c="POP";let b=p(),E=b==null?null:b-f;f=b,h&&h({action:c,location:_.location,delta:E})}function m(b,E){c="PUSH";let T=tg(_.location,b,E);f=p()+1;let S=R_(T,f),k=_.createHref(T);try{o.pushState(S,"",k)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;r.location.assign(k)}a&&h&&h({action:c,location:_.location,delta:1})}function y(b,E){c="REPLACE";let T=tg(_.location,b,E);f=p();let S=R_(T,f),k=_.createHref(T);o.replaceState(S,"",k),a&&h&&h({action:c,location:_.location,delta:0})}function w(b){return p2(b)}let _={get action(){return c},get location(){return n(r,o)},listen(b){if(h)throw new Error("A history only accepts one active listener");return r.addEventListener(C_,g),h=b,()=>{r.removeEventListener(C_,g),h=null}},createHref(b){return e(r,b)},createURL:w,encodeLocation(b){let E=w(b);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:m,replace:y,go(b){return o.go(b)}};return _}function p2(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Gt(t,"No window.location.(origin|href) available to create URL");let i=typeof n=="string"?n:Mc(n);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function Hw(n,e,t="/"){return g2(n,e,t,!1)}function g2(n,e,t,i){let r=typeof e=="string"?ul(e):e,a=rs(r.pathname||"/",t);if(a==null)return null;let o=zw(n);m2(o);let c=null;for(let h=0;c==null&&h<o.length;++h){let f=C2(a);c=A2(o[h],f,i)}return c}function zw(n,e=[],t=[],i="",r=!1){let a=(o,c,h=r,f)=>{let p={relativePath:f===void 0?o.path||"":f,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(i)&&h)return;Gt(p.relativePath.startsWith(i),`Absolute route path "${p.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(i.length)}let g=es([i,p.relativePath]),m=t.concat(p);o.children&&o.children.length>0&&(Gt(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${g}".`),zw(o.children,e,m,g,h)),!(o.path==null&&!o.index)&&e.push({path:g,score:E2(g,o.index),routesMeta:m})};return n.forEach((o,c)=>{if(o.path===""||!o.path?.includes("?"))a(o,c);else for(let h of $w(o.path))a(o,c,!0,h)}),e}function $w(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,r=t.endsWith("?"),a=t.replace(/\?$/,"");if(i.length===0)return r?[a,""]:[a];let o=$w(i.join("/")),c=[];return c.push(...o.map(h=>h===""?a:[a,h].join("/"))),r&&c.push(...o),c.map(h=>n.startsWith("/")&&h===""?"/":h)}function m2(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:S2(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var v2=/^:[\w-]+$/,y2=3,_2=2,x2=1,w2=10,b2=-2,O_=n=>n==="*";function E2(n,e){let t=n.split("/"),i=t.length;return t.some(O_)&&(i+=b2),e&&(i+=_2),t.filter(r=>!O_(r)).reduce((r,a)=>r+(v2.test(a)?y2:a===""?x2:w2),i)}function S2(n,e){return n.length===e.length&&n.slice(0,-1).every((i,r)=>i===e[r])?n[n.length-1]-e[e.length-1]:0}function A2(n,e,t=!1){let{routesMeta:i}=n,r={},a="/",o=[];for(let c=0;c<i.length;++c){let h=i[c],f=c===i.length-1,p=a==="/"?e:e.slice(a.length)||"/",g=gf({path:h.relativePath,caseSensitive:h.caseSensitive,end:f},p),m=h.route;if(!g&&f&&t&&!i[i.length-1].route.index&&(g=gf({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},p)),!g)return null;Object.assign(r,g.params),o.push({params:r,pathname:es([a,g.pathname]),pathnameBase:D2(es([a,g.pathnameBase])),route:m}),g.pathnameBase!=="/"&&(a=es([a,g.pathnameBase]))}return o}function gf(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=T2(n.path,n.caseSensitive,n.end),r=e.match(t);if(!r)return null;let a=r[0],o=a.replace(/(.)\/+$/,"$1"),c=r.slice(1);return{params:i.reduce((f,{paramName:p,isOptional:g},m)=>{if(p==="*"){let w=c[m]||"";o=a.slice(0,a.length-w.length).replace(/(.)\/+$/,"$1")}const y=c[m];return g&&!y?f[p]=void 0:f[p]=(y||"").replace(/%2F/g,"/"),f},{}),pathname:a,pathnameBase:o,pattern:n}}function T2(n,e=!1,t=!0){fr(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],r="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,h)=>(i.push({paramName:c,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(i.push({paramName:"*"}),r+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":n!==""&&n!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),i]}function C2(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return fr(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function rs(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}var Gw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,R2=n=>Gw.test(n);function O2(n,e="/"){let{pathname:t,search:i="",hash:r=""}=typeof n=="string"?ul(n):n,a;if(t)if(R2(t))a=t;else{if(t.includes("//")){let o=t;t=t.replace(/\/\/+/g,"/"),fr(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${t}`)}t.startsWith("/")?a=k_(t.substring(1),"/"):a=k_(t,e)}else a=e;return{pathname:a,search:N2(i),hash:M2(r)}}function k_(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function Sp(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function k2(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Vw(n){let e=k2(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function qw(n,e,t,i=!1){let r;typeof n=="string"?r=ul(n):(r={...n},Gt(!r.pathname||!r.pathname.includes("?"),Sp("?","pathname","search",r)),Gt(!r.pathname||!r.pathname.includes("#"),Sp("#","pathname","hash",r)),Gt(!r.search||!r.search.includes("#"),Sp("#","search","hash",r)));let a=n===""||r.pathname==="",o=a?"/":r.pathname,c;if(o==null)c=t;else{let g=e.length-1;if(!i&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),g-=1;r.pathname=m.join("/")}c=g>=0?e[g]:"/"}let h=O2(r,c),f=o&&o!=="/"&&o.endsWith("/"),p=(a||o===".")&&t.endsWith("/");return!h.pathname.endsWith("/")&&(f||p)&&(h.pathname+="/"),h}var es=n=>n.join("/").replace(/\/\/+/g,"/"),D2=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),N2=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,M2=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,L2=class{constructor(n,e,t,i=!1){this.status=n,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function F2(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function I2(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var Ww=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Xw(n,e){let t=n;if(typeof t!="string"||!Gw.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,r=!1;if(Ww)try{let a=new URL(window.location.href),o=t.startsWith("//")?new URL(a.protocol+t):new URL(t),c=rs(o.pathname,e);o.origin===a.origin&&c!=null?t=c+o.search+o.hash:r=!0}catch{fr(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:r,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Yw=["POST","PUT","PATCH","DELETE"];new Set(Yw);var P2=["GET",...Yw];new Set(P2);var hl=Z.createContext(null);hl.displayName="DataRouter";var Uf=Z.createContext(null);Uf.displayName="DataRouterState";var B2=Z.createContext(!1),Kw=Z.createContext({isTransitioning:!1});Kw.displayName="ViewTransition";var U2=Z.createContext(new Map);U2.displayName="Fetchers";var j2=Z.createContext(null);j2.displayName="Await";var Ki=Z.createContext(null);Ki.displayName="Navigation";var nu=Z.createContext(null);nu.displayName="Location";var Dr=Z.createContext({outlet:null,matches:[],isDataRoute:!1});Dr.displayName="Route";var Fg=Z.createContext(null);Fg.displayName="RouteError";var Jw="REACT_ROUTER_ERROR",H2="REDIRECT",z2="ROUTE_ERROR_RESPONSE";function $2(n){if(n.startsWith(`${Jw}:${H2}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function G2(n){if(n.startsWith(`${Jw}:${z2}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new L2(e.status,e.statusText,e.data)}catch{}}function V2(n,{relative:e}={}){Gt(iu(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=Z.useContext(Ki),{hash:r,pathname:a,search:o}=ru(n,{relative:e}),c=a;return t!=="/"&&(c=a==="/"?t:es([t,a])),i.createHref({pathname:c,search:o,hash:r})}function iu(){return Z.useContext(nu)!=null}function La(){return Gt(iu(),"useLocation() may be used only in the context of a <Router> component."),Z.useContext(nu).location}var Qw="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Zw(n){Z.useContext(Ki).static||Z.useLayoutEffect(n)}function jf(){let{isDataRoute:n}=Z.useContext(Dr);return n?rC():q2()}function q2(){Gt(iu(),"useNavigate() may be used only in the context of a <Router> component.");let n=Z.useContext(hl),{basename:e,navigator:t}=Z.useContext(Ki),{matches:i}=Z.useContext(Dr),{pathname:r}=La(),a=JSON.stringify(Vw(i)),o=Z.useRef(!1);return Zw(()=>{o.current=!0}),Z.useCallback((h,f={})=>{if(fr(o.current,Qw),!o.current)return;if(typeof h=="number"){t.go(h);return}let p=qw(h,JSON.parse(a),r,f.relative==="path");n==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:es([e,p.pathname])),(f.replace?t.replace:t.push)(p,f.state,f)},[e,t,a,r,n])}Z.createContext(null);function eb(){let{matches:n}=Z.useContext(Dr),e=n[n.length-1];return e?e.params:{}}function ru(n,{relative:e}={}){let{matches:t}=Z.useContext(Dr),{pathname:i}=La(),r=JSON.stringify(Vw(t));return Z.useMemo(()=>qw(n,JSON.parse(r),i,e==="path"),[n,r,i,e])}function W2(n,e){return tb(n,e)}function tb(n,e,t,i,r){Gt(iu(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=Z.useContext(Ki),{matches:o}=Z.useContext(Dr),c=o[o.length-1],h=c?c.params:{},f=c?c.pathname:"/",p=c?c.pathnameBase:"/",g=c&&c.route;{let T=g&&g.path||"";ib(f,!g||T.endsWith("*")||T.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${T}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${T}"> to <Route path="${T==="/"?"*":`${T}/*`}">.`)}let m=La(),y;if(e){let T=typeof e=="string"?ul(e):e;Gt(p==="/"||T.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${T.pathname}" was given in the \`location\` prop.`),y=T}else y=m;let w=y.pathname||"/",_=w;if(p!=="/"){let T=p.replace(/^\//,"").split("/");_="/"+w.replace(/^\//,"").split("/").slice(T.length).join("/")}let b=Hw(n,{pathname:_});fr(g||b!=null,`No routes matched location "${y.pathname}${y.search}${y.hash}" `),fr(b==null||b[b.length-1].route.element!==void 0||b[b.length-1].route.Component!==void 0||b[b.length-1].route.lazy!==void 0,`Matched leaf route at location "${y.pathname}${y.search}${y.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=Q2(b&&b.map(T=>Object.assign({},T,{params:Object.assign({},h,T.params),pathname:es([p,a.encodeLocation?a.encodeLocation(T.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?p:es([p,a.encodeLocation?a.encodeLocation(T.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathnameBase])})),o,t,i,r);return e&&E?Z.createElement(nu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...y},navigationType:"POP"}},E):E}function X2(){let n=iC(),e=F2(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:i},a={padding:"2px 4px",backgroundColor:i},o=null;return console.error("Error handled by React Router default ErrorBoundary:",n),o=Z.createElement(Z.Fragment,null,Z.createElement("p",null," Hey developer "),Z.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",Z.createElement("code",{style:a},"ErrorBoundary")," or"," ",Z.createElement("code",{style:a},"errorElement")," prop on your route.")),Z.createElement(Z.Fragment,null,Z.createElement("h2",null,"Unexpected Application Error!"),Z.createElement("h3",{style:{fontStyle:"italic"}},e),t?Z.createElement("pre",{style:r},t):null,o)}var Y2=Z.createElement(X2,null),nb=class extends Z.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=G2(n.digest);t&&(n=t)}let e=n!==void 0?Z.createElement(Dr.Provider,{value:this.props.routeContext},Z.createElement(Fg.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?Z.createElement(K2,{error:n},e):e}};nb.contextType=B2;var Ap=new WeakMap;function K2({children:n,error:e}){let{basename:t}=Z.useContext(Ki);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=$2(e.digest);if(i){let r=Ap.get(e);if(r)throw r;let a=Xw(i.location,t);if(Ww&&!Ap.get(e))if(a.isExternal||i.reloadDocument)window.location.href=a.absoluteURL||a.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(a.to,{replace:i.replace}));throw Ap.set(e,o),o}return Z.createElement("meta",{httpEquiv:"refresh",content:`0;url=${a.absoluteURL||a.to}`})}}return n}function J2({routeContext:n,match:e,children:t}){let i=Z.useContext(hl);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),Z.createElement(Dr.Provider,{value:n},t)}function Q2(n,e=[],t=null,i=null,r=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,o=t?.errors;if(o!=null){let p=a.findIndex(g=>g.route.id&&o?.[g.route.id]!==void 0);Gt(p>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,p+1))}let c=!1,h=-1;if(t)for(let p=0;p<a.length;p++){let g=a[p];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(h=p),g.route.id){let{loaderData:m,errors:y}=t,w=g.route.loader&&!m.hasOwnProperty(g.route.id)&&(!y||y[g.route.id]===void 0);if(g.route.lazy||w){c=!0,h>=0?a=a.slice(0,h+1):a=[a[0]];break}}}let f=t&&i?(p,g)=>{i(p,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:I2(t.matches),errorInfo:g})}:void 0;return a.reduceRight((p,g,m)=>{let y,w=!1,_=null,b=null;t&&(y=o&&g.route.id?o[g.route.id]:void 0,_=g.route.errorElement||Y2,c&&(h<0&&m===0?(ib("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),w=!0,b=null):h===m&&(w=!0,b=g.route.hydrateFallbackElement||null)));let E=e.concat(a.slice(0,m+1)),T=()=>{let S;return y?S=_:w?S=b:g.route.Component?S=Z.createElement(g.route.Component,null):g.route.element?S=g.route.element:S=p,Z.createElement(J2,{match:g,routeContext:{outlet:p,matches:E,isDataRoute:t!=null},children:S})};return t&&(g.route.ErrorBoundary||g.route.errorElement||m===0)?Z.createElement(nb,{location:t.location,revalidation:t.revalidation,component:_,error:y,children:T(),routeContext:{outlet:null,matches:E,isDataRoute:!0},onError:f}):T()},null)}function Ig(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Z2(n){let e=Z.useContext(hl);return Gt(e,Ig(n)),e}function eC(n){let e=Z.useContext(Uf);return Gt(e,Ig(n)),e}function tC(n){let e=Z.useContext(Dr);return Gt(e,Ig(n)),e}function Pg(n){let e=tC(n),t=e.matches[e.matches.length-1];return Gt(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function nC(){return Pg("useRouteId")}function iC(){let n=Z.useContext(Fg),e=eC("useRouteError"),t=Pg("useRouteError");return n!==void 0?n:e.errors?.[t]}function rC(){let{router:n}=Z2("useNavigate"),e=Pg("useNavigate"),t=Z.useRef(!1);return Zw(()=>{t.current=!0}),Z.useCallback(async(r,a={})=>{fr(t.current,Qw),t.current&&(typeof r=="number"?await n.navigate(r):await n.navigate(r,{fromRouteId:e,...a}))},[n,e])}var D_={};function ib(n,e,t){!e&&!D_[n]&&(D_[n]=!0,fr(!1,t))}Z.memo(sC);function sC({routes:n,future:e,state:t,onError:i}){return tb(n,void 0,t,i,e)}function Fs(n){Gt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function aC({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:r,static:a=!1,unstable_useTransitions:o}){Gt(!iu(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=n.replace(/^\/*/,"/"),h=Z.useMemo(()=>({basename:c,navigator:r,static:a,unstable_useTransitions:o,future:{}}),[c,r,a,o]);typeof t=="string"&&(t=ul(t));let{pathname:f="/",search:p="",hash:g="",state:m=null,key:y="default"}=t,w=Z.useMemo(()=>{let _=rs(f,c);return _==null?null:{location:{pathname:_,search:p,hash:g,state:m,key:y},navigationType:i}},[c,f,p,g,m,y,i]);return fr(w!=null,`<Router basename="${c}"> is not able to match the URL "${f}${p}${g}" because it does not start with the basename, so the <Router> won't render anything.`),w==null?null:Z.createElement(Ki.Provider,{value:h},Z.createElement(nu.Provider,{children:e,value:w}))}function oC({children:n,location:e}){return W2(ng(n),e)}function ng(n,e=[]){let t=[];return Z.Children.forEach(n,(i,r)=>{if(!Z.isValidElement(i))return;let a=[...e,r];if(i.type===Z.Fragment){t.push.apply(t,ng(i.props.children,a));return}Gt(i.type===Fs,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Gt(!i.props.index||!i.props.children,"An index route cannot have child routes.");let o={id:i.props.id||a.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(o.children=ng(i.props.children,a)),t.push(o)}),t}var cf="get",uf="application/x-www-form-urlencoded";function Hf(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function lC(n){return Hf(n)&&n.tagName.toLowerCase()==="button"}function cC(n){return Hf(n)&&n.tagName.toLowerCase()==="form"}function uC(n){return Hf(n)&&n.tagName.toLowerCase()==="input"}function hC(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function fC(n,e){return n.button===0&&(!e||e==="_self")&&!hC(n)}var Uh=null;function dC(){if(Uh===null)try{new FormData(document.createElement("form"),0),Uh=!1}catch{Uh=!0}return Uh}var pC=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Tp(n){return n!=null&&!pC.has(n)?(fr(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${uf}"`),null):n}function gC(n,e){let t,i,r,a,o;if(cC(n)){let c=n.getAttribute("action");i=c?rs(c,e):null,t=n.getAttribute("method")||cf,r=Tp(n.getAttribute("enctype"))||uf,a=new FormData(n)}else if(lC(n)||uC(n)&&(n.type==="submit"||n.type==="image")){let c=n.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=n.getAttribute("formaction")||c.getAttribute("action");if(i=h?rs(h,e):null,t=n.getAttribute("formmethod")||c.getAttribute("method")||cf,r=Tp(n.getAttribute("formenctype"))||Tp(c.getAttribute("enctype"))||uf,a=new FormData(c,n),!dC()){let{name:f,type:p,value:g}=n;if(p==="image"){let m=f?`${f}.`:"";a.append(`${m}x`,"0"),a.append(`${m}y`,"0")}else f&&a.append(f,g)}}else{if(Hf(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=cf,i=null,r=uf,o=n}return a&&r==="text/plain"&&(o=a,a=void 0),{action:i,method:t.toLowerCase(),encType:r,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Bg(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function mC(n,e,t,i){let r=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?r.pathname.endsWith("/")?r.pathname=`${r.pathname}_.${i}`:r.pathname=`${r.pathname}.${i}`:r.pathname==="/"?r.pathname=`_root.${i}`:e&&rs(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${i}`,r}async function vC(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function yC(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function _C(n,e,t){let i=await Promise.all(n.map(async r=>{let a=e.routes[r.route.id];if(a){let o=await vC(a,t);return o.links?o.links():[]}return[]}));return EC(i.flat(1).filter(yC).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function N_(n,e,t,i,r,a){let o=(h,f)=>t[f]?h.route.id!==t[f].route.id:!0,c=(h,f)=>t[f].pathname!==h.pathname||t[f].route.path?.endsWith("*")&&t[f].params["*"]!==h.params["*"];return a==="assets"?e.filter((h,f)=>o(h,f)||c(h,f)):a==="data"?e.filter((h,f)=>{let p=i.routes[h.route.id];if(!p||!p.hasLoader)return!1;if(o(h,f)||c(h,f))return!0;if(h.route.shouldRevalidate){let g=h.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof g=="boolean")return g}return!0}):[]}function xC(n,e,{includeHydrateFallback:t}={}){return wC(n.map(i=>{let r=e.routes[i.route.id];if(!r)return[];let a=[r.module];return r.clientActionModule&&(a=a.concat(r.clientActionModule)),r.clientLoaderModule&&(a=a.concat(r.clientLoaderModule)),t&&r.hydrateFallbackModule&&(a=a.concat(r.hydrateFallbackModule)),r.imports&&(a=a.concat(r.imports)),a}).flat(1))}function wC(n){return[...new Set(n)]}function bC(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function EC(n,e){let t=new Set;return new Set(e),n.reduce((i,r)=>{let a=JSON.stringify(bC(r));return t.has(a)||(t.add(a),i.push({key:a,link:r})),i},[])}function rb(){let n=Z.useContext(hl);return Bg(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function SC(){let n=Z.useContext(Uf);return Bg(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Ug=Z.createContext(void 0);Ug.displayName="FrameworkContext";function sb(){let n=Z.useContext(Ug);return Bg(n,"You must render this element inside a <HydratedRouter> element"),n}function AC(n,e){let t=Z.useContext(Ug),[i,r]=Z.useState(!1),[a,o]=Z.useState(!1),{onFocus:c,onBlur:h,onMouseEnter:f,onMouseLeave:p,onTouchStart:g}=e,m=Z.useRef(null);Z.useEffect(()=>{if(n==="render"&&o(!0),n==="viewport"){let _=E=>{E.forEach(T=>{o(T.isIntersecting)})},b=new IntersectionObserver(_,{threshold:.5});return m.current&&b.observe(m.current),()=>{b.disconnect()}}},[n]),Z.useEffect(()=>{if(i){let _=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(_)}}},[i]);let y=()=>{r(!0)},w=()=>{r(!1),o(!1)};return t?n!=="intent"?[a,m,{}]:[a,m,{onFocus:hc(c,y),onBlur:hc(h,w),onMouseEnter:hc(f,y),onMouseLeave:hc(p,w),onTouchStart:hc(g,y)}]:[!1,m,{}]}function hc(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function TC({page:n,...e}){let{router:t}=rb(),i=Z.useMemo(()=>Hw(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?Z.createElement(RC,{page:n,matches:i,...e}):null}function CC(n){let{manifest:e,routeModules:t}=sb(),[i,r]=Z.useState([]);return Z.useEffect(()=>{let a=!1;return _C(n,e,t).then(o=>{a||r(o)}),()=>{a=!0}},[n,e,t]),i}function RC({page:n,matches:e,...t}){let i=La(),{future:r,manifest:a,routeModules:o}=sb(),{basename:c}=rb(),{loaderData:h,matches:f}=SC(),p=Z.useMemo(()=>N_(n,e,f,a,i,"data"),[n,e,f,a,i]),g=Z.useMemo(()=>N_(n,e,f,a,i,"assets"),[n,e,f,a,i]),m=Z.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let _=new Set,b=!1;if(e.forEach(T=>{let S=a.routes[T.route.id];!S||!S.hasLoader||(!p.some(k=>k.route.id===T.route.id)&&T.route.id in h&&o[T.route.id]?.shouldRevalidate||S.hasClientLoader?b=!0:_.add(T.route.id))}),_.size===0)return[];let E=mC(n,c,r.unstable_trailingSlashAwareDataRequests,"data");return b&&_.size>0&&E.searchParams.set("_routes",e.filter(T=>_.has(T.route.id)).map(T=>T.route.id).join(",")),[E.pathname+E.search]},[c,r.unstable_trailingSlashAwareDataRequests,h,i,a,p,e,n,o]),y=Z.useMemo(()=>xC(g,a),[g,a]),w=CC(g);return Z.createElement(Z.Fragment,null,m.map(_=>Z.createElement("link",{key:_,rel:"prefetch",as:"fetch",href:_,...t})),y.map(_=>Z.createElement("link",{key:_,rel:"modulepreload",href:_,...t})),w.map(({key:_,link:b})=>Z.createElement("link",{key:_,nonce:t.nonce,...b})))}function OC(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var kC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{kC&&(window.__reactRouterVersion="7.12.0")}catch{}function DC({basename:n,children:e,unstable_useTransitions:t,window:i}){let r=Z.useRef();r.current==null&&(r.current=h2({window:i,v5Compat:!0}));let a=r.current,[o,c]=Z.useState({action:a.action,location:a.location}),h=Z.useCallback(f=>{t===!1?c(f):Z.startTransition(()=>c(f))},[t]);return Z.useLayoutEffect(()=>a.listen(h),[a,h]),Z.createElement(aC,{basename:n,children:e,location:o.location,navigationType:o.action,navigator:a,unstable_useTransitions:t})}var ab=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,dr=Z.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:r,reloadDocument:a,replace:o,state:c,target:h,to:f,preventScrollReset:p,viewTransition:g,unstable_defaultShouldRevalidate:m,...y},w){let{basename:_,unstable_useTransitions:b}=Z.useContext(Ki),E=typeof f=="string"&&ab.test(f),T=Xw(f,_);f=T.to;let S=V2(f,{relative:r}),[k,P,F]=AC(i,y),O=FC(f,{replace:o,state:c,target:h,preventScrollReset:p,relative:r,viewTransition:g,unstable_defaultShouldRevalidate:m,unstable_useTransitions:b});function G(W){e&&e(W),W.defaultPrevented||O(W)}let M=Z.createElement("a",{...y,...F,href:T.absoluteURL||S,onClick:T.isExternal||a?e:G,ref:OC(w,P),target:h,"data-discover":!E&&t==="render"?"true":void 0});return k&&!E?Z.createElement(Z.Fragment,null,M,Z.createElement(TC,{page:S})):M});dr.displayName="Link";var NC=Z.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:r=!1,style:a,to:o,viewTransition:c,children:h,...f},p){let g=ru(o,{relative:f.relative}),m=La(),y=Z.useContext(Uf),{navigator:w,basename:_}=Z.useContext(Ki),b=y!=null&&jC(g)&&c===!0,E=w.encodeLocation?w.encodeLocation(g).pathname:g.pathname,T=m.pathname,S=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;t||(T=T.toLowerCase(),S=S?S.toLowerCase():null,E=E.toLowerCase()),S&&_&&(S=rs(S,_)||S);const k=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let P=T===E||!r&&T.startsWith(E)&&T.charAt(k)==="/",F=S!=null&&(S===E||!r&&S.startsWith(E)&&S.charAt(E.length)==="/"),O={isActive:P,isPending:F,isTransitioning:b},G=P?e:void 0,M;typeof i=="function"?M=i(O):M=[i,P?"active":null,F?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let W=typeof a=="function"?a(O):a;return Z.createElement(dr,{...f,"aria-current":G,className:M,ref:p,style:W,to:o,viewTransition:c},typeof h=="function"?h(O):h)});NC.displayName="NavLink";var MC=Z.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:r,state:a,method:o=cf,action:c,onSubmit:h,relative:f,preventScrollReset:p,viewTransition:g,unstable_defaultShouldRevalidate:m,...y},w)=>{let{unstable_useTransitions:_}=Z.useContext(Ki),b=BC(),E=UC(c,{relative:f}),T=o.toLowerCase()==="get"?"get":"post",S=typeof c=="string"&&ab.test(c),k=P=>{if(h&&h(P),P.defaultPrevented)return;P.preventDefault();let F=P.nativeEvent.submitter,O=F?.getAttribute("formmethod")||o,G=()=>b(F||P.currentTarget,{fetcherKey:e,method:O,navigate:t,replace:r,state:a,relative:f,preventScrollReset:p,viewTransition:g,unstable_defaultShouldRevalidate:m});_&&t!==!1?Z.startTransition(()=>G()):G()};return Z.createElement("form",{ref:w,method:T,action:E,onSubmit:i?h:k,...y,"data-discover":!S&&n==="render"?"true":void 0})});MC.displayName="Form";function LC(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ob(n){let e=Z.useContext(hl);return Gt(e,LC(n)),e}function FC(n,{target:e,replace:t,state:i,preventScrollReset:r,relative:a,viewTransition:o,unstable_defaultShouldRevalidate:c,unstable_useTransitions:h}={}){let f=jf(),p=La(),g=ru(n,{relative:a});return Z.useCallback(m=>{if(fC(m,e)){m.preventDefault();let y=t!==void 0?t:Mc(p)===Mc(g),w=()=>f(n,{replace:y,state:i,preventScrollReset:r,relative:a,viewTransition:o,unstable_defaultShouldRevalidate:c});h?Z.startTransition(()=>w()):w()}},[p,f,g,t,i,e,n,r,a,o,c,h])}var IC=0,PC=()=>`__${String(++IC)}__`;function BC(){let{router:n}=ob("useSubmit"),{basename:e}=Z.useContext(Ki),t=nC(),i=n.fetch,r=n.navigate;return Z.useCallback(async(a,o={})=>{let{action:c,method:h,encType:f,formData:p,body:g}=gC(a,e);if(o.navigate===!1){let m=o.fetcherKey||PC();await i(m,t,o.action||c,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:p,body:g,formMethod:o.method||h,formEncType:o.encType||f,flushSync:o.flushSync})}else await r(o.action||c,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:p,body:g,formMethod:o.method||h,formEncType:o.encType||f,replace:o.replace,state:o.state,fromRouteId:t,flushSync:o.flushSync,viewTransition:o.viewTransition})},[i,r,e,t])}function UC(n,{relative:e}={}){let{basename:t}=Z.useContext(Ki),i=Z.useContext(Dr);Gt(i,"useFormAction must be used inside a RouteContext");let[r]=i.matches.slice(-1),a={...ru(n||".",{relative:e})},o=La();if(n==null){a.search=o.search;let c=new URLSearchParams(a.search),h=c.getAll("index");if(h.some(p=>p==="")){c.delete("index"),h.filter(g=>g).forEach(g=>c.append("index",g));let p=c.toString();a.search=p?`?${p}`:""}}return(!n||n===".")&&r.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(a.pathname=a.pathname==="/"?t:es([t,a.pathname])),Mc(a)}function jC(n,{relative:e}={}){let t=Z.useContext(Kw);Gt(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=ob("useViewTransitionState"),r=ru(n,{relative:e});if(!t.isTransitioning)return!1;let a=rs(t.currentLocation.pathname,i)||t.currentLocation.pathname,o=rs(t.nextLocation.pathname,i)||t.nextLocation.pathname;return gf(r.pathname,o)!=null||gf(r.pathname,a)!=null}const HC=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),zC=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),M_=n=>{const e=zC(n);return e.charAt(0).toUpperCase()+e.slice(1)},lb=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),$C=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var GC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const VC=Z.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:r="",children:a,iconNode:o,...c},h)=>Z.createElement("svg",{ref:h,...GC,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:lb("lucide",r),...!a&&!$C(c)&&{"aria-hidden":"true"},...c},[...o.map(([f,p])=>Z.createElement(f,p)),...Array.isArray(a)?a:[a]]));const Ot=(n,e)=>{const t=Z.forwardRef(({className:i,...r},a)=>Z.createElement(VC,{ref:a,iconNode:e,className:lb(`lucide-${HC(M_(n))}`,`lucide-${n}`,i),...r}));return t.displayName=M_(n),t};const qC=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],L_=Ot("arrow-left",qC);const WC=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],F_=Ot("book-open",WC);const XC=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],mf=Ot("check",XC);const YC=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],KC=Ot("chevron-left",YC);const JC=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],QC=Ot("chevron-right",JC);const ZC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Lc=Ot("circle-alert",ZC);const eR=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],jg=Ot("clock",eR);const tR=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],I_=Ot("download",tR);const nR=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],iR=Ot("external-link",nR);const rR=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],P_=Ot("eye",rR);const sR=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],aR=Ot("file-text",sR);const oR=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],lR=Ot("graduation-cap",oR);const cR=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],B_=Ot("house",cR);const uR=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],cb=Ot("key",uR);const hR=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],fR=Ot("loader-circle",hR);const dR=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],U_=Ot("log-in",dR);const pR=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],gR=Ot("refresh-cw",pR);const mR=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],vR=Ot("send",mR);const yR=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],_R=Ot("settings",yR);const xR=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],wR=Ot("shield",xR);const bR=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Fc=Ot("triangle-alert",bR);const ER=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],SR=Ot("trophy",ER);const AR=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],j_=Ot("upload",AR);const TR=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],CR=Ot("user",TR);const RR=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ig=Ot("users",RR);const OR=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],kR=Ot("x",OR);const DR=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],NR=Ot("zap",DR);function MR(){return C.jsx("div",{className:"page",children:C.jsxs("div",{className:"container",children:[C.jsxs("section",{className:"text-center mb-6",style:{paddingTop:"3rem"},children:[C.jsxs("h1",{style:{fontSize:"3rem",marginBottom:"1rem"},children:["ng Dng",C.jsx("span",{style:{background:"linear-gradient(135deg, var(--primary), var(--secondary))",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",marginLeft:"0.5rem"},children:"Thi Trc Tuyn"})]}),C.jsx("p",{style:{fontSize:"1.25rem",color:"var(--text-secondary)",maxWidth:"600px",margin:"0 auto 2rem"},children:"Upload PDF  thi, AI t ng to cu hi tng tc. Theo di realtime, chng gian ln, chm im t ng."}),C.jsxs("div",{className:"flex gap-4 justify-center",style:{flexWrap:"wrap"},children:[C.jsxs(dr,{to:"/teacher",className:"btn btn-primary btn-lg",children:[C.jsx(F_,{size:24}),"Gio vin"]}),C.jsxs(dr,{to:"/student",className:"btn btn-secondary btn-lg",children:[C.jsx(ig,{size:24}),"Hc sinh"]})]})]}),C.jsxs("section",{className:"grid grid-2",style:{marginTop:"4rem"},children:[C.jsxs("div",{className:"card",children:[C.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[C.jsx("div",{style:{width:"50px",height:"50px",borderRadius:"var(--radius-lg)",background:"linear-gradient(135deg, var(--primary), var(--primary-dark))",display:"flex",alignItems:"center",justifyContent:"center"},children:C.jsx(NR,{size:24})}),C.jsx("h3",{children:"AI Phn Tch  Thi"})]}),C.jsx("p",{className:"text-muted",children:"Upload PDF, AI t ng nhn din cu hi trc nghim, ng/sai, tr li ngn v to  thi tng tc."})]}),C.jsxs("div",{className:"card",children:[C.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[C.jsx("div",{style:{width:"50px",height:"50px",borderRadius:"var(--radius-lg)",background:"linear-gradient(135deg, var(--secondary), var(--secondary-dark))",display:"flex",alignItems:"center",justifyContent:"center"},children:C.jsx(ig,{size:24})}),C.jsx("h3",{children:"Theo Di Realtime"})]}),C.jsx("p",{className:"text-muted",children:"Xem hc sinh lm bi trc tip. Bit ai ang lm cu no, thi gian cn li, v pht hin hnh vi gian ln."})]}),C.jsxs("div",{className:"card",children:[C.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[C.jsx("div",{style:{width:"50px",height:"50px",borderRadius:"var(--radius-lg)",background:"linear-gradient(135deg, var(--warning), #d97706)",display:"flex",alignItems:"center",justifyContent:"center"},children:C.jsx(wR,{size:24})}),C.jsx("h3",{children:"Chng Gian Ln"})]}),C.jsx("p",{className:"text-muted",children:"Theo di khi hc sinh chuyn tab hoc ri mn hnh. Ghi nhn v cnh bo ngay lp tc."})]}),C.jsxs("div",{className:"card",children:[C.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[C.jsx("div",{style:{width:"50px",height:"50px",borderRadius:"var(--radius-lg)",background:"linear-gradient(135deg, var(--success), #16a34a)",display:"flex",alignItems:"center",justifyContent:"center"},children:C.jsx(F_,{size:24})}),C.jsx("h3",{children:"Chm im T ng"})]}),C.jsx("p",{className:"text-muted",children:"im s c tnh ngay khi hc sinh np bi. Xut bo co Excel d dng."})]})]}),C.jsxs("section",{className:"card",style:{marginTop:"3rem",textAlign:"center"},children:[C.jsx("h3",{className:"mb-4",children:"Bt u nhanh"}),C.jsxs("div",{className:"flex gap-6 justify-center",style:{flexWrap:"wrap"},children:[C.jsxs("div",{children:[C.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"var(--primary)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 0.5rem",fontWeight:"bold"},children:"1"}),C.jsx("p",{className:"text-sm text-muted",children:"Upload PDF  thi"})]}),C.jsxs("div",{children:[C.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"var(--primary)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 0.5rem",fontWeight:"bold"},children:"2"}),C.jsx("p",{className:"text-sm text-muted",children:"Nhn m phng thi"})]}),C.jsxs("div",{children:[C.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"var(--primary)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 0.5rem",fontWeight:"bold"},children:"3"}),C.jsx("p",{className:"text-sm text-muted",children:"Hc sinh vo thi"})]}),C.jsxs("div",{children:[C.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"var(--secondary)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 0.5rem",fontWeight:"bold"},children:"4"}),C.jsx("p",{className:"text-sm text-muted",children:"Xem kt qu realtime"})]})]})]})]})})}const qn=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),rg=[.001,0,0,.001,0,0],Cp=1.35,wi={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Bs={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Ic="pdfjs_internal_editor_",Ye={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},ot={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},LR={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},sg={TRIANGLES:1,LATTICE:2},pn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},hf={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},cn={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},jo={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},zf={ERRORS:0,WARNINGS:1,INFOS:5},Pc={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},fc={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},FR={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let $f=zf.WARNINGS;function IR(n){Number.isInteger(n)&&($f=n)}function PR(){return $f}function Gf(n){$f>=zf.INFOS&&console.info(`Info: ${n}`)}function We(n){$f>=zf.WARNINGS&&console.warn(`Warning: ${n}`)}function Rt(n){throw new Error(n)}function lt(n,e){n||Rt(e)}function BR(n){switch(n?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function ub(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"&&(t.addDefaultProtocol&&n.startsWith("www.")&&n.match(/\./g)?.length>=2&&(n=`http://${n}`),t.tryConvertEncoding))try{n=$R(n)}catch{}const i=e?URL.parse(n,e):URL.parse(n);return BR(i)?i:null}function hb(n,e,t=!1){const i=URL.parse(n);return i?(i.hash=e,i.href):t&&ub(n,"http://example.com")?n.split("#",1)[0]+`${e?`#${e}`:""}`:""}function Xe(n,e,t,i=!1){return Object.defineProperty(n,e,{value:t,enumerable:!i,configurable:!0,writable:!1}),t}const Fa=(function(){function e(t,i){this.message=t,this.name=i}return e.prototype=new Error,e.constructor=e,e})();class H_ extends Fa{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Rp extends Fa{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class ag extends Fa{constructor(e){super(e,"InvalidPDFException")}}class vf extends Fa{constructor(e,t,i){super(e,"ResponseException"),this.status=t,this.missing=i}}class UR extends Fa{constructor(e){super(e,"FormatError")}}class Gs extends Fa{constructor(e){super(e,"AbortException")}}function fb(n){(typeof n!="object"||n?.length===void 0)&&Rt("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const i=[];for(let r=0;r<e;r+=t){const a=Math.min(r+t,e),o=n.subarray(r,a);i.push(String.fromCharCode.apply(null,o))}return i.join("")}function su(n){typeof n!="string"&&Rt("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let i=0;i<e;++i)t[i]=n.charCodeAt(i)&255;return t}function jR(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function HR(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function zR(){try{return new Function(""),!0}catch{return!1}}class vn{static get isLittleEndian(){return Xe(this,"isLittleEndian",HR())}static get isEvalSupported(){return Xe(this,"isEvalSupported",zR())}static get isOffscreenCanvasSupported(){return Xe(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Xe(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return Xe(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return Xe(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return Xe(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){return Xe(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Op=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));class Ne{static makeHexColor(e,t,i){return`#${Op[e]}${Op[t]}${Op[i]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let i;e[0]?(e[0]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[3],t[3]*=e[3]):(i=t[0],t[0]=t[1],t[1]=i,i=t[2],t[2]=t[3],t[3]=i,e[1]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,i=0){const r=e[i],a=e[i+1];e[i]=r*t[0]+a*t[2]+t[4],e[i+1]=r*t[1]+a*t[3]+t[5]}static applyTransformToBezier(e,t,i=0){const r=t[0],a=t[1],o=t[2],c=t[3],h=t[4],f=t[5];for(let p=0;p<6;p+=2){const g=e[i+p],m=e[i+p+1];e[i+p]=g*r+m*o+h,e[i+p+1]=g*a+m*c+f}}static applyInverseTransform(e,t){const i=e[0],r=e[1],a=t[0]*t[3]-t[1]*t[2];e[0]=(i*t[3]-r*t[2]+t[2]*t[5]-t[4]*t[3])/a,e[1]=(-i*t[1]+r*t[0]+t[4]*t[1]-t[5]*t[0])/a}static axialAlignedBoundingBox(e,t,i){const r=t[0],a=t[1],o=t[2],c=t[3],h=t[4],f=t[5],p=e[0],g=e[1],m=e[2],y=e[3];let w=r*p+h,_=w,b=r*m+h,E=b,T=c*g+f,S=T,k=c*y+f,P=k;if(a!==0||o!==0){const F=a*p,O=a*m,G=o*g,M=o*y;w+=G,E+=G,b+=M,_+=M,T+=F,P+=F,k+=O,S+=O}i[0]=Math.min(i[0],w,b,_,E),i[1]=Math.min(i[1],T,k,S,P),i[2]=Math.max(i[2],w,b,_,E),i[3]=Math.max(i[3],T,k,S,P)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const i=e[0],r=e[1],a=e[2],o=e[3],c=i**2+r**2,h=i*a+r*o,f=a**2+o**2,p=(c+f)/2,g=Math.sqrt(p**2-(c*f-h**2));t[0]=Math.sqrt(p+g||1),t[1]=Math.sqrt(p-g||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const i=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),r=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(i>r)return null;const a=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),o=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return a>o?null:[i,a,r,o]}static pointBoundingBox(e,t,i){i[0]=Math.min(i[0],e),i[1]=Math.min(i[1],t),i[2]=Math.max(i[2],e),i[3]=Math.max(i[3],t)}static rectBoundingBox(e,t,i,r,a){a[0]=Math.min(a[0],e,i),a[1]=Math.min(a[1],t,r),a[2]=Math.max(a[2],e,i),a[3]=Math.max(a[3],t,r)}static#e(e,t,i,r,a,o,c,h,f,p){if(f<=0||f>=1)return;const g=1-f,m=f*f,y=m*f,w=g*(g*(g*e+3*f*t)+3*m*i)+y*r,_=g*(g*(g*a+3*f*o)+3*m*c)+y*h;p[0]=Math.min(p[0],w),p[1]=Math.min(p[1],_),p[2]=Math.max(p[2],w),p[3]=Math.max(p[3],_)}static#t(e,t,i,r,a,o,c,h,f,p,g,m){if(Math.abs(f)<1e-12){Math.abs(p)>=1e-12&&this.#e(e,t,i,r,a,o,c,h,-g/p,m);return}const y=p**2-4*g*f;if(y<0)return;const w=Math.sqrt(y),_=2*f;this.#e(e,t,i,r,a,o,c,h,(-p+w)/_,m),this.#e(e,t,i,r,a,o,c,h,(-p-w)/_,m)}static bezierBoundingBox(e,t,i,r,a,o,c,h,f){f[0]=Math.min(f[0],e,c),f[1]=Math.min(f[1],t,h),f[2]=Math.max(f[2],e,c),f[3]=Math.max(f[3],t,h),this.#t(e,i,a,c,t,r,o,h,3*(-e+3*(i-a)+c),6*(e-2*i+a),3*(i-e),f),this.#t(e,i,a,c,t,r,o,h,3*(-t+3*(r-o)+h),6*(t-2*r+o),3*(r-t),f)}}function $R(n){return decodeURIComponent(escape(n))}let kp=null,z_=null;function GR(n){return kp||(kp=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,z_=new Map([["","t"]])),n.replaceAll(kp,(e,t,i)=>t?t.normalize("NFKC"):z_.get(i))}function db(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),fb(n)}const Wo="pdfjs_internal_id_";function VR(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[i,r,...a]=t;if(!n(i)&&!Number.isInteger(i)||!e(r))return!1;const o=a.length;let c=!0;switch(r.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return o===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(o!==4)return!1;c=!1;break;default:return!1}for(const h of a)if(!(typeof h=="number"||c&&h===null))return!1;return!0}function Wn(n,e,t){return Math.min(Math.max(n,e),t)}function pb(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(fb(n))}function qR(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):su(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});class Bc{static textContent(e){const t=[],i={items:t,styles:Object.create(null)};function r(a){if(!a)return;let o=null;const c=a.name;if(c==="#text")o=a.value;else if(Bc.shouldBuildText(c))a?.attributes?.textContent?o=a.attributes.textContent:a.value&&(o=a.value);else return;if(o!==null&&t.push({str:o}),!!a.children)for(const h of a.children)r(h)}return r(e),i}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class gb{static setupStorage(e,t,i,r,a){const o=r.getValue(t,{value:null});switch(i.name){case"textarea":if(o.value!==null&&(e.textContent=o.value),a==="print")break;e.addEventListener("input",c=>{r.setValue(t,{value:c.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(o.value===i.attributes.xfaOn?e.setAttribute("checked",!0):o.value===i.attributes.xfaOff&&e.removeAttribute("checked"),a==="print")break;e.addEventListener("change",c=>{r.setValue(t,{value:c.target.checked?c.target.getAttribute("xfaOn"):c.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&e.setAttribute("value",o.value),a==="print")break;e.addEventListener("input",c=>{r.setValue(t,{value:c.target.value})})}break;case"select":if(o.value!==null){e.setAttribute("value",o.value);for(const c of i.children)c.attributes.value===o.value?c.attributes.selected=!0:c.attributes.hasOwnProperty("selected")&&delete c.attributes.selected}e.addEventListener("input",c=>{const h=c.target.options,f=h.selectedIndex===-1?"":h[h.selectedIndex].value;r.setValue(t,{value:f})});break}}static setAttributes({html:e,element:t,storage:i=null,intent:r,linkService:a}){const{attributes:o}=t,c=e instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${r}`);for(const[h,f]of Object.entries(o))if(f!=null)switch(h){case"class":f.length&&e.setAttribute(h,f.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",f);break;case"style":Object.assign(e.style,f);break;case"textContent":e.textContent=f;break;default:(!c||h!=="href"&&h!=="newWindow")&&e.setAttribute(h,f)}c&&a.addLinkAttributes(e,o.href,o.newWindow),i&&o.dataId&&this.setupStorage(e,o.dataId,t,i)}static render(e){const t=e.annotationStorage,i=e.linkService,r=e.xfaHtml,a=e.intent||"display",o=document.createElement(r.name);r.attributes&&this.setAttributes({html:o,element:r,intent:a,linkService:i});const c=a!=="richText",h=e.div;if(h.append(o),e.viewport){const g=`matrix(${e.viewport.transform.join(",")})`;h.style.transform=g}c&&h.setAttribute("class","xfaLayer xfaFont");const f=[];if(r.children.length===0){if(r.value){const g=document.createTextNode(r.value);o.append(g),c&&Bc.shouldBuildText(r.name)&&f.push(g)}return{textDivs:f}}const p=[[r,-1,o]];for(;p.length>0;){const[g,m,y]=p.at(-1);if(m+1===g.children.length){p.pop();continue}const w=g.children[++p.at(-1)[1]];if(w===null)continue;const{name:_}=w;if(_==="#text"){const E=document.createTextNode(w.value);f.push(E),y.append(E);continue}const b=w?.attributes?.xmlns?document.createElementNS(w.attributes.xmlns,_):document.createElement(_);if(y.append(b),w.attributes&&this.setAttributes({html:b,element:w,storage:t,intent:a,linkService:i}),w.children?.length>0)p.push([w,-1,b]);else if(w.value){const E=document.createTextNode(w.value);c&&Bc.shouldBuildText(_)&&f.push(E),b.append(E)}}for(const g of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:f}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Kr="http://www.w3.org/2000/svg";class ll{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function au(n,e="text"){if(yc(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,i)=>{const r=new XMLHttpRequest;r.open("GET",n,!0),r.responseType=e,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(r.response);return}t(r.responseText);return}i(new Error(r.statusText))}},r.send(null)})}class ou{constructor({viewBox:e,userUnit:t,scale:i,rotation:r,offsetX:a=0,offsetY:o=0,dontFlip:c=!1}){this.viewBox=e,this.userUnit=t,this.scale=i,this.rotation=r,this.offsetX=a,this.offsetY=o,i*=t;const h=(e[2]+e[0])/2,f=(e[3]+e[1])/2;let p,g,m,y;switch(r%=360,r<0&&(r+=360),r){case 180:p=-1,g=0,m=0,y=1;break;case 90:p=0,g=1,m=1,y=0;break;case 270:p=0,g=-1,m=-1,y=0;break;case 0:p=1,g=0,m=0,y=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(m=-m,y=-y);let w,_,b,E;p===0?(w=Math.abs(f-e[1])*i+a,_=Math.abs(h-e[0])*i+o,b=(e[3]-e[1])*i,E=(e[2]-e[0])*i):(w=Math.abs(h-e[0])*i+a,_=Math.abs(f-e[1])*i+o,b=(e[2]-e[0])*i,E=(e[3]-e[1])*i),this.transform=[p*i,g*i,m*i,y*i,w-p*i*h-m*i*f,_-g*i*h-y*i*f],this.width=b,this.height=E}get rawDims(){const e=this.viewBox;return Xe(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:i=this.offsetX,offsetY:r=this.offsetY,dontFlip:a=!1}={}){return new ou({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:r,dontFlip:a})}convertToViewportPoint(e,t){const i=[e,t];return Ne.applyTransform(i,this.transform),i}convertToViewportRectangle(e){const t=[e[0],e[1]];Ne.applyTransform(t,this.transform);const i=[e[2],e[3]];return Ne.applyTransform(i,this.transform),[t[0],t[1],i[0],i[1]]}convertToPdfPoint(e,t){const i=[e,t];return Ne.applyInverseTransform(i,this.transform),i}}class Hg extends Fa{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Vf(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function zg(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function WR(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function XR(n,e="document.pdf"){if(typeof n!="string")return e;if(Vf(n))return We('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const i=(c=>{try{return new URL(c)}catch{try{return new URL(decodeURIComponent(c))}catch{try{return new URL(c,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(c),"https://foo.bar")}catch{return null}}}}})(n);if(!i)return e;const r=c=>{try{let h=decodeURIComponent(c);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:c):h}catch{return c}},a=/\.pdf$/i,o=i.pathname.split("/").at(-1);if(a.test(o))return r(o);if(i.searchParams.size>0){const c=Array.from(i.searchParams.values()).reverse();for(const f of c)if(a.test(f))return r(f);const h=Array.from(i.searchParams.keys()).reverse();for(const f of h)if(a.test(f))return r(f)}if(i.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(i.hash);if(h)return r(h[0])}return e}class $_{started=Object.create(null);times=[];time(e){e in this.started&&We(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||We(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:i}of this.times)t=Math.max(i.length,t);for(const{name:i,start:r,end:a}of this.times)e.push(`${i.padEnd(t)} ${a-r}ms
`);return e.join("")}}function yc(n,e){const t=e?URL.parse(n,e):URL.parse(n);return t?.protocol==="http:"||t?.protocol==="https:"}function Yi(n){n.preventDefault()}function Yt(n){n.preventDefault(),n.stopPropagation()}function YR(n){console.log("Deprecated API usage: "+n)}class og{static#e;static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;this.#e||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=this.#e.exec(e);if(!t)return null;const i=parseInt(t[1],10);let r=parseInt(t[2],10);r=r>=1&&r<=12?r-1:0;let a=parseInt(t[3],10);a=a>=1&&a<=31?a:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let c=parseInt(t[5],10);c=c>=0&&c<=59?c:0;let h=parseInt(t[6],10);h=h>=0&&h<=59?h:0;const f=t[7]||"Z";let p=parseInt(t[8],10);p=p>=0&&p<=23?p:0;let g=parseInt(t[9],10)||0;return g=g>=0&&g<=59?g:0,f==="-"?(o+=p,c+=g):f==="+"&&(o-=p,c-=g),new Date(Date.UTC(i,r,a,o,c,h))}}function KR(n,{scale:e=1,rotation:t=0}){const{width:i,height:r}=n.attributes.style,a=[0,0,parseInt(i),parseInt(r)];return new ou({viewBox:a,userUnit:1,scale:e,rotation:t})}function lu(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(We(`Not a valid color format: "${n}"`),[0,0,0])}function JR(n){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of n.keys()){e.style.color=t;const i=window.getComputedStyle(e).color;n.set(t,lu(i))}e.remove()}function zt(n){const{a:e,b:t,c:i,d:r,e:a,f:o}=n.getTransform();return[e,t,i,r,a,o]}function br(n){const{a:e,b:t,c:i,d:r,e:a,f:o}=n.getTransform().invertSelf();return[e,t,i,r,a,o]}function Ra(n,e,t=!1,i=!0){if(e instanceof ou){const{pageWidth:r,pageHeight:a}=e.rawDims,{style:o}=n,c=vn.isCSSRoundSupported,h=`var(--total-scale-factor) * ${r}px`,f=`var(--total-scale-factor) * ${a}px`,p=c?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,g=c?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!t||e.rotation%180===0?(o.width=p,o.height=g):(o.width=g,o.height=p)}i&&n.setAttribute("data-main-rotation",e.rotation)}class Or{constructor(){const{pixelRatio:e}=Or;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,i,r,a=-1){let o=1/0,c=1/0,h=1/0;i=Or.capPixels(i,a),i>0&&(o=Math.sqrt(i/(e*t))),r!==-1&&(c=r/e,h=r/t);const f=Math.min(o,c,h);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const i=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,i):i}return e}}const lg=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class QR{static get isDarkMode(){return Xe(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class ZR{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:i}=window.getComputedStyle(e);return e.remove(),Xe(this,"commentForegroundColor",lu(i))}}function eO(n,e,t,i){i=Math.min(Math.max(i??1,0),1);const r=255*(1-i);return n=Math.round(n*i+r),e=Math.round(e*i+r),t=Math.round(t*i+r),[n,e,t]}function G_(n,e){const t=n[0]/255,i=n[1]/255,r=n[2]/255,a=Math.max(t,i,r),o=Math.min(t,i,r),c=(a+o)/2;if(a===o)e[0]=e[1]=0;else{const h=a-o;switch(e[1]=c<.5?h/(a+o):h/(2-a-o),a){case t:e[0]=((i-r)/h+(i<r?6:0))*60;break;case i:e[0]=((r-t)/h+2)*60;break;case r:e[0]=((t-i)/h+4)*60;break}}e[2]=c}function cg(n,e){const t=n[0],i=n[1],r=n[2],a=(1-Math.abs(2*r-1))*i,o=a*(1-Math.abs(t/60%2-1)),c=r-a/2;switch(Math.floor(t/60)){case 0:e[0]=a+c,e[1]=o+c,e[2]=c;break;case 1:e[0]=o+c,e[1]=a+c,e[2]=c;break;case 2:e[0]=c,e[1]=a+c,e[2]=o+c;break;case 3:e[0]=c,e[1]=o+c,e[2]=a+c;break;case 4:e[0]=o+c,e[1]=c,e[2]=a+c;break;case 5:case 6:e[0]=a+c,e[1]=c,e[2]=o+c;break}}function V_(n){return n<=.03928?n/12.92:((n+.055)/1.055)**2.4}function q_(n,e,t){cg(n,t),t.map(V_);const i=.2126*t[0]+.7152*t[1]+.0722*t[2];cg(e,t),t.map(V_);const r=.2126*t[0]+.7152*t[1]+.0722*t[2];return i>r?(i+.05)/(r+.05):(r+.05)/(i+.05)}const W_=new Map;function tO(n,e){const t=n[0]+n[1]*256+n[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let i=W_.get(t);if(i)return i;const r=new Float32Array(9),a=r.subarray(0,3),o=r.subarray(3,6);G_(n,o);const c=r.subarray(6,9);G_(e,c);const h=c[2]<.5,f=h?12:4.5;if(o[2]=h?Math.sqrt(o[2]):1-Math.sqrt(1-o[2]),q_(o,c,a)<f){let p,g;h?(p=o[2],g=1):(p=0,g=o[2]);const m=.005;for(;g-p>m;){const y=o[2]=(p+g)/2;h===q_(o,c,a)<f?p=y:g=y}o[2]=h?g:p}return cg(o,a),i=Ne.makeHexColor(Math.round(a[0]*255),Math.round(a[1]*255),Math.round(a[2]*255)),W_.set(t,i),i}function mb({html:n,dir:e,className:t},i){const r=document.createDocumentFragment();if(typeof n=="string"){const a=document.createElement("p");a.dir=e||"auto";const o=n.split(/(?:\r\n?|\n)/);for(let c=0,h=o.length;c<h;++c){const f=o[c];a.append(document.createTextNode(f)),c<h-1&&a.append(document.createElement("br"))}r.append(a)}else gb.render({xfaHtml:n,div:r,intent:"richText"});r.firstElementChild.classList.add("richText",t),i.append(r)}function vb(n){const e=new Path2D;if(!n)return e;for(let t=0,i=n.length;t<i;)switch(n[t++]){case fc.moveTo:e.moveTo(n[t++],n[t++]);break;case fc.lineTo:e.lineTo(n[t++],n[t++]);break;case fc.curveTo:e.bezierCurveTo(n[t++],n[t++],n[t++],n[t++],n[t++],n[t++]);break;case fc.quadraticCurveTo:e.quadraticCurveTo(n[t++],n[t++],n[t++],n[t++]);break;case fc.closePath:e.closePath();break;default:We(`Unrecognized drawing path operator: ${n[t-1]}`);break}return e}class Ec{#e=null;#t=null;#i;#n=null;#a=null;#s=null;#r=null;#o=null;static#c=null;constructor(e){this.#i=e,Ec.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const e=this.#e=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=this.#i._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",Yi,{signal:t}),e.addEventListener("pointerdown",Ec.#l,{signal:t}));const i=this.#n=document.createElement("div");i.className="buttons",e.append(i);const r=this.#i.toolbarPosition;if(r){const{style:a}=e,o=this.#i._uiManager.direction==="ltr"?1-r[0]:r[0];a.insetInlineEnd=`${100*o}%`,a.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return this.#e}static#l(e){e.stopPropagation()}#f(e){this.#i._focusEventsAllowed=!1,Yt(e)}#h(e){this.#i._focusEventsAllowed=!0,Yt(e)}#d(e){const t=this.#i._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",this.#f.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Yi,{signal:t}),!0)}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#a?.shown(),this.#s?.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=this.#i,i=document.createElement("button");i.classList.add("basic","deleteButton"),i.tabIndex=0,i.setAttribute("data-l10n-id",Ec.#c[e]),this.#d(i)&&i.addEventListener("click",r=>{t.delete()},{signal:t._signal}),this.#n.append(i)}get#m(){const e=document.createElement("div");return e.className="divider",e}async addAltText(e){const t=await e.render();this.#d(t),this.#n.append(t,this.#m),this.#a=e}addComment(e,t=null){if(this.#s)return;const i=e.renderForToolbar();if(!i)return;this.#d(i);const r=this.#r=this.#m;t?(this.#n.insertBefore(i,t),this.#n.insertBefore(r,t)):this.#n.append(i,r),this.#s=e,e.toolbar=this}addColorPicker(e){if(this.#t)return;this.#t=e;const t=e.renderButton();this.#d(t),this.#n.append(t,this.#m)}async addEditSignatureButton(e){const t=this.#o=await e.renderEditButton(this.#i);this.#d(t),this.#n.append(t,this.#m)}removeButton(e){e==="comment"&&(this.#s?.removeToolbarCommentButton(),this.#s=null,this.#r?.remove(),this.#r=null)}async addButton(e,t){switch(e){case"colorPicker":t&&this.addColorPicker(t);break;case"altText":t&&await this.addAltText(t);break;case"editSignature":t&&await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":t&&this.addComment(t);break}}async addButtonBefore(e,t,i){if(!t&&e==="comment")return;const r=this.#n.querySelector(i);r&&e==="comment"&&this.addComment(t,r)}updateEditSignatureButton(e){this.#o&&(this.#o.title=e)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}}class nO{#e=null;#t=null;#i;constructor(e){this.#i=e}#n(){const e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar");const t=this.#i._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",Yi,{signal:t});const i=this.#e=document.createElement("div");return i.className="buttons",e.append(i),this.#i.hasCommentManager()&&this.#s("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#i.commentSelection("floating_button")}),this.#s("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#i.highlightSelection("floating_button")}),e}#a(e,t){let i=0,r=0;for(const a of e){const o=a.y+a.height;if(o<i)continue;const c=a.x+(t?a.width:0);if(o>i){r=c,i=o;continue}t?c>r&&(r=c):c<r&&(r=c)}return[t?1-r:r,i]}show(e,t,i){const[r,a]=this.#a(t,i),{style:o}=this.#t||=this.#n();e.append(this.#t),o.insetInlineEnd=`${100*r}%`,o.top=`calc(${100*a}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#s(e,t,i,r){const a=document.createElement("button");a.classList.add("basic",e),a.tabIndex=0,a.setAttribute("data-l10n-id",t);const o=document.createElement("span");a.append(o),o.className="visuallyHidden",o.setAttribute("data-l10n-id",i);const c=this.#i._signal;c instanceof AbortSignal&&!c.aborted&&(a.addEventListener("contextmenu",Yi,{signal:c}),a.addEventListener("click",r,{signal:c})),this.#e.append(a)}}function yb(n,e,t){for(const i of t)e.addEventListener(i,n[i].bind(n))}class pt{static#e=NaN;static#t=null;static#i=NaN;static#n=null;static initializeAndAddPointerId(e){(pt.#t||=new Set).add(e)}static setPointer(e,t){pt.#e||=t,pt.#n??=e}static setTimeStamp(e){pt.#i=e}static isSamePointerId(e){return pt.#e===e}static isSamePointerIdOrRemove(e){return pt.#e===e?!0:(pt.#t?.delete(e),!1)}static isSamePointerType(e){return pt.#n===e}static isInitializedAndDifferentPointerType(e){return pt.#n!==null&&!pt.isSamePointerType(e)}static isSameTimeStamp(e){return pt.#i===e}static isUsingMultiplePointers(){return pt.#t?.size>=1}static clearPointerType(){pt.#n=null}static clearPointerIds(){pt.#e=NaN,pt.#t=null}static clearTimeStamp(){pt.#i=NaN}}class iO{#e=0;get id(){return`${Ic}${this.#e++}`}}class $g{#e=db();#t=0;#i=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=e;const a=r.decode().then(()=>(i.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return Xe(this,"_isSVGFittingCanvas",a)}async#n(e,t){this.#i||=new Map;let i=this.#i.get(e);if(i===null)return null;if(i?.bitmap)return i.refCounter+=1,i;try{i||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let r;if(typeof t=="string"?(i.url=t,r=await au(t,"blob")):t instanceof File?r=i.file=t:t instanceof Blob&&(r=t),r.type==="image/svg+xml"){const a=$g._isSVGFittingCanvas,o=new FileReader,c=new Image,h=new Promise((f,p)=>{c.onload=()=>{i.bitmap=c,i.isSvg=!0,f()},o.onload=async()=>{const g=i.svgUrl=o.result;c.src=await a?`${g}#svgView(preserveAspectRatio(none))`:g},c.onerror=o.onerror=p});o.readAsDataURL(r),await h}else i.bitmap=await createImageBitmap(r);i.refCounter=1}catch(r){We(r),i=null}return this.#i.set(e,i),i&&this.#i.set(i.id,i),i}async getFromFile(e){const{lastModified:t,name:i,size:r,type:a}=e;return this.#n(`${t}_${i}_${r}_${a}`,e)}async getFromUrl(e){return this.#n(e,e)}async getFromBlob(e,t){const i=await t;return this.#n(e,i)}async getFromId(e){this.#i||=new Map;const t=this.#i.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:i}=t;return delete t.blobPromise,this.getFromBlob(t.id,i)}return this.getFromUrl(t.url)}getFromCanvas(e,t){this.#i||=new Map;let i=this.#i.get(e);if(i?.bitmap)return i.refCounter+=1,i;const r=new OffscreenCanvas(t.width,t.height);return r.getContext("2d").drawImage(t,0,0),i={bitmap:r.transferToImageBitmap(),id:`image_${this.#e}_${this.#t++}`,refCounter:1,isSvg:!1},this.#i.set(e,i),this.#i.set(i.id,i),i}getSvgUrl(e){const t=this.#i.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#i||=new Map;const t=this.#i.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:i}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(i.width,i.height);r.getContext("bitmaprenderer").transferFromImageBitmap(i),t.blobPromise=r.convertToBlob()}i.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#e}_`)}}class rO{#e=[];#t=!1;#i;#n=-1;constructor(e=128){this.#i=e}add({cmd:e,undo:t,post:i,mustExec:r,type:a=NaN,overwriteIfSameType:o=!1,keepUndo:c=!1}){if(r&&e(),this.#t)return;const h={cmd:e,undo:t,post:i,type:a};if(this.#n===-1){this.#e.length>0&&(this.#e.length=0),this.#n=0,this.#e.push(h);return}if(o&&this.#e[this.#n].type===a){c&&(h.undo=this.#e[this.#n].undo),this.#e[this.#n]=h;return}const f=this.#n+1;f===this.#i?this.#e.splice(0,1):(this.#n=f,f<this.#e.length&&this.#e.splice(f)),this.#e.push(h)}undo(){if(this.#n===-1)return;this.#t=!0;const{undo:e,post:t}=this.#e[this.#n];e(),t?.(),this.#t=!1,this.#n-=1}redo(){if(this.#n<this.#e.length-1){this.#n+=1,this.#t=!0;const{cmd:e,post:t}=this.#e[this.#n];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#e.length-1}cleanType(e){if(this.#n!==-1){for(let t=this.#n;t>=0;t--)if(this.#e[t].type!==e){this.#e.splice(t+1,this.#n-t),this.#n=t;return}this.#e.length=0,this.#n=-1}}destroy(){this.#e=null}}class cu{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=vn.platform;for(const[i,r,a={}]of e)for(const o of i){const c=o.startsWith("mac+");t&&c?(this.callbacks.set(o.slice(4),{callback:r,options:a}),this.allKeys.add(o.split("+").at(-1))):!t&&!c&&(this.callbacks.set(o,{callback:r,options:a}),this.allKeys.add(o.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const i=this.callbacks.get(this.#e(t));if(!i)return;const{callback:r,options:{bubbles:a=!1,args:o=[],checker:c=null}}=i;c&&!c(e,t)||(r.bind(e,...o,t)(),a||Yt(t))}}class Gg{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return JR(e),Xe(this,"_colors",e)}convert(e){const t=lu(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[i,r]of this._colors)if(r.every((a,o)=>a===t[o]))return Gg._colorsMapping.get(i);return t}getHexCode(e){const t=this._colors.get(e);return t?Ne.makeHexColor(...t):e}}class Vs{#e=new AbortController;#t=null;#i=null;#n=new Map;#a=new Map;#s=null;#r=null;#o=null;#c=new rO;#l=null;#f=null;#h=null;#d=0;#m=new Set;#g=null;#u=null;#p=new Set;_editorUndoBar=null;#v=!1;#_=!1;#y=!1;#A=null;#E=null;#w=null;#C=null;#x=!1;#S=null;#k=new iO;#R=!1;#O=!1;#P=!1;#N=null;#L=null;#B=null;#F=null;#G=null;#T=Ye.NONE;#b=new Set;#M=null;#U=null;#H=null;#W=null;#q=null;#X={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#z=[0,0];#I=null;#V=null;#Q=null;#Z=null;#j=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=Vs.prototype,t=o=>o.#V.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),i=(o,{target:c})=>{if(c instanceof HTMLInputElement){const{type:h}=c;return h!=="text"&&h!=="number"}return!0},r=this.TRANSLATE_SMALL,a=this.TRANSLATE_BIG;return Xe(this,"_keyboardManager",new cu([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],e.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:i}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(o,{target:c})=>!(c instanceof HTMLButtonElement)&&o.#V.contains(c)&&!o.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(o,{target:c})=>!(c instanceof HTMLButtonElement)&&o.#V.contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-a,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[a,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-a],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,a],checker:t}]]))}constructor(e,t,i,r,a,o,c,h,f,p,g,m,y,w,_,b){const E=this._signal=this.#e.signal;this.#V=e,this.#Q=t,this.#Z=i,this.#s=r,this.#l=a,this.#U=o,this.#q=h,this._eventBus=c,c._on("editingaction",this.onEditingAction.bind(this),{signal:E}),c._on("pagechanging",this.onPageChanging.bind(this),{signal:E}),c._on("scalechanging",this.onScaleChanging.bind(this),{signal:E}),c._on("rotationchanging",this.onRotationChanging.bind(this),{signal:E}),c._on("setpreference",this.onSetPreference.bind(this),{signal:E}),c._on("switchannotationeditorparams",T=>this.updateParams(T.type,T.value),{signal:E}),window.addEventListener("pointerdown",()=>{this.#O=!0},{capture:!0,signal:E}),window.addEventListener("pointerup",()=>{this.#O=!1},{capture:!0,signal:E}),this.#ae(),this.#fe(),this.#te(),this.#r=h.annotationStorage,this.#A=h.filterFactory,this.#H=f,this.#C=p||null,this.#v=g,this.#_=m,this.#y=y,this.#G=w||null,this.viewParameters={realScale:ll.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=_||null,this._supportsPinchToZoom=b!==!1,a?.setSidebarUiManager(this)}destroy(){this.#j?.resolve(),this.#j=null,this.#e?.abort(),this.#e=null,this._signal=null;for(const e of this.#a.values())e.destroy();this.#a.clear(),this.#n.clear(),this.#p.clear(),this.#F?.clear(),this.#t=null,this.#b.clear(),this.#c.destroy(),this.#s?.destroy(),this.#l?.destroy(),this.#U?.destroy(),this.#S?.hide(),this.#S=null,this.#B?.destroy(),this.#B=null,this.#i=null,this.#E&&(clearTimeout(this.#E),this.#E=null),this.#I&&(clearTimeout(this.#I),this.#I=null),this._editorUndoBar?.destroy(),this.#q=null}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return this.#G}get useNewAltTextFlow(){return this.#_}get useNewAltTextWhenAddingImage(){return this.#y}get hcmFilter(){return Xe(this,"hcmFilter",this.#H?this.#A.addHCMFilter(this.#H.foreground,this.#H.background):"none")}get direction(){return Xe(this,"direction",getComputedStyle(this.#V).direction)}get _highlightColors(){return Xe(this,"_highlightColors",this.#C?new Map(this.#C.split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return Xe(this,"highlightColors",null);const t=new Map,i=!!this.#H;for(const[r,a]of e){const o=r.endsWith("_HCM");if(i&&o){t.set(r.replace("_HCM",""),a);continue}!i&&!o&&t.set(r,a)}return Xe(this,"highlightColors",t)}get highlightColorNames(){return Xe(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#h=e}setMainHighlightColorPicker(e){this.#B=e}editAltText(e,t=!1){this.#s?.editAltText(this,e,t)}hasCommentManager(){return!!this.#l}editComment(e,t,i,r){this.#l?.showDialog(this,e,t,i,r)}selectComment(e,t){this.#a.get(e)?.getEditorByUID(t)?.toggleComment(!0,!0)}updateComment(e){this.#l?.updateComment(e.getData())}updatePopupColor(e){this.#l?.updatePopupColor(e)}removeComment(e){this.#l?.removeComments([e.uid])}toggleComment(e,t,i=void 0){this.#l?.toggleCommentPopup(e,t,i)}makeCommentColor(e,t){return e&&this.#l?.makeCommentColor(e,t)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(e){if(this.#a.has(e-1))return;const{resolve:t,promise:i}=Promise.withResolvers(),r=a=>{a.pageNumber===e&&(this._eventBus._off("editorsrendered",r),t())};this._eventBus.on("editorsrendered",r),await i}getSignature(e){this.#U?.getSignature({uiManager:this,editor:e})}get signatureManager(){return this.#U}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){e==="enableNewAltTextWhenAddingImage"&&(this.#y=t)}onPageChanging({pageNumber:e}){this.#d=e-1}focusMainContainer(){this.#V.focus()}findParent(e,t){for(const i of this.#a.values()){const{x:r,y:a,width:o,height:c}=i.div.getBoundingClientRect();if(e>=r&&e<=r+o&&t>=a&&t<=a+c)return i}return null}disableUserSelect(e=!1){this.#Q.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#p.add(e)}removeShouldRescale(e){this.#p.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*ll.PDF_TO_CSS_UNITS;for(const t of this.#p)t.onScaleChanging();this.#h?.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}#J({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e}#ee(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const i of this.#a.values())if(i.hasTextLayer(e))return i;return null}highlightSelection(e="",t=!1){const i=document.getSelection();if(!i||i.isCollapsed)return;const{anchorNode:r,anchorOffset:a,focusNode:o,focusOffset:c}=i,h=i.toString(),p=this.#J(i).closest(".textLayer"),g=this.getSelectionBoxes(p);if(!g)return;i.empty();const m=this.#ee(p),y=this.#T===Ye.NONE,w=()=>{const _=m?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:g,anchorNode:r,anchorOffset:a,focusNode:o,focusOffset:c,text:h});y&&this.showAllEditors("highlight",!0,!0),t&&_?.editComment()};if(y){this.switchToMode(Ye.HIGHLIGHT,w);return}w()}commentSelection(e=""){this.highlightSelection(e,!0)}#re(){const e=document.getSelection();if(!e||e.isCollapsed)return;const i=this.#J(e).closest(".textLayer"),r=this.getSelectionBoxes(i);r&&(this.#S||=new nO(this),this.#S.show(i,r,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(e){if(!this.#r)return null;const t=`${Ic}${e}`,i=this.#r.getRawValue(t);return i&&this.#r.remove(t),i}addToAnnotationStorage(e){!e.isEmpty()&&this.#r&&!this.#r.has(e.id)&&this.#r.setValue(e.id,e)}a11yAlert(e,t=null){const i=this.#Z;i&&(i.setAttribute("data-l10n-id",e),t?i.setAttribute("data-l10n-args",JSON.stringify(t)):i.removeAttribute("data-l10n-args"))}#se(){const e=document.getSelection();if(!e||e.isCollapsed){this.#M&&(this.#S?.hide(),this.#M=null,this.#D({hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===this.#M)return;const r=this.#J(e).closest(".textLayer");if(!r){this.#M&&(this.#S?.hide(),this.#M=null,this.#D({hasSelectedText:!1}));return}if(this.#S?.hide(),this.#M=t,this.#D({hasSelectedText:!0}),!(this.#T!==Ye.HIGHLIGHT&&this.#T!==Ye.NONE)&&(this.#T===Ye.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#x=this.isShiftKeyDown,!this.isShiftKeyDown)){const a=this.#T===Ye.HIGHLIGHT?this.#ee(r):null;if(a?.toggleDrawing(),this.#O){const o=new AbortController,c=this.combinedSignal(o),h=f=>{f.type==="pointerup"&&f.button!==0||(o.abort(),a?.toggleDrawing(!0),f.type==="pointerup"&&this.#Y("main_toolbar"))};window.addEventListener("pointerup",h,{signal:c}),window.addEventListener("blur",h,{signal:c})}else a?.toggleDrawing(!0),this.#Y("main_toolbar")}}#Y(e=""){this.#T===Ye.HIGHLIGHT?this.highlightSelection(e):this.#v&&this.#re()}#ae(){document.addEventListener("selectionchange",this.#se.bind(this),{signal:this._signal})}#oe(){if(this.#w)return;this.#w=new AbortController;const e=this.combinedSignal(this.#w);window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}#le(){this.#w?.abort(),this.#w=null}blur(){if(this.isShiftKeyDown=!1,this.#x&&(this.#x=!1,this.#Y("main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#b)if(t.div.contains(e)){this.#L=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#L)return;const[e,t]=this.#L;this.#L=null,t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}#te(){if(this.#N)return;this.#N=new AbortController;const e=this.combinedSignal(this.#N);window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}#ce(){this.#N?.abort(),this.#N=null}#ue(){if(this.#f)return;this.#f=new AbortController;const e=this.combinedSignal(this.#f);document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}#he(){this.#f?.abort(),this.#f=null}#fe(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}addEditListeners(){this.#te(),this.setEditingState(!0)}removeEditListeners(){this.#ce(),this.setEditingState(!1)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const i of this.#u)if(i.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const i of this.#u)if(i.isHandlingMimeForPasting(t.type)){i.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of this.#b){const r=i.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const a of t.items)for(const o of this.#u)if(o.isHandlingMimeForPasting(a.type)){o.paste(a,this.currentLayer);return}let i=t.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(a){We(`paste: "${a.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const r=this.currentLayer;try{const a=[];for(const h of i){const f=await r.deserialize(h);if(!f)return;a.push(f)}const o=()=>{for(const h of a)this.#ne(h);this.#ie(a)},c=()=>{for(const h of a)h.remove()};this.addCommands({cmd:o,undo:c,mustExec:!0})}catch(a){We(`paste: "${a.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),this.#T!==Ye.NONE&&!this.isEditorHandlingKeyboard&&Vs._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,this.#x&&(this.#x=!1,this.#Y("main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#D(e){Object.entries(e).some(([i,r])=>this.#X[i]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#X,e)}),this.#T===Ye.HIGHLIGHT&&e.hasSelectedEditor===!1&&this.#$([[ot.HIGHLIGHT_FREE,!0]]))}#$(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#oe(),this.#ue(),this.#D({isEditing:this.#T!==Ye.NONE,isEmpty:this.#K(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#le(),this.#he(),this.#D({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#u){this.#u=e;for(const t of this.#u)this.#$(t.defaultPropertiesToUpdate)}}getId(){return this.#k.id}get currentLayer(){return this.#a.get(this.#d)}getLayer(e){return this.#a.get(e)}get currentPageIndex(){return this.#d}addLayer(e){this.#a.set(e.pageIndex,e),this.#R?e.enable():e.disable()}removeLayer(e){this.#a.delete(e.pageIndex)}async updateMode(e,t=null,i=!1,r=!1,a=!1,o=!1){if(this.#T!==e&&!(this.#j&&(await this.#j.promise,!this.#j))){if(this.#j=Promise.withResolvers(),this.#h?.commitOrRemove(),this.#T===Ye.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#T=e,e===Ye.NONE){this.setEditingState(!1),this.#pe();for(const c of this.#n.values())c.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#j.resolve();return}for(const c of this.#n.values())c.addStandaloneCommentButton();e===Ye.SIGNATURE&&await this.#U?.loadSignatures(),i&&pt.clearPointerType(),this.setEditingState(!0),await this.#de(),this.unselectAll();for(const c of this.#a.values())c.updateMode(e);if(e===Ye.POPUP){this.#i||=await this.#q.getAnnotationsByType(new Set(this.#u.map(f=>f._editorType)));const c=new Set,h=[];for(const f of this.#n.values()){const{annotationElementId:p,hasComment:g,deleted:m}=f;p&&c.add(p),g&&!m&&h.push(f.getData())}for(const f of this.#i){const{id:p,popupRef:g,contentsObj:m}=f;g&&m?.str&&!c.has(p)&&!this.#m.has(p)&&h.push(f)}this.#l?.showSidebar(h)}if(!t){r&&this.addNewEditorFromKeyboard(),this.#j.resolve();return}for(const c of this.#n.values())c.uid===t?(this.setSelected(c),o?c.editComment():a?c.enterInEditMode():c.focus()):c.unselect();this.#j.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==this.#T&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(this.#u){switch(e){case ot.CREATE:this.currentLayer.addNewEditor(t);return;case ot.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#W||=new Map).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const i of this.#b)i.updateParams(e,t);else for(const i of this.#u)i.updateDefaultParams(e,t)}}showAllEditors(e,t,i=!1){for(const a of this.#n.values())a.editorType===e&&a.show(t);(this.#W?.get(ot.HIGHLIGHT_SHOW_ALL)??!0)!==t&&this.#$([[ot.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(this.#P!==e){this.#P=e;for(const t of this.#a.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}async#de(){if(!this.#R){this.#R=!0;const e=[];for(const t of this.#a.values())e.push(t.enable());await Promise.all(e);for(const t of this.#n.values())t.enable()}}#pe(){if(this.unselectAll(),this.#R){this.#R=!1;for(const e of this.#a.values())e.disable();for(const e of this.#n.values())e.disable()}}*getEditors(e){for(const t of this.#n.values())t.pageIndex===e&&(yield t)}getEditor(e){return this.#n.get(e)}addEditor(e){this.#n.set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(this.#E&&clearTimeout(this.#E),this.#E=setTimeout(()=>{this.focusMainContainer(),this.#E=null},0)),this.#n.delete(e.id),e.annotationElementId&&this.#F?.delete(e.annotationElementId),this.unselect(e),(!e.annotationElementId||!this.#m.has(e.annotationElementId))&&this.#r?.remove(e.id)}addDeletedAnnotationElement(e){this.#m.add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return this.#m.has(e)}removeDeletedAnnotationElement(e){this.#m.delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}#ne(e){const t=this.#a.get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#$(e.propertiesToUpdate))}get#ge(){let e=null;for(e of this.#b);return e}updateUI(e){this.#ge===e&&this.#$(e.propertiesToUpdate)}updateUIForDefaultProperties(e){this.#$(e.defaultPropertiesToUpdate)}toggleSelected(e){if(this.#b.has(e)){this.#b.delete(e),e.unselect(),this.#D({hasSelectedEditor:this.hasSelection});return}this.#b.add(e),e.select(),this.#$(e.propertiesToUpdate),this.#D({hasSelectedEditor:!0})}setSelected(e){this.updateToolbar({mode:e.mode,editId:e.uid}),this.#h?.commitOrRemove();for(const t of this.#b)t!==e&&t.unselect();this.#b.clear(),this.#b.add(e),e.select(),this.#$(e.propertiesToUpdate),this.#D({hasSelectedEditor:!0})}isSelected(e){return this.#b.has(e)}get firstSelectedEditor(){return this.#b.values().next().value}unselect(e){e.unselect(),this.#b.delete(e),this.#D({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#b.size!==0}get isEnterHandled(){return this.#b.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#D({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#K()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#D({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#K()})}addCommands(e){this.#c.add(e),this.#D({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#K()})}cleanUndoStack(e){this.#c.cleanType(e)}#K(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const e of this.#n.values())return e.isEmpty();return!1}delete(){this.commitOrRemove();const e=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...this.#b],i=()=>{this._editorUndoBar?.show(r,t.length===1?t[0].editorType:t.length);for(const a of t)a.remove()},r=()=>{for(const a of t)this.#ne(a)};this.addCommands({cmd:i,undo:r,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#ie(e){for(const t of this.#b)t.unselect();this.#b.clear();for(const t of e)t.isEmpty()||(this.#b.add(t),t.select());this.#D({hasSelectedEditor:this.hasSelection})}selectAll(){for(const e of this.#b)e.commit();this.#ie(this.#n.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#T!==Ye.NONE))&&!this.#h?.commitOrRemove()&&this.hasSelection){for(const e of this.#b)e.unselect();this.#b.clear(),this.#D({hasSelectedEditor:!1})}}translateSelectedEditors(e,t,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;this.#z[0]+=e,this.#z[1]+=t;const[r,a]=this.#z,o=[...this.#b],c=1e3;this.#I&&clearTimeout(this.#I),this.#I=setTimeout(()=>{this.#I=null,this.#z[0]=this.#z[1]=0,this.addCommands({cmd:()=>{for(const h of o)this.#n.has(h.id)&&(h.translateInPage(r,a),h.translationDone())},undo:()=>{for(const h of o)this.#n.has(h.id)&&(h.translateInPage(-r,-a),h.translationDone())},mustExec:!1})},c);for(const h of o)h.translateInPage(e,t),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#g=new Map;for(const e of this.#b)this.#g.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#g)return!1;this.disableUserSelect(!1);const e=this.#g;this.#g=null;let t=!1;for(const[{x:r,y:a,pageIndex:o},c]of e)c.newX=r,c.newY=a,c.newPageIndex=o,t||=r!==c.savedX||a!==c.savedY||o!==c.savedPageIndex;if(!t)return!1;const i=(r,a,o,c)=>{if(this.#n.has(r.id)){const h=this.#a.get(c);h?r._setParentAndPosition(h,a,o):(r.pageIndex=c,r.x=a,r.y=o)}};return this.addCommands({cmd:()=>{for(const[r,{newX:a,newY:o,newPageIndex:c}]of e)i(r,a,o,c)},undo:()=>{for(const[r,{savedX:a,savedY:o,savedPageIndex:c}]of e)i(r,a,o,c)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#g)for(const i of this.#g.keys())i.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#b.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#T}isEditingMode(){return this.#T!==Ye.NONE}get imageManager(){return Xe(this,"imageManager",new $g)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let f=0,p=t.rangeCount;f<p;f++)if(!e.contains(t.getRangeAt(f).commonAncestorContainer))return null;const{x:i,y:r,width:a,height:o}=e.getBoundingClientRect();let c;switch(e.getAttribute("data-main-rotation")){case"90":c=(f,p,g,m)=>({x:(p-r)/o,y:1-(f+g-i)/a,width:m/o,height:g/a});break;case"180":c=(f,p,g,m)=>({x:1-(f+g-i)/a,y:1-(p+m-r)/o,width:g/a,height:m/o});break;case"270":c=(f,p,g,m)=>({x:1-(p+m-r)/o,y:(f-i)/a,width:m/o,height:g/a});break;default:c=(f,p,g,m)=>({x:(f-i)/a,y:(p-r)/o,width:g/a,height:m/o});break}const h=[];for(let f=0,p=t.rangeCount;f<p;f++){const g=t.getRangeAt(f);if(!g.collapsed)for(const{x:m,y,width:w,height:_}of g.getClientRects())w===0||_===0||h.push(c(m,y,w,_))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:e,id:t}){(this.#o||=new Map).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){this.#o?.delete(e)}renderAnnotationElement(e){const t=this.#o?.get(e.data.id);if(!t)return;const i=this.#r.getRawValue(t);i&&(this.#T===Ye.NONE&&!i.hasBeenModified||i.renderAnnotationElement(e))}setMissingCanvas(e,t,i){const r=this.#F?.get(e);r&&(r.setCanvas(t,i),this.#F.delete(e))}addMissingCanvas(e,t){(this.#F||=new Map).set(e,t)}}class Cr{#e=null;#t=!1;#i=null;#n=null;#a=null;#s=null;#r=!1;#o=null;#c=null;#l=null;#f=null;#h=!1;static#d=null;static _l10n=null;constructor(e){this.#c=e,this.#h=e._uiManager.useNewAltTextFlow,Cr.#d||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(e){Cr._l10n??=e}async render(){const e=this.#i=document.createElement("button");e.className="altText",e.tabIndex="0";const t=this.#n=document.createElement("span");e.append(t),this.#h?(e.classList.add("new"),e.setAttribute("data-l10n-id",Cr.#d.missing),t.setAttribute("data-l10n-id",Cr.#d["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=this.#c._uiManager._signal;e.addEventListener("contextmenu",Yi,{signal:i}),e.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:i});const r=a=>{a.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#h&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#m}})};return e.addEventListener("click",r,{capture:!0,signal:i}),e.addEventListener("keydown",a=>{a.target===e&&a.key==="Enter"&&(this.#r=!0,r(a))},{signal:i}),await this.#g(),e}get#m(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#i&&(this.#i.focus({focusVisible:this.#r}),this.#r=!1)}isEmpty(){return this.#h?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#h?this.#e!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(e){this.#e===null&&(this.#l=e,this.#f=await Cr._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e}),this.#g())}toggleAltTextBadge(e=!1){if(!this.#h||this.#e){this.#o?.remove(),this.#o=null;return}if(!this.#o){const t=this.#o=document.createElement("div");t.className="noAltTextBadge",this.#c.div.append(t)}this.#o.classList.toggle("hidden",!e)}serialize(e){let t=this.#e;return!e&&this.#l===t&&(t=this.#f),{altText:t,decorative:this.#t,guessedText:this.#l,textWithDisclaimer:this.#f}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:e,decorative:t,guessedText:i,textWithDisclaimer:r,cancel:a=!1}){i&&(this.#l=i,this.#f=r),!(this.#e===e&&this.#t===t)&&(a||(this.#e=e,this.#t=t),this.#g())}toggle(e=!1){this.#i&&(!e&&this.#s&&(clearTimeout(this.#s),this.#s=null),this.#i.disabled=!e)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#m}})}destroy(){this.#i?.remove(),this.#i=null,this.#n=null,this.#a=null,this.#o?.remove(),this.#o=null}async#g(){const e=this.#i;if(!e)return;if(this.#h){if(e.classList.toggle("done",!!this.#e),e.setAttribute("data-l10n-id",Cr.#d[this.#m]),this.#n?.setAttribute("data-l10n-id",Cr.#d[`${this.#m}-label`]),!this.#e){this.#a?.remove();return}}else{if(!this.#e&&!this.#t){e.classList.remove("done"),this.#a?.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=this.#a;if(!t){this.#a=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${this.#c.id}`;const r=100,a=this.#c._uiManager._signal;a.addEventListener("abort",()=>{clearTimeout(this.#s),this.#s=null},{once:!0}),e.addEventListener("mouseenter",()=>{this.#s=setTimeout(()=>{this.#s=null,this.#a.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},r)},{signal:a}),e.addEventListener("mouseleave",()=>{this.#s&&(clearTimeout(this.#s),this.#s=null),this.#a?.classList.remove("show")},{signal:a})}this.#t?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=this.#e),t.parentNode||e.append(t),this.#c.getElementForAltText()?.setAttribute("aria-describedby",t.id)}}class jh{#e=null;#t=null;#i=!1;#n=null;#a=null;#s=null;#r=null;#o=null;#c=!1;#l=null;constructor(e){this.#n=e}renderForToolbar(){const e=this.#t=document.createElement("button");return e.className="comment",this.#f(e,!1)}renderForStandalone(){const e=this.#e=document.createElement("button");e.className="annotationCommentButton";const t=this.#n.commentButtonPosition;if(t){const{style:i}=e;i.insetInlineEnd=`calc(${100*(this.#n._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,i.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const r=this.#n.commentButtonColor;r&&(i.backgroundColor=r)}return this.#f(e,!0)}focusButton(){setTimeout(()=>{(this.#e??this.#t)?.focus()},0)}onUpdatedColor(){if(!this.#e)return;const e=this.#n.commentButtonColor;e&&(this.#e.style.backgroundColor=e),this.#n._uiManager.updatePopupColor(this.#n)}get commentButtonWidth(){return(this.#e?.getBoundingClientRect().width??0)/this.#n.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#e)return null;const{x:e,y:t,height:i}=this.#e.getBoundingClientRect(),{x:r,y:a,width:o,height:c}=this.#n.parent.boundingClientRect;return[(e-r)/o,(t+i-a)/c]}set commentPopupPositionInLayer(e){this.#l=e}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#e?.remove(),this.#e=null}removeToolbarCommentButton(){this.#t?.remove(),this.#t=null}setCommentButtonStates({selected:e,hasPopup:t}){this.#e&&(this.#e.classList.toggle("selected",e),this.#e.ariaExpanded=t)}#f(e,t){if(!this.#n._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[this.#n._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const i=this.#n._uiManager._signal;if(!(i instanceof AbortSignal)||i.aborted)return e;e.addEventListener("contextmenu",Yi,{signal:i}),t&&(e.addEventListener("focusin",a=>{this.#n._focusEventsAllowed=!1,Yt(a)},{capture:!0,signal:i}),e.addEventListener("focusout",a=>{this.#n._focusEventsAllowed=!0,Yt(a)},{capture:!0,signal:i})),e.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:i});const r=a=>{a.preventDefault(),e===this.#t?this.edit():this.#n.toggleComment(!0)};return e.addEventListener("click",r,{capture:!0,signal:i}),e.addEventListener("keydown",a=>{a.target===e&&a.key==="Enter"&&(this.#i=!0,r(a))},{signal:i}),e.addEventListener("pointerenter",()=>{this.#n.toggleComment(!1,!0)},{signal:i}),e.addEventListener("pointerleave",()=>{this.#n.toggleComment(!1,!1)},{signal:i}),e}edit(e){const t=this.commentPopupPositionInLayer;let i,r;if(t)[i,r]=t;else{[i,r]=this.#n.commentButtonPosition;const{width:p,height:g,x:m,y}=this.#n;i=m+i*p,r=y+r*g}const a=this.#n.parent.boundingClientRect,{x:o,y:c,width:h,height:f}=a;this.#n._uiManager.editComment(this.#n,o+i*h,c+r*f,{...e,parentDimensions:a})}finish(){this.#t&&(this.#t.focus({focusVisible:this.#i}),this.#i=!1)}isDeleted(){return this.#c||this.#r===""}isEmpty(){return this.#r===null}hasBeenEdited(){return this.isDeleted()||this.#r!==this.#a}serialize(){return this.data}get data(){return{text:this.#r,richText:this.#s,date:this.#o,deleted:this.isDeleted()}}set data(e){if(e!==this.#r&&(this.#s=null),e===null){this.#r="",this.#c=!0;return}this.#r=e,this.#o=new Date,this.#c=!1}setInitialText(e,t=null){this.#a=e,this.data=e,this.#o=null,this.#s=t}shown(){}destroy(){this.#t?.remove(),this.#t=null,this.#e?.remove(),this.#e=null,this.#r="",this.#s=null,this.#o=null,this.#n=null,this.#i=!1,this.#c=!1}}class qf{#e;#t=!1;#i=null;#n;#a;#s;#r;#o=null;#c;#l=null;#f;#h=null;constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:i=null,onPinchStart:r=null,onPinching:a=null,onPinchEnd:o=null,signal:c}){this.#e=e,this.#i=i,this.#n=t,this.#a=r,this.#s=a,this.#r=o,this.#f=new AbortController,this.#c=AbortSignal.any([c,this.#f.signal]),e.addEventListener("touchstart",this.#d.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Or.pixelRatio}#d(e){if(this.#n?.())return;if(e.touches.length===1){if(this.#o)return;const r=this.#o=new AbortController,a=AbortSignal.any([this.#c,r.signal]),o=this.#e,c={capture:!0,signal:a,passive:!1},h=f=>{f.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};o.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(Yt(f),h(f))},c),o.addEventListener("pointerup",h,c),o.addEventListener("pointercancel",h,c);return}if(!this.#h){this.#h=new AbortController;const r=AbortSignal.any([this.#c,this.#h.signal]),a=this.#e,o={signal:r,capture:!1,passive:!1};a.addEventListener("touchmove",this.#m.bind(this),o);const c=this.#g.bind(this);a.addEventListener("touchend",c,o),a.addEventListener("touchcancel",c,o),o.capture=!0,a.addEventListener("pointerdown",Yt,o),a.addEventListener("pointermove",Yt,o),a.addEventListener("pointercancel",Yt,o),a.addEventListener("pointerup",Yt,o),this.#a?.()}if(Yt(e),e.touches.length!==2||this.#i?.()){this.#l=null;return}let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]),this.#l={touch0X:t.screenX,touch0Y:t.screenY,touch1X:i.screenX,touch1Y:i.screenY}}#m(e){if(!this.#l||e.touches.length!==2)return;Yt(e);let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]);const{screenX:r,screenY:a}=t,{screenX:o,screenY:c}=i,h=this.#l,{touch0X:f,touch0Y:p,touch1X:g,touch1Y:m}=h,y=g-f,w=m-p,_=o-r,b=c-a,E=Math.hypot(_,b)||1,T=Math.hypot(y,w)||1;if(!this.#t&&Math.abs(T-E)<=qf.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=r,h.touch0Y=a,h.touch1X=o,h.touch1Y=c,!this.#t){this.#t=!0;return}const S=[(r+o)/2,(a+c)/2];this.#s?.(S,T,E)}#g(e){e.touches.length>=2||(this.#h&&(this.#h.abort(),this.#h=null,this.#r?.()),this.#l&&(Yt(e),this.#l=null,this.#t=!1))}destroy(){this.#f?.abort(),this.#f=null,this.#o?.abort(),this.#o=null}}class He{#e=null;#t=null;#i=null;#n=null;#a=null;#s=!1;#r=null;#o="";#c=null;#l=null;#f=null;#h=null;#d=null;#m="";#g=!1;#u=null;#p=!1;#v=!1;#_=!1;#y=null;#A=0;#E=0;#w=null;#C=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#x=!1;#S=He._zIndex++;static _borderLineWidth=-1;static _colorManager=new Gg;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const e=He.prototype._resizeWithKeyboard,t=Vs.TRANSLATE_SMALL,i=Vs.TRANSLATE_BIG;return Xe(this,"_resizerKeyboardManager",new cu([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,i]}],[["Escape","mac+Escape"],He.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null,this.canAddComment=!0;const{rotation:t,rawDims:{pageWidth:i,pageHeight:r,pageX:a,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,r],this.pageTranslation=[a,o];const[c,h]=this.parentDimensions;this.x=e.x/c,this.y=e.y/h,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Xe(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new sO({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(He._l10n??=e,He._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),He._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);He._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Rt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#x}set _isDraggable(e){this.#x=e,this.div?.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#S}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(this.#I(),this.#h?.remove(),this.#h=null),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#g?this.#g=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,i,r){const[a,o]=this.parentDimensions;[i,r]=this.screenToPageTranslation(i,r),this.x=(e+i)/a,this.y=(t+r)/o,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[i,r]=this.parentDimensions;this.setAt(e*i,t*r,this.width*i,this.height*r),this._onTranslated()}#k([e,t],i,r){[i,r]=this.screenToPageTranslation(i,r),this.x+=i/e,this.y+=r/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(e,t){this.#k(this.parentDimensions,e,t)}translateInPage(e,t){this.#u||=[this.x,this.y,this.width,this.height],this.#k(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){this.#u||=[this.x,this.y,this.width,this.height];const{div:i,parentDimensions:[r,a]}=this;if(this.x+=e/r,this.y+=t/a,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:g,y:m}=this.div.getBoundingClientRect();this.parent.findNewParent(this,g,m)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:c}=this;const[h,f]=this.getBaseTranslation();o+=h,c+=f;const{style:p}=i;p.left=`${(100*o).toFixed(2)}%`,p.top=`${(100*c).toFixed(2)}%`,this._onTranslating(o,c),i.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:i}=He,r=i/e,a=i/t;switch(this.rotation){case 90:return[-r,a];case 180:return[r,a];case 270:return[r,-a];default:return[-r,-a]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[i,r]}=this;let{x:a,y:o,width:c,height:h}=this;if(c*=i,h*=r,a*=i,o*=r,this._mustFixPosition)switch(e){case 0:a=Wn(a,0,i-c),o=Wn(o,0,r-h);break;case 90:a=Wn(a,0,i-h),o=Wn(o,c,r);break;case 180:a=Wn(a,c,i),o=Wn(o,h,r);break;case 270:a=Wn(a,h,i),o=Wn(o,0,r-c);break}this.x=a/=i,this.y=o/=r;const[f,p]=this.getBaseTranslation();a+=f,o+=p,t.left=`${(100*a).toFixed(2)}%`,t.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}static#R(e,t,i){switch(i){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return He.#R(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return He.#R(e,t,360-this.parentRotation)}#O(e){switch(e){case 90:{const[t,i]=this.pageDimensions;return[0,-t/i,i/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,i]=this.pageDimensions;return[0,t/i,-i/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,i]}=this;return[t*e,i*e]}setDims(){const{div:{style:e},width:t,height:i}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*i).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#P(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const i of e){const r=document.createElement("div");this.#c.append(r),r.classList.add("resizer",i),r.setAttribute("data-resizer-name",i),r.addEventListener("pointerdown",this.#N.bind(this,i),{signal:t}),r.addEventListener("contextmenu",Yi,{signal:t}),r.tabIndex=-1}this.div.prepend(this.#c)}#N(e,t){t.preventDefault();const{isMac:i}=vn.platform;if(t.button!==0||t.ctrlKey&&i)return;this.#i?.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,this.#l=[t.screenX,t.screenY];const a=new AbortController,o=this._uiManager.combinedSignal(a);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#F.bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",Yt,{passive:!1,signal:o}),window.addEventListener("contextmenu",Yi,{signal:o}),this.#f={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const c=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const f=()=>{a.abort(),this.parent.togglePointerEvents(!0),this.#i?.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=c,this.div.style.cursor=h,this.#B()};window.addEventListener("pointerup",f,{signal:o}),window.addEventListener("blur",f,{signal:o})}#L(e,t,i,r){this.width=i,this.height=r,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#B(){if(!this.#f)return;const{savedX:e,savedY:t,savedWidth:i,savedHeight:r}=this.#f;this.#f=null;const a=this.x,o=this.y,c=this.width,h=this.height;a===e&&o===t&&c===i&&h===r||this.addCommands({cmd:this.#L.bind(this,a,o,c,h),undo:this.#L.bind(this,e,t,i,r),mustExec:!0})}static _round(e){return Math.round(e*1e4)/1e4}#F(e,t){const[i,r]=this.parentDimensions,a=this.x,o=this.y,c=this.width,h=this.height,f=He.MIN_SIZE/i,p=He.MIN_SIZE/r,g=this.#O(this.rotation),m=(J,ae)=>[g[0]*J+g[2]*ae,g[1]*J+g[3]*ae],y=this.#O(360-this.rotation),w=(J,ae)=>[y[0]*J+y[2]*ae,y[1]*J+y[3]*ae];let _,b,E=!1,T=!1;switch(e){case"topLeft":E=!0,_=(J,ae)=>[0,0],b=(J,ae)=>[J,ae];break;case"topMiddle":_=(J,ae)=>[J/2,0],b=(J,ae)=>[J/2,ae];break;case"topRight":E=!0,_=(J,ae)=>[J,0],b=(J,ae)=>[0,ae];break;case"middleRight":T=!0,_=(J,ae)=>[J,ae/2],b=(J,ae)=>[0,ae/2];break;case"bottomRight":E=!0,_=(J,ae)=>[J,ae],b=(J,ae)=>[0,0];break;case"bottomMiddle":_=(J,ae)=>[J/2,ae],b=(J,ae)=>[J/2,0];break;case"bottomLeft":E=!0,_=(J,ae)=>[0,ae],b=(J,ae)=>[J,0];break;case"middleLeft":T=!0,_=(J,ae)=>[0,ae/2],b=(J,ae)=>[J,ae/2];break}const S=_(c,h),k=b(c,h);let P=m(...k);const F=He._round(a+P[0]),O=He._round(o+P[1]);let G=1,M=1,W,Y;if(t.fromKeyboard)({deltaX:W,deltaY:Y}=t);else{const{screenX:J,screenY:ae}=t,[we,Pe]=this.#l;[W,Y]=this.screenToPageTranslation(J-we,ae-Pe),this.#l[0]=J,this.#l[1]=ae}if([W,Y]=w(W/i,Y/r),E){const J=Math.hypot(c,h);G=M=Math.max(Math.min(Math.hypot(k[0]-S[0]-W,k[1]-S[1]-Y)/J,1/c,1/h),f/c,p/h)}else T?G=Wn(Math.abs(k[0]-S[0]-W),f,1)/c:M=Wn(Math.abs(k[1]-S[1]-Y),p,1)/h;const ce=He._round(c*G),ve=He._round(h*M);P=m(...b(ce,ve));const Ce=F-P[0],ke=O-P[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=ce,this.height=ve,this.x=Ce,this.y=ke,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#i?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#v)return this._editToolbar;this._editToolbar=new Ec(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,i]of e)await this._editToolbar.addButton(t,i);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#i?.destroy()}addContainer(e){const t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#i||(Cr.initialize(He._l10n),this.#i=new Cr(this),this.#e&&(this.#i.data=this.#e,this.#e=null)),this.#i}get altTextData(){return this.#i?.data}set altTextData(e){this.#i&&(this.#i.data=e)}get guessedAltText(){return this.#i?.guessedText}async setGuessedAltText(e){await this.#i?.setGuessedText(e)}serializeAltText(e){return this.#i?.serialize(e)}hasAltText(){return!!this.#i&&!this.#i.isEmpty()}hasAltTextData(){return this.#i?.hasData()??!1}focusCommentButton(){this.#n?.focusButton()}addCommentButton(){return this.canAddComment?this.#n||=new jh(this):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(this.#a){this._uiManager.isEditingMode()&&this.#a.classList.remove("hidden");return}this.hasComment&&(this.#a=this.#n.renderForStandalone(),this.div.append(this.#a))}}removeStandaloneCommentButton(){this.#n.removeStandaloneCommentButton(),this.#a=null}hideStandaloneCommentButton(){this.#a?.classList.add("hidden")}get comment(){const{data:{richText:e,text:t,date:i,deleted:r}}=this.#n;return{text:t,richText:e,date:i,deleted:r,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){this.#n||=new jh(this),this.#n.data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:i}){if(!t||(this.#n||=new jh(this),this.#n.setInitialText(e,i),!this.annotationElementId))return;const r=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);r&&this.updateFromAnnotationLayer(r)}get hasEditedComment(){return this.#n?.hasBeenEdited()}get hasDeletedComment(){return this.#n?.isDeleted()}get hasComment(){return!!this.#n&&!this.#n.isEmpty()&&!this.#n.isDeleted()}async editComment(e){this.#n||=new jh(this),this.#n.edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){this.#n.setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,r]=e.rect,[a]=this.pageDimensions,[o]=this.pageTranslation,c=o+a+1,h=r-100,f=c+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[c,h,f,r]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){this.#n.data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=this.#s?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),this.#H();const[t,i]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*i/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/i).toFixed(2)}%`);const[r,a]=this.getInitialTranslation();return this.translate(r,a),yb(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#C||=new qf({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#G.bind(this),onPinching:this.#T.bind(this),onPinchEnd:this.#b.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),e}#G(){this.#f={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#i?.toggle(!1),this.parent.togglePointerEvents(!1)}#T(e,t,i){let a=.7*(i/t)+1-.7;if(a===1)return;const o=this.#O(this.rotation),c=(F,O)=>[o[0]*F+o[2]*O,o[1]*F+o[3]*O],[h,f]=this.parentDimensions,p=this.x,g=this.y,m=this.width,y=this.height,w=He.MIN_SIZE/h,_=He.MIN_SIZE/f;a=Math.max(Math.min(a,1/m,1/y),w/m,_/y);const b=He._round(m*a),E=He._round(y*a);if(b===m&&E===y)return;this.#u||=[p,g,m,y];const T=c(m/2,y/2),S=He._round(p+T[0]),k=He._round(g+T[1]),P=c(b/2,E/2);this.x=S-P[0],this.y=k-P[1],this.width=b,this.height=E,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#b(){this.#i?.toggle(!0),this.parent.togglePointerEvents(!0),this.#B()}pointerdown(e){const{isMac:t}=vn.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#g=!0,this._isDraggable){this.#U(e);return}this.#M(e)}#M(e){const{isMac:t}=vn.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#U(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let i=!1;const r=new AbortController,a=this._uiManager.combinedSignal(r),o={capture:!0,passive:!1,signal:a},c=f=>{r.abort(),this.#r=null,this.#g=!1,this._uiManager.endDragSession()||this.#M(f),i&&this._onStopDragging()};t&&(this.#A=e.clientX,this.#E=e.clientY,this.#r=e.pointerId,this.#o=e.pointerType,window.addEventListener("pointermove",f=>{i||(i=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:p,clientY:g,pointerId:m}=f;if(m!==this.#r){Yt(f);return}const[y,w]=this.screenToPageTranslation(p-this.#A,g-this.#E);this.#A=p,this.#E=g,this._uiManager.dragSelectedEditors(y,w)},o),window.addEventListener("touchmove",Yt,o),window.addEventListener("pointerdown",f=>{f.pointerType===this.#o&&(this.#C||f.isPrimary)&&c(f),Yt(f)},o));const h=f=>{if(!this.#r||this.#r===f.pointerId){c(f);return}Yt(f)};window.addEventListener("pointerup",h,{signal:a}),window.addEventListener("blur",h,{signal:a})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#y&&clearTimeout(this.#y),this.#y=setTimeout(()=>{this.#y=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,i){e.changeParent(this),this.x=t,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,i=this.rotation){const r=this.parentScale,[a,o]=this.pageDimensions,[c,h]=this.pageTranslation,f=e/r,p=t/r,g=this.x*a,m=this.y*o,y=this.width*a,w=this.height*o;switch(i){case 0:return[g+f+c,o-m-p-w+h,g+f+y+c,o-m-p+h];case 90:return[g+p+c,o-m+f+h,g+p+w+c,o-m+f+y+h];case 180:return[g-f-y+c,o-m+p+h,g-f+c,o-m+p+w+h];case 270:return[g-p-w+c,o-m-f-y+h,g-p+c,o-m-f+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[i,r,a,o]=e,c=a-i,h=o-r;switch(this.rotation){case 0:return[i,t-o,c,h];case 90:return[i,t-r,h,c];case 180:return[a,t-r,c,h];case 270:return[a,t-o,h,c];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&He._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#n?.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:i,opacity:r,deleted:a,richText:o},uid:c,pageIndex:h,creationDate:f,modificationDate:p}=this;return{id:c,pageIndex:h,rect:this.getPDFRect(),richText:o,contentsObj:{str:e},creationDate:f,modificationDate:i||p,popupRef:!a,color:t,opacity:r}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#v=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#v=!1,!0):!1}isInEditMode(){return this.#v}shouldGetKeyboardEvents(){return this.#_}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:i,right:r}=this.getClientDimensions(),{innerHeight:a,innerWidth:o}=window;return t<o&&r>0&&e<a&&i>0}#H(){if(this.#d||!this.div)return;this.#d=new AbortController;const e=this._uiManager.combinedSignal(this.#d);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#H()}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(e,t,i){const r=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:i,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});r.rotation=e.rotation,r.#e=e.accessibilityData,r._isCopy=e.isCopy||!1;const[a,o]=r.pageDimensions,[c,h,f,p]=r.getRectInCurrentCoords(e.rect,o);return r.x=c/a,r.y=h/o,r.width=f/a,r.height=p/o,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#d?.abort(),this.#d=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),this.#y&&(clearTimeout(this.#y),this.#y=null),this.#I(),this.removeEditToolbar(),this.#w){for(const e of this.#w.values())clearTimeout(e);this.#w=null}this.parent=null,this.#C?.destroy(),this.#C=null,this.#h?.remove(),this.#h=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#P(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[i,r,a,o]=this.getPDFRect();return[He._round(i+(a-i)*e),He._round(r+(o-r)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#n.commentPopupPositionInLayer}set commentPopupPosition(e){this.#n.commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return this.#n.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#n.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){this.#n?.setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#f={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const t=this.#c.children;if(!this.#t){this.#t=Array.from(t);const o=this.#W.bind(this),c=this.#q.bind(this),h=this._uiManager._signal;for(const f of this.#t){const p=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",o,{signal:h}),f.addEventListener("blur",c,{signal:h}),f.addEventListener("focus",this.#X.bind(this,p),{signal:h}),f.setAttribute("data-l10n-id",He._l10nResizer[p])}}const i=this.#t[0];let r=0;for(const o of t){if(o===i)break;r++}const a=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(a!==r){if(a<r)for(let c=0;c<r-a;c++)this.#c.append(this.#c.firstElementChild);else if(a>r)for(let c=0;c<a-r;c++)this.#c.firstElementChild.before(this.#c.lastElementChild);let o=0;for(const c of t){const f=this.#t[o++].getAttribute("data-resizer-name");c.setAttribute("data-l10n-id",He._l10nResizer[f])}}this.#z(0),this.#_=!0,this.#c.firstElementChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#W(e){He._resizerKeyboardManager.exec(this,e)}#q(e){this.#_&&e.relatedTarget?.parentNode!==this.#c&&this.#I()}#X(e){this.#m=this.#_?e:""}#z(e){if(this.#t)for(const t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#_&&this.#F(this.#m,{deltaX:e,deltaY:t,fromKeyboard:!0})}#I(){this.#_=!1,this.#z(-1),this.#B()}_stopResizingWithKeyboard(){this.#I(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#i?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#i?.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(e){this.#p=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#w||=new Map;const{action:i}=e;let r=this.#w.get(i);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(e),this.#w.delete(i),this.#w.size===0&&(this.#w=null)},He._telemetryTimeout),this.#w.set(i,r);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#s=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#s=!0}updateFakeAnnotationElement(e){if(!this.#h&&!this.deleted){this.#h=e.addFakeAnnotation(this);return}if(this.deleted){this.#h.remove(),this.#h=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#h.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const i=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),i.before(t)}return t}resetAnnotationElement(e){const{firstElementChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}}class sO extends He{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const X_=3285377520,Gi=4294901760,Er=65535;class _b{constructor(e){this.h1=e?e&4294967295:X_,this.h2=e?e&4294967295:X_}update(e){let t,i;if(typeof e=="string"){t=new Uint8Array(e.length*2),i=0;for(let _=0,b=e.length;_<b;_++){const E=e.charCodeAt(_);E<=255?t[i++]=E:(t[i++]=E>>>8,t[i++]=E&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),i=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=i>>2,a=i-r*4,o=new Uint32Array(t.buffer,0,r);let c=0,h=0,f=this.h1,p=this.h2;const g=3432918353,m=461845907,y=g&Er,w=m&Er;for(let _=0;_<r;_++)_&1?(c=o[_],c=c*g&Gi|c*y&Er,c=c<<15|c>>>17,c=c*m&Gi|c*w&Er,f^=c,f=f<<13|f>>>19,f=f*5+3864292196):(h=o[_],h=h*g&Gi|h*y&Er,h=h<<15|h>>>17,h=h*m&Gi|h*w&Er,p^=h,p=p<<13|p>>>19,p=p*5+3864292196);switch(c=0,a){case 3:c^=t[r*4+2]<<16;case 2:c^=t[r*4+1]<<8;case 1:c^=t[r*4],c=c*g&Gi|c*y&Er,c=c<<15|c>>>17,c=c*m&Gi|c*w&Er,r&1?f^=c:p^=c}this.h1=f,this.h2=p}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Gi|e*36045&Er,t=t*4283543511&Gi|((t<<16|e>>>16)*2950163797&Gi)>>>16,e^=t>>>1,e=e*444984403&Gi|e*60499&Er,t=t*3301882366&Gi|((t<<16|e>>>16)*3120437893&Gi)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const ug=Object.freeze({map:null,hash:"",transfer:void 0});class Vg{#e=!1;#t=null;#i=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const i=this.#n.get(e);return i===void 0?t:Object.assign(t,i)}getRawValue(e){return this.#n.get(e)}remove(e){const t=this.#n.get(e);if(t!==void 0&&(t instanceof He&&this.#i.delete(t.annotationElementId),this.#n.delete(e),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const i of this.#n.values())if(i instanceof He)return;this.onAnnotationEditor(null)}}setValue(e,t){const i=this.#n.get(e);let r=!1;if(i!==void 0)for(const[a,o]of Object.entries(t))i[a]!==o&&(r=!0,i[a]=o);else r=!0,this.#n.set(e,t);r&&this.#a(),t instanceof He&&((this.#i||=new Map).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return this.#n.has(e)}get size(){return this.#n.size}#a(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new xb(this)}get serializable(){if(this.#n.size===0)return ug;const e=new Map,t=new _b,i=[],r=Object.create(null);let a=!1;for(const[o,c]of this.#n){const h=c instanceof He?c.serialize(!1,r):c;h&&(e.set(o,h),t.update(`${o}:${JSON.stringify(h)}`),a||=!!h.bitmap)}if(a)for(const o of e.values())o.bitmap&&i.push(o.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:i}:ug}get editorStats(){let e=null;const t=new Map;let i=0,r=0;for(const a of this.#n.values()){if(!(a instanceof He)){a.popup&&(a.popup.deleted?r+=1:i+=1);continue}a.isCommentDeleted?r+=1:a.hasEditedComment&&(i+=1);const o=a.telemetryFinalData;if(!o)continue;const{type:c}=o;t.has(c)||t.set(c,Object.getPrototypeOf(a).constructor),e||=Object.create(null);const h=e[c]||=new Map;for(const[f,p]of Object.entries(o)){if(f==="type")continue;let g=h.get(f);g||(g=new Map,h.set(f,g));const m=g.get(p)??0;g.set(p,m+1)}}if((r>0||i>0)&&(e||=Object.create(null),e.comments={deleted:r,edited:i}),!e)return null;for(const[a,o]of t)e[a]=o.computeTelemetryFinalData(e[a]);return e}resetModifiedIds(){this.#t=null}updateEditor(e,t){const i=this.#i?.get(e);return i?(i.updateFromAnnotationLayer(t),!0):!1}getEditor(e){return this.#i?.get(e)||null}get modifiedIds(){if(this.#t)return this.#t;const e=[];if(this.#i)for(const t of this.#i.values())t.serialize()&&e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}[Symbol.iterator](){return this.#n.entries()}}class xb extends Vg{#e;constructor(e){super();const{map:t,hash:i,transfer:r}=e.serializable,a=structuredClone(t,r?{transfer:r}:null);this.#e={map:a,hash:i,transfer:r}}get print(){Rt("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return Xe(this,"modifiedIds",{ids:new Set,hash:""})}}class aO{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:i}){if(!(!e||this.#e.has(e.loadedName))){if(lt(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:r,src:a,style:o}=e,c=new FontFace(r,a,o);this.addNativeFontFace(c);try{await c.load(),this.#e.add(r),i?.(e)}catch{We(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(c)}return}Rt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const i=e.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(r){throw We(`Failed to load font '${i.family}': '${r}'.`),e.disableFontFace=!0,r}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const r=this._queueLoadingCallback(i);this._prepareFontLoadEvent(e,r)})}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return Xe(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return Xe(this,"isSyncFontLoadingSupported",qn||vn.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(lt(!r.done,"completeRequest() cannot be called twice."),r.done=!0;i.length>0&&i[0].done;){const a=i.shift();setTimeout(a.callback,0)}}const{loadingRequests:i}=this,r={done:!1,complete:t,callback:e};return i.push(r),r}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Xe(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function i(k,P){return k.charCodeAt(P)<<24|k.charCodeAt(P+1)<<16|k.charCodeAt(P+2)<<8|k.charCodeAt(P+3)&255}function r(k,P,F,O){const G=k.substring(0,P),M=k.substring(P+F);return G+O+M}let a,o;const c=this._document.createElement("canvas");c.width=1,c.height=1;const h=c.getContext("2d");let f=0;function p(k,P){if(++f>30){We("Load test font never loaded."),P();return}if(h.font="30px "+k,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){P();return}setTimeout(p.bind(null,k,P))}const g=`lt${Date.now()}${this.loadTestFontId++}`;let m=this._loadTestFont;m=r(m,976,g.length,g);const w=16,_=1482184792;let b=i(m,w);for(a=0,o=g.length-3;a<o;a+=4)b=b-_+i(g,a)|0;a<g.length&&(b=b-_+i(g+"XXX",a)|0),m=r(m,w,4,jR(b));const E=`url(data:font/opentype;base64,${btoa(m)});`,T=`@font-face {font-family:"${g}";src:${E}}`;this.insertRule(T);const S=this._document.createElement("div");S.style.visibility="hidden",S.style.width=S.style.height="10px",S.style.position="absolute",S.style.top=S.style.left="0px";for(const k of[e.loadedName,g]){const P=this._document.createElement("span");P.textContent="Hi",P.style.fontFamily=k,S.append(P)}this._document.body.append(S),p(g,()=>{S.remove(),t.complete()})}}class oO{#e;constructor(e,t=null,i,r){this.compiledGlyphs=Object.create(null),this.#e=e,this._inspectFont=t,i&&Object.assign(this,i),r&&(this.charProcOperatorList=r)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${pb(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const i=this.loadedName+"_path_"+t;let r;try{r=e.get(i)}catch(o){We(`getPathGenerator - ignoring character: "${o}".`)}const a=vb(r?.path);return this.fontExtraProperties||e.delete(i),this.compiledGlyphs[t]=a}get black(){return this.#e.black}get bold(){return this.#e.bold}get disableFontFace(){return this.#e.disableFontFace??!1}set disableFontFace(e){Xe(this,"disableFontFace",!!e)}get fontExtraProperties(){return this.#e.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#e.isInvalidPDFjsFont}get isType3Font(){return this.#e.isType3Font}get italic(){return this.#e.italic}get missingFile(){return this.#e.missingFile}get remeasure(){return this.#e.remeasure}get vertical(){return this.#e.vertical}get ascent(){return this.#e.ascent}get defaultWidth(){return this.#e.defaultWidth}get descent(){return this.#e.descent}get bbox(){return this.#e.bbox}set bbox(e){Xe(this,"bbox",e)}get fontMatrix(){return this.#e.fontMatrix}get fallbackName(){return this.#e.fallbackName}get loadedName(){return this.#e.loadedName}get mimetype(){return this.#e.mimetype}get name(){return this.#e.name}get data(){return this.#e.data}clearData(){this.#e.clearData()}get cssFontInfo(){return this.#e.cssFontInfo}get systemFontInfo(){return this.#e.systemFontInfo}get defaultVMetrics(){return this.#e.defaultVMetrics}}class Qo{#e;#t;#i;static strings=["fontFamily","fontWeight","italicAngle"];static write(e){const t=new TextEncoder,i={};let r=0;for(const f of Qo.strings){const p=t.encode(e[f]);i[f]=p,r+=4+p.length}const a=new ArrayBuffer(r),o=new Uint8Array(a),c=new DataView(a);let h=0;for(const f of Qo.strings){const p=i[f],g=p.length;c.setUint32(h,g),o.set(p,h+4),h+=4+g}return lt(h===a.byteLength,"CssFontInfo.write: Buffer overflow"),a}constructor(e){this.#e=e,this.#t=new DataView(this.#e),this.#i=new TextDecoder}#n(e){lt(e<Qo.strings.length,"Invalid string index");let t=0;for(let r=0;r<e;r++)t+=this.#t.getUint32(t)+4;const i=this.#t.getUint32(t);return this.#i.decode(new Uint8Array(this.#e,t+4,i))}get fontFamily(){return this.#n(0)}get fontWeight(){return this.#n(1)}get italicAngle(){return this.#n(2)}}class Zo{#e;#t;#i;static strings=["css","loadedName","baseFontName","src"];static write(e){const t=new TextEncoder,i={};let r=0;for(const m of Zo.strings){const y=t.encode(e[m]);i[m]=y,r+=4+y.length}r+=4;let a,o,c=1+r;e.style&&(a=t.encode(e.style.style),o=t.encode(e.style.weight),c+=4+a.length+4+o.length);const h=new ArrayBuffer(c),f=new Uint8Array(h),p=new DataView(h);let g=0;p.setUint8(g++,e.guessFallback?1:0),p.setUint32(g,0),g+=4,r=0;for(const m of Zo.strings){const y=i[m],w=y.length;r+=4+w,p.setUint32(g,w),f.set(y,g+4),g+=4+w}return p.setUint32(g-r-4,r),e.style&&(p.setUint32(g,a.length),f.set(a,g+4),g+=4+a.length,p.setUint32(g,o.length),f.set(o,g+4),g+=4+o.length),lt(g<=h.byteLength,"SubstitionInfo.write: Buffer overflow"),h.transferToFixedLength(g)}constructor(e){this.#e=e,this.#t=new DataView(this.#e),this.#i=new TextDecoder}get guessFallback(){return this.#t.getUint8(0)!==0}#n(e){lt(e<Zo.strings.length,"Invalid string index");let t=5;for(let r=0;r<e;r++)t+=this.#t.getUint32(t)+4;const i=this.#t.getUint32(t);return this.#i.decode(new Uint8Array(this.#e,t+4,i))}get css(){return this.#n(0)}get loadedName(){return this.#n(1)}get baseFontName(){return this.#n(2)}get src(){return this.#n(3)}get style(){let e=1;e+=4+this.#t.getUint32(e);const t=this.#t.getUint32(e),i=this.#i.decode(new Uint8Array(this.#e,e+4,t));e+=4+t;const r=this.#t.getUint32(e),a=this.#i.decode(new Uint8Array(this.#e,e+4,r));return{style:i,weight:a}}}class At{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#e=Math.ceil(this.bools.length*2/8);static#t=this.#e+this.numbers.length*8;static#i=this.#t+1+8;static#n=this.#i+1+48;static#a=this.#n+1+6;#s;#r;#o;constructor({data:e,extra:t}){this.#s=e,this.#r=new TextDecoder,this.#o=new DataView(this.#s),t&&Object.assign(this,t)}#c(e){lt(e<At.bools.length,"Invalid boolean index");const t=Math.floor(e/4),i=e*2%8,r=this.#o.getUint8(t)>>i&3;return r===0?void 0:r===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(e){return lt(e<At.numbers.length,"Invalid number index"),this.#o.getFloat64(At.#e+e*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let e=At.#t;if(this.#o.getUint8(e)===0)return;e+=1;const i=[];for(let r=0;r<4;r++)i.push(this.#o.getInt16(e,!0)),e+=2;return i}get fontMatrix(){let e=At.#i;if(this.#o.getUint8(e)===0)return;e+=1;const i=[];for(let r=0;r<6;r++)i.push(this.#o.getFloat64(e,!0)),e+=8;return i}get defaultVMetrics(){let e=At.#n;if(this.#o.getUint8(e)===0)return;e+=1;const i=[];for(let r=0;r<3;r++)i.push(this.#o.getInt16(e,!0)),e+=2;return i}#f(e){lt(e<At.strings.length,"Invalid string index");let t=At.#a+4;for(let a=0;a<e;a++)t+=this.#o.getUint32(t)+4;const i=this.#o.getUint32(t),r=new Uint8Array(i);return r.set(new Uint8Array(this.#s,t+4,i)),this.#r.decode(r)}get fallbackName(){return this.#f(0)}get loadedName(){return this.#f(1)}get mimetype(){return this.#f(2)}get name(){return this.#f(3)}get data(){let e=At.#a;const t=this.#o.getUint32(e);e+=4+t;const i=this.#o.getUint32(e);e+=4+i;const r=this.#o.getUint32(e);e+=4+r;const a=this.#o.getUint32(e);if(a!==0)return new Uint8Array(this.#s,e+4,a)}clearData(){let e=At.#a;const t=this.#o.getUint32(e);e+=4+t;const i=this.#o.getUint32(e);e+=4+i;const r=this.#o.getUint32(e);e+=4+r;const a=this.#o.getUint32(e);new Uint8Array(this.#s,e+4,a).fill(0),this.#o.setUint32(e,0)}get cssFontInfo(){let e=At.#a;const t=this.#o.getUint32(e);e+=4+t;const i=this.#o.getUint32(e);e+=4+i;const r=this.#o.getUint32(e);if(r===0)return null;const a=new Uint8Array(r);return a.set(new Uint8Array(this.#s,e+4,r)),new Qo(a.buffer)}get systemFontInfo(){let e=At.#a;const t=this.#o.getUint32(e);e+=4+t;const i=this.#o.getUint32(e);if(i===0)return null;const r=new Uint8Array(i);return r.set(new Uint8Array(this.#s,e+4,i)),new Zo(r.buffer)}static write(e){const t=e.systemFontInfo?Zo.write(e.systemFontInfo):null,i=e.cssFontInfo?Qo.write(e.cssFontInfo):null,r=new TextEncoder,a={};let o=0;for(const _ of At.strings)a[_]=r.encode(e[_]),o+=4+a[_].length;const c=At.#a+4+o+4+(t?t.byteLength:0)+4+(i?i.byteLength:0)+4+(e.data?e.data.length:0),h=new ArrayBuffer(c),f=new Uint8Array(h),p=new DataView(h);let g=0;const m=At.bools.length;let y=0,w=0;for(let _=0;_<m;_++){const b=e[At.bools[_]];y|=(b===void 0?0:b?2:1)<<w,w+=2,(w===8||_===m-1)&&(p.setUint8(g++,y),y=0,w=0)}lt(g===At.#e,"FontInfo.write: Boolean properties offset mismatch");for(const _ of At.numbers)p.setFloat64(g,e[_]),g+=8;if(lt(g===At.#t,"FontInfo.write: Number properties offset mismatch"),e.bbox){p.setUint8(g++,4);for(const _ of e.bbox)p.setInt16(g,_,!0),g+=2}else p.setUint8(g++,0),g+=8;if(lt(g===At.#i,"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){p.setUint8(g++,6);for(const _ of e.fontMatrix)p.setFloat64(g,_,!0),g+=8}else p.setUint8(g++,0),g+=48;if(lt(g===At.#n,"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){p.setUint8(g++,1);for(const _ of e.defaultVMetrics)p.setInt16(g,_,!0),g+=2}else p.setUint8(g++,0),g+=6;lt(g===At.#a,"FontInfo.write: DefaultVMetrics properties offset mismatch"),p.setUint32(At.#a,0),g+=4;for(const _ of At.strings){const b=a[_],E=b.length;p.setUint32(g,E),f.set(b,g+4),g+=4+E}if(p.setUint32(At.#a,g-At.#a-4),!t)p.setUint32(g,0),g+=4;else{const _=t.byteLength;p.setUint32(g,_),lt(g+4+_<=h.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),f.set(new Uint8Array(t),g+4),g+=4+_}if(!i)p.setUint32(g,0),g+=4;else{const _=i.byteLength;p.setUint32(g,_),lt(g+4+_<=h.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),f.set(new Uint8Array(i),g+4),g+=4+_}return e.data===void 0?(p.setUint32(g,0),g+=4):(p.setUint32(g,e.data.length),f.set(e.data,g+4),g+=4+e.data.length),lt(g<=h.byteLength,"FontInfo.write: Buffer overflow"),h.transferToFixedLength(g)}}class _n{static#e=0;static#t=1;static#i=2;static#n=3;static#a=4;static#s=8;static#r=12;static#o=16;constructor(e){this.buffer=e,this.view=new DataView(e),this.data=new Uint8Array(e)}static write(e){let t,i=null,r=[],a=[],o=[],c=[],h=null,f=null;switch(e[0]){case"RadialAxial":t=e[1]==="axial"?1:2,i=e[2],o=e[3],t===1?r.push(...e[4],...e[5]):r.push(e[4][0],e[4][1],e[6],e[5][0],e[5][1],e[7]);break;case"Mesh":t=3,h=e[1],r=e[2],a=e[3],c=e[4]||[],i=e[6],f=e[7];break;default:throw new Error(`Unsupported pattern type: ${e[0]}`)}const p=Math.floor(r.length/2),g=Math.floor(a.length/3),m=o.length,y=c.length;let w=0;for(const P of c)w+=1,w=Math.ceil(w/4)*4,w+=4+P.coords.length*4,w+=4+P.colors.length*4,P.verticesPerRow!==void 0&&(w+=4);const _=20+p*8+g*3+m*8+(i?16:0)+(f?3:0)+w,b=new ArrayBuffer(_),E=new DataView(b),T=new Uint8Array(b);E.setUint8(_n.#e,t),E.setUint8(_n.#t,i?1:0),E.setUint8(_n.#i,f?1:0),E.setUint8(_n.#n,h),E.setUint32(_n.#a,p,!0),E.setUint32(_n.#s,g,!0),E.setUint32(_n.#r,m,!0),E.setUint32(_n.#o,y,!0);let S=20;new Float32Array(b,S,p*2).set(r),S+=p*8,T.set(a,S),S+=g*3;for(const[P,F]of o)E.setFloat32(S,P,!0),S+=4,E.setUint32(S,parseInt(F.slice(1),16),!0),S+=4;if(i)for(const P of i)E.setFloat32(S,P,!0),S+=4;f&&(T.set(f,S),S+=3);for(let P=0;P<c.length;P++){const F=c[P];E.setUint8(S,F.type),S+=1,S=Math.ceil(S/4)*4,E.setUint32(S,F.coords.length,!0),S+=4,new Int32Array(b,S,F.coords.length).set(F.coords),S+=F.coords.length*4,E.setUint32(S,F.colors.length,!0),S+=4,new Int32Array(b,S,F.colors.length).set(F.colors),S+=F.colors.length*4,F.verticesPerRow!==void 0&&(E.setUint32(S,F.verticesPerRow,!0),S+=4)}return b}getIR(){const e=this.view,t=this.data[_n.#e],i=!!this.data[_n.#t],r=!!this.data[_n.#i],a=e.getUint32(_n.#a,!0),o=e.getUint32(_n.#s,!0),c=e.getUint32(_n.#r,!0),h=e.getUint32(_n.#o,!0);let f=20;const p=new Float32Array(this.buffer,f,a*2);f+=a*8;const g=new Uint8Array(this.buffer,f,o*3);f+=o*3;const m=[];for(let b=0;b<c;++b){const E=e.getFloat32(f,!0);f+=4;const T=e.getUint32(f,!0);f+=4,m.push([E,`#${T.toString(16).padStart(6,"0")}`])}let y=null;if(i){y=[];for(let b=0;b<4;++b)y.push(e.getFloat32(f,!0)),f+=4}let w=null;r&&(w=new Uint8Array(this.buffer,f,3),f+=3);const _=[];for(let b=0;b<h;++b){const E=e.getUint8(f);f+=1,f=Math.ceil(f/4)*4;const T=e.getUint32(f,!0);f+=4;const S=new Int32Array(this.buffer,f,T);f+=T*4;const k=e.getUint32(f,!0);f+=4;const P=new Int32Array(this.buffer,f,k);f+=k*4;const F={type:E,coords:S,colors:P};E===sg.LATTICE&&(F.verticesPerRow=e.getUint32(f,!0),f+=4),_.push(F)}if(t===1)return["RadialAxial","axial",y,m,Array.from(p.slice(0,2)),Array.from(p.slice(2,4)),null,null];if(t===2)return["RadialAxial","radial",y,m,[p[0],p[1]],[p[3],p[4]],p[2],p[5]];if(t===3){const b=this.data[_n.#n];let E=null;if(p.length>0){let T=p[0],S=p[0],k=p[1],P=p[1];for(let F=0;F<p.length;F+=2){const O=p[F],G=p[F+1];T=T>O?O:T,k=k>G?G:k,S=S<O?O:S,P=P<G?G:P}E=[T,k,S,P]}return["Mesh",b,p,g,_,E,y,w]}throw new Error(`Unsupported pattern kind: ${t}`)}}class lO{static write(e){let t,i;return vn.isFloat16ArraySupported?(i=new ArrayBuffer(e.length*2),t=new Float16Array(i)):(i=new ArrayBuffer(e.length*4),t=new Float32Array(i)),t.set(e),i}#e;constructor(e){this.#e=e}get path(){return vn.isFloat16ArraySupported?new Float16Array(this.#e):new Float32Array(this.#e)}}function cO(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(qn)return n;const e=URL.parse(n,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function uO(n){if(qn&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return su(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n?.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Hh(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const hg=n=>typeof n=="object"&&Number.isInteger(n?.num)&&n.num>=0&&Number.isInteger(n?.gen)&&n.gen>=0,hO=n=>typeof n=="object"&&typeof n?.name=="string",fO=VR.bind(null,hg,hO);class dO{#e=new Map;#t=Promise.resolve();postMessage(e,t){const i={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(const[r]of this.#e)r.call(this,i)})}addEventListener(e,t,i=null){let r=null;if(i?.signal instanceof AbortSignal){const{signal:a}=i;if(a.aborted){We("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(e,t);r=()=>a.removeEventListener("abort",o),a.addEventListener("abort",o)}this.#e.set(t,r)}removeEventListener(e,t){this.#e.get(t)?.(),this.#e.delete(t)}terminate(){for(const[,e]of this.#e)e?.();this.#e.clear()}}const zh={DATA:1,ERROR:2},on={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Y_(){}function ai(n){if(n instanceof Gs||n instanceof ag||n instanceof H_||n instanceof vf||n instanceof Rp)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||Rt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Gs(n.message);case"InvalidPDFException":return new ag(n.message);case"PasswordException":return new H_(n.message,n.code);case"ResponseException":return new vf(n.message,n.status,n.missing);case"UnknownErrorException":return new Rp(n.message,n.details)}return new Rp(n.message,n.toString())}class _c{#e=new AbortController;constructor(e,t,i){this.sourceName=e,this.targetName=t,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",this.#t.bind(this),{signal:this.#e.signal})}#t({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#n(e);return}if(e.callback){const i=e.callbackId,r=this.callbackCapabilities[i];if(!r)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],e.callback===zh.DATA)r.resolve(e.data);else if(e.callback===zh.ERROR)r.reject(ai(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const i=this.sourceName,r=e.sourceName,a=this.comObj;Promise.try(t,e.data).then(function(o){a.postMessage({sourceName:i,targetName:r,callback:zh.DATA,callbackId:e.callbackId,data:o})},function(o){a.postMessage({sourceName:i,targetName:r,callback:zh.ERROR,callbackId:e.callbackId,reason:ai(o)})});return}if(e.streamId){this.#i(e);return}t(e.data)}on(e,t){const i=this.actionHandler;if(i[e])throw new Error(`There is already an actionName called "${e}"`);i[e]=t}send(e,t,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},i)}sendWithPromise(e,t,i){const r=this.callbackId++,a=Promise.withResolvers();this.callbackCapabilities[r]=a;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:r,data:t},i)}catch(o){a.reject(o)}return a.promise}sendWithStream(e,t,i,r){const a=this.streamId++,o=this.sourceName,c=this.targetName,h=this.comObj;return new ReadableStream({start:f=>{const p=Promise.withResolvers();return this.streamControllers[a]={controller:f,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:o,targetName:c,action:e,streamId:a,data:t,desiredSize:f.desiredSize},r),p.promise},pull:f=>{const p=Promise.withResolvers();return this.streamControllers[a].pullCall=p,h.postMessage({sourceName:o,targetName:c,stream:on.PULL,streamId:a,desiredSize:f.desiredSize}),p.promise},cancel:f=>{lt(f instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[a].cancelCall=p,this.streamControllers[a].isClosed=!0,h.postMessage({sourceName:o,targetName:c,stream:on.CANCEL,streamId:a,reason:ai(f)}),p.promise}},i)}#i(e){const t=e.streamId,i=this.sourceName,r=e.sourceName,a=this.comObj,o=this,c=this.actionHandler[e.action],h={enqueue(f,p=1,g){if(this.isCancelled)return;const m=this.desiredSize;this.desiredSize-=p,m>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),a.postMessage({sourceName:i,targetName:r,stream:on.ENQUEUE,streamId:t,chunk:f},g)},close(){this.isCancelled||(this.isCancelled=!0,a.postMessage({sourceName:i,targetName:r,stream:on.CLOSE,streamId:t}),delete o.streamSinks[t])},error(f){lt(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,a.postMessage({sourceName:i,targetName:r,stream:on.ERROR,streamId:t,reason:ai(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[t]=h,Promise.try(c,e.data,h).then(function(){a.postMessage({sourceName:i,targetName:r,stream:on.START_COMPLETE,streamId:t,success:!0})},function(f){a.postMessage({sourceName:i,targetName:r,stream:on.START_COMPLETE,streamId:t,reason:ai(f)})})}#n(e){const t=e.streamId,i=this.sourceName,r=e.sourceName,a=this.comObj,o=this.streamControllers[t],c=this.streamSinks[t];switch(e.stream){case on.START_COMPLETE:e.success?o.startCall.resolve():o.startCall.reject(ai(e.reason));break;case on.PULL_COMPLETE:e.success?o.pullCall.resolve():o.pullCall.reject(ai(e.reason));break;case on.PULL:if(!c){a.postMessage({sourceName:i,targetName:r,stream:on.PULL_COMPLETE,streamId:t,success:!0});break}c.desiredSize<=0&&e.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=e.desiredSize,Promise.try(c.onPull||Y_).then(function(){a.postMessage({sourceName:i,targetName:r,stream:on.PULL_COMPLETE,streamId:t,success:!0})},function(f){a.postMessage({sourceName:i,targetName:r,stream:on.PULL_COMPLETE,streamId:t,reason:ai(f)})});break;case on.ENQUEUE:if(lt(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case on.CLOSE:if(lt(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),this.#a(o,t);break;case on.ERROR:lt(o,"error should have stream controller"),o.controller.error(ai(e.reason)),this.#a(o,t);break;case on.CANCEL_COMPLETE:e.success?o.cancelCall.resolve():o.cancelCall.reject(ai(e.reason)),this.#a(o,t);break;case on.CANCEL:if(!c)break;const h=ai(e.reason);Promise.try(c.onCancel||Y_,h).then(function(){a.postMessage({sourceName:i,targetName:r,stream:on.CANCEL_COMPLETE,streamId:t,success:!0})},function(f){a.postMessage({sourceName:i,targetName:r,stream:on.CANCEL_COMPLETE,streamId:t,reason:ai(f)})}),c.sinkCapability.reject(h),c.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#a(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.#e?.abort(),this.#e=null}}class wb{#e=!1;constructor({enableHWA:e=!1}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(e,t);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,i){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||i<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=i}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Rt("Abstract method `_createCanvas` called.")}}class pO extends wb{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const i=this._document.createElement("canvas");return i.width=e,i.height=t,i}}class bb{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Rt("Abstract method `_fetch` called.")}}class K_ extends bb{async _fetch(e){const t=await au(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):su(t)}}class Eb{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,i,r,a){return"none"}destroy(e=!1){}}class gO extends Eb{#e;#t;#i;#n;#a;#s;#r=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#n=e,this.#a=t}get#o(){return this.#t||=new Map}get#c(){return this.#s||=new Map}get#l(){if(!this.#i){const e=this.#a.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const i=this.#a.createElementNS(Kr,"svg");i.setAttribute("width",0),i.setAttribute("height",0),this.#i=this.#a.createElementNS(Kr,"defs"),e.append(i),i.append(this.#i),this.#a.body.append(e)}return this.#i}#f(e){if(e.length===1){const h=e[0],f=new Array(256);for(let g=0;g<256;g++)f[g]=h[g]/255;const p=f.join(",");return[p,p,p]}const[t,i,r]=e,a=new Array(256),o=new Array(256),c=new Array(256);for(let h=0;h<256;h++)a[h]=t[h]/255,o[h]=i[h]/255,c[h]=r[h]/255;return[a.join(","),o.join(","),c.join(",")]}#h(e){if(this.#e===void 0){this.#e="";const t=this.#a.URL;t!==this.#a.baseURI&&(Vf(t)?We('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=hb(t,""))}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#o.get(e);if(t)return t;const[i,r,a]=this.#f(e),o=e.length===1?i:`${i}${r}${a}`;if(t=this.#o.get(o),t)return this.#o.set(e,t),t;const c=`g_${this.#n}_transfer_map_${this.#r++}`,h=this.#h(c);this.#o.set(e,h),this.#o.set(o,h);const f=this.#g(c);return this.#p(i,r,a,f),h}addHCMFilter(e,t){const i=`${e}-${t}`,r="base";let a=this.#c.get(r);if(a?.key===i||(a?(a.filter?.remove(),a.key=i,a.url="none",a.filter=null):(a={key:i,url:"none",filter:null},this.#c.set(r,a)),!e||!t))return a.url;const o=this.#_(e);e=Ne.makeHexColor(...o);const c=this.#_(t);if(t=Ne.makeHexColor(...c),this.#l.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return a.url;const h=new Array(256);for(let y=0;y<=255;y++){const w=y/255;h[y]=w<=.03928?w/12.92:((w+.055)/1.055)**2.4}const f=h.join(","),p=`g_${this.#n}_hcm_filter`,g=a.filter=this.#g(p);this.#p(f,f,f,g),this.#m(g);const m=(y,w)=>{const _=o[y]/255,b=c[y]/255,E=new Array(w+1);for(let T=0;T<=w;T++)E[T]=_+T/w*(b-_);return E.join(",")};return this.#p(m(0,5),m(1,5),m(2,5),g),a.url=this.#h(p),a.url}addAlphaFilter(e){let t=this.#o.get(e);if(t)return t;const[i]=this.#f([e]),r=`alpha_${i}`;if(t=this.#o.get(r),t)return this.#o.set(e,t),t;const a=`g_${this.#n}_alpha_map_${this.#r++}`,o=this.#h(a);this.#o.set(e,o),this.#o.set(r,o);const c=this.#g(a);return this.#v(i,c),o}addLuminosityFilter(e){let t=this.#o.get(e||"luminosity");if(t)return t;let i,r;if(e?([i]=this.#f([e]),r=`luminosity_${i}`):r="luminosity",t=this.#o.get(r),t)return this.#o.set(e,t),t;const a=`g_${this.#n}_luminosity_map_${this.#r++}`,o=this.#h(a);this.#o.set(e,o),this.#o.set(r,o);const c=this.#g(a);return this.#d(c),e&&this.#v(i,c),o}addHighlightHCMFilter(e,t,i,r,a){const o=`${t}-${i}-${r}-${a}`;let c=this.#c.get(e);if(c?.key===o||(c?(c.filter?.remove(),c.key=o,c.url="none",c.filter=null):(c={key:o,url:"none",filter:null},this.#c.set(e,c)),!t||!i))return c.url;const[h,f]=[t,i].map(this.#_.bind(this));let p=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),g=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[m,y]=[r,a].map(this.#_.bind(this));g<p&&([p,g,m,y]=[g,p,y,m]),this.#l.style.color="";const w=(E,T,S)=>{const k=new Array(256),P=(g-p)/S,F=E/255,O=(T-E)/(255*S);let G=0;for(let M=0;M<=S;M++){const W=Math.round(p+M*P),Y=F+M*O;for(let ce=G;ce<=W;ce++)k[ce]=Y;G=W+1}for(let M=G;M<256;M++)k[M]=k[G-1];return k.join(",")},_=`g_${this.#n}_hcm_${e}_filter`,b=c.filter=this.#g(_);return this.#m(b),this.#p(w(m[0],y[0],5),w(m[1],y[1],5),w(m[2],y[2],5),b),c.url=this.#h(_),c.url}destroy(e=!1){e&&this.#s?.size||(this.#i?.parentNode.parentNode.remove(),this.#i=null,this.#t?.clear(),this.#t=null,this.#s?.clear(),this.#s=null,this.#r=0)}#d(e){const t=this.#a.createElementNS(Kr,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#m(e){const t=this.#a.createElementNS(Kr,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#g(e){const t=this.#a.createElementNS(Kr,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#l.append(t),t}#u(e,t,i){const r=this.#a.createElementNS(Kr,t);r.setAttribute("type","discrete"),r.setAttribute("tableValues",i),e.append(r)}#p(e,t,i,r){const a=this.#a.createElementNS(Kr,"feComponentTransfer");r.append(a),this.#u(a,"feFuncR",e),this.#u(a,"feFuncG",t),this.#u(a,"feFuncB",i)}#v(e,t){const i=this.#a.createElementNS(Kr,"feComponentTransfer");t.append(i),this.#u(i,"feFuncA",e)}#_(e){return this.#l.style.color=e,lu(getComputedStyle(this.#l).getPropertyValue("color"))}}class Sb{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(i=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Rt("Abstract method `_fetch` called.")}}class J_ extends Sb{async _fetch(e){const t=await au(e,"arraybuffer");return new Uint8Array(t)}}class Ab{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(i=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){Rt("Abstract method `_fetch` called.")}}class Q_ extends Ab{async _fetch(e){const t=await au(e,"arraybuffer");return new Uint8Array(t)}}qn&&We("Please use the `legacy` build in Node.js environments.");async function qg(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class mO extends Eb{}class vO extends wb{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class yO extends bb{async _fetch(e){return qg(e)}}class _O extends Sb{async _fetch(e){return qg(e)}}class xO extends Ab{async _fetch(e){return qg(e)}}const Oo="__forcedDependency",{floor:Z_,ceil:ex}=Math;function $h(n,e,t,i,r,a){n[e*4+0]=Math.min(n[e*4+0],t),n[e*4+1]=Math.min(n[e*4+1],i),n[e*4+2]=Math.max(n[e*4+2],r),n[e*4+3]=Math.max(n[e*4+3],a)}const fg=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class wO{#e;#t;constructor(e,t){this.#e=e,this.#t=t}get length(){return this.#e.length}isEmpty(e){return this.#e[e]===fg}minX(e){return this.#t[e*4+0]/256}minY(e){return this.#t[e*4+1]/256}maxX(e){return(this.#t[e*4+2]+1)/256}maxY(e){return(this.#t[e*4+3]+1)/256}}const Gh=(n,e)=>{if(!n)return;let t=n.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},n.set(e,t)),t};class bO{#e={__proto__:null};#t={__proto__:null,transform:[],moveText:[],sameLineText:[],[Oo]:[]};#i=new Map;#n=[];#a=[];#s=[[1,0,0,1,0,0]];#r=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#f=new Map;#h=new Map;#d;#m;#g;#u;#p;constructor(e,t,i=!1){this.#d=e.width,this.#m=e.height,this.#v(t),i&&(this.#p=new Map)}growOperationsCount(e){e>=this.#u.length&&this.#v(e,this.#u)}#v(e,t){const i=new ArrayBuffer(e*4);this.#g=new Uint8ClampedArray(i),this.#u=new Uint32Array(i),t&&t.length>0?(this.#u.set(t),this.#u.fill(fg,t.length)):this.#u.fill(fg)}save(e){return this.#e={__proto__:this.#e},this.#t={__proto__:this.#t,transform:{__proto__:this.#t.transform},moveText:{__proto__:this.#t.moveText},sameLineText:{__proto__:this.#t.sameLineText},[Oo]:{__proto__:this.#t[Oo]}},this.#r={__proto__:this.#r},this.#n.push(e),this}restore(e){const t=Object.getPrototypeOf(this.#e);if(t===null)return this;this.#e=t,this.#t=Object.getPrototypeOf(this.#t),this.#r=Object.getPrototypeOf(this.#r);const i=this.#n.pop();return i!==void 0&&(Gh(this.#p,e)?.dependencies.add(i),this.#u[e]=this.#u[i]),this}recordOpenMarker(e){return this.#n.push(e),this}getOpenMarker(){return this.#n.length===0?null:this.#n.at(-1)}recordCloseMarker(e){const t=this.#n.pop();return t!==void 0&&(Gh(this.#p,e)?.dependencies.add(t),this.#u[e]=this.#u[t]),this}beginMarkedContent(e){return this.#a.push(e),this}endMarkedContent(e){const t=this.#a.pop();return t!==void 0&&(Gh(this.#p,e)?.dependencies.add(t),this.#u[e]=this.#u[t]),this}pushBaseTransform(e){return this.#s.push(Ne.multiplyByDOMMatrix(this.#s.at(-1),e.getTransform())),this}popBaseTransform(){return this.#s.length>1&&this.#s.pop(),this}recordSimpleData(e,t){return this.#e[e]=t,this}recordIncrementalData(e,t){return this.#t[e].push(t),this}resetIncrementalData(e,t){return this.#t[e].length=0,this}recordNamedData(e,t){return this.#i.set(e,t),this}recordSimpleDataFromNamed(e,t,i){this.#e[e]=this.#i.get(t)??i}recordFutureForcedDependency(e,t){return this.recordIncrementalData(Oo,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in this.#e&&this.recordFutureForcedDependency(t,this.#e[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of this.#l)this.recordFutureForcedDependency(Oo,e);return this}resetBBox(e){return this.#c!==e&&(this.#c=e,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(e,t,i,r,a,o){const c=Ne.multiplyByDOMMatrix(this.#s.at(-1),t.getTransform()),h=[1/0,1/0,-1/0,-1/0];Ne.axialAlignedBoundingBox([i,a,r,o],c,h);const f=Ne.intersect(this.#r,h);return f?(this.#r[0]=f[0],this.#r[1]=f[1],this.#r[2]=f[2],this.#r[3]=f[3]):(this.#r[0]=this.#r[1]=1/0,this.#r[2]=this.#r[3]=-1/0),this}recordBBox(e,t,i,r,a,o){const c=this.#r;if(c[0]===1/0)return this;const h=Ne.multiplyByDOMMatrix(this.#s.at(-1),t.getTransform());if(c[0]===-1/0)return Ne.axialAlignedBoundingBox([i,a,r,o],h,this.#o),this;const f=[1/0,1/0,-1/0,-1/0];return Ne.axialAlignedBoundingBox([i,a,r,o],h,f),this.#o[0]=Math.min(this.#o[0],Math.max(f[0],c[0])),this.#o[1]=Math.min(this.#o[1],Math.max(f[1],c[1])),this.#o[2]=Math.max(this.#o[2],Math.min(f[2],c[2])),this.#o[3]=Math.max(this.#o[3],Math.min(f[3],c[3])),this}recordCharacterBBox(e,t,i,r=1,a=0,o=0,c){const h=i.bbox;let f,p;if(h&&(f=h[2]!==h[0]&&h[3]!==h[1]&&this.#h.get(i),f!==!1&&(p=[0,0,0,0],Ne.axialAlignedBoundingBox(h,i.fontMatrix,p),(r!==1||a!==0||o!==0)&&Ne.scaleMinMax([r,0,0,-r,a,o],p),f)))return this.recordBBox(e,t,p[0],p[2],p[1],p[3]);if(!c)return this.recordFullPageBBox(e);const g=c();return h&&p&&f===void 0&&(f=p[0]<=a-g.actualBoundingBoxLeft&&p[2]>=a+g.actualBoundingBoxRight&&p[1]<=o-g.actualBoundingBoxAscent&&p[3]>=o+g.actualBoundingBoxDescent,this.#h.set(i,f),f)?this.recordBBox(e,t,p[0],p[2],p[1],p[3]):this.recordBBox(e,t,a-g.actualBoundingBoxLeft,a+g.actualBoundingBoxRight,o-g.actualBoundingBoxAscent,o+g.actualBoundingBoxDescent)}recordFullPageBBox(e){return this.#o[0]=Math.max(0,this.#r[0]),this.#o[1]=Math.max(0,this.#r[1]),this.#o[2]=Math.min(this.#d,this.#r[2]),this.#o[3]=Math.min(this.#m,this.#r[3]),this}getSimpleIndex(e){return this.#e[e]}recordDependencies(e,t){const i=this.#l,r=this.#e,a=this.#t;for(const o of t)o in this.#e?i.add(r[o]):o in a&&a[o].forEach(i.add,i);return this}recordNamedDependency(e,t){return this.#i.has(t)&&this.#l.add(this.#i.get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[Oo]),this.#p){const i=Gh(this.#p,e),{dependencies:r}=i;this.#l.forEach(r.add,r),this.#n.forEach(r.add,r),this.#a.forEach(r.add,r),r.delete(e),i.isRenderingOperation=!0}if(this.#c===e){const i=Z_(this.#o[0]*256/this.#d),r=Z_(this.#o[1]*256/this.#m),a=ex(this.#o[2]*256/this.#d),o=ex(this.#o[3]*256/this.#m);$h(this.#g,e,i,r,a,o);for(const c of this.#l)c!==e&&$h(this.#g,c,i,r,a,o);for(const c of this.#n)c!==e&&$h(this.#g,c,i,r,a,o);for(const c of this.#a)c!==e&&$h(this.#g,c,i,r,a,o);t||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(e,t=!1){const i=Array.from(this.#l);this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const r of i)this.recordIncrementalData("sameLineText",r);return this}bboxToClipBoxDropOperation(e,t=!1){return this.#c===e&&(this.#c=-1,this.#r[0]=Math.max(this.#r[0],this.#o[0]),this.#r[1]=Math.max(this.#r[1],this.#o[1]),this.#r[2]=Math.min(this.#r[2],this.#o[2]),this.#r[3]=Math.min(this.#r[3],this.#o[3]),t||this.#l.clear()),this}_takePendingDependencies(){const e=this.#l;return this.#l=new Set,e}_extractOperation(e){const t=this.#f.get(e);return this.#f.delete(e),t}_pushPendingDependencies(e){for(const t of e)this.#l.add(t)}take(){return this.#h.clear(),new wO(this.#u,this.#g)}takeDebugMetadata(){return this.#p}}class yf{#e;#t;#i;#n=0;#a=0;constructor(e,t,i){if(e instanceof yf&&e.#i===!!i)return e;this.#e=e,this.#t=t,this.#i=!!i}growOperationsCount(){throw new Error("Unreachable")}save(e){return this.#a++,this.#e.save(this.#t),this}restore(e){return this.#a>0&&(this.#e.restore(this.#t),this.#a--),this}recordOpenMarker(e){return this.#n++,this}getOpenMarker(){return this.#n>0?this.#t:this.#e.getOpenMarker()}recordCloseMarker(e){return this.#n--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return this.#e.pushBaseTransform(e),this}popBaseTransform(){return this.#e.popBaseTransform(),this}recordSimpleData(e,t){return this.#e.recordSimpleData(e,this.#t),this}recordIncrementalData(e,t){return this.#e.recordIncrementalData(e,this.#t),this}resetIncrementalData(e,t){return this.#e.resetIncrementalData(e,this.#t),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,i){return this.#e.recordSimpleDataFromNamed(e,t,this.#t),this}recordFutureForcedDependency(e,t){return this.#e.recordFutureForcedDependency(e,this.#t),this}inheritSimpleDataAsFutureForcedDependencies(e){return this.#e.inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#e.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return this.#i||this.#e.resetBBox(this.#t),this}recordClipBox(e,t,i,r,a,o){return this.#i||this.#e.recordClipBox(this.#t,t,i,r,a,o),this}recordBBox(e,t,i,r,a,o){return this.#i||this.#e.recordBBox(this.#t,t,i,r,a,o),this}recordCharacterBBox(e,t,i,r,a,o,c){return this.#i||this.#e.recordCharacterBBox(this.#t,t,i,r,a,o,c),this}recordFullPageBBox(e){return this.#i||this.#e.recordFullPageBBox(this.#t),this}getSimpleIndex(e){return this.#e.getSimpleIndex(e)}recordDependencies(e,t){return this.#e.recordDependencies(this.#t,t),this}recordNamedDependency(e,t){return this.#e.recordNamedDependency(this.#t,t),this}recordOperation(e){return this.#e.recordOperation(this.#t,!0),this}recordShowTextOperation(e){return this.#e.recordShowTextOperation(this.#t,!0),this}bboxToClipBoxDropOperation(e){return this.#i||this.#e.bboxToClipBoxDropOperation(this.#t,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const Vi={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},Mn={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function dg(n,e){if(!e)return;const t=e[2]-e[0],i=e[3]-e[1],r=new Path2D;r.rect(e[0],e[1],t,i),n.clip(r)}class Wg{isModifyingCurrentTransform(){return!1}getPattern(){Rt("Abstract method `getPattern` called.")}}class EO extends Wg{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}isOriginBased(){return this._p0[0]===0&&this._p0[1]===0&&(!this.isRadial()||this._p1[0]===0&&this._p1[1]===0)}isRadial(){return this._type==="radial"}_createGradient(e,t=null){let i,r=this._p0,a=this._p1;if(t&&(r=r.slice(),a=a.slice(),Ne.applyTransform(r,t),Ne.applyTransform(a,t)),this._type==="axial")i=e.createLinearGradient(r[0],r[1],a[0],a[1]);else if(this._type==="radial"){let o=this._r0,c=this._r1;if(t){const h=new Float32Array(2);Ne.singularValueDecompose2dScale(t,h),o*=h[0],c*=h[0]}i=e.createRadialGradient(r[0],r[1],o,a[0],a[1],c)}for(const o of this._colorStops)i.addColorStop(o[0],o[1]);return i}getPattern(e,t,i,r){let a;if(r===Mn.STROKE||r===Mn.FILL){if(this.isOriginBased()){let m=Ne.transform(i,t.baseTransform);this.matrix&&(m=Ne.transform(m,this.matrix));const y=.001,w=Math.hypot(m[0],m[1]),_=Math.hypot(m[2],m[3]),b=(m[0]*m[2]+m[1]*m[3])/(w*_);if(Math.abs(b)<y)if(this.isRadial()){if(Math.abs(w-_)<y)return this._createGradient(e,m)}else return this._createGradient(e,m)}const o=t.current.getClippedPathBoundingBox(r,zt(e))||[0,0,0,0],c=Math.ceil(o[2]-o[0])||1,h=Math.ceil(o[3]-o[1])||1,f=t.cachedCanvases.getCanvas("pattern",c,h),p=f.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-o[0],-o[1]),i=Ne.transform(i,[1,0,0,1,o[0],o[1]]),p.transform(...t.baseTransform),this.matrix&&p.transform(...this.matrix),dg(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),a=e.createPattern(f.canvas,"no-repeat");const g=new DOMMatrix(i);a.setTransform(g)}else dg(e,this._bbox),a=this._createGradient(e);return a}}function Dp(n,e,t,i,r,a,o,c){const h=e.coords,f=e.colors,p=n.data,g=n.width*4;let m;h[t+1]>h[i+1]&&(m=t,t=i,i=m,m=a,a=o,o=m),h[i+1]>h[r+1]&&(m=i,i=r,r=m,m=o,o=c,c=m),h[t+1]>h[i+1]&&(m=t,t=i,i=m,m=a,a=o,o=m);const y=(h[t]+e.offsetX)*e.scaleX,w=(h[t+1]+e.offsetY)*e.scaleY,_=(h[i]+e.offsetX)*e.scaleX,b=(h[i+1]+e.offsetY)*e.scaleY,E=(h[r]+e.offsetX)*e.scaleX,T=(h[r+1]+e.offsetY)*e.scaleY;if(w>=T)return;const S=f[a],k=f[a+1],P=f[a+2],F=f[o],O=f[o+1],G=f[o+2],M=f[c],W=f[c+1],Y=f[c+2],ce=Math.round(w),ve=Math.round(T);let Ce,ke,J,ae,we,Pe,$e,V;for(let N=ce;N<=ve;N++){if(N<b){const me=N<w?0:(w-N)/(w-b);Ce=y-(y-_)*me,ke=S-(S-F)*me,J=k-(k-O)*me,ae=P-(P-G)*me}else{let me;N>T?me=1:b===T?me=0:me=(b-N)/(b-T),Ce=_-(_-E)*me,ke=F-(F-M)*me,J=O-(O-W)*me,ae=G-(G-Y)*me}let z;N<w?z=0:N>T?z=1:z=(w-N)/(w-T),we=y-(y-E)*z,Pe=S-(S-M)*z,$e=k-(k-W)*z,V=P-(P-Y)*z;const H=Math.round(Math.min(Ce,we)),q=Math.round(Math.max(Ce,we));let oe=g*N+H*4;for(let me=H;me<=q;me++)z=(Ce-me)/(Ce-we),z<0?z=0:z>1&&(z=1),p[oe++]=ke-(ke-Pe)*z|0,p[oe++]=J-(J-$e)*z|0,p[oe++]=ae-(ae-V)*z|0,p[oe++]=255}}function SO(n,e,t){const i=e.coords,r=e.colors;let a,o;switch(e.type){case sg.LATTICE:const c=e.verticesPerRow,h=Math.floor(i.length/c)-1,f=c-1;for(a=0;a<h;a++){let p=a*c;for(let g=0;g<f;g++,p++)Dp(n,t,i[p],i[p+1],i[p+c],r[p],r[p+1],r[p+c]),Dp(n,t,i[p+c+1],i[p+1],i[p+c],r[p+c+1],r[p+1],r[p+c])}break;case sg.TRIANGLES:for(a=0,o=i.length;a<o;a+=3)Dp(n,t,i[a],i[a+1],i[a+2],r[a],r[a+1],r[a+2]);break;default:throw new Error("illegal figure")}}class AO extends Wg{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,i){const c=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-c,p=Math.ceil(this._bounds[3])-h,g=Math.min(Math.ceil(Math.abs(f*e[0]*1.1)),3e3),m=Math.min(Math.ceil(Math.abs(p*e[1]*1.1)),3e3),y=f/g,w=p/m,_={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-h,scaleX:1/y,scaleY:1/w},b=g+4,E=m+4,T=i.getCanvas("mesh",b,E),S=T.context,k=S.createImageData(g,m);if(t){const F=k.data;for(let O=0,G=F.length;O<G;O+=4)F[O]=t[0],F[O+1]=t[1],F[O+2]=t[2],F[O+3]=255}for(const F of this._figures)SO(k,F,_);return S.putImageData(k,2,2),{canvas:T.canvas,offsetX:c-2*y,offsetY:h-2*w,scaleX:y,scaleY:w}}isModifyingCurrentTransform(){return!0}getPattern(e,t,i,r){dg(e,this._bbox);const a=new Float32Array(2);if(r===Mn.SHADING)Ne.singularValueDecompose2dScale(zt(e),a);else if(this.matrix){Ne.singularValueDecompose2dScale(this.matrix,a);const[c,h]=a;Ne.singularValueDecompose2dScale(t.baseTransform,a),a[0]*=c,a[1]*=h}else Ne.singularValueDecompose2dScale(t.baseTransform,a);const o=this._createMeshCanvas(a,r===Mn.SHADING?null:this._background,t.cachedCanvases);return r!==Mn.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(o.offsetX,o.offsetY),e.scale(o.scaleX,o.scaleY),e.createPattern(o.canvas,"no-repeat")}}class TO extends Wg{getPattern(){return"hotpink"}}function CO(n){switch(n[0]){case"RadialAxial":return new EO(n);case"Mesh":return new AO(n);case"Dummy":return new TO}throw new Error(`Unknown IR type: ${n[0]}`)}const tx={COLORED:1,UNCOLORED:2};class Xg{static MAX_PATTERN_SIZE=3e3;constructor(e,t,i,r){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=i,this.baseTransform=r}createPatternCanvas(e,t){const{bbox:i,operatorList:r,paintType:a,tilingType:o,color:c,canvasGraphicsFactory:h}=this;let{xstep:f,ystep:p}=this;f=Math.abs(f),p=Math.abs(p),Gf("TilingType: "+o);const g=i[0],m=i[1],y=i[2],w=i[3],_=y-g,b=w-m,E=new Float32Array(2);Ne.singularValueDecompose2dScale(this.matrix,E);const[T,S]=E;Ne.singularValueDecompose2dScale(this.baseTransform,E);const k=T*E[0],P=S*E[1];let F=_,O=b,G=!1,M=!1;const W=Math.ceil(f*k),Y=Math.ceil(p*P),ce=Math.ceil(_*k),ve=Math.ceil(b*P);W>=ce?F=f:G=!0,Y>=ve?O=p:M=!0;const Ce=this.getSizeAndScale(F,this.ctx.canvas.width,k),ke=this.getSizeAndScale(O,this.ctx.canvas.height,P),J=e.cachedCanvases.getCanvas("pattern",Ce.size,ke.size),ae=J.context,we=h.createCanvasGraphics(ae,t);if(we.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(we,a,c),ae.translate(-Ce.scale*g,-ke.scale*m),we.transform(0,Ce.scale,0,0,ke.scale,0,0),ae.save(),we.dependencyTracker?.save(),this.clipBbox(we,g,m,y,w),we.baseTransform=zt(we.ctx),we.executeOperatorList(r),we.endDrawing(),we.dependencyTracker?.restore(),ae.restore(),G||M){const Pe=J.canvas;G&&(F=f),M&&(O=p);const $e=this.getSizeAndScale(F,this.ctx.canvas.width,k),V=this.getSizeAndScale(O,this.ctx.canvas.height,P),N=$e.size,z=V.size,H=e.cachedCanvases.getCanvas("pattern-workaround",N,z),q=H.context,oe=G?Math.floor(_/f):0,me=M?Math.floor(b/p):0;for(let Re=0;Re<=oe;Re++)for(let be=0;be<=me;be++)q.drawImage(Pe,N*Re,z*be,N,z,0,0,N,z);return{canvas:H.canvas,scaleX:$e.scale,scaleY:V.scale,offsetX:g,offsetY:m}}return{canvas:J.canvas,scaleX:Ce.scale,scaleY:ke.scale,offsetX:g,offsetY:m}}getSizeAndScale(e,t,i){const r=Math.max(Xg.MAX_PATTERN_SIZE,t);let a=Math.ceil(e*i);return a>=r?a=r:i=a/e,{scale:i,size:a}}clipBbox(e,t,i,r,a){const o=r-t,c=a-i;e.ctx.rect(t,i,o,c),Ne.axialAlignedBoundingBox([t,i,r,a],zt(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,i){const r=e.ctx,a=e.current;switch(t){case tx.COLORED:const{fillStyle:o,strokeStyle:c}=this.ctx;r.fillStyle=a.fillColor=o,r.strokeStyle=a.strokeColor=c;break;case tx.UNCOLORED:r.fillStyle=r.strokeStyle=i,a.fillColor=a.strokeColor=i;break;default:throw new UR(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,i,r,a){let o=i;r!==Mn.SHADING&&(o=Ne.transform(o,t.baseTransform),this.matrix&&(o=Ne.transform(o,this.matrix)));const c=this.createPatternCanvas(t,a);let h=new DOMMatrix(o);h=h.translate(c.offsetX,c.offsetY),h=h.scale(1/c.scaleX,1/c.scaleY);const f=e.createPattern(c.canvas,"repeat");return f.setTransform(h),f}}function RO({src:n,srcPos:e=0,dest:t,width:i,height:r,nonBlackColor:a=4294967295,inverseDecode:o=!1}){const c=vn.isLittleEndian?4278190080:255,[h,f]=o?[a,c]:[c,a],p=i>>3,g=i&7,m=n.length;t=new Uint32Array(t.buffer);let y=0;for(let w=0;w<r;w++){for(const b=e+p;e<b;e++){const E=e<m?n[e]:255;t[y++]=E&128?f:h,t[y++]=E&64?f:h,t[y++]=E&32?f:h,t[y++]=E&16?f:h,t[y++]=E&8?f:h,t[y++]=E&4?f:h,t[y++]=E&2?f:h,t[y++]=E&1?f:h}if(g===0)continue;const _=e<m?n[e++]:255;for(let b=0;b<g;b++)t[y++]=_&1<<7-b?f:h}return{srcPos:e,destPos:y}}const nx=16,ix=100,OO=15,rx=10,oi=16,Np=new DOMMatrix,Si=new Float32Array(2),Xo=new Float32Array([1/0,1/0,-1/0,-1/0]);function kO(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(t,i){e.translate(t,i),this.__originalTranslate(t,i)},n.scale=function(t,i){e.scale(t,i),this.__originalScale(t,i)},n.transform=function(t,i,r,a,o,c){e.transform(t,i,r,a,o,c),this.__originalTransform(t,i,r,a,o,c)},n.setTransform=function(t,i,r,a,o,c){e.setTransform(t,i,r,a,o,c),this.__originalSetTransform(t,i,r,a,o,c)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(t){e.rotate(t),this.__originalRotate(t)},n.clip=function(t){e.clip(t),this.__originalClip(t)},n.moveTo=function(t,i){e.moveTo(t,i),this.__originalMoveTo(t,i)},n.lineTo=function(t,i){e.lineTo(t,i),this.__originalLineTo(t,i)},n.bezierCurveTo=function(t,i,r,a,o,c){e.bezierCurveTo(t,i,r,a,o,c),this.__originalBezierCurveTo(t,i,r,a,o,c)},n.rect=function(t,i,r,a){e.rect(t,i,r,a),this.__originalRect(t,i,r,a)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class DO{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,i){let r;return this.cache[e]!==void 0?(r=this.cache[e],this.canvasFactory.reset(r,t,i)):(r=this.canvasFactory.create(t,i),this.cache[e]=r),r}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Vh(n,e,t,i,r,a,o,c,h,f){const[p,g,m,y,w,_]=zt(n);if(g===0&&m===0){const T=o*p+w,S=Math.round(T),k=c*y+_,P=Math.round(k),F=(o+h)*p+w,O=Math.abs(Math.round(F)-S)||1,G=(c+f)*y+_,M=Math.abs(Math.round(G)-P)||1;return n.setTransform(Math.sign(p),0,0,Math.sign(y),S,P),n.drawImage(e,t,i,r,a,0,0,O,M),n.setTransform(p,g,m,y,w,_),[O,M]}if(p===0&&y===0){const T=c*m+w,S=Math.round(T),k=o*g+_,P=Math.round(k),F=(c+f)*m+w,O=Math.abs(Math.round(F)-S)||1,G=(o+h)*g+_,M=Math.abs(Math.round(G)-P)||1;return n.setTransform(0,Math.sign(g),Math.sign(m),0,S,P),n.drawImage(e,t,i,r,a,0,0,M,O),n.setTransform(p,g,m,y,w,_),[M,O]}n.drawImage(e,t,i,r,a,o,c,h,f);const b=Math.hypot(p,g),E=Math.hypot(m,y);return[b*h,E*f]}class sx{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=rg;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=pn.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(e,t,i){i?.(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=Xo.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=Mn.FILL,t=null){const i=this.minMax.slice();if(e===Mn.STROKE){t||Rt("Stroke bounding box must include transform."),Ne.singularValueDecompose2dScale(t,Si);const r=Si[0]*this.lineWidth/2,a=Si[1]*this.lineWidth/2;i[0]-=r,i[1]-=a,i[2]+=r,i[3]+=a}return i}updateClipFromPath(){const e=Ne.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(Xo,0)}getClippedPathBoundingBox(e=Mn.FILL,t=null){return Ne.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function ax(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,i=e.width,r=t%oi,a=(t-r)/oi,o=r===0?a:a+1,c=n.createImageData(i,oi);let h=0,f;const p=e.data,g=c.data;let m,y,w,_;if(e.kind===hf.GRAYSCALE_1BPP){const b=p.byteLength,E=new Uint32Array(g.buffer,0,g.byteLength>>2),T=E.length,S=i+7>>3,k=4294967295,P=vn.isLittleEndian?4278190080:255;for(m=0;m<o;m++){for(w=m<a?oi:r,f=0,y=0;y<w;y++){const F=b-h;let O=0;const G=F>S?i:F*8-7,M=G&-8;let W=0,Y=0;for(;O<M;O+=8)Y=p[h++],E[f++]=Y&128?k:P,E[f++]=Y&64?k:P,E[f++]=Y&32?k:P,E[f++]=Y&16?k:P,E[f++]=Y&8?k:P,E[f++]=Y&4?k:P,E[f++]=Y&2?k:P,E[f++]=Y&1?k:P;for(;O<G;O++)W===0&&(Y=p[h++],W=128),E[f++]=Y&W?k:P,W>>=1}for(;f<T;)E[f++]=0;n.putImageData(c,0,m*oi)}}else if(e.kind===hf.RGBA_32BPP){for(y=0,_=i*oi*4,m=0;m<a;m++)g.set(p.subarray(h,h+_)),h+=_,n.putImageData(c,0,y),y+=oi;m<o&&(_=i*r*4,g.set(p.subarray(h,h+_)),n.putImageData(c,0,y))}else if(e.kind===hf.RGB_24BPP)for(w=oi,_=i*w,m=0;m<o;m++){for(m>=a&&(w=r,_=i*w),f=0,y=_;y--;)g[f++]=p[h++],g[f++]=p[h++],g[f++]=p[h++],g[f++]=255;n.putImageData(c,0,m*oi)}else throw new Error(`bad image kind: ${e.kind}`)}function ox(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,i=e.width,r=t%oi,a=(t-r)/oi,o=r===0?a:a+1,c=n.createImageData(i,oi);let h=0;const f=e.data,p=c.data;for(let g=0;g<o;g++){const m=g<a?oi:r;({srcPos:h}=RO({src:f,srcPos:h,dest:p,width:i,height:m,nonBlackColor:0})),n.putImageData(c,0,g*oi)}}function dc(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of t)n[i]!==void 0&&(e[i]=n[i]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function qh(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}function lx(n,e){if(e)return!0;Ne.singularValueDecompose2dScale(n,Si);const t=Math.fround(Or.pixelRatio*ll.PDF_TO_CSS_UNITS);return Si[0]<=t&&Si[1]<=t}const NO=["butt","round","square"],MO=["miter","round","bevel"],LO={},cx={};class el{constructor(e,t,i,r,a,{optionalContentConfig:o,markedContentStack:c=null},h,f,p){this.ctx=e,this.current=new sx(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=i,this.canvasFactory=r,this.filterFactory=a,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=o,this.cachedCanvases=new DO(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=p??null}getObject(e,t,i=null){return typeof t=="string"?(this.dependencyTracker?.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):i}beginDrawing({transform:e,viewport:t,transparency:i=!1,background:r=null}){const a=this.ctx.canvas.width,o=this.ctx.canvas.height,c=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,a,o),this.ctx.fillStyle=c,i){const h=this.cachedCanvases.getCanvas("transparent",a,o);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...zt(this.compositeCtx))}this.ctx.save(),qh(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=zt(this.ctx)}executeOperatorList(e,t,i,r,a){const o=e.argsArray,c=e.fnArray;let h=t||0;const f=o.length;if(f===h)return h;const p=f-h>rx&&typeof i=="function",g=p?Date.now()+OO:0;let m=0;const y=this.commonObjs,w=this.objs;let _,b;for(;;){if(r!==void 0&&h===r.nextBreakPoint)return r.breakIt(h,i),h;if(!a||a(h))if(_=c[h],b=o[h]??null,_!==Pc.dependency)b===null?this[_](h):this[_](h,...b);else for(const E of b){this.dependencyTracker?.recordNamedData(E,h);const T=E.startsWith("g_")?y:w;if(!T.has(E))return T.get(E,i),h}if(h++,h===f)return h;if(p&&++m>rx){if(Date.now()>g)return i(),h;m=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const i=e.width??e.displayWidth,r=e.height??e.displayHeight;let a=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),c=i,h=r,f="prescale1",p,g;for(;a>2&&c>1||o>2&&h>1;){let m=c,y=h;a>2&&c>1&&(m=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),a/=c/m),o>2&&h>1&&(y=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,o/=h/y),p=this.cachedCanvases.getCanvas(f,m,y),g=p.context,g.clearRect(0,0,m,y),g.drawImage(e,0,0,c,h,0,0,m,y),e=p.canvas,c=m,h=y,f=f==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:c,paintHeight:h}}_createMaskCanvas(e,t){const i=this.ctx,{width:r,height:a}=t,o=this.current.fillColor,c=this.current.patternFill,h=zt(i);let f,p,g,m;if((t.bitmap||t.data)&&t.count>1){const W=t.bitmap||t.data.buffer;p=JSON.stringify(c?h:[h.slice(0,4),o]),f=this._cachedBitmapsMap.get(W),f||(f=new Map,this._cachedBitmapsMap.set(W,f));const Y=f.get(p);if(Y&&!c){const ce=Math.round(Math.min(h[0],h[2])+h[4]),ve=Math.round(Math.min(h[1],h[3])+h[5]);return this.dependencyTracker?.recordDependencies(e,Vi.transformAndFill),{canvas:Y,offsetX:ce,offsetY:ve}}g=Y}g||(m=this.cachedCanvases.getCanvas("maskCanvas",r,a),ox(m.context,t));let y=Ne.transform(h,[1/r,0,0,-1/a,0,0]);y=Ne.transform(y,[1,0,0,1,0,-a]);const w=Xo.slice();Ne.axialAlignedBoundingBox([0,0,r,a],y,w);const[_,b,E,T]=w,S=Math.round(E-_)||1,k=Math.round(T-b)||1,P=this.cachedCanvases.getCanvas("fillCanvas",S,k),F=P.context,O=_,G=b;F.translate(-O,-G),F.transform(...y),g||(g=this._scaleImage(m.canvas,br(F)),g=g.img,f&&c&&f.set(p,g)),F.imageSmoothingEnabled=lx(zt(F),t.interpolate),Vh(F,g,0,0,g.width,g.height,0,0,r,a),F.globalCompositeOperation="source-in";const M=Ne.transform(br(F),[1,0,0,1,-O,-G]);return F.fillStyle=c?o.getPattern(i,this,M,Mn.FILL,e):o,F.fillRect(0,0,r,a),f&&!c&&(this.cachedCanvases.delete("fillCanvas"),f.set(p,P.canvas)),this.dependencyTracker?.recordDependencies(e,Vi.transformAndFill),{canvas:P.canvas,offsetX:Math.round(O),offsetY:Math.round(G)}}setLineWidth(e,t){this.dependencyTracker?.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){this.dependencyTracker?.recordSimpleData("lineCap",e),this.ctx.lineCap=NO[t]}setLineJoin(e,t){this.dependencyTracker?.recordSimpleData("lineJoin",e),this.ctx.lineJoin=MO[t]}setMiterLimit(e,t){this.dependencyTracker?.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,i){this.dependencyTracker?.recordSimpleData("dash",e);const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(t),r.lineDashOffset=i)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){for(const[i,r]of t)switch(i){case"LW":this.setLineWidth(e,r);break;case"LC":this.setLineCap(e,r);break;case"LJ":this.setLineJoin(e,r);break;case"ML":this.setMiterLimit(e,r);break;case"D":this.setDash(e,r[0],r[1]);break;case"RI":this.setRenderingIntent(e,r);break;case"FL":this.setFlatness(e,r);break;case"Font":this.setFont(e,r[0],r[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=r;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=r;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=r;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",e),this.current.activeSMask=r?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(r);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,i=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,a=this.cachedCanvases.getCanvas(r,t,i);this.suspendedCtx=this.ctx;const o=this.ctx=a.context;o.setTransform(this.suspendedCtx.getTransform()),dc(this.suspendedCtx,o),kO(o,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),dc(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,i,r){const a=r[0],o=r[1],c=r[2]-a,h=r[3]-o;c===0||h===0||(this.genericComposeSMask(t.context,i,c,h,t.subtype,t.backdrop,t.transferMap,a,o,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(i.canvas,0,0),e.restore())}genericComposeSMask(e,t,i,r,a,o,c,h,f,p,g){let m=e.canvas,y=h-p,w=f-g;if(o)if(y<0||w<0||y+i>m.width||w+r>m.height){const b=this.cachedCanvases.getCanvas("maskExtension",i,r),E=b.context;E.drawImage(m,-y,-w),E.globalCompositeOperation="destination-atop",E.fillStyle=o,E.fillRect(0,0,i,r),E.globalCompositeOperation="source-over",m=b.canvas,y=w=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const b=new Path2D;b.rect(y,w,i,r),e.clip(b),e.globalCompositeOperation="destination-atop",e.fillStyle=o,e.fillRect(y,w,i,r),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),a==="Alpha"&&c?t.filter=this.filterFactory.addAlphaFilter(c):a==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(c));const _=new Path2D;_.rect(h,f,i,r),t.clip(_),t.globalCompositeOperation="destination-in",t.drawImage(m,y,w,i,r,h,f,i,r),t.restore()}save(e){this.inSMaskMode&&dc(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),this.dependencyTracker?.save(e)}restore(e){if(this.dependencyTracker?.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&dc(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,i,r,a,o,c){this.dependencyTracker?.recordIncrementalData("transform",e),this.ctx.transform(t,i,r,a,o,c),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,i,r){let[a]=i;if(!r){a||=i[0]=new Path2D,this[t](e,a);return}if(this.dependencyTracker!==null){const o=t===Pc.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,r[0]-o,r[2]+o,r[1]-o,r[3]+o).recordDependencies(e,["transform"])}a instanceof Path2D||(a=i[0]=vb(a)),Ne.axialAlignedBoundingBox(r,zt(this.ctx),this.current.minMax),this[t](e,a),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,i=!0){const r=this.ctx,a=this.current.strokeColor;if(r.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof a=="object"&&a?.getPattern){const o=a.isModifyingCurrentTransform()?r.getTransform():null;if(r.save(),r.strokeStyle=a.getPattern(r,this,br(r),Mn.STROKE,e),o){const c=new Path2D;c.addPath(t,r.getTransform().invertSelf().multiplySelf(o)),t=c}this.rescaleAndStroke(t,!1),r.restore()}else this.rescaleAndStroke(t,!0);this.dependencyTracker?.recordDependencies(e,Vi.stroke),i&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(Mn.STROKE,zt(this.ctx))),r.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,i=!0){const r=this.ctx,a=this.current.fillColor,o=this.current.patternFill;let c=!1;if(o){const f=a.isModifyingCurrentTransform()?r.getTransform():null;if(this.dependencyTracker?.save(e),r.save(),r.fillStyle=a.getPattern(r,this,br(r),Mn.FILL,e),f){const p=new Path2D;p.addPath(t,r.getTransform().invertSelf().multiplySelf(f)),t=p}c=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(r.fill(t,"evenodd"),this.pendingEOFill=!1):r.fill(t)),this.dependencyTracker?.recordDependencies(e,Vi.fill),c&&(r.restore(),this.dependencyTracker?.restore(e)),i&&this.consumePath(e,t,h)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){this.ctx.fill(t),this.dependencyTracker?.recordDependencies(e,Vi.rawFillPath).recordOperation(e)}clip(e){this.dependencyTracker?.recordFutureForcedDependency("clipMode",e),this.pendingClip=LO}eoClip(e){this.dependencyTracker?.recordFutureForcedDependency("clipMode",e),this.pendingClip=cx}beginText(e){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,i=this.ctx;if(this.dependencyTracker){const{dependencyTracker:r}=this;t!==void 0&&r.recordFutureForcedDependency("textClip",r.getOpenMarker()).recordFutureForcedDependency("textClip",e),r.recordCloseMarker(e)}if(t!==void 0){const r=new Path2D,a=i.getTransform().invertSelf();for(const{transform:o,x:c,y:h,fontSize:f,path:p}of t)p&&r.addPath(p,new DOMMatrix(o).preMultiplySelf(a).translate(c,h).scale(f,-f));i.clip(r)}delete this.pendingTextPaths}setCharSpacing(e,t){this.dependencyTracker?.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){this.dependencyTracker?.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){this.dependencyTracker?.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){this.dependencyTracker?.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,i){this.dependencyTracker?.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const r=this.commonObjs.get(t),a=this.current;if(!r)throw new Error(`Can't find font for ${t}`);if(a.fontMatrix=r.fontMatrix||rg,(a.fontMatrix[0]===0||a.fontMatrix[3]===0)&&We("Invalid font matrix for font "+t),i<0?(i=-i,a.fontDirection=-1):a.fontDirection=1,this.current.font=r,this.current.fontSize=i,r.isType3Font)return;const o=r.loadedName||"sans-serif",c=r.systemFontInfo?.css||`"${o}", ${r.fallbackName}`;let h="normal";r.black?h="900":r.bold&&(h="bold");const f=r.italic?"italic":"normal";let p=i;i<nx?p=nx:i>ix&&(p=ix),this.current.fontSizeScale=i/p,this.ctx.font=`${f} ${h} ${p}px ${c}`}setTextRenderingMode(e,t){this.dependencyTracker?.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){this.dependencyTracker?.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,i){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=i}setLeadingMoveText(e,t,i){this.setLeading(e,-i),this.moveText(e,t,i)}setTextMatrix(e,t){this.dependencyTracker?.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",e);const{current:i}=this;i.textMatrix=t,i.textMatrixScale=Math.hypot(t[0],t[1]),i.x=i.lineX=0,i.y=i.lineY=0}nextLine(e){this.moveText(e,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}#i(e,t,i){const r=new Path2D;return r.addPath(e,new DOMMatrix(i).invertSelf().multiplySelf(t)),r}paintChar(e,t,i,r,a,o){const c=this.ctx,h=this.current,f=h.font,p=h.textRenderingMode,g=h.fontSize/h.fontSizeScale,m=p&pn.FILL_STROKE_MASK,y=!!(p&pn.ADD_TO_PATH_FLAG),w=h.patternFill&&!f.missingFile,_=h.patternStroke&&!f.missingFile;let b;if((f.disableFontFace||y||w||_)&&!f.missingFile&&(b=f.getPathGenerator(this.commonObjs,t)),b&&(f.disableFontFace||w||_)){c.save(),c.translate(i,r),c.scale(g,-g),this.dependencyTracker?.recordCharacterBBox(e,c,f);let E;if(m===pn.FILL||m===pn.FILL_STROKE)if(a){E=c.getTransform(),c.setTransform(...a);const T=this.#i(b,E,a);c.fill(T)}else c.fill(b);if(m===pn.STROKE||m===pn.FILL_STROKE)if(o){E||=c.getTransform(),c.setTransform(...o);const{a:T,b:S,c:k,d:P}=E,F=Ne.inverseTransform(o),O=Ne.transform([T,S,k,P,0,0],F);Ne.singularValueDecompose2dScale(O,Si),c.lineWidth*=Math.max(Si[0],Si[1])/g,c.stroke(this.#i(b,E,o))}else c.lineWidth/=g,c.stroke(b);c.restore()}else(m===pn.FILL||m===pn.FILL_STROKE)&&(c.fillText(t,i,r),this.dependencyTracker?.recordCharacterBBox(e,c,f,g,i,r,()=>c.measureText(t))),(m===pn.STROKE||m===pn.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(e,c,f,g,i,r,()=>c.measureText(t)).recordDependencies(e,Vi.stroke),c.strokeText(t,i,r));y&&((this.pendingTextPaths||=[]).push({transform:zt(c),x:i,y:r,fontSize:g,path:b}),this.dependencyTracker?.recordCharacterBBox(e,c,f,g,i,r))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let i=!1;for(let r=3;r<t.length;r+=4)if(t[r]>0&&t[r]<255){i=!0;break}return Xe(this,"isFontSubpixelAAEnabled",i)}showText(e,t){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,Vi.showText).resetBBox(e),this.current.textRenderingMode&pn.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const i=this.current,r=i.font;if(r.isType3Font){this.showType3Text(e,t),this.dependencyTracker?.recordShowTextOperation(e);return}const a=i.fontSize;if(a===0){this.dependencyTracker?.recordOperation(e);return}const o=this.ctx,c=i.fontSizeScale,h=i.charSpacing,f=i.wordSpacing,p=i.fontDirection,g=i.textHScale*p,m=t.length,y=r.vertical,w=y?1:-1,_=r.defaultVMetrics,b=a*i.fontMatrix[0],E=i.textRenderingMode===pn.FILL&&!r.disableFontFace&&!i.patternFill;o.save(),i.textMatrix&&o.transform(...i.textMatrix),o.translate(i.x,i.y+i.textRise),p>0?o.scale(g,-1):o.scale(g,1);let T,S;const k=i.textRenderingMode&pn.FILL_STROKE_MASK,P=k===pn.FILL||k===pn.FILL_STROKE,F=k===pn.STROKE||k===pn.FILL_STROKE;if(P&&i.patternFill){o.save();const Y=i.fillColor.getPattern(o,this,br(o),Mn.FILL,e);T=zt(o),o.restore(),o.fillStyle=Y}if(F&&i.patternStroke){o.save();const Y=i.strokeColor.getPattern(o,this,br(o),Mn.STROKE,e);S=zt(o),o.restore(),o.strokeStyle=Y}let O=i.lineWidth;const G=i.textMatrixScale;if(G===0||O===0?F&&(O=this.getSinglePixelWidth()):O/=G,c!==1&&(o.scale(c,c),O/=c),o.lineWidth=O,r.isInvalidPDFjsFont){const Y=[];let ce=0;for(const Ce of t)Y.push(Ce.unicode),ce+=Ce.width;const ve=Y.join("");if(o.fillText(ve,0,0),this.dependencyTracker!==null){const Ce=o.measureText(ve);this.dependencyTracker.recordBBox(e,this.ctx,-Ce.actualBoundingBoxLeft,Ce.actualBoundingBoxRight,-Ce.actualBoundingBoxAscent,Ce.actualBoundingBoxDescent).recordShowTextOperation(e)}i.x+=ce*b*g,o.restore(),this.compose();return}let M=0,W;for(W=0;W<m;++W){const Y=t[W];if(typeof Y=="number"){M+=w*Y*a/1e3;continue}let ce=!1;const ve=(Y.isSpace?f:0)+h,Ce=Y.fontChar,ke=Y.accent;let J,ae,we=Y.width;if(y){const V=Y.vmetric||_,N=-(Y.vmetric?V[1]:we*.5)*b,z=V[2]*b;we=V?-V[0]:we,J=N/c,ae=(M+z)/c}else J=M/c,ae=0;let Pe;if(r.remeasure&&we>0){Pe=o.measureText(Ce);const V=Pe.width*1e3/a*c;if(we<V&&this.isFontSubpixelAAEnabled){const N=we/V;ce=!0,o.save(),o.scale(N,1),J/=N}else we!==V&&(J+=(we-V)/2e3*a/c)}if(this.contentVisible&&(Y.isInFont||r.missingFile)){if(E&&!ke)o.fillText(Ce,J,ae),this.dependencyTracker?.recordCharacterBBox(e,o,Pe?{bbox:null}:r,a/c,J,ae,()=>Pe??o.measureText(Ce));else if(this.paintChar(e,Ce,J,ae,T,S),ke){const V=J+a*ke.offset.x/c,N=ae-a*ke.offset.y/c;this.paintChar(e,ke.fontChar,V,N,T,S)}}const $e=y?we*b-ve*p:we*b+ve*p;M+=$e,ce&&o.restore()}y?i.y-=M:i.x+=M*g,o.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(e)}showType3Text(e,t){const i=this.ctx,r=this.current,a=r.font,o=r.fontSize,c=r.fontDirection,h=a.vertical?1:-1,f=r.charSpacing,p=r.wordSpacing,g=r.textHScale*c,m=r.fontMatrix||rg,y=t.length,w=r.textRenderingMode===pn.INVISIBLE;let _,b,E,T;if(w||o===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),r.textMatrix&&i.transform(...r.textMatrix),i.translate(r.x,r.y+r.textRise),i.scale(g,c);const S=this.dependencyTracker;for(this.dependencyTracker=S?new yf(S,e):null,_=0;_<y;++_){if(b=t[_],typeof b=="number"){T=h*b*o/1e3,this.ctx.translate(T,0),r.x+=T*g;continue}const k=(b.isSpace?p:0)+f,P=a.charProcOperatorList[b.operatorListId];P?this.contentVisible&&(this.save(),i.scale(o,o),i.transform(...m),this.executeOperatorList(P),this.restore()):We(`Type3 character "${b.operatorListId}" is not available.`);const F=[b.width,0];Ne.applyTransform(F,m),E=F[0]*o+k,i.translate(E,0),r.x+=E*g}i.restore(),S&&(this.dependencyTracker=S)}setCharWidth(e,t,i){}setCharWidthAndBounds(e,t,i,r,a,o,c){const h=new Path2D;h.rect(r,a,o-r,c-a),this.ctx.clip(h),this.dependencyTracker?.recordBBox(e,this.ctx,r,o,a,c).recordClipBox(e,this.ctx,r,o,a,c),this.endPath(e)}getColorN_Pattern(e,t){let i;if(t[0]==="TilingPattern"){const r=this.baseTransform||zt(this.ctx),a={createCanvasGraphics:(o,c)=>new el(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new yf(this.dependencyTracker,c,!0):null)};i=new Xg(t,this.ctx,a,r)}else i=this._getPattern(e,t[1],t[2]);return i}setStrokeColorN(e,...t){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){this.dependencyTracker?.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){this.dependencyTracker?.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){this.dependencyTracker?.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,i=null){let r;return this.cachedPatterns.has(t)?r=this.cachedPatterns.get(t):(r=CO(this.getObject(e,t)),this.cachedPatterns.set(t,r)),i&&(r.matrix=i),r}shadingFill(e,t){if(!this.contentVisible)return;const i=this.ctx;this.save(e);const r=this._getPattern(e,t);i.fillStyle=r.getPattern(i,this,br(i),Mn.SHADING,e);const a=br(i);if(a){const{width:o,height:c}=i.canvas,h=Xo.slice();Ne.axialAlignedBoundingBox([0,0,o,c],a,h);const[f,p,g,m]=h;this.ctx.fillRect(f,p,g-f,m-p)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,Vi.transform).recordDependencies(e,Vi.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){Rt("Should not call beginInlineImage")}beginImageData(){Rt("Should not call beginImageData")}paintFormXObjectBegin(e,t,i){if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=zt(this.ctx),i)){Ne.axialAlignedBoundingBox(i,this.baseTransform,this.current.minMax);const[r,a,o,c]=i,h=new Path2D;h.rect(r,a,o-r,c-a),this.ctx.clip(h),this.dependencyTracker?.recordClipBox(e,this.ctx,r,o,a,c),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;t.isolated||Gf("TODO: Support non-isolated groups."),t.knockout&&We("Knockout groups not supported.");const r=zt(i);if(t.matrix&&i.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let a=Xo.slice();Ne.axialAlignedBoundingBox(t.bbox,zt(i),a);const o=[0,0,i.canvas.width,i.canvas.height];a=Ne.intersect(a,o)||[0,0,0,0];const c=Math.floor(a[0]),h=Math.floor(a[1]),f=Math.max(Math.ceil(a[2])-c,1),p=Math.max(Math.ceil(a[3])-h,1);this.current.startNewPathAndClipBox([0,0,f,p]);let g="groupAt"+this.groupLevel;t.smask&&(g+="_smask_"+this.smaskCounter++%2);const m=this.cachedCanvases.getCanvas(g,f,p),y=m.context;y.translate(-c,-h),y.transform(...r);let w=new Path2D;const[_,b,E,T]=t.bbox;if(w.rect(_,b,E-_,T-b),t.matrix){const S=new Path2D;S.addPath(w,new DOMMatrix(t.matrix)),w=S}y.clip(w),t.smask&&this.smaskStack.push({canvas:m.canvas,context:y,offsetX:c,offsetY:h,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(i.setTransform(1,0,0,1,0,0),i.translate(c,h),i.save()),dc(i,y),this.ctx=y,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(i),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(e,t){if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const a=zt(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...a);const o=Xo.slice();Ne.axialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],a,o),this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(e,t,i,r,a,o){if(this.#e(),qh(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),i){const c=i[2]-i[0],h=i[3]-i[1];if(o&&this.annotationCanvasMap){r=r.slice(),r[4]-=i[0],r[5]-=i[1],i=i.slice(),i[0]=i[1]=0,i[2]=c,i[3]=h,Ne.singularValueDecompose2dScale(zt(this.ctx),Si);const{viewportScale:f}=this,p=Math.ceil(c*this.outputScaleX*f),g=Math.ceil(h*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(p,g);const{canvas:m,context:y}=this.annotationCanvas;this.annotationCanvasMap.set(t,m),this.annotationCanvas.savedCtx=this.ctx,this.ctx=y,this.ctx.save(),this.ctx.setTransform(Si[0],0,0,-Si[1],0,h*Si[1]),qh(this.ctx)}else{qh(this.ctx),this.endPath(e);const f=new Path2D;f.rect(i[0],i[1],c,h),this.ctx.clip(f)}}this.current=new sx(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...r),this.transform(e,...a)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){if(!this.contentVisible)return;const i=t.count;t=this.getObject(e,t.data,t),t.count=i;const r=this.ctx,a=this._createMaskCanvas(e,t),o=a.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(o,a.offsetX,a.offsetY),this.dependencyTracker?.resetBBox(e).recordBBox(e,this.ctx,a.offsetX,a.offsetX+o.width,a.offsetY,a.offsetY+o.height).recordOperation(e),r.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,i,r=0,a=0,o,c){if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const h=this.ctx;h.save();const f=zt(h);h.transform(i,r,a,o,0,0);const p=this._createMaskCanvas(e,t);h.setTransform(1,0,0,1,p.offsetX-f[4],p.offsetY-f[5]),this.dependencyTracker?.resetBBox(e);for(let g=0,m=c.length;g<m;g+=2){const y=Ne.transform(f,[i,r,a,o,c[g],c[g+1]]);h.drawImage(p.canvas,y[4],y[5]),this.dependencyTracker?.recordBBox(e,this.ctx,y[4],y[4]+p.canvas.width,y[5],y[5]+p.canvas.height)}h.restore(),this.compose(),this.dependencyTracker?.recordOperation(e)}paintImageMaskXObjectGroup(e,t){if(!this.contentVisible)return;const i=this.ctx,r=this.current.fillColor,a=this.current.patternFill;this.dependencyTracker?.resetBBox(e).recordDependencies(e,Vi.transformAndFill);for(const o of t){const{data:c,width:h,height:f,transform:p}=o,g=this.cachedCanvases.getCanvas("maskCanvas",h,f),m=g.context;m.save();const y=this.getObject(e,c,o);ox(m,y),m.globalCompositeOperation="source-in",m.fillStyle=a?r.getPattern(m,this,br(i),Mn.FILL,e):r,m.fillRect(0,0,h,f),m.restore(),i.save(),i.transform(...p),i.scale(1,-1),Vh(i,g.canvas,0,0,h,f,0,-1,1,1),this.dependencyTracker?.recordBBox(e,i,0,h,0,f),i.restore()}this.compose(),this.dependencyTracker?.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const i=this.getObject(e,t);if(!i){We("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,i)}paintImageXObjectRepeat(e,t,i,r,a){if(!this.contentVisible)return;const o=this.getObject(e,t);if(!o){We("Dependent image isn't ready yet");return}const c=o.width,h=o.height,f=[];for(let p=0,g=a.length;p<g;p+=2)f.push({transform:[i,0,0,r,a[p],a[p+1]],x:0,y:0,w:c,h});this.paintInlineImageXObjectGroup(e,o,f)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:i,height:r}=e,a=this.cachedCanvases.getCanvas("inlineImage",i,r),o=a.context;return o.filter=this.current.transferMaps,o.drawImage(t,0,0),o.filter="none",a.canvas}paintInlineImageXObject(e,t){if(!this.contentVisible)return;const i=t.width,r=t.height,a=this.ctx;this.save(e);const{filter:o}=a;o!=="none"&&o!==""&&(a.filter="none"),a.scale(1/i,-1/r);let c;if(t.bitmap)c=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)c=t;else{const p=this.cachedCanvases.getCanvas("inlineImage",i,r).context;ax(p,t),c=this.applyTransferMapsToCanvas(p)}const h=this._scaleImage(c,br(a));a.imageSmoothingEnabled=lx(zt(a),t.interpolate),this.dependencyTracker?.resetBBox(e).recordBBox(e,a,0,i,-r,0).recordDependencies(e,Vi.imageXObject).recordOperation(e),Vh(a,h.img,0,0,h.paintWidth,h.paintHeight,0,-r,i,r),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,i){if(!this.contentVisible)return;const r=this.ctx;let a;if(t.bitmap)a=t.bitmap;else{const o=t.width,c=t.height,f=this.cachedCanvases.getCanvas("inlineImage",o,c).context;ax(f,t),a=this.applyTransferMapsToCanvas(f)}this.dependencyTracker?.resetBBox(e);for(const o of i)r.save(),r.transform(...o.transform),r.scale(1,-1),Vh(r,a,o.x,o.y,o.w,o.h,0,-1,1,1),this.dependencyTracker?.recordBBox(e,r,0,1,-1,0),r.restore();this.dependencyTracker?.recordOperation(e),this.compose()}paintSolidColorImageMask(e){this.contentVisible&&(this.dependencyTracker?.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,Vi.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,i){}beginMarkedContent(e,t){this.dependencyTracker?.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,i){this.dependencyTracker?.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){this.dependencyTracker?.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,i){const r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const a=this.ctx;this.pendingClip?(r||(this.pendingClip===cx?a.clip(t,"evenodd"):a.clip(t)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):this.dependencyTracker?.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=zt(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),i=Math.hypot(e[0],e[2]),r=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(i,r)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:i,c:r,d:a}=this.ctx.getTransform();let o,c;if(i===0&&r===0){const h=Math.abs(t),f=Math.abs(a);if(h===f)if(e===0)o=c=1/h;else{const p=h*e;o=c=p<1?1/p:1}else if(e===0)o=1/h,c=1/f;else{const p=h*e,g=f*e;o=p<1?1/p:1,c=g<1?1/g:1}}else{const h=Math.abs(t*a-i*r),f=Math.hypot(t,i),p=Math.hypot(r,a);if(e===0)o=p/h,c=f/h;else{const g=e*h;o=p>g?p/g:1,c=f>g?f/g:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=c}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:i,current:{lineWidth:r}}=this,[a,o]=this.getScaleForStroking();if(a===o){i.lineWidth=(r||1)*a,i.stroke(e);return}const c=i.getLineDash();t&&i.save(),i.scale(a,o),Np.a=1/a,Np.d=1/o;const h=new Path2D;if(h.addPath(e,Np),c.length>0){const f=Math.max(a,o);i.setLineDash(c.map(p=>p/f)),i.lineDashOffset/=f}i.lineWidth=r||1,i.stroke(h),t&&i.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}for(const n in Pc)el.prototype[n]!==void 0&&(el.prototype[Pc[n]]=el.prototype[n]);class tl{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}}class FO{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}[Symbol.iterator](){return this.#e.entries()}}const Ho=Symbol("INTERNAL");class IO{#e=!1;#t=!1;#i=!1;#n=!0;constructor(e,{name:t,intent:i,usage:r,rbGroups:a}){this.#e=!!(e&wi.DISPLAY),this.#t=!!(e&wi.PRINT),this.name=t,this.intent=i,this.usage=r,this.rbGroups=a}get visible(){if(this.#i)return this.#n;if(!this.#n)return!1;const{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,i=!1){e!==Ho&&Rt("Internal method `_setVisible` called."),this.#i=i,this.#n=t}}class PO{#e=null;#t=new Map;#i=null;#n=null;constructor(e,t=wi.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#n=e.order;for(const i of e.groups)this.#t.set(i.id,new IO(t,i));if(e.baseState==="OFF")for(const i of this.#t.values())i._setVisible(Ho,!1);for(const i of e.on)this.#t.get(i)._setVisible(Ho,!0);for(const i of e.off)this.#t.get(i)._setVisible(Ho,!1);this.#i=this.getHash()}}#a(e){const t=e.length;if(t<2)return!0;const i=e[0];for(let r=1;r<t;r++){const a=e[r];let o;if(Array.isArray(a))o=this.#a(a);else if(this.#t.has(a))o=this.#t.get(a).visible;else return We(`Optional content group not found: ${a}`),!0;switch(i){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return i==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return Gf("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(We(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#a(e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!this.#t.has(t))return We(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!this.#t.has(t))return We(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!this.#t.has(t))return We(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!this.#t.has(t))return We(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return We(`Unknown optional content policy ${e.policy}.`),!0}return We(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,i=!0){const r=this.#t.get(e);if(!r){We(`Optional content group not found: ${e}`);return}if(i&&t&&r.rbGroups.length)for(const a of r.rbGroups)for(const o of a)o!==e&&this.#t.get(o)?._setVisible(Ho,!1,!0);r._setVisible(Ho,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let i;for(const r of e){switch(r){case"ON":case"OFF":case"Toggle":i=r;continue}const a=this.#t.get(r);if(a)switch(i){case"ON":this.setVisibility(r,!0,t);break;case"OFF":this.setVisibility(r,!1,t);break;case"Toggle":this.setVisibility(r,!a.visible,t);break}}this.#e=null}get hasInitialVisibility(){return this.#i===null||this.getHash()===this.#i}getOrder(){return this.#t.size?this.#n?this.#n.slice():[...this.#t.keys()]:null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;const e=new _b;for(const[t,i]of this.#t)e.update(`${t}:${i.visible}`);return this.#e=e.hexdigest()}[Symbol.iterator](){return this.#t.entries()}}class BO{constructor(e,{disableRange:t=!1,disableStream:i=!1}){lt(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:a,progressiveDone:o,contentDispositionFilename:c}=e;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=c,a?.length>0){const h=a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength?a.buffer:new Uint8Array(a).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!i,this._isRangeSupported=!t,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((h,f)=>{this._onReceiveData({begin:h,chunk:f})}),e.addProgressListener((h,f)=>{this._onProgress({loaded:h,total:f})}),e.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const i=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const r=this._rangeReaders.some(function(a){return a._begin!==e?!1:(a._enqueue(i),!0)});lt(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){lt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new UO(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new jO(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(i),i}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}}class UO{constructor(e,t,i=!1,r=null){this._stream=e,this._done=i||!1,this._filename=zg(r)?r:null,this._queuedChunks=t||[],this._loaded=0;for(const a of this._queuedChunks)this._loaded+=a.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class jO{constructor(e,t,i){this._stream=e,this._begin=t,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function HO(n){let e=!0,t=i("filename\\*","i").exec(n);if(t){t=t[1];let p=c(t);return p=unescape(p),p=h(p),p=f(p),a(p)}if(t=o(n),t){const p=f(t);return a(p)}if(t=i("filename","i").exec(n),t){t=t[1];let p=c(t);return p=f(p),a(p)}function i(p,g){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',g)}function r(p,g){if(p){if(!/^[\x00-\xFF]+$/.test(g))return g;try{const m=new TextDecoder(p,{fatal:!0}),y=su(g);g=m.decode(y),e=!1}catch{}}return g}function a(p){return e&&/[\x80-\xff]/.test(p)&&(p=r("utf-8",p),e&&(p=r("iso-8859-1",p))),p}function o(p){const g=[];let m;const y=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(m=y.exec(p))!==null;){let[,_,b,E]=m;if(_=parseInt(_,10),_ in g){if(_===0)break;continue}g[_]=[b,E]}const w=[];for(let _=0;_<g.length&&_ in g;++_){let[b,E]=g[_];E=c(E),b&&(E=unescape(E),_===0&&(E=h(E))),w.push(E)}return w.join("")}function c(p){if(p.startsWith('"')){const g=p.slice(1).split('\\"');for(let m=0;m<g.length;++m){const y=g[m].indexOf('"');y!==-1&&(g[m]=g[m].slice(0,y),g.length=m+1),g[m]=g[m].replaceAll(/\\(.)/g,"$1")}p=g.join('"')}return p}function h(p){const g=p.indexOf("'");if(g===-1)return p;const m=p.slice(0,g),w=p.slice(g+1).replace(/^[^']*'/,"");return r(m,w)}function f(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(g,m,y,w){if(y==="q"||y==="Q")return w=w.replaceAll("_"," "),w=w.replaceAll(/=([0-9a-fA-F]{2})/g,function(_,b){return String.fromCharCode(parseInt(b,16))}),r(m,w);try{w=atob(w)}catch{}return r(m,w)})}return""}function Tb(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const i in e){const r=e[i];r!==void 0&&t.append(i,r)}return t}function Wf(n){return URL.parse(n)?.origin??null}function Cb({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:i}){const r={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(n.get("Content-Length"),10);return!Number.isInteger(a)||(r.suggestedLength=a,a<=2*t)||i||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function Rb(n){const e=n.get("Content-Disposition");if(e){let t=HO(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(zg(t))return t}return null}function uu(n,e){return new vf(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n,n===404||n===0&&e.startsWith("file:"))}function Ob(n){return n===200||n===206}function kb(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function Db(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(We(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class zO{_responseOrigin=null;constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=Tb(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return lt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new $O(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new GO(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class $O{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const i=new Headers(e.headers),r=t.url;fetch(r,kb(i,this._withCredentials,this._abortController)).then(a=>{if(e._responseOrigin=Wf(a.url),!Ob(a.status))throw uu(a.status,r);this._reader=a.body.getReader(),this._headersCapability.resolve();const o=a.headers,{allowRangeRequests:c,suggestedLength:h}=Cb({responseHeaders:o,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=c,this._contentLength=h||this._contentLength,this._filename=Rb(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Gs("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:Db(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class GO{constructor(e,t,i){this._stream=e,this._reader=null,this._loaded=0;const r=e.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const a=new Headers(e.headers);a.append("Range",`bytes=${t}-${i-1}`);const o=r.url;fetch(o,kb(a,this._withCredentials,this._abortController)).then(c=>{const h=Wf(c.url);if(h!==e._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${e._responseOrigin}".`);if(!Ob(c.status))throw uu(c.status,o);this._readCapability.resolve(),this._reader=c.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:Db(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}const Mp=200,Lp=206;function VO(n){const e=n.response;return typeof e!="string"?e:su(e).buffer}class qO{_responseOrigin=null;constructor({url:e,httpHeaders:t,withCredentials:i}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=Tb(this.isHttp,t),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,i=this.currXhrId++,r=this.pendingRequests[i]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[a,o]of this.headers)t.setRequestHeader(a,o);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),r.expectedStatus=Lp):r.expectedStatus=Mp,t.responseType="arraybuffer",lt(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,i),t.onprogress=this.onProgress.bind(this,i),r.onHeadersReceived=e.onHeadersReceived,r.onDone=e.onDone,r.onError=e.onError,r.onProgress=e.onProgress,t.send(null),i}onProgress(e,t){const i=this.pendingRequests[e];i&&i.onProgress?.(t)}onStateChange(e,t){const i=this.pendingRequests[e];if(!i)return;const r=i.xhr;if(r.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),r.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],r.status===0&&this.isHttp){i.onError(r.status);return}const a=r.status||Mp;if(!(a===Mp&&i.expectedStatus===Lp)&&a!==i.expectedStatus){i.onError(r.status);return}const c=VO(r);if(a===Lp){const h=r.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);f?i.onDone({begin:parseInt(f[1],10),chunk:c}):(We('Missing or invalid "Content-Range" header.'),i.onError(0))}else c?i.onDone({begin:0,chunk:c}):i.onError(r.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class WO{constructor(e){this._source=e,this._manager=new qO(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return lt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new XO(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const i=new YO(this._manager,e,t);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class XO{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Wf(t.responseURL);const i=t.getAllResponseHeaders(),r=new Headers(i?i.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(c=>{const[h,...f]=c.split(": ");return[h,f.join(": ")]}):[]),{allowRangeRequests:a,suggestedLength:o}=Cb({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});a&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=Rb(r),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=uu(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class YO{constructor(e,t,i){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const e=Wf(this._manager.getRequestXhr(this._requestId)?.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??=uu(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const KO=/^[a-z][a-z0-9\-+.]+:/i;function JO(n){if(KO.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class QO{constructor(e){this.source=e,this.url=JO(e.url),lt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return lt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new ZO(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new ek(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class ZO{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=uu(0,this._url.href)),this._storedError=r,this._headersCapability.reject(r)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Gs("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class ek{constructor(e,t,i){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const r=e.source;this._isStreamingSupported=!r.disableStream;const a=process.getBuiltinModule("fs");this._setReadableStream(a.createReadStream(this._url,{start:t,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const pc=Symbol("INITIAL_DATA");class Nb{#e=Object.create(null);#t(e){return this.#e[e]||={...Promise.withResolvers(),data:pc}}get(e,t=null){if(t){const r=this.#t(e);return r.promise.then(()=>t(r.data)),null}const i=this.#e[e];if(!i||i.data===pc)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return i.data}has(e){const t=this.#e[e];return!!t&&t.data!==pc}delete(e){const t=this.#e[e];return!t||t.data===pc?!1:(delete this.#e[e],!0)}resolve(e,t=null){const i=this.#t(e);i.data=t,i.resolve()}clear(){for(const e in this.#e){const{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(const e in this.#e){const{data:t}=this.#e[e];t!==pc&&(yield[e,t])}}}const tk=1e5,ux=30;class bi{#e=Promise.withResolvers();#t=null;#i=!1;#n=!!globalThis.FontInspector?.enabled;#a=null;#s=null;#r=0;#o=0;#c=null;#l=null;#f=0;#h=0;#d=Object.create(null);#m=[];#g=null;#u=[];#p=new WeakMap;#v=null;static#_=new Map;static#y=new Map;static#A=new WeakMap;static#E=null;static#w=new Set;constructor({textContentSource:e,container:t,viewport:i}){if(e instanceof ReadableStream)this.#g=e;else if(typeof e=="object")this.#g=new ReadableStream({start(h){h.enqueue(e),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#l=t,this.#h=i.scale*Or.pixelRatio,this.#f=i.rotation,this.#s={div:null,properties:null,ctx:null};const{pageWidth:r,pageHeight:a,pageX:o,pageY:c}=i.rawDims;this.#v=[1,0,0,-1,-o,c+a],this.#o=r,this.#r=a,bi.#O(),t.style.setProperty("--min-font-size",bi.#E),Ra(t,i),this.#e.promise.finally(()=>{bi.#w.delete(this),this.#s=null,this.#d=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=vn.platform;return Xe(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{this.#c.read().then(({value:t,done:i})=>{if(i){this.#e.resolve();return}this.#a??=t.lang,Object.assign(this.#d,t.styles),this.#C(t.items),e()},this.#e.reject)};return this.#c=this.#g.getReader(),bi.#w.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){const i=e.scale*Or.pixelRatio,r=e.rotation;if(r!==this.#f&&(t?.(),this.#f=r,Ra(this.#l,{rotation:r})),i!==this.#h){t?.(),this.#h=i;const a={div:null,properties:null,ctx:bi.#k(this.#a)};for(const o of this.#u)a.properties=this.#p.get(o),a.div=o,this.#S(a)}}cancel(){const e=new Gs("TextLayer task cancelled.");this.#c?.cancel(e).catch(()=>{}),this.#c=null,this.#e.reject(e)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#m}#C(e){if(this.#i)return;this.#s.ctx??=bi.#k(this.#a);const t=this.#u,i=this.#m;for(const r of e){if(t.length>tk){We("Ignoring additional textDivs for performance reasons."),this.#i=!0;return}if(r.str===void 0){if(r.type==="beginMarkedContentProps"||r.type==="beginMarkedContent"){const a=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),r.id&&this.#t.setAttribute("id",`${r.id}`),a.append(this.#t)}else r.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}i.push(r.str),this.#x(r)}}#x(e){const t=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#u.push(t);const r=Ne.transform(this.#v,e.transform);let a=Math.atan2(r[1],r[0]);const o=this.#d[e.fontName];o.vertical&&(a+=Math.PI/2);let c=this.#n&&o.fontSubstitution||o.fontFamily;c=bi.fontFamilyMap.get(c)||c;const h=Math.hypot(r[2],r[3]),f=h*bi.#P(c,o,this.#a);let p,g;a===0?(p=r[4],g=r[5]-f):(p=r[4]+f*Math.sin(a),g=r[5]-f*Math.cos(a));const m=t.style;m.left=`${(100*p/this.#o).toFixed(2)}%`,m.top=`${(100*g/this.#r).toFixed(2)}%`,m.setProperty("--font-height",`${h.toFixed(2)}px`),m.fontFamily=c,i.fontSize=h,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#n&&(t.dataset.fontName=o.fontSubstitutionLoadedName||e.fontName),a!==0&&(i.angle=a*(180/Math.PI));let y=!1;if(e.str.length>1)y=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const w=Math.abs(e.transform[0]),_=Math.abs(e.transform[3]);w!==_&&Math.max(w,_)/Math.min(w,_)>1.5&&(y=!0)}if(y&&(i.canvasWidth=o.vertical?e.height:e.width),this.#p.set(t,i),this.#s.div=t,this.#s.properties=i,this.#S(this.#s),i.hasText&&this.#t.append(t),i.hasEOL){const w=document.createElement("br");w.setAttribute("role","presentation"),this.#t.append(w)}}#S(e){const{div:t,properties:i,ctx:r}=e,{style:a}=t;if(i.canvasWidth!==0&&i.hasText){const{fontFamily:o}=a,{canvasWidth:c,fontSize:h}=i;bi.#R(r,h*this.#h,o);const{width:f}=r.measureText(t.textContent);f>0&&a.setProperty("--scale-x",c*this.#h/f)}i.angle!==0&&a.setProperty("--rotate",`${i.angle}deg`)}static cleanup(){if(!(this.#w.size>0)){this.#_.clear();for(const{canvas:e}of this.#y.values())e.remove();this.#y.clear()}}static#k(e=null){let t=this.#y.get(e||="");if(!t){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=e,document.body.append(i),t=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#y.set(e,t),this.#A.set(t,{size:0,family:""})}return t}static#R(e,t,i){const r=this.#A.get(e);t===r.size&&i===r.family||(e.font=`${t}px ${i}`,r.size=t,r.family=i)}static#O(){if(this.#E!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#E=e.getBoundingClientRect().height,e.remove()}static#P(e,t,i){const r=this.#_.get(e);if(r)return r;const a=this.#k(i);a.canvas.width=a.canvas.height=ux,this.#R(a,ux,e);const o=a.measureText(""),c=o.fontBoundingBoxAscent,h=Math.abs(o.fontBoundingBoxDescent);a.canvas.width=a.canvas.height=0;let f=.8;return c?f=c/(c+h):(vn.platform.isFirefox&&We("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?f=t.ascent:t.descent&&(f=1+t.descent)),this.#_.set(e,f),f}}const nk=100;function Mb(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new Yg,{docId:t}=e,i=n.url?cO(n.url):null,r=n.data?uO(n.data):null,a=n.httpHeaders||null,o=n.withCredentials===!0,c=n.password??null,h=n.range instanceof Lb?n.range:null,f=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let p=n.worker instanceof Uc?n.worker:null;const g=n.verbosity,m=typeof n.docBaseUrl=="string"&&!Vf(n.docBaseUrl)?n.docBaseUrl:null,y=Hh(n.cMapUrl),w=n.cMapPacked!==!1,_=n.CMapReaderFactory||(qn?yO:K_),b=Hh(n.iccUrl),E=Hh(n.standardFontDataUrl),T=n.StandardFontDataFactory||(qn?_O:J_),S=Hh(n.wasmUrl),k=n.WasmFactory||(qn?xO:Q_),P=n.stopAtErrors!==!0,F=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,O=n.isEvalSupported!==!1,G=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!qn,M=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!qn&&(vn.platform.isFirefox||!globalThis.chrome),W=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,Y=typeof n.disableFontFace=="boolean"?n.disableFontFace:qn,ce=n.fontExtraProperties===!0,ve=n.enableXfa===!0,Ce=n.ownerDocument||globalThis.document,ke=n.disableRange===!0,J=n.disableStream===!0,ae=n.disableAutoFetch===!0,we=n.pdfBug===!0,Pe=n.CanvasFactory||(qn?vO:pO),$e=n.FilterFactory||(qn?mO:gO),V=n.enableHWA===!0,N=n.useWasm!==!1,z=h?h.length:n.length??NaN,H=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!qn&&!Y,q=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(_===K_&&T===J_&&k===Q_&&y&&E&&S&&yc(y,document.baseURI)&&yc(E,document.baseURI)&&yc(S,document.baseURI)),oe=null;IR(g);const me={canvasFactory:new Pe({ownerDocument:Ce,enableHWA:V}),filterFactory:new $e({docId:t,ownerDocument:Ce}),cMapReaderFactory:q?null:new _({baseUrl:y,isCompressed:w}),standardFontDataFactory:q?null:new T({baseUrl:E}),wasmFactory:q?null:new k({baseUrl:S})};p||(p=Uc.create({verbosity:g,port:tl.workerPort}),e._worker=p);const Re={docId:t,apiVersion:"5.4.530",data:r,password:c,disableAutoFetch:ae,rangeChunkSize:f,length:z,docBaseUrl:m,enableXfa:ve,evaluatorOptions:{maxImageSize:F,disableFontFace:Y,ignoreErrors:P,isEvalSupported:O,isOffscreenCanvasSupported:G,isImageDecoderSupported:M,canvasMaxAreaInBytes:W,fontExtraProperties:ce,useSystemFonts:H,useWasm:N,useWorkerFetch:q,cMapUrl:y,iccUrl:b,standardFontDataUrl:E,wasmUrl:S}},be={ownerDocument:Ce,pdfBug:we,styleElement:oe,loadingParams:{disableAutoFetch:ae,enableXfa:ve}};return p.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const Te=p.messageHandler.sendWithPromise("GetDocRequest",Re,r?[r.buffer]:null);let it;if(h)it=new BO(h,{disableRange:ke,disableStream:J});else if(!r){if(!i)throw new Error("getDocument - no `url` parameter provided.");const Je=yc(i)?zO:qn?QO:WO;it=new Je({url:i,length:z,httpHeaders:a,withCredentials:o,rangeChunkSize:f,disableRange:ke,disableStream:J})}return Te.then(Je=>{if(e.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const Qt=new _c(t,Je,p.port),Ze=new sk(Qt,e,it,be,me,V);e._transport=Ze,Qt.send("Ready",null)})}).catch(e._capability.reject),e}class Yg{static#e=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${Yg.#e++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class Lb{#e=Promise.withResolvers();#t=[];#i=[];#n=[];#a=[];constructor(e,t,i=!1,r=null){this.length=e,this.initialData=t,this.progressiveDone=i,this.contentDispositionFilename=r}addRangeListener(e){this.#a.push(e)}addProgressListener(e){this.#n.push(e)}addProgressiveReadListener(e){this.#i.push(e)}addProgressiveDoneListener(e){this.#t.push(e)}onDataRange(e,t){for(const i of this.#a)i(e,t)}onDataProgress(e,t){this.#e.promise.then(()=>{for(const i of this.#n)i(e,t)})}onDataProgressiveRead(e){this.#e.promise.then(()=>{for(const t of this.#i)t(e)})}onDataProgressiveDone(){this.#e.promise.then(()=>{for(const e of this.#t)e()})}transportReady(){this.#e.resolve()}requestDataRange(e,t){Rt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class ik{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Xe(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(e){return this._transport.extractPages(e)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class rk{#e=!1;constructor(e,t,i,r=!1){this._pageIndex=e,this._pageInfo=t,this._transport=i,this._stats=r?new $_:null,this._pdfBug=r,this.commonObjs=i.commonObjs,this.objs=new Nb,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:i=0,offsetY:r=0,dontFlip:a=!1}={}){return new ou({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:r,dontFlip:a})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Xe(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,canvas:t=e.canvas,viewport:i,intent:r="display",annotationMode:a=Bs.ENABLE,transform:o=null,background:c=null,optionalContentConfigPromise:h=null,annotationCanvasMap:f=null,pageColors:p=null,printAnnotationStorage:g=null,isEditing:m=!1,recordOperations:y=!1,operationsFilter:w=null}){this._stats?.time("Overall");const _=this._transport.getRenderingIntent(r,a,g,m),{renderingIntent:b,cacheKey:E}=_;this.#e=!1,h||=this._transport.getOptionalContentConfig(b);let T=this._intentStates.get(E);T||(T=Object.create(null),this._intentStates.set(E,T)),T.streamReaderCancelTimeout&&(clearTimeout(T.streamReaderCancelTimeout),T.streamReaderCancelTimeout=null);const S=!!(b&wi.PRINT);T.displayReadyCapability||(T.displayReadyCapability=Promise.withResolvers(),T.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(_));const k=!!(this._pdfBug&&globalThis.StepperManager?.enabled),P=!this.recordedBBoxes&&(y||k),F=M=>{if(T.renderTasks.delete(O),P){const W=O.gfx?.dependencyTracker.take();W&&(O.stepper&&O.stepper.setOperatorBBoxes(W,O.gfx.dependencyTracker.takeDebugMetadata()),y&&(this.recordedBBoxes=W))}S&&(this.#e=!0),this.#t(),M?(O.capability.reject(M),this._abortOperatorList({intentState:T,reason:M instanceof Error?M:new Error(M)})):O.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},O=new Yo({callback:F,params:{canvas:t,canvasContext:e,dependencyTracker:P?new bO(t,T.operatorList.length,k):null,viewport:i,transform:o,background:c},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:T.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!S,pdfBug:this._pdfBug,pageColors:p,enableHWA:this._transport.enableHWA,operationsFilter:w});(T.renderTasks||=new Set).add(O);const G=O.task;return Promise.all([T.displayReadyCapability.promise,h]).then(([M,W])=>{if(this.destroyed){F();return}if(this._stats?.time("Rendering"),!(W.renderingIntent&b))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");O.initializeGraphics({transparency:M,optionalContentConfig:W}),O.operatorListChanged()}).catch(F),G}getOperatorList({intent:e="display",annotationMode:t=Bs.ENABLE,printAnnotationStorage:i=null,isEditing:r=!1}={}){function a(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(h))}const o=this._transport.getRenderingIntent(e,t,i,r,!0);let c=this._intentStates.get(o.cacheKey);c||(c=Object.create(null),this._intentStates.set(o.cacheKey,c));let h;return c.opListReadCapability||(h=Object.create(null),h.operatorListChanged=a,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||=new Set).add(h),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(o)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>Bc.textContent(i));const t=this.streamTextContent(e);return new Promise(function(i,r){function a(){o.read().then(function({value:h,done:f}){if(f){i(c);return}c.lang??=h.lang,Object.assign(c.styles,h.styles),c.items.push(...h.items),a()},r)}const o=t.getReader(),c={items:[],styles:Object.create(null),lang:null};a()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const i of t.renderTasks)e.push(i.completed),i.cancel();return this.objs.clear(),this.#e=!1,Promise.all(e)}cleanup(e=!1){this.#e=!0;const t=this.#t();return e&&t&&(this._stats&&=new $_),t}#t(){if(!this.#e||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}_startRenderPage(e,t){const i=this._intentStates.get(t);i&&(this._stats?.timeEnd("Page Request"),i.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let i=0,r=e.length;i<r;i++)t.operatorList.fnArray.push(e.fnArray[i]),t.operatorList.argsArray.push(e.argsArray[i]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const i of t.renderTasks)i.operatorListChanged();e.lastChunk&&this.#t()}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:i,modifiedIds:r}){const{map:a,transfer:o}=i,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:a,modifiedIds:r},o).getReader(),f=this._intentStates.get(t);f.streamReader=h;const p=()=>{h.read().then(({value:g,done:m})=>{if(m){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(g,f),p())},g=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const m of f.renderTasks)m.operatorListChanged();this.#t()}if(f.displayReadyCapability)f.displayReadyCapability.reject(g);else if(f.opListReadCapability)f.opListReadCapability.reject(g);else throw g}})};p()}_abortOperatorList({intentState:e,reason:t,force:i=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!i){if(e.renderTasks.size>0)return;if(t instanceof Hg){let r=nk;t.extraDelay>0&&t.extraDelay<1e3&&(r+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},r);return}}if(e.streamReader.cancel(new Gs(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[r,a]of this._intentStates)if(a===e){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}var js,or,Zr,Sa,Bf,Aa,Ta,Kn,ff,Fb,Ib,xc,ol,df;const Ht=class Ht{constructor({name:e=null,port:t=null,verbosity:i=PR()}={}){xr(this,Kn);xr(this,js,Promise.withResolvers());xr(this,or,null);xr(this,Zr,null);xr(this,Sa,null);if(this.name=e,this.destroyed=!1,this.verbosity=i,t){if(jt(Ht,Ta).has(t))throw new Error("Cannot use more than one PDFWorker per port.");jt(Ht,Ta).set(t,this),wr(this,Kn,Fb).call(this,t)}else wr(this,Kn,Ib).call(this)}get promise(){return jt(this,js).promise}get port(){return jt(this,Zr)}get messageHandler(){return jt(this,or)}destroy(){this.destroyed=!0,jt(this,Sa)?.terminate(),si(this,Sa,null),jt(Ht,Ta).delete(jt(this,Zr)),si(this,Zr,null),jt(this,or)?.destroy(),si(this,or,null)}static create(e){const t=jt(this,Ta).get(e?.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Ht(e)}static get workerSrc(){if(tl.workerSrc)return tl.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Xe(this,"_setupFakeWorkerGlobal",(async()=>jt(this,ol,df)?jt(this,ol,df):(await import(this.workerSrc)).WorkerMessageHandler)())}};js=new WeakMap,or=new WeakMap,Zr=new WeakMap,Sa=new WeakMap,Bf=new WeakMap,Aa=new WeakMap,Ta=new WeakMap,Kn=new WeakSet,ff=function(){jt(this,js).resolve(),jt(this,or).send("configure",{verbosity:this.verbosity})},Fb=function(e){si(this,Zr,e),si(this,or,new _c("main","worker",e)),jt(this,or).on("ready",()=>{}),wr(this,Kn,ff).call(this)},Ib=function(){if(jt(Ht,Aa)||jt(Ht,ol,df)){wr(this,Kn,xc).call(this);return}let{workerSrc:e}=Ht;try{Ht._isSameOrigin(window.location,e)||(e=Ht._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),i=new _c("main","worker",t),r=()=>{a.abort(),i.destroy(),t.terminate(),this.destroyed?jt(this,js).reject(new Error("Worker was destroyed")):wr(this,Kn,xc).call(this)},a=new AbortController;t.addEventListener("error",()=>{jt(this,Sa)||r()},{signal:a.signal}),i.on("test",c=>{if(a.abort(),this.destroyed||!c){r();return}si(this,or,i),si(this,Zr,t),si(this,Sa,t),wr(this,Kn,ff).call(this)}),i.on("ready",c=>{if(a.abort(),this.destroyed){r();return}try{o()}catch{wr(this,Kn,xc).call(this)}});const o=()=>{const c=new Uint8Array;i.send("test",c,[c.buffer])};o();return}catch{Gf("The worker has been disabled.")}wr(this,Kn,xc).call(this)},xc=function(){jt(Ht,Aa)||(We("Setting up fake worker."),si(Ht,Aa,!0)),Ht._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){jt(this,js).reject(new Error("Worker was destroyed"));return}const t=new dO;si(this,Zr,t);const i=`fake${m_(Ht,Bf)._++}`,r=new _c(i+"_worker",i,t);e.setup(r,t),si(this,or,new _c(i,i+"_worker",t)),wr(this,Kn,ff).call(this)}).catch(e=>{jt(this,js).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},ol=new WeakSet,df=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},xr(Ht,ol),xr(Ht,Bf,0),xr(Ht,Aa,!1),xr(Ht,Ta,new WeakMap),qn&&(si(Ht,Aa,!0),tl.workerSrc||="./pdf.worker.mjs"),Ht._isSameOrigin=(e,t)=>{const i=URL.parse(e);if(!i?.origin||i.origin==="null")return!1;const r=new URL(t,i);return i.origin===r.origin},Ht._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},Ht.fromPort=e=>{if(YR("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Ht.create(e)};let Uc=Ht;class sk{#e=new Map;#t=new Map;#i=new Map;#n=new Map;#a=null;constructor(e,t,i,r,a,o){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new Nb,this.fontLoader=new aO({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=a.canvasFactory,this.filterFactory=a.filterFactory,this.cMapReaderFactory=a.cMapReaderFactory,this.standardFontDataFactory=a.standardFontDataFactory,this.wasmFactory=a.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=o,this.setupMessageHandler()}#s(e,t=null){const i=this.#e.get(e);if(i)return i;const r=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,r),r}get annotationStorage(){return Xe(this,"annotationStorage",new Vg)}getRenderingIntent(e,t=Bs.ENABLE,i=null,r=!1,a=!1){let o=wi.DISPLAY,c=ug;switch(e){case"any":o=wi.ANY;break;case"display":break;case"print":o=wi.PRINT;break;default:We(`getRenderingIntent - invalid intent: ${e}`)}const h=o&wi.PRINT&&i instanceof xb?i:this.annotationStorage;switch(t){case Bs.DISABLE:o+=wi.ANNOTATIONS_DISABLE;break;case Bs.ENABLE:break;case Bs.ENABLE_FORMS:o+=wi.ANNOTATIONS_FORMS;break;case Bs.ENABLE_STORAGE:o+=wi.ANNOTATIONS_STORAGE,c=h.serializable;break;default:We(`getRenderingIntent - invalid annotationMode: ${t}`)}r&&(o+=wi.IS_EDITING),a&&(o+=wi.OPLIST);const{ids:f,hash:p}=h.modifiedIds,g=[o,c.hash,p];return{renderingIntent:o,cacheKey:g.join("_"),annotationStorageSerializable:c,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#a?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of this.#t.values())e.push(i._destroy());this.#t.clear(),this.#i.clear(),this.#n.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),bi.cleanup(),this._networkStream?.cancelAllRequests(new Gs("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(i,r)=>{lt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=a=>{this._lastProgress={loaded:a.loaded,total:a.total}},r.onPull=()=>{this._fullReader.read().then(function({value:a,done:o}){if(o){r.close();return}lt(a instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{r.error(a)})},r.onCancel=a=>{this._fullReader.cancel(a),r.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",async i=>{await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:a,contentLength:o}=this._fullReader;return(!r||!a)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=c=>{t.onProgress?.({loaded:c.loaded,total:c.total})}),{isStreamingSupported:r,isRangeSupported:a,contentLength:o}}),e.on("GetRangeReader",(i,r)=>{lt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const a=this._networkStream.getRangeReader(i.begin,i.end);if(!a){r.close();return}r.onPull=()=>{a.read().then(function({value:o,done:c}){if(c){r.close();return}lt(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{r.error(o)})},r.onCancel=o=>{a.cancel(o),r.ready.catch(c=>{if(!this.destroyed)throw c})}}),e.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,t._capability.resolve(new ik(i,this))}),e.on("DocException",i=>{t._capability.reject(ai(i))}),e.on("PasswordRequest",i=>{this.#a=Promise.withResolvers();try{if(!t.onPassword)throw ai(i);const r=a=>{a instanceof Error?this.#a.reject(a):this.#a.resolve({password:a})};t.onPassword(r,i.code)}catch(r){this.#a.reject(r)}return this.#a.promise}),e.on("DataLoaded",i=>{t.onProgress?.({loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),e.on("StartRenderPage",i=>{if(this.destroyed)return;this.#t.get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),e.on("commonobj",([i,r,a])=>{if(this.destroyed||this.commonObjs.has(i))return null;switch(r){case"Font":if("error"in a){const g=a.error;We(`Error during font loading: ${g}`),this.commonObjs.resolve(i,g);break}const o=new At(a),c=this._params.pdfBug&&globalThis.FontInspector?.enabled?(g,m)=>globalThis.FontInspector.fontAdded(g,m):null,h=new oO(o,c,a.extra,a.charProcOperatorList);this.fontLoader.bind(h).catch(()=>e.sendWithPromise("FontFallback",{id:i})).finally(()=>{!h.fontExtraProperties&&h.data&&h.clearData(),this.commonObjs.resolve(i,h)});break;case"CopyLocalImage":const{imageRef:f}=a;lt(f,"The imageRef must be defined.");for(const g of this.#t.values())for(const[,m]of g.objs)if(m?.ref===f)return m.dataLen?(this.commonObjs.resolve(i,structuredClone(m)),m.dataLen):null;break;case"FontPath":this.commonObjs.resolve(i,new lO(a));break;case"Image":this.commonObjs.resolve(i,a);break;case"Pattern":const p=new _n(a);this.commonObjs.resolve(i,p.getIR());break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),e.on("obj",([i,r,a,o])=>{if(this.destroyed)return;const c=this.#t.get(r);if(!c.objs.has(i)){if(c._intentStates.size===0){o?.bitmap?.close();return}switch(a){case"Image":case"Pattern":c.objs.resolve(i,o);break;default:throw new Error(`Got unknown object type ${a}`)}}}),e.on("DocProgress",i=>{this.destroyed||t.onProgress?.({loaded:i.loaded,total:i.total})}),e.on("FetchBinaryData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");const r=this[i.type];if(!r)throw new Error(`${i.type} not initialized, see the \`useWorkerFetch\` parameter.`);return r.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&We("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}extractPages(e){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:e})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,i=this.#i.get(t);if(i)return i;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(a=>{if(this.destroyed)throw new Error("Transport destroyed");a.refStr&&this.#n.set(a.refStr,e);const o=new rk(t,a,this,this._params.pdfBug);return this.#t.set(t,o),o});return this.#i.set(t,r),r}getPageIndex(e){return hg(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#s("GetFieldObjects")}hasJSActions(){return this.#s("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return this.#s("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#s("GetOptionalContentConfig").then(t=>new PO(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#e.get(e);if(t)return t;const i=this.messageHandler.sendWithPromise(e,null).then(r=>({info:r[0],metadata:r[1]?new FO(r[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null,hasStructTree:r[2]}));return this.#e.set(e,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),bi.cleanup()}}cachedPageNumber(e){if(!hg(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#n.get(t)??null}}class ak{#e=null;onContinue=null;onError=null;constructor(e){this.#e=e}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}}class Yo{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:i,commonObjs:r,annotationCanvasMap:a,operatorList:o,pageIndex:c,canvasFactory:h,filterFactory:f,useRequestAnimationFrame:p=!1,pdfBug:g=!1,pageColors:m=null,enableHWA:y=!1,operationsFilter:w=null}){this.callback=e,this.params=t,this.objs=i,this.commonObjs=r,this.annotationCanvasMap=a,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=c,this.canvasFactory=h,this.filterFactory=f,this._pdfBug=g,this.pageColors=m,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new ak(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=y,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=w}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(Yo.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Yo.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:i,transform:r,background:a,dependencyTracker:o}=this.params,c=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new el(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,o),this.gfx.beginDrawing({transform:r,viewport:i,transparency:e,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),Yo.#t.delete(this._canvas),e||=new Hg(`Rendering cancelled, page ${this._pageIndex+1}`,t),this.callback(e),this.task.onError?.(e)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Yo.#t.delete(this._canvas),this.callback())))}}const Pb="5.4.530",ok="50cc4adac";class Wi{#e=null;#t=null;#i;#n=null;#a=!1;#s=!1;#r=null;#o;#c=null;#l=null;static#f=null;static get _keyboardManager(){return Xe(this,"_keyboardManager",new cu([[["Escape","mac+Escape"],Wi.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Wi.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Wi.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Wi.prototype._moveToPrevious],[["Home","mac+Home"],Wi.prototype._moveToBeginning],[["End","mac+End"],Wi.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#s=!1,this.#r=e):this.#s=!0,this.#l=e?._uiManager||t,this.#o=this.#l._eventBus,this.#i=e?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",Wi.#f||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const e=this.#e=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",this.#r&&(e.ariaControls=`${this.#r.id}_colorpicker_dropdown`);const t=this.#l._signal;e.addEventListener("click",this.#g.bind(this),{signal:t}),e.addEventListener("keydown",this.#m.bind(this),{signal:t});const i=this.#t=document.createElement("span");return i.className="swatch",i.ariaHidden="true",i.style.backgroundColor=this.#i,e.append(i),e}renderMainDropdown(){const e=this.#n=this.#h();return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}#h(){const e=document.createElement("div"),t=this.#l._signal;e.addEventListener("contextmenu",Yi,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#r&&(e.id=`${this.#r.id}_colorpicker_dropdown`);for(const[i,r]of this.#l.highlightColors){const a=document.createElement("button");a.tabIndex="0",a.role="option",a.setAttribute("data-color",r),a.title=i,a.setAttribute("data-l10n-id",Wi.#f[i]);const o=document.createElement("span");a.append(o),o.className="swatch",o.style.backgroundColor=r,a.ariaSelected=r===this.#i,a.addEventListener("click",this.#d.bind(this,r),{signal:t}),e.append(a)}return e.addEventListener("keydown",this.#m.bind(this),{signal:t}),e}#d(e,t){t.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:ot.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)}_colorSelectFromKeyboard(e){if(e.target===this.#e){this.#g(e);return}const t=e.target.getAttribute("data-color");t&&this.#d(t,e)}_moveToNext(e){if(!this.#p){this.#g(e);return}if(e.target===this.#e){this.#n.firstElementChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#n?.firstElementChild||e.target===this.#e){this.#p&&this._hideDropdownFromKeyboard();return}this.#p||this.#g(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#p){this.#g(e);return}this.#n.firstElementChild?.focus()}_moveToEnd(e){if(!this.#p){this.#g(e);return}this.#n.lastElementChild?.focus()}#m(e){Wi._keyboardManager.exec(this,e)}#g(e){if(this.#p){this.hideDropdown();return}if(this.#a=e.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#e.ariaExpanded="true",this.#n){this.#n.classList.remove("hidden");return}const t=this.#n=this.#h();this.#e.append(t)}#u(e){this.#n?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#n?.classList.add("hidden"),this.#e.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#p(){return this.#n&&!this.#n.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#s){if(!this.#p){this.#r?.unselect();return}this.hideDropdown(),this.#e.focus({preventScroll:!0,focusVisible:this.#a})}}updateColor(e){if(this.#t&&(this.#t.style.backgroundColor=e),!this.#n)return;const t=this.#l.highlightColors.values();for(const i of this.#n.children)i.ariaSelected=t.next().value===e.toUpperCase()}destroy(){this.#e?.remove(),this.#e=null,this.#t=null,this.#n?.remove(),this.#n=null}}class jc{#e=null;#t=null;#i=null;static#n=null;constructor(e){this.#t=e,this.#i=e._uiManager,jc.#n||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#e)return this.#e;const{editorType:e,colorType:t,color:i}=this.#t,r=this.#e=document.createElement("input");return r.type="color",r.value=i||"#000000",r.className="basicColorPicker",r.tabIndex=0,r.setAttribute("data-l10n-id",jc.#n[e]),r.addEventListener("input",()=>{this.#i.updateParams(t,r.value)},{signal:this.#i._signal}),r}update(e){this.#e&&(this.#e.value=e)}destroy(){this.#e?.remove(),this.#e=null}hideDropdown(){}}function hx(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function gc(n){return Math.max(0,Math.min(255,255*n))}class fx{static CMYK_G([e,t,i,r]){return["G",1-Math.min(1,.3*e+.59*i+.11*t+r)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=gc(e),[e,e,e]}static G_HTML([e]){const t=hx(e);return`#${t}${t}${t}`}static RGB_G([e,t,i]){return["G",.3*e+.59*t+.11*i]}static RGB_rgb(e){return e.map(gc)}static RGB_HTML(e){return`#${e.map(hx).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,i,r]){return["RGB",1-Math.min(1,e+r),1-Math.min(1,i+r),1-Math.min(1,t+r)]}static CMYK_rgb([e,t,i,r]){return[gc(1-Math.min(1,e+r)),gc(1-Math.min(1,i+r)),gc(1-Math.min(1,t+r))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,i]){const r=1-e,a=1-t,o=1-i,c=Math.min(r,a,o);return["CMYK",r,a,o,c]}}class lk{create(e,t,i=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),i||(r.setAttribute("width",`${e}px`),r.setAttribute("height",`${t}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${e} ${t}`),r}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Rt("Abstract method `_createSVG` called.")}}class _f extends lk{_createSVG(e){return document.createElementNS(Kr,e)}}const ck=9,Oa=new WeakSet,uk=new Date().getTimezoneOffset()*60*1e3;class Fp{static create(e){switch(e.data.annotationType){case cn.LINK:return new Kg(e);case cn.TEXT:return new fk(e);case cn.WIDGET:switch(e.data.fieldType){case"Tx":return new dk(e);case"Btn":return e.data.radioButton?new Bb(e):e.data.checkBox?new gk(e):new mk(e);case"Ch":return new vk(e);case"Sig":return new pk(e)}return new Ia(e);case cn.POPUP:return new pg(e);case cn.FREETEXT:return new Ub(e);case cn.LINE:return new _k(e);case cn.SQUARE:return new xk(e);case cn.CIRCLE:return new wk(e);case cn.POLYLINE:return new jb(e);case cn.CARET:return new Ek(e);case cn.INK:return new Jg(e);case cn.POLYGON:return new bk(e);case cn.HIGHLIGHT:return new Hb(e);case cn.UNDERLINE:return new Sk(e);case cn.SQUIGGLY:return new Ak(e);case cn.STRIKEOUT:return new Tk(e);case cn.STAMP:return new zb(e);case cn.FILEATTACHMENT:return new Ck(e);default:return new Vt(e)}}}class Vt{#e=null;#t=!1;#i=null;constructor(e,{isRenderable:t=!1,ignoreBorder:i=!1,createQuadrilaterals:r=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,this.hasOwnCommentButton=!1,t&&(this.contentElement=this.container=this._createContainer(i)),r&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e?.str||t?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Vt._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:e}=this,t=this.annotationStorage?.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const e=this.annotationStorage?.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:i,rect:r}=this.data;let a=-1/0,o=-1/0;if(t?.length>=8){for(let c=0;c<t.length;c+=8)t[c+1]>o?(o=t[c+1],a=t[c+2]):t[c+1]===o&&(a=Math.max(a,t[c+2]));return[a,o]}if(i?.length>=1){for(const c of i)for(let h=0,f=c.length;h<f;h+=2)c[h+1]>o?(o=c[h+1],a=c[h]):c[h+1]===o&&(a=Math.max(a,c[h]));if(a!==1/0)return[a,o]}return r?[r[2],r[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:i,pageHeight:r,pageX:a,pageY:o}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-a)/i,e[1]=100*(e[1]-o)/r,e}get commentText(){const{data:e}=this;return this.annotationStorage.getRawValue(`${Ic}${e.id}`)?.popup?.contents||e.contentsObj?.str||""}set commentText(e){const{data:t}=this,i={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:i})||this.annotationStorage.setValue(`${Ic}${t.id}`,{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:i,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){(this.#i?.popup||this.popup)?.remove(),this.#i=this.popup=null}updateEdited(e){if(!this.container)return;e.rect&&(this.#e||={rect:this.data.rect.slice(0)});const{rect:t,popup:i}=e;t&&this.#n(t);let r=this.#i?.popup||this.popup;!r&&i?.text&&(this._createPopup(i),r=this.#i.popup),r&&(r.updateEdited(e),i?.deleted&&(r.remove(),this.#i=null,this.popup=null))}resetEdited(){this.#e&&(this.#n(this.#e.rect),this.#i?.popup.resetEdited(),this.#e=null)}#n(e){const{container:{style:t},data:{rect:i,rotation:r},parent:{viewport:{rawDims:{pageWidth:a,pageHeight:o,pageX:c,pageY:h}}}}=this;i?.splice(0,4,...e),t.left=`${100*(e[0]-c)/a}%`,t.top=`${100*(o-e[3]+h)/o}%`,r===0?(t.width=`${100*(e[2]-e[0])/a}%`,t.height=`${100*(e[3]-e[1])/o}%`):this.setRotation(r)}_createContainer(e){const{data:t,parent:{page:i,viewport:r}}=this,a=document.createElement("section");a.setAttribute("data-annotation-id",t.id),!(this instanceof Ia)&&!(this instanceof Kg)&&(a.tabIndex=0);const{style:o}=a;if(o.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(a.title=t.alternativeText),t.noRotate&&a.classList.add("norotate"),!t.rect||this instanceof pg){const{rotation:_}=t;return!t.hasOwnCanvas&&_!==0&&this.setRotation(_,a),a}const{width:c,height:h}=this;if(!e&&t.borderStyle.width>0){o.borderWidth=`${t.borderStyle.width}px`;const _=t.borderStyle.horizontalCornerRadius,b=t.borderStyle.verticalCornerRadius;if(_>0||b>0){const T=`calc(${_}px * var(--total-scale-factor)) / calc(${b}px * var(--total-scale-factor))`;o.borderRadius=T}else if(this instanceof Bb){const T=`calc(${c}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;o.borderRadius=T}switch(t.borderStyle.style){case jo.SOLID:o.borderStyle="solid";break;case jo.DASHED:o.borderStyle="dashed";break;case jo.BEVELED:We("Unimplemented border style: beveled");break;case jo.INSET:We("Unimplemented border style: inset");break;case jo.UNDERLINE:o.borderBottomStyle="solid";break}const E=t.borderColor||null;E?(this.#t=!0,o.borderColor=Ne.makeHexColor(E[0]|0,E[1]|0,E[2]|0)):o.borderWidth=0}const f=Ne.normalizeRect([t.rect[0],i.view[3]-t.rect[1]+i.view[1],t.rect[2],i.view[3]-t.rect[3]+i.view[1]]),{pageWidth:p,pageHeight:g,pageX:m,pageY:y}=r.rawDims;o.left=`${100*(f[0]-m)/p}%`,o.top=`${100*(f[1]-y)/g}%`;const{rotation:w}=t;return t.hasOwnCanvas||w===0?(o.width=`${100*c/p}%`,o.height=`${100*h/g}%`):this.setRotation(w,a),a}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:r}=this.parent.viewport.rawDims;let{width:a,height:o}=this;e%180!==0&&([a,o]=[o,a]),t.style.width=`${100*a/i}%`,t.style.height=`${100*o/r}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,i,r)=>{const a=r.detail[t],o=a[0],c=a.slice(1);r.target.style[i]=fx[`${o}_HTML`](c),this.annotationStorage.setValue(this.data.id,{[i]:fx[`${o}_rgb`](c)})};return Xe(this,"_commonActions",{display:t=>{const{display:i}=t.detail,r=i%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:i===1||i===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:i}=t.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const i=t.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(e,t){const i=this._commonActions;for(const r of Object.keys(t.detail))(e[r]||i[r])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const i=this._commonActions;for(const[r,a]of Object.entries(t)){const o=i[r];if(o){const c={detail:{[r]:a},target:e};o(c),delete t[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,i,r,a]=this.data.rect.map(_=>Math.fround(_));if(e.length===8){const[_,b,E,T]=e.subarray(2,6);if(r===_&&a===b&&t===E&&i===T)return}const{style:o}=this.container;let c;if(this.#t){const{borderColor:_,borderWidth:b}=o;o.borderWidth=0,c=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${_}" stroke-width="${b}">`],this.container.classList.add("hasBorder")}const h=r-t,f=a-i,{svgFactory:p}=this,g=p.createElement("svg");g.classList.add("quadrilateralsContainer"),g.setAttribute("width",0),g.setAttribute("height",0),g.role="none";const m=p.createElement("defs");g.append(m);const y=p.createElement("clipPath"),w=`clippath_${this.data.id}`;y.setAttribute("id",w),y.setAttribute("clipPathUnits","objectBoundingBox"),m.append(y);for(let _=2,b=e.length;_<b;_+=8){const E=e[_],T=e[_+1],S=e[_+2],k=e[_+3],P=p.createElement("rect"),F=(S-t)/h,O=(a-T)/f,G=(E-S)/h,M=(T-k)/f;P.setAttribute("x",F),P.setAttribute("y",O),P.setAttribute("width",G),P.setAttribute("height",M),y.append(P),c?.push(`<rect vector-effect="non-scaling-stroke" x="${F}" y="${O}" width="${G}" height="${M}"/>`)}this.#t&&(c.push("</g></svg>')"),o.backgroundImage=c.join("")),this.container.append(g),this.container.style.clipPath=`url(#${w})`}_createPopup(e=null){const{data:t}=this;let i,r;e?(i={str:e.text},r=e.date):(i=t.contentsObj,r=t.modificationDate),this.#i=new pg({data:{color:t.color,titleObj:t.titleObj,modificationDate:r,contentsObj:i,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]})}get hasPopupElement(){return!!(this.#i||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#i}render(){Rt("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const i=[];if(this._fieldObjects){const r=this._fieldObjects[e];if(r)for(const{page:a,id:o,exportValues:c}of r){if(a===-1||o===t)continue;const h=typeof c=="string"?c:null,f=document.querySelector(`[data-element-id="${o}"]`);if(f&&!Oa.has(f)){We(`_getElementsByName - element not allowed: ${o}`);continue}i.push({id:o,exportValue:h,domElement:f})}return i}for(const r of document.getElementsByName(e)){const{exportValue:a}=r,o=r.getAttribute("data-element-id");o!==t&&Oa.has(r)&&i.push({id:o,exportValue:a,domElement:r})}return i}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class hk extends Vt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&this._createPopup(e.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}class Kg extends Vt{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,i=document.createElement("a");i.setAttribute("data-element-id",e.id);let r=!1;return e.url?(t.addLinkAttributes(i,e.url,e.newWindow),r=!0):e.action?(this._bindNamedAction(i,e.action,e.overlaidText),r=!0):e.attachment?(this.#t(i,e.attachment,e.overlaidText,e.attachmentDest),r=!0):e.setOCGState?(this.#i(i,e.setOCGState,e.overlaidText),r=!0):e.dest?(this._bindLink(i,e.dest,e.overlaidText),r=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,e),r=!0),e.resetForm?(this._bindResetFormAction(i,e.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(i,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&(this.contentElement=i,this.container.append(i)),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t,i=""){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e(),i&&(e.title=i)}_bindNamedAction(e,t,i=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),i&&(e.title=i),this.#e()}#t(e,t,i="",r=null){e.href=this.linkService.getAnchorUrl(""),t.description?e.title=t.description:i&&(e.title=i),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,r),!1),this.#e()}#i(e,t,i=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),i&&(e.title=i),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(t.actions)){const a=i.get(r);a&&(e[a]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:r}}),!1))}t.overlaidText&&(e.title=t.overlaidText),e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){const i=e.onclick;if(i||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){We('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(e.onclick=()=>!1);return}e.onclick=()=>{i?.();const{fields:r,refs:a,include:o}=t,c=[];if(r.length!==0||a.length!==0){const p=new Set(a);for(const g of r){const m=this._fieldObjects[g]||[];for(const{id:y}of m)p.add(y)}for(const g of Object.values(this._fieldObjects))for(const m of g)p.has(m.id)===o&&c.push(m)}else for(const p of Object.values(this._fieldObjects))c.push(...p);const h=this.annotationStorage,f=[];for(const p of c){const{id:g}=p;switch(f.push(g),p.type){case"text":{const y=p.defaultValue||"";h.setValue(g,{value:y});break}case"checkbox":case"radiobutton":{const y=p.defaultValue===p.exportValues;h.setValue(g,{value:y});break}case"combobox":case"listbox":{const y=p.defaultValue||"";h.setValue(g,{value:y});break}default:continue}const m=document.querySelector(`[data-element-id="${g}"]`);if(m){if(!Oa.has(m)){We(`_bindResetFormAction - element not allowed: ${g}`);continue}}else continue;m.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class fk extends Vt{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(e),this.container}}class Ia extends Vt{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return vn.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,i,r,a){i.includes("mouse")?e.addEventListener(i,o=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:a(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):e.addEventListener(i,o=>{if(i==="blur"){if(!t.focused||!o.relatedTarget)return;t.focused=!1}else if(i==="focus"){if(t.focused)return;t.focused=!0}a&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:a(o)}})})}_setEventListeners(e,t,i,r){for(const[a,o]of i)(o==="Action"||this.data.actions?.[o])&&((o==="Focus"||o==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,a,o,r),o==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):o==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":Ne.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||ck,a=e.style;let o;const c=2,h=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-c),p=Math.round(f/(Cp*r))||1,g=f/p;o=Math.min(r,h(g/Cp))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-c);o=Math.min(r,h(f/Cp))}a.fontSize=`calc(${o}px * var(--total-scale-factor))`,a.color=Ne.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(a.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class dk extends Ia{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,i,r){const a=this.annotationStorage;for(const o of this._getElementsByName(e.name,e.id))o.domElement&&(o.domElement[t]=i),a.setValue(o.id,{[r]:i})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const r=e.getValue(t,{value:this.data.fieldValue});let a=r.value||"";const o=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;o&&a.length>o&&(a=a.slice(0,o));let c=r.formattedValue||this.data.textContent?.join(`
`)||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const h={userValue:a,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=c??a,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type=this.data.password?"password":"text",i.setAttribute("value",c??a),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),Oa.add(i),this.contentElement=i,i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=0;const{datetimeFormat:f,datetimeType:p,timeStep:g}=this.data,m=!!p&&this.enableScripting;f&&(i.title=f),this._setRequired(i,this.data.required),o&&(i.maxLength=o),i.addEventListener("input",w=>{e.setValue(t,{value:w.target.value}),this.setPropertyOnSiblings(i,"value",w.target.value,"value"),h.formattedValue=null}),i.addEventListener("resetform",w=>{const _=this.data.defaultFieldValue??"";i.value=h.userValue=_,h.formattedValue=null});let y=w=>{const{formattedValue:_}=h;_!=null&&(w.target.value=_),w.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",_=>{if(h.focused)return;const{target:b}=_;if(m&&(b.type=p,g&&(b.step=g)),h.userValue){const E=h.userValue;if(m)if(p==="time"){const T=new Date(E),S=[T.getHours(),T.getMinutes(),T.getSeconds()];b.value=S.map(k=>k.toString().padStart(2,"0")).join(":")}else b.value=new Date(E-uk).toISOString().split(p==="date"?"T":".",1)[0];else b.value=E}h.lastCommittedValue=b.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),i.addEventListener("updatefromsandbox",_=>{this.showElementAndHideCanvas(_.target);const b={value(E){h.userValue=E.detail.value??"",m||e.setValue(t,{value:h.userValue.toString()}),E.target.value=h.userValue},formattedValue(E){const{formattedValue:T}=E.detail;h.formattedValue=T,T!=null&&E.target!==document.activeElement&&(E.target.value=T);const S={formattedValue:T};m&&(S.value=T),e.setValue(t,S)},selRange(E){E.target.setSelectionRange(...E.detail.selRange)},charLimit:E=>{const{charLimit:T}=E.detail,{target:S}=E;if(T===0){S.removeAttribute("maxLength");return}S.setAttribute("maxLength",T);let k=h.userValue;!k||k.length<=T||(k=k.slice(0,T),S.value=h.userValue=k,e.setValue(t,{value:k}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:k,willCommit:!0,commitKey:1,selStart:S.selectionStart,selEnd:S.selectionEnd}}))}};this._dispatchEventFromSandbox(b,_)}),i.addEventListener("keydown",_=>{h.commitKey=1;let b=-1;if(_.key==="Escape"?b=0:_.key==="Enter"&&!this.data.multiLine?b=2:_.key==="Tab"&&(h.commitKey=3),b===-1)return;const{value:E}=_.target;h.lastCommittedValue!==E&&(h.lastCommittedValue=E,h.userValue=E,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:E,willCommit:!0,commitKey:b,selStart:_.target.selectionStart,selEnd:_.target.selectionEnd}}))});const w=y;y=null,i.addEventListener("blur",_=>{if(!h.focused||!_.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{target:b}=_;let{value:E}=b;if(m){if(E&&p==="time"){const T=E.split(":").map(S=>parseInt(S,10));E=new Date(2e3,0,1,T[0],T[1],T[2]||0).valueOf(),b.step=""}else E.includes("T")||(E=`${E}T00:00`),E=new Date(E).valueOf();b.type="text"}h.userValue=E,h.lastCommittedValue!==E&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:E,willCommit:!0,commitKey:h.commitKey,selStart:_.target.selectionStart,selEnd:_.target.selectionEnd}}),w(_)}),this.data.actions?.Keystroke&&i.addEventListener("beforeinput",_=>{h.lastCommittedValue=null;const{data:b,target:E}=_,{value:T,selectionStart:S,selectionEnd:k}=E;let P=S,F=k;switch(_.inputType){case"deleteWordBackward":{const O=T.substring(0,S).match(/\w*[^\w]*$/);O&&(P-=O[0].length);break}case"deleteWordForward":{const O=T.substring(S).match(/^[^\w]*\w*/);O&&(F+=O[0].length);break}case"deleteContentBackward":S===k&&(P-=1);break;case"deleteContentForward":S===k&&(F+=1);break}_.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:T,change:b||"",willCommit:!1,selStart:P,selEnd:F}})}),this._setEventListeners(i,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],_=>_.target.value)}if(y&&i.addEventListener("blur",y),this.data.comb){const _=(this.data.rect[2]-this.data.rect[0])/o;i.classList.add("comb"),i.style.letterSpacing=`calc(${_}px * var(--total-scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class pk extends Ia{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class gk extends Ia{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,i=t.id;let r=e.getValue(i,{value:t.exportValue===t.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",e.setValue(i,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const a=document.createElement("input");return Oa.add(a),a.setAttribute("data-element-id",i),a.disabled=t.readOnly,this._setRequired(a,this.data.required),a.type="checkbox",a.name=t.fieldName,r&&a.setAttribute("checked",!0),a.setAttribute("exportValue",t.exportValue),a.tabIndex=0,a.addEventListener("change",o=>{const{name:c,checked:h}=o.target;for(const f of this._getElementsByName(c,i)){const p=h&&f.exportValue===t.exportValue;f.domElement&&(f.domElement.checked=p),e.setValue(f.id,{value:p})}e.setValue(i,{value:h})}),a.addEventListener("resetform",o=>{const c=t.defaultFieldValue||"Off";o.target.checked=c===t.exportValue}),this.enableScripting&&this.hasJSActions&&(a.addEventListener("updatefromsandbox",o=>{const c={value(h){h.target.checked=h.detail.value!=="Off",e.setValue(i,{value:h.target.checked})}};this._dispatchEventFromSandbox(c,o)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class Bb extends Ia{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,i=t.id;let r=e.getValue(i,{value:t.fieldValue===t.buttonValue}).value;if(typeof r=="string"&&(r=r!==t.buttonValue,e.setValue(i,{value:r})),r)for(const o of this._getElementsByName(t.fieldName,i))e.setValue(o.id,{value:!1});const a=document.createElement("input");if(Oa.add(a),a.setAttribute("data-element-id",i),a.disabled=t.readOnly,this._setRequired(a,this.data.required),a.type="radio",a.name=t.fieldName,r&&a.setAttribute("checked",!0),a.tabIndex=0,a.addEventListener("change",o=>{const{name:c,checked:h}=o.target;for(const f of this._getElementsByName(c,i))e.setValue(f.id,{value:!1});e.setValue(i,{value:h})}),a.addEventListener("resetform",o=>{const c=t.defaultFieldValue;o.target.checked=c!=null&&c===t.buttonValue}),this.enableScripting&&this.hasJSActions){const o=t.buttonValue;a.addEventListener("updatefromsandbox",c=>{const h={value:f=>{const p=o===f.detail.value;for(const g of this._getElementsByName(f.target.name)){const m=p&&g.id===i;g.domElement&&(g.domElement.checked=m),e.setValue(g.id,{value:m})}}};this._dispatchEventFromSandbox(h,c)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)}return this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class mk extends Kg{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),e}}class vk extends Ia{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,i=e.getValue(t,{value:this.data.fieldValue}),r=document.createElement("select");Oa.add(r),r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=0;let a=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",p=>{const g=this.data.defaultFieldValue;for(const m of r.options)m.selected=m.value===g});for(const p of this.data.options){const g=document.createElement("option");g.textContent=p.displayValue,g.value=p.exportValue,i.value.includes(p.exportValue)&&(g.setAttribute("selected",!0),a=!1),r.append(g)}let o=null;if(a){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),r.prepend(p),o=()=>{p.remove(),r.removeEventListener("input",o),o=null},r.addEventListener("input",o)}const c=p=>{const g=p?"value":"textContent",{options:m,multiple:y}=r;return y?Array.prototype.filter.call(m,w=>w.selected).map(w=>w[g]):m.selectedIndex===-1?null:m[m.selectedIndex][g]};let h=c(!1);const f=p=>{const g=p.target.options;return Array.prototype.map.call(g,m=>({displayValue:m.textContent,exportValue:m.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",p=>{const g={value(m){o?.();const y=m.detail.value,w=new Set(Array.isArray(y)?y:[y]);for(const _ of r.options)_.selected=w.has(_.value);e.setValue(t,{value:c(!0)}),h=c(!1)},multipleSelection(m){r.multiple=!0},remove(m){const y=r.options,w=m.detail.remove;y[w].selected=!1,r.remove(w),y.length>0&&Array.prototype.findIndex.call(y,b=>b.selected)===-1&&(y[0].selected=!0),e.setValue(t,{value:c(!0),items:f(m)}),h=c(!1)},clear(m){for(;r.length!==0;)r.remove(0);e.setValue(t,{value:null,items:[]}),h=c(!1)},insert(m){const{index:y,displayValue:w,exportValue:_}=m.detail.insert,b=r.children[y],E=document.createElement("option");E.textContent=w,E.value=_,b?b.before(E):r.append(E),e.setValue(t,{value:c(!0),items:f(m)}),h=c(!1)},items(m){const{items:y}=m.detail;for(;r.length!==0;)r.remove(0);for(const w of y){const{displayValue:_,exportValue:b}=w,E=document.createElement("option");E.textContent=_,E.value=b,r.append(E)}r.options.length>0&&(r.options[0].selected=!0),e.setValue(t,{value:c(!0),items:f(m)}),h=c(!1)},indices(m){const y=new Set(m.detail.indices);for(const w of m.target.options)w.selected=y.has(w.index);e.setValue(t,{value:c(!0)}),h=c(!1)},editable(m){m.target.disabled=!m.detail.editable}};this._dispatchEventFromSandbox(g,p)}),r.addEventListener("input",p=>{const g=c(!0),m=c(!1);e.setValue(t,{value:g}),p.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:h,change:m,changeEx:g,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):r.addEventListener("input",function(p){e.setValue(t,{value:c(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class pg extends Vt{constructor(e){const{data:t,elements:i,parent:r}=e,a=!!r._commentManager;if(super(e,{isRenderable:!a&&Vt._hasPopupData(t)}),this.elements=i,a&&Vt._hasPopupData(t)){const o=this.popup=this.#e();for(const c of i)c.popup=o}else this.popup=null}#e(){return new yk({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=this.#e(),i=[];for(const r of this.elements)r.popup=t,r.container.ariaHasPopup="dialog",i.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(r=>`${Wo}${r}`).join(",")),this.container}}class yk{#e=null;#t=this.#G.bind(this);#i=this.#U.bind(this);#n=this.#M.bind(this);#a=this.#b.bind(this);#s=null;#r=null;#o=null;#c=null;#l=null;#f=null;#h=null;#d=!1;#m=null;#g=null;#u=null;#p=null;#v=null;#_=null;#y=null;#A=null;#E=null;#w=null;#C=!1;#x=null;#S=null;constructor({container:e,color:t,elements:i,titleObj:r,modificationDate:a,contentsObj:o,richText:c,parent:h,rect:f,parentRect:p,open:g,commentManager:m=null}){this.#r=e,this.#E=r,this.#o=o,this.#A=c,this.#f=h,this.#s=t,this.#y=f,this.#h=p,this.#l=i,this.#e=m,this.#x=i[0],this.#c=og.toDateObject(a),this.trigger=i.flatMap(y=>y.getElementsToTriggerPopup()),m||(this.#k(),this.#r.hidden=!0,g&&this.#b())}#k(){if(this.#g)return;this.#g=new AbortController;const{signal:e}=this.#g;for(const t of this.trigger)t.addEventListener("click",this.#a,{signal:e}),t.addEventListener("pointerenter",this.#n,{signal:e}),t.addEventListener("pointerleave",this.#i,{signal:e}),t.classList.add("popupTriggerArea");for(const t of this.#l)t.container?.addEventListener("keydown",this.#t,{signal:e})}#R(){const e=this.#l.find(t=>t.hasCommentButton);e&&(this.#v=e._normalizePoint(e.commentButtonPosition))}renderCommentButton(){if(this.#p){this.#p.parentNode||this.#x.container.after(this.#p);return}if(this.#v||this.#R(),!this.#v)return;const{signal:e}=this.#g=new AbortController,t=this.#x.hasOwnCommentButton,i=()=>{this.#e.toggleCommentPopup(this,!0,void 0,!t)},r=()=>{this.#e.toggleCommentPopup(this,!1,!0,!t)},a=()=>{this.#e.toggleCommentPopup(this,!1,!1)};if(t){this.#p=this.#x.container;for(const o of this.trigger)o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.addEventListener("keydown",this.#t,{signal:e}),o.addEventListener("click",i,{signal:e}),o.addEventListener("pointerenter",r,{signal:e}),o.addEventListener("pointerleave",a,{signal:e}),o.classList.add("popupTriggerArea")}else{const o=this.#p=document.createElement("button");o.className="annotationCommentButton";const c=this.#x.container;o.style.zIndex=c.style.zIndex+1,o.tabIndex=0,o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#P(),this.#O(),o.addEventListener("keydown",this.#t,{signal:e}),o.addEventListener("click",i,{signal:e}),o.addEventListener("pointerenter",r,{signal:e}),o.addEventListener("pointerleave",a,{signal:e}),c.after(o)}}#O(){if(this.#x.extraPopupElement&&!this.#x.editor)return;this.#p||this.renderCommentButton();const[e,t]=this.#v,{style:i}=this.#p;i.left=`calc(${e}%)`,i.top=`calc(${t}% - var(--comment-button-dim))`}#P(){this.#x.extraPopupElement||(this.#p||this.renderCommentButton(),this.#p.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:e,opacity:t}=this.#x.commentData;return e?this.#f._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{this.#p?.focus()},0)}getData(){const{richText:e,color:t,opacity:i,creationDate:r,modificationDate:a}=this.#x.commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:i,creationDate:r,modificationDate:a}}get elementBeforePopup(){return this.#p}get comment(){return this.#S||=this.#x.commentText,this.#S}set comment(e){e!==this.comment&&(this.#x.commentText=this.#S=e)}focus(){this.#x.container?.focus()}get parentBoundingClientRect(){return this.#x.layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){this.#p&&(this.#p.classList.toggle("selected",e),this.#p.ariaExpanded=t)}setSelectedCommentButton(e){this.#p.classList.toggle("selected",e)}get commentPopupPosition(){if(this.#_)return this.#_;const{x:e,y:t,height:i}=this.#p.getBoundingClientRect(),{x:r,y:a,width:o,height:c}=this.#x.layer.getBoundingClientRect();return[(e-r)/o,(t+i-a)/c]}set commentPopupPosition(e){this.#_=e}hasDefaultPopupPosition(){return this.#_===null}get commentButtonPosition(){return this.#v}get commentButtonWidth(){return this.#p.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,i]=this.#_||this.commentButtonPosition.map(f=>f/100),r=this.parentBoundingClientRect,{x:a,y:o,width:c,height:h}=r;this.#e.showDialog(null,this,a+t*c,o+i*h,{...e,parentDimensions:r})}render(){if(this.#m)return;const e=this.#m=document.createElement("div");if(e.className="popup",this.#s){const i=e.style.outlineColor=Ne.makeHexColor(...this.#s);e.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`}const t=document.createElement("span");if(t.className="header",this.#E?.str){const i=document.createElement("span");i.className="title",t.append(i),{dir:i.dir,str:i.textContent}=this.#E}if(e.append(t),this.#c){const i=document.createElement("time");i.className="popupDate",i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),i.dateTime=this.#c.toISOString(),t.append(i)}mb({html:this.#N||this.#o.str,dir:this.#o?.dir,className:"popupContent"},e),this.#r.append(e)}get#N(){const e=this.#A,t=this.#o;return e?.str&&(!t?.str||t.str===e.str)&&this.#A.html||null}get#L(){return this.#N?.attributes?.style?.fontSize||0}get#B(){return this.#N?.attributes?.style?.color||null}#F(e){const t=[],i={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},r={style:{color:this.#B,fontSize:this.#L?`calc(${this.#L}px * var(--total-scale-factor))`:""}};for(const a of e.split(`
`))t.push({name:"span",value:a,attributes:r});return i}#G(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#d)&&this.#b()}updateEdited({rect:e,popup:t,deleted:i}){if(this.#e){i?(this.remove(),this.#S=null):t&&(t.deleted?this.remove():(this.#P(),this.#S=t.text)),e&&(this.#v=null,this.#R(),this.#O());return}if(i||t?.deleted){this.remove();return}this.#k(),this.#w||={contentsObj:this.#o,richText:this.#A},e&&(this.#u=null),t&&t.text&&(this.#A=this.#F(t.text),this.#c=og.toDateObject(t.date),this.#o=null),this.#m?.remove(),this.#m=null}resetEdited(){this.#w&&({contentsObj:this.#o,richText:this.#A}=this.#w,this.#w=null,this.#m?.remove(),this.#m=null,this.#u=null)}remove(){if(this.#g?.abort(),this.#g=null,this.#m?.remove(),this.#m=null,this.#C=!1,this.#d=!1,this.#p?.remove(),this.#p=null,this.trigger)for(const e of this.trigger)e.classList.remove("popupTriggerArea")}#T(){if(this.#u!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:i,pageX:r,pageY:a}}}=this.#f;let o=!!this.#h,c=o?this.#h:this.#y;for(const w of this.#l)if(!c||Ne.intersect(w.data.rect,c)!==null){c=w.data.rect,o=!0;break}const h=Ne.normalizeRect([c[0],e[3]-c[1]+e[1],c[2],e[3]-c[3]+e[1]]),p=o?c[2]-c[0]+5:0,g=h[0]+p,m=h[1];this.#u=[100*(g-r)/t,100*(m-a)/i];const{style:y}=this.#r;y.left=`${this.#u[0]}%`,y.top=`${this.#u[1]}%`}#b(){if(this.#e){this.#e.toggleCommentPopup(this,!1);return}this.#d=!this.#d,this.#d?(this.#M(),this.#r.addEventListener("click",this.#a),this.#r.addEventListener("keydown",this.#t)):(this.#U(),this.#r.removeEventListener("click",this.#a),this.#r.removeEventListener("keydown",this.#t))}#M(){this.#m||this.render(),this.isVisible?this.#d&&this.#r.classList.add("focused"):(this.#T(),this.#r.hidden=!1,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)+1e3)}#U(){this.#r.classList.remove("focused"),!(this.#d||!this.isVisible)&&(this.#r.hidden=!0,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)-1e3)}forceHide(){this.#C=this.isVisible,this.#C&&(this.#r.hidden=!0)}maybeShow(){this.#e||(this.#k(),this.#C&&(this.#m||this.#M(),this.#C=!1,this.#r.hidden=!1))}get isVisible(){return this.#e?!1:this.#r.hidden===!1}}class Ub extends Vt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Ye.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=this.contentElement=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const i=document.createElement("span");i.textContent=t,e.append(i)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class _k extends Vt{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:e,width:t,height:i}=this,r=this.svgFactory.create(t,i,!0),a=this.#e=this.svgFactory.createElement("svg:line");return a.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),a.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),a.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),a.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),a.setAttribute("stroke-width",e.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class xk extends Vt{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:e,width:t,height:i}=this,r=this.svgFactory.create(t,i,!0),a=e.borderStyle.width,o=this.#e=this.svgFactory.createElement("svg:rect");return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",t-a),o.setAttribute("height",i-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class wk extends Vt{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:e,width:t,height:i}=this,r=this.svgFactory.create(t,i,!0),a=e.borderStyle.width,o=this.#e=this.svgFactory.createElement("svg:ellipse");return o.setAttribute("cx",t/2),o.setAttribute("cy",i/2),o.setAttribute("rx",t/2-a/2),o.setAttribute("ry",i/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class jb extends Vt{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:i,popupRef:r},width:a,height:o}=this;if(!t)return this.container;const c=this.svgFactory.create(a,o,!0);let h=[];for(let p=0,g=t.length;p<g;p+=2){const m=t[p]-e[0],y=e[3]-t[p+1];h.push(`${m},${y}`)}h=h.join(" ");const f=this.#e=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",h),f.setAttribute("stroke-width",i.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),c.append(f),this.container.append(c),!r&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class bk extends jb{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Ek extends Vt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}class Jg extends Vt{#e=null;#t=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Ye.HIGHLIGHT:Ye.INK}#i(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:i,borderStyle:r,popupRef:a}}=this,{transform:o,width:c,height:h}=this.#i(t,e),f=this.svgFactory.create(c,h,!0),p=this.#e=this.svgFactory.createElement("svg:g");f.append(p),p.setAttribute("stroke-width",r.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",o);for(let g=0,m=i.length;g<m;g++){const y=this.svgFactory.createElement(this.svgElementName);this.#t.push(y),y.setAttribute("points",i[g].join(",")),p.append(y)}return!a&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:i,rect:r}=e,a=this.#e;if(t>=0&&a.setAttribute("stroke-width",t||1),i)for(let o=0,c=this.#t.length;o<c;o++)this.#t[o].setAttribute("points",i[o].join(","));if(r){const{transform:o,width:c,height:h}=this.#i(this.data.rotation,r);a.parentElement.setAttribute("viewBox",`0 0 ${c} ${h}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Hb extends Vt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Ye.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const i=document.createElement("mark");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class Sk extends Vt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),e){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class Ak extends Vt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),e){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class Tk extends Vt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),e){const i=document.createElement("s");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class zb extends Vt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Ye.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class Ck extends Vt{#e=null;constructor(e){super(e,{isRenderable:!0});const{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...t})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let i;t.hasAppearance||t.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),i.addEventListener("dblclick",this.#t.bind(this)),this.#e=i;const{isMac:r}=vn.platform;return e.addEventListener("keydown",a=>{a.key==="Enter"&&(r?a.metaKey:a.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):i.classList.add("popupTriggerArea"),e.append(i),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class Qg{#e=null;#t=null;#i=null;#n=new Map;#a=null;#s=null;#r=[];#o=!1;constructor({div:e,accessibilityManager:t,annotationCanvasMap:i,annotationEditorUIManager:r,page:a,viewport:o,structTreeLayer:c,commentManager:h,linkService:f,annotationStorage:p}){this.div=e,this.#e=t,this.#t=i,this.#a=c||null,this.#s=f||null,this.#i=p||new Vg,this.page=a,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=r,this._commentManager=h||null}hasEditableAnnotations(){return this.#n.size>0}async render(e){const{annotations:t}=e,i=this.div;Ra(i,this.viewport);const r=new Map,a=[],o={data:null,layer:i,linkService:this.#s,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new _f,annotationStorage:this.#i,enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const c of t){if(c.noHTML)continue;const h=c.annotationType===cn.POPUP;if(h){const g=r.get(c.id);if(!g)continue;if(!this._commentManager){a.push(c);continue}o.elements=g}else if(c.rect[2]===c.rect[0]||c.rect[3]===c.rect[1])continue;o.data=c;const f=Fp.create(o);if(!f.isRenderable)continue;if(!h&&(this.#r.push(f),c.popupRef)){const g=r.get(c.popupRef);g?g.push(f):r.set(c.popupRef,[f])}const p=f.render();c.hidden&&(p.style.visibility="hidden"),f._isEditable&&(this.#n.set(f.data.id,f),this._annotationEditorUIManager?.renderAnnotationElement(f))}await this.#c();for(const c of a){const h=o.elements=r.get(c.id);o.data=c;const f=Fp.create(o);if(!f.isRenderable)continue;const p=f.render();f.contentElement.id=`${Wo}${c.id}`,c.hidden&&(p.style.visibility="hidden"),h.at(-1).container.after(p)}this.#l()}async#c(){if(this.#r.length===0)return;this.div.replaceChildren();const e=[];if(!this.#o){this.#o=!0;for(const{contentElement:i,data:{id:r}}of this.#r){const a=i.id=`${Wo}${r}`;e.push(this.#a?.getAriaAttributes(a).then(o=>{if(o)for(const[c,h]of o)i.setAttribute(c,h)}))}}this.#r.sort(({data:{rect:[i,r,a,o]}},{data:{rect:[c,h,f,p]}})=>{if(i===a&&r===o)return 1;if(c===f&&h===p)return-1;const g=o,m=r,y=(r+o)/2,w=p,_=h,b=(h+p)/2;if(y>=w&&b<=m)return-1;if(b>=g&&y<=_)return 1;const E=(i+a)/2,T=(c+f)/2;return E-T});const t=document.createDocumentFragment();for(const i of this.#r)t.append(i.container),this._commentManager?(i.extraPopupElement?.popup||i.popup)?.renderCommentButton():i.extraPopupElement&&t.append(i.extraPopupElement.render());if(this.div.append(t),await Promise.all(e),this.#e)for(const i of this.#r)this.#e.addPointerInTextLayer(i.contentElement,!1)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:this.#s,svgFactory:new _f,parent:this};for(const i of e){i.borderStyle||=Qg._defaultBorderStyle,t.data=i;const r=Fp.create(t);r.isRenderable&&(r.render(),r.contentElement.id=`${Wo}${i.id}`,this.#r.push(r))}await this.#c()}update({viewport:e}){const t=this.div;this.viewport=e,Ra(t,{rotation:e.rotation}),this.#l(),t.hidden=!1}#l(){if(!this.#t)return;const e=this.div;for(const[t,i]of this.#t){const r=e.querySelector(`[data-annotation-id="${t}"]`);if(!r)continue;i.className="annotationContent";const{firstChild:a}=r;a?a.nodeName==="CANVAS"?a.replaceWith(i):a.classList.contains("annotationContent")?a.after(i):a.before(i):r.append(i);const o=this.#n.get(t);o&&(o._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(t,r.id,i),o._hasNoCanvas=!1):o.canvas=i)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(e){return this.#n.get(e)}addFakeAnnotation(e){const{div:t}=this,{id:i,rotation:r}=e,a=new hk({data:{id:i,rect:e.getPDFRect(),rotation:r},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:this.#s,annotationStorage:this.#i});return a.render(),a.contentElement.id=`${Wo}${i}`,a.createOrUpdatePopup(),this.#r.push(a),a}removeAnnotation(e){const t=this.#r.findIndex(r=>r.data.id===e);if(t<0)return;const[i]=this.#r.splice(t,1);this.#e?.removePointerInTextLayer(i.contentElement)}updateFakeAnnotations(e){if(e.length!==0){for(const t of e)t.updateFakeAnnotationElement(this);this.#c()}}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}static get _defaultBorderStyle(){return Xe(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:jo.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const Wh=/\r\n?|\n/g;class xn extends He{#e="";#t=`${this.id}-editor`;#i=null;#n;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=xn.prototype,t=a=>a.isEmpty(),i=Vs.TRANSLATE_SMALL,r=Vs.TRANSLATE_BIG;return Xe(this,"_keyboardManager",new cu([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,r],checker:t}]]))}static _type="freetext";static _editorType=Ye.FREETEXT;constructor(e){super({...e,name:"freeTextEditor"}),this.color=e.color||xn._defaultColor||He._defaultLineColor,this.#n=e.fontSize||xn._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(e,t){He.initialize(e,t);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case ot.FREETEXT_SIZE:xn._defaultFontSize=t;break;case ot.FREETEXT_COLOR:xn._defaultColor=t;break}}updateParams(e,t){switch(e){case ot.FREETEXT_SIZE:this.#a(t);break;case ot.FREETEXT_COLOR:this.#s(t);break}}static get defaultPropertiesToUpdate(){return[[ot.FREETEXT_SIZE,xn._defaultFontSize],[ot.FREETEXT_COLOR,xn._defaultColor||He._defaultLineColor]]}get propertiesToUpdate(){return[[ot.FREETEXT_SIZE,this.#n],[ot.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new jc(this),[["colorPicker",this._colorPicker]]}get colorType(){return ot.FREETEXT_COLOR}#a(e){const t=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-this.#n)*this.parentScale),this.#n=r,this.#o()},i=this.#n;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ot.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#s(e){const t=r=>{this.color=r,this.onUpdatedColor()},i=this.color;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ot.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-xn._internalPadding*e,-(xn._internalPadding+this.#n)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;const e=this._uiManager.combinedSignal(this.#i);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#t),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#r(){const e=[];this.editorDiv.normalize();let t=null;for(const i of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&i.nodeName==="BR"||(e.push(xn.#c(i)),t=i);return e.join(`
`)}#o(){const[e,t]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:r,div:a}=this,o=a.style.display,c=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",r.div.append(this.div),i=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=i.width/e,this.height=i.height/t):(this.width=i.height/e,this.height=i.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#e,t=this.#e=this.#r().trimEnd();if(e===t)return;const i=r=>{if(this.#e=r,!r){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{i(t)},undo:()=>{i(e)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){xn._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,t;(this._isCopy||this.annotationElementId)&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#t),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,i.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[c,h]=this.getInitialTranslation();[c,h]=this.pageTranslationToScreen(c,h);const[f,p]=this.pageDimensions,[g,m]=this.pageTranslation;let y,w;switch(this.rotation){case 0:y=e+(o[0]-g)/f,w=t+this.height-(o[1]-m)/p;break;case 90:y=e+(o[0]-g)/f,w=t-(o[1]-m)/p,[c,h]=[h,-c];break;case 180:y=e-this.width+(o[0]-g)/f,w=t-(o[1]-m)/p,[c,h]=[-c,-h];break;case 270:y=e+(o[0]-g-this.height*p)/f,w=t+(o[1]-m-this.width*f)/p,[c,h]=[-h,c];break}this.setAt(y*r,w*a,c,h)}else this._moveAfterPaste(e,t);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(Wh,"")}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:i}=t;if(i.length===1&&i[0]==="text/plain")return;e.preventDefault();const r=xn.#h(t.getData("text")||"").replaceAll(Wh,`
`);if(!r)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!r.includes(`
`)){o.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:c,startOffset:h}=o,f=[],p=[];if(c.nodeType===Node.TEXT_NODE){const y=c.parentElement;if(p.push(c.nodeValue.slice(h).replaceAll(Wh,"")),y!==this.editorDiv){let w=f;for(const _ of this.editorDiv.childNodes){if(_===y){w=p;continue}w.push(xn.#c(_))}}f.push(c.nodeValue.slice(0,h).replaceAll(Wh,""))}else if(c===this.editorDiv){let y=f,w=0;for(const _ of this.editorDiv.childNodes)w++===h&&(y=p),y.push(xn.#c(_))}this.#e=`${f.join(`
`)}${r}${p.join(`
`)}`,this.#l();const g=new Range;let m=Math.sumPrecise(f.map(y=>y.length));for(const{firstChild:y}of this.editorDiv.childNodes)if(y.nodeType===Node.TEXT_NODE){const w=y.nodeValue.length;if(m<=w){g.setStart(y,m),g.setEnd(y,m);break}m-=w}a.removeAllRanges(),a.addRange(g)}#l(){if(this.editorDiv.replaceChildren(),!!this.#e)for(const e of this.#e.split(`
`)){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#f(){return this.#e.replaceAll(""," ")}static#h(e){return e.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const e=xn._internalPadding*this.parentScale;return this.getRect(e,e)}static async deserialize(e,t,i){let r=null;if(e instanceof Ub){const{data:{defaultAppearanceData:{fontSize:o,fontColor:c},rect:h,rotation:f,id:p,popupRef:g,richText:m,contentsObj:y,creationDate:w,modificationDate:_},textContent:b,textPosition:E,parent:{page:{pageNumber:T}}}=e;if(!b||b.length===0)return null;r=e={annotationType:Ye.FREETEXT,color:Array.from(c),fontSize:o,value:b.join(`
`),position:E,pageIndex:T-1,rect:h.slice(0),rotation:f,annotationElementId:p,id:p,deleted:!1,popupRef:g,comment:y?.str||null,richText:m,creationDate:w,modificationDate:_}}const a=await super.deserialize(e,t,i);return a.#n=e.fontSize,a.color=Ne.makeHexColor(...e.color),a.#e=xn.#h(e.value),a._initialData=r,e.comment&&a.setCommentData(e),a}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=He._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),i=Object.assign(super.serialize(e),{color:t,fontSize:this.#n,value:this.#f()});return this.addComment(i),e?(i.isCopy=!0,i):this.annotationElementId&&!this.#d(i)?null:(i.id=this.annotationElementId,i)}#d(e){const{value:t,fontSize:i,color:r,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||e.value!==t||e.fontSize!==i||e.color.some((o,c)=>o!==r[c])||e.pageIndex!==a}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(!t)return null;const{style:i}=t;i.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,i.color=this.color,t.replaceChildren();for(const r of this.#e.split(`
`)){const a=document.createElement("div");a.append(r?document.createTextNode(r):document.createElement("br")),t.append(a)}return e.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#e}}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}class Me{static PRECISION=1e-4;toSVGPath(){Rt("Abstract method `toSVGPath` must be implemented.")}get box(){Rt("Abstract getter `box` must be implemented.")}serialize(e,t){Rt("Abstract method `serialize` must be implemented.")}static _rescale(e,t,i,r,a,o){o||=new Float32Array(e.length);for(let c=0,h=e.length;c<h;c+=2)o[c]=t+e[c]*r,o[c+1]=i+e[c+1]*a;return o}static _rescaleAndSwap(e,t,i,r,a,o){o||=new Float32Array(e.length);for(let c=0,h=e.length;c<h;c+=2)o[c]=t+e[c+1]*r,o[c+1]=i+e[c]*a;return o}static _translate(e,t,i,r){r||=new Float32Array(e.length);for(let a=0,o=e.length;a<o;a+=2)r[a]=t+e[a],r[a+1]=i+e[a+1];return r}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,i,r,a){switch(a){case 90:return[1-t/i,e/r];case 180:return[1-e/i,1-t/r];case 270:return[t/i,1-e/r];default:return[e/i,t/r]}}static _normalizePagePoint(e,t,i){switch(i){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,i,r,a,o){return[(e+5*i)/6,(t+5*r)/6,(5*i+a)/6,(5*r+o)/6,(i+a)/2,(r+o)/2]}}class ba{#e;#t=[];#i;#n;#a=[];#s=new Float32Array(18);#r;#o;#c;#l;#f;#h;#d=[];static#m=8;static#g=2;static#u=ba.#m+ba.#g;constructor({x:e,y:t},i,r,a,o,c=0){this.#e=i,this.#h=a*r,this.#n=o,this.#s.set([NaN,NaN,NaN,NaN,e,t],6),this.#i=c,this.#l=ba.#m*r,this.#c=ba.#u*r,this.#f=r,this.#d.push(e,t)}isEmpty(){return isNaN(this.#s[8])}#p(){const e=this.#s.subarray(4,6),t=this.#s.subarray(16,18),[i,r,a,o]=this.#e;return[(this.#r+(e[0]-t[0])/2-i)/a,(this.#o+(e[1]-t[1])/2-r)/o,(this.#r+(t[0]-e[0])/2-i)/a,(this.#o+(t[1]-e[1])/2-r)/o]}add({x:e,y:t}){this.#r=e,this.#o=t;const[i,r,a,o]=this.#e;let[c,h,f,p]=this.#s.subarray(8,12);const g=e-f,m=t-p,y=Math.hypot(g,m);if(y<this.#c)return!1;const w=y-this.#l,_=w/y,b=_*g,E=_*m;let T=c,S=h;c=f,h=p,f+=b,p+=E,this.#d?.push(e,t);const k=-E/w,P=b/w,F=k*this.#h,O=P*this.#h;return this.#s.set(this.#s.subarray(2,8),0),this.#s.set([f+F,p+O],4),this.#s.set(this.#s.subarray(14,18),12),this.#s.set([f-F,p-O],16),isNaN(this.#s[6])?(this.#a.length===0&&(this.#s.set([c+F,h+O],2),this.#a.push(NaN,NaN,NaN,NaN,(c+F-i)/a,(h+O-r)/o),this.#s.set([c-F,h-O],14),this.#t.push(NaN,NaN,NaN,NaN,(c-F-i)/a,(h-O-r)/o)),this.#s.set([T,S,c,h,f,p],6),!this.isEmpty()):(this.#s.set([T,S,c,h,f,p],6),Math.abs(Math.atan2(S-h,T-c)-Math.atan2(E,b))<Math.PI/2?([c,h,f,p]=this.#s.subarray(2,6),this.#a.push(NaN,NaN,NaN,NaN,((c+f)/2-i)/a,((h+p)/2-r)/o),[c,h,T,S]=this.#s.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,((T+c)/2-i)/a,((S+h)/2-r)/o),!0):([T,S,c,h,f,p]=this.#s.subarray(0,6),this.#a.push(((T+5*c)/6-i)/a,((S+5*h)/6-r)/o,((5*c+f)/6-i)/a,((5*h+p)/6-r)/o,((c+f)/2-i)/a,((h+p)/2-r)/o),[f,p,c,h,T,S]=this.#s.subarray(12,18),this.#t.push(((T+5*c)/6-i)/a,((S+5*h)/6-r)/o,((5*c+f)/6-i)/a,((5*h+p)/6-r)/o,((c+f)/2-i)/a,((h+p)/2-r)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const e=this.#a,t=this.#t;if(isNaN(this.#s[6])&&!this.isEmpty())return this.#v();const i=[];i.push(`M${e[4]} ${e[5]}`);for(let r=6;r<e.length;r+=6)isNaN(e[r])?i.push(`L${e[r+4]} ${e[r+5]}`):i.push(`C${e[r]} ${e[r+1]} ${e[r+2]} ${e[r+3]} ${e[r+4]} ${e[r+5]}`);this.#y(i);for(let r=t.length-6;r>=6;r-=6)isNaN(t[r])?i.push(`L${t[r+4]} ${t[r+5]}`):i.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);return this.#_(i),i.join(" ")}#v(){const[e,t,i,r]=this.#e,[a,o,c,h]=this.#p();return`M${(this.#s[2]-e)/i} ${(this.#s[3]-t)/r} L${(this.#s[4]-e)/i} ${(this.#s[5]-t)/r} L${a} ${o} L${c} ${h} L${(this.#s[16]-e)/i} ${(this.#s[17]-t)/r} L${(this.#s[14]-e)/i} ${(this.#s[15]-t)/r} Z`}#_(e){const t=this.#t;e.push(`L${t[4]} ${t[5]} Z`)}#y(e){const[t,i,r,a]=this.#e,o=this.#s.subarray(4,6),c=this.#s.subarray(16,18),[h,f,p,g]=this.#p();e.push(`L${(o[0]-t)/r} ${(o[1]-i)/a} L${h} ${f} L${p} ${g} L${(c[0]-t)/r} ${(c[1]-i)/a}`)}newFreeDrawOutline(e,t,i,r,a,o){return new $b(e,t,i,r,a,o)}getOutlines(){const e=this.#a,t=this.#t,i=this.#s,[r,a,o,c]=this.#e,h=new Float32Array((this.#d?.length??0)+2);for(let g=0,m=h.length-2;g<m;g+=2)h[g]=(this.#d[g]-r)/o,h[g+1]=(this.#d[g+1]-a)/c;if(h[h.length-2]=(this.#r-r)/o,h[h.length-1]=(this.#o-a)/c,isNaN(i[6])&&!this.isEmpty())return this.#A(h);const f=new Float32Array(this.#a.length+24+this.#t.length);let p=e.length;for(let g=0;g<p;g+=2){if(isNaN(e[g])){f[g]=f[g+1]=NaN;continue}f[g]=e[g],f[g+1]=e[g+1]}p=this.#w(f,p);for(let g=t.length-6;g>=6;g-=6)for(let m=0;m<6;m+=2){if(isNaN(t[g+m])){f[p]=f[p+1]=NaN,p+=2;continue}f[p]=t[g+m],f[p+1]=t[g+m+1],p+=2}return this.#E(f,p),this.newFreeDrawOutline(f,h,this.#e,this.#f,this.#i,this.#n)}#A(e){const t=this.#s,[i,r,a,o]=this.#e,[c,h,f,p]=this.#p(),g=new Float32Array(36);return g.set([NaN,NaN,NaN,NaN,(t[2]-i)/a,(t[3]-r)/o,NaN,NaN,NaN,NaN,(t[4]-i)/a,(t[5]-r)/o,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,(t[16]-i)/a,(t[17]-r)/o,NaN,NaN,NaN,NaN,(t[14]-i)/a,(t[15]-r)/o],0),this.newFreeDrawOutline(g,e,this.#e,this.#f,this.#i,this.#n)}#E(e,t){const i=this.#t;return e.set([NaN,NaN,NaN,NaN,i[4],i[5]],t),t+=6}#w(e,t){const i=this.#s.subarray(4,6),r=this.#s.subarray(16,18),[a,o,c,h]=this.#e,[f,p,g,m]=this.#p();return e.set([NaN,NaN,NaN,NaN,(i[0]-a)/c,(i[1]-o)/h,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,g,m,NaN,NaN,NaN,NaN,(r[0]-a)/c,(r[1]-o)/h],t),t+=24}}class $b extends Me{#e;#t=new Float32Array(4);#i;#n;#a;#s;#r;constructor(e,t,i,r,a,o){super(),this.#r=e,this.#a=t,this.#e=i,this.#s=r,this.#i=a,this.#n=o,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(o);const[c,h,f,p]=this.#t;for(let g=0,m=e.length;g<m;g+=2)e[g]=(e[g]-c)/f,e[g+1]=(e[g+1]-h)/p;for(let g=0,m=t.length;g<m;g+=2)t[g]=(t[g]-c)/f,t[g+1]=(t[g+1]-h)/p}toSVGPath(){const e=[`M${this.#r[4]} ${this.#r[5]}`];for(let t=6,i=this.#r.length;t<i;t+=6){if(isNaN(this.#r[t])){e.push(`L${this.#r[t+4]} ${this.#r[t+5]}`);continue}e.push(`C${this.#r[t]} ${this.#r[t+1]} ${this.#r[t+2]} ${this.#r[t+3]} ${this.#r[t+4]} ${this.#r[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,i,r],a){const o=i-e,c=r-t;let h,f;switch(a){case 0:h=Me._rescale(this.#r,e,r,o,-c),f=Me._rescale(this.#a,e,r,o,-c);break;case 90:h=Me._rescaleAndSwap(this.#r,e,t,o,c),f=Me._rescaleAndSwap(this.#a,e,t,o,c);break;case 180:h=Me._rescale(this.#r,i,t,-o,c),f=Me._rescale(this.#a,i,t,-o,c);break;case 270:h=Me._rescaleAndSwap(this.#r,i,r,-o,-c),f=Me._rescaleAndSwap(this.#a,i,r,-o,-c);break}return{outline:Array.from(h),points:[Array.from(f)]}}#o(e){const t=this.#r;let i=t[4],r=t[5];const a=[i,r,i,r];let o=i,c=r,h=i,f=r;const p=e?Math.max:Math.min,g=new Float32Array(4);for(let y=6,w=t.length;y<w;y+=6){const _=t[y+4],b=t[y+5];isNaN(t[y])?(Ne.pointBoundingBox(_,b,a),c>b?(o=_,c=b):c===b&&(o=p(o,_)),f<b?(h=_,f=b):f===b&&(h=p(h,_))):(g[0]=g[1]=1/0,g[2]=g[3]=-1/0,Ne.bezierBoundingBox(i,r,...t.slice(y,y+6),g),Ne.rectBoundingBox(g[0],g[1],g[2],g[3],a),c>g[1]?(o=g[0],c=g[1]):c===g[1]&&(o=p(o,g[0])),f<g[3]?(h=g[2],f=g[3]):f===g[3]&&(h=p(h,g[2]))),i=_,r=b}const m=this.#t;m[0]=a[0]-this.#i,m[1]=a[1]-this.#i,m[2]=a[2]-a[0]+2*this.#i,m[3]=a[3]-a[1]+2*this.#i,this.firstPoint=[o,c],this.lastPoint=[h,f]}get box(){return this.#t}newOutliner(e,t,i,r,a,o=0){return new ba(e,t,i,r,a,o)}getNewOutline(e,t){const[i,r,a,o]=this.#t,[c,h,f,p]=this.#e,g=a*f,m=o*p,y=i*f+c,w=r*p+h,_=this.newOutliner({x:this.#a[0]*g+y,y:this.#a[1]*m+w},this.#e,this.#s,e,this.#n,t??this.#i);for(let b=2;b<this.#a.length;b+=2)_.add({x:this.#a[b]*g+y,y:this.#a[b+1]*m+w});return _.getOutlines()}}class gg{#e;#t;#i;#n=[];#a=[];constructor(e,t=0,i=0,r=!0){const a=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:_,y:b,width:E,height:T}of e){const S=Math.floor((_-t)/o)*o,k=Math.ceil((_+E+t)/o)*o,P=Math.floor((b-t)/o)*o,F=Math.ceil((b+T+t)/o)*o,O=[S,P,F,!0],G=[k,P,F,!1];this.#n.push(O,G),Ne.rectBoundingBox(S,P,k,F,a)}const c=a[2]-a[0]+2*i,h=a[3]-a[1]+2*i,f=a[0]-i,p=a[1]-i;let g=r?-1/0:1/0,m=1/0;const y=this.#n.at(r?-1:-2),w=[y[0],y[2]];for(const _ of this.#n){const[b,E,T,S]=_;!S&&r?E<m?(m=E,g=b):E===m&&(g=Math.max(g,b)):S&&!r&&(E<m?(m=E,g=b):E===m&&(g=Math.min(g,b))),_[0]=(b-f)/c,_[1]=(E-p)/h,_[2]=(T-p)/h}this.#e=new Float32Array([f,p,c,h]),this.#t=[g,m],this.#i=w}getOutlines(){this.#n.sort((t,i)=>t[0]-i[0]||t[1]-i[1]||t[2]-i[2]);const e=[];for(const t of this.#n)t[3]?(e.push(...this.#l(t)),this.#o(t)):(this.#c(t),e.push(...this.#l(t)));return this.#s(e)}#s(e){const t=[],i=new Set;for(const o of e){const[c,h,f]=o;t.push([c,h,o],[c,f,o])}t.sort((o,c)=>o[1]-c[1]||o[0]-c[0]);for(let o=0,c=t.length;o<c;o+=2){const h=t[o][2],f=t[o+1][2];h.push(f),f.push(h),i.add(h),i.add(f)}const r=[];let a;for(;i.size>0;){const o=i.values().next().value;let[c,h,f,p,g]=o;i.delete(o);let m=c,y=h;for(a=[c,f],r.push(a);;){let w;if(i.has(p))w=p;else if(i.has(g))w=g;else break;i.delete(w),[c,h,f,p,g]=w,m!==c&&(a.push(m,y,c,y===h?h:f),m=c),y=y===h?f:h}a.push(m,y)}return new Rk(r,this.#e,this.#t,this.#i)}#r(e){const t=this.#a;let i=0,r=t.length-1;for(;i<=r;){const a=i+r>>1,o=t[a][0];if(o===e)return a;o<e?i=a+1:r=a-1}return r+1}#o([,e,t]){const i=this.#r(e);this.#a.splice(i,0,[e,t])}#c([,e,t]){const i=this.#r(e);for(let r=i;r<this.#a.length;r++){const[a,o]=this.#a[r];if(a!==e)break;if(a===e&&o===t){this.#a.splice(r,1);return}}for(let r=i-1;r>=0;r--){const[a,o]=this.#a[r];if(a!==e)break;if(a===e&&o===t){this.#a.splice(r,1);return}}}#l(e){const[t,i,r]=e,a=[[t,i,r]],o=this.#r(r);for(let c=0;c<o;c++){const[h,f]=this.#a[c];for(let p=0,g=a.length;p<g;p++){const[,m,y]=a[p];if(!(f<=m||y<=h)){if(m>=h){if(y>f)a[p][1]=f;else{if(g===1)return[];a.splice(p,1),p--,g--}continue}a[p][2]=h,y>f&&a.push([t,f,y])}}}return a}}class Rk extends Me{#e;#t;constructor(e,t,i,r){super(),this.#t=e,this.#e=t,this.firstPoint=i,this.lastPoint=r}toSVGPath(){const e=[];for(const t of this.#t){let[i,r]=t;e.push(`M${i} ${r}`);for(let a=2;a<t.length;a+=2){const o=t[a],c=t[a+1];o===i?(e.push(`V${c}`),r=c):c===r&&(e.push(`H${o}`),i=o)}e.push("Z")}return e.join(" ")}serialize([e,t,i,r],a){const o=[],c=i-e,h=r-t;for(const f of this.#t){const p=new Array(f.length);for(let g=0;g<f.length;g+=2)p[g]=e+f[g]*c,p[g+1]=r-f[g+1]*h;o.push(p)}return o}get box(){return this.#e}get classNamesForOutlining(){return["highlightOutline"]}}class mg extends ba{newFreeDrawOutline(e,t,i,r,a,o){return new Ok(e,t,i,r,a,o)}}class Ok extends $b{newOutliner(e,t,i,r,a,o=0){return new mg(e,t,i,r,a,o)}}class tn extends He{#e=null;#t=0;#i;#n=null;#a=null;#s=null;#r=null;#o=0;#c=null;#l=null;#f=null;#h=!1;#d=null;#m=null;#g=null;#u="";#p;#v="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=Ye.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const e=tn.prototype;return Xe(this,"_keyboardManager",new cu([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super({...e,name:"highlightEditor"}),this.color=e.color||tn._defaultColor,this.#p=e.thickness||tn._defaultThickness,this.opacity=e.opacity||tn._defaultOpacity,this.#i=e.boxes||null,this.#v=e.methodOfCreation||"",this.#u=e.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(this.#h=!0,this.#y(e),this.#x()):this.#i&&(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#r=e.focusNode,this.#o=e.focusOffset,this.#_(),this.#x(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#p,methodOfCreation:this.#v}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#_(){const e=new gg(this.#i,.001);this.#l=e.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const t=new gg(this.#i,.0025,.001,this._uiManager.direction==="ltr");this.#s=t.getOutlines();const{firstPoint:i}=this.#l;this.#d=[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height];const{lastPoint:r}=this.#s;this.#m=[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height]}#y({highlightOutlines:e,highlightId:t,clipPathId:i}){this.#l=e;const r=1.5;if(this.#s=e.getNewOutline(this.#p/2+r,.0025),t>=0)this.#f=t,this.#n=i,this.parent.drawLayer.finalizeDraw(t,{bbox:e.box,path:{d:e.toSVGPath()}}),this.#g=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},!0);else if(this.parent){const g=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#f,{bbox:tn.#S(this.#l.box,(g-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#g,{bbox:tn.#S(this.#s.box,g),path:{d:this.#s.toSVGPath()}})}const[a,o,c,h]=e.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=c,this.height=h;break;case 90:{const[g,m]=this.parentDimensions;this.x=o,this.y=1-a,this.width=c*m/g,this.height=h*g/m;break}case 180:this.x=1-a,this.y=1-o,this.width=c,this.height=h;break;case 270:{const[g,m]=this.parentDimensions;this.x=1-o,this.y=a,this.width=c*m/g,this.height=h*g/m;break}}const{firstPoint:f}=e;this.#d=[(f[0]-a)/c,(f[1]-o)/h];const{lastPoint:p}=this.#s;this.#m=[(p[0]-a)/c,(p[1]-o)/h]}static initialize(e,t){He.initialize(e,t),tn._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case ot.HIGHLIGHT_COLOR:tn._defaultColor=t;break;case ot.HIGHLIGHT_THICKNESS:tn._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#m}get commentButtonPosition(){return this.#d}updateParams(e,t){switch(e){case ot.HIGHLIGHT_COLOR:this.#A(t);break;case ot.HIGHLIGHT_THICKNESS:this.#E(t);break}}static get defaultPropertiesToUpdate(){return[[ot.HIGHLIGHT_COLOR,tn._defaultColor],[ot.HIGHLIGHT_THICKNESS,tn._defaultThickness]]}get propertiesToUpdate(){return[[ot.HIGHLIGHT_COLOR,this.color||tn._defaultColor],[ot.HIGHLIGHT_THICKNESS,this.#p||tn._defaultThickness],[ot.HIGHLIGHT_FREE,this.#h]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#f,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#a?.updateColor(this.color),super.onUpdatedColor()}#A(e){const t=(a,o)=>{this.color=a,this.opacity=o,this.onUpdatedColor()},i=this.color,r=this.opacity;this.addCommands({cmd:t.bind(this,e,tn._defaultOpacity),undo:t.bind(this,i,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ot.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(e)},!0)}#E(e){const t=this.#p,i=r=>{this.#p=r,this.#w(r)};this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ot.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#a=new Wi({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#O())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#O())}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){this.#C(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#x(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#C():e&&(this.#x(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#w(e){this.#h&&(this.#y({highlightOutlines:this.#l.getNewOutline(e/2)}),this.fixAndSetPosition(),this.setDims())}#C(){this.#f===null||!this.parent||(this.parent.drawLayer.remove(this.#f),this.#f=null,this.parent.drawLayer.remove(this.#g),this.#g=null)}#x(e=this.parent){this.#f===null&&({id:this.#f,clipPathId:this.#n}=e.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#h},path:{d:this.#l.toSVGPath()}},!1,!0),this.#g=e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},this.#h),this.#c&&(this.#c.style.clipPath=this.#n))}static#S([e,t,i,r],a){switch(a){case 90:return[1-t-r,e,r,i];case 180:return[1-e-i,1-t-r,i,r];case 270:return[t,1-e-i,r,i]}return[e,t,i,r]}rotate(e){const{drawLayer:t}=this.parent;let i;this.#h?(e=(e-this.rotation+360)%360,i=tn.#S(this.#l.box,e)):i=tn.#S([this.x,this.y,this.width,this.height],e),t.updateProperties(this.#f,{bbox:i,root:{"data-main-rotation":e}}),t.updateProperties(this.#g,{bbox:tn.#S(this.#s.box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();this.#u&&(e.setAttribute("aria-label",this.#u),e.setAttribute("role","mark")),this.#h?e.classList.add("free"):this.div.addEventListener("keydown",this.#k.bind(this),{signal:this._uiManager._signal});const t=this.#c=document.createElement("div");return e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#n,this.setDims(),yb(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1}})}#k(e){tn._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#R(!0);break;case 1:case 3:this.#R(!1);break}}#R(e){if(!this.#e)return;const t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#r,this.#o)}select(){super.select(),this.#g&&this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#g&&(this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{selected:!1}}),this.#h||this.#R(!1))}get _mustFixPosition(){return!this.#h}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(this.#f,{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(this.#g,{rootClass:{hidden:!e}}))}#O(){return this.#h?this.rotation:0}#P(){if(this.#h)return null;const[e,t]=this.pageDimensions,[i,r]=this.pageTranslation,a=this.#i,o=new Float32Array(a.length*8);let c=0;for(const{x:h,y:f,width:p,height:g}of a){const m=h*e+i,y=(1-f)*t+r;o[c]=o[c+4]=m,o[c+1]=o[c+3]=y,o[c+2]=o[c+6]=m+p*e,o[c+5]=o[c+7]=y-g*t,c+=8}return o}#N(e){return this.#l.serialize(e,this.#O())}static startHighlighting(e,t,{target:i,x:r,y:a}){const{x:o,y:c,width:h,height:f}=i.getBoundingClientRect(),p=new AbortController,g=e.combinedSignal(p),m=y=>{p.abort(),this.#B(e,y)};window.addEventListener("blur",m,{signal:g}),window.addEventListener("pointerup",m,{signal:g}),window.addEventListener("pointerdown",Yt,{capture:!0,passive:!1,signal:g}),window.addEventListener("contextmenu",Yi,{signal:g}),i.addEventListener("pointermove",this.#L.bind(this,e),{signal:g}),this._freeHighlight=new mg({x:r,y:a},[o,c,h,f],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#L(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#B(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(e,t,i){let r=null;if(e instanceof Hb){const{data:{quadPoints:w,rect:_,rotation:b,id:E,color:T,opacity:S,popupRef:k,richText:P,contentsObj:F,creationDate:O,modificationDate:G},parent:{page:{pageNumber:M}}}=e;r=e={annotationType:Ye.HIGHLIGHT,color:Array.from(T),opacity:S,quadPoints:w,boxes:null,pageIndex:M-1,rect:_.slice(0),rotation:b,annotationElementId:E,id:E,deleted:!1,popupRef:k,richText:P,comment:F?.str||null,creationDate:O,modificationDate:G}}else if(e instanceof Jg){const{data:{inkLists:w,rect:_,rotation:b,id:E,color:T,borderStyle:{rawWidth:S},popupRef:k,richText:P,contentsObj:F,creationDate:O,modificationDate:G},parent:{page:{pageNumber:M}}}=e;r=e={annotationType:Ye.HIGHLIGHT,color:Array.from(T),thickness:S,inkLists:w,boxes:null,pageIndex:M-1,rect:_.slice(0),rotation:b,annotationElementId:E,id:E,deleted:!1,popupRef:k,richText:P,comment:F?.str||null,creationDate:O,modificationDate:G}}const{color:a,quadPoints:o,inkLists:c,opacity:h}=e,f=await super.deserialize(e,t,i);f.color=Ne.makeHexColor(...a),f.opacity=h||1,c&&(f.#p=e.thickness),f._initialData=r,e.comment&&f.setCommentData(e);const[p,g]=f.pageDimensions,[m,y]=f.pageTranslation;if(o){const w=f.#i=[];for(let _=0;_<o.length;_+=8)w.push({x:(o[_]-m)/p,y:1-(o[_+1]-y)/g,width:(o[_+2]-o[_])/p,height:(o[_+1]-o[_+5])/g});f.#_(),f.#x(),f.rotate(f.rotation)}else if(c){f.#h=!0;const w=c[0],_={x:w[0]-m,y:g-(w[1]-y)},b=new mg(_,[0,0,p,g],1,f.#p/2,!0,.001);for(let S=0,k=w.length;S<k;S+=2)_.x=w[S]-m,_.y=g-(w[S+1]-y),b.add(_);const{id:E,clipPathId:T}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:b.toSVGPath()}},!0,!0);f.#y({highlightOutlines:b.getOutlines(),highlightId:E,clipPathId:T}),f.#x(),f.rotate(f.parentRotation)}return f}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=He._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i=super.serialize(e);return Object.assign(i,{color:t,opacity:this.opacity,thickness:this.#p,quadPoints:this.#P(),outlines:this.#N(i.rect)}),this.addComment(i),this.annotationElementId&&!this.#F(i)?null:(i.id=this.annotationElementId,i)}#F(e){const{color:t}=this._initialData;return this.hasEditedComment||e.color.some((i,r)=>i!==t[r])}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class Gb{#e=Object.create(null);updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,i]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,i)}updateSVGProperty(e,t){this.#e[e]=t}toSVGProperties(){const e=this.#e;return this.#e=Object.create(null),{root:e}}reset(){this.#e=Object.create(null)}updateAll(e=this){this.updateProperties(e)}clone(){Rt("Not implemented")}}class dt extends He{#e=null;#t;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#i=null;static#n=null;static#a=null;static _INNER_MARGIN=3;constructor(e){super(e),this.#t=e.mustBeCommitted||!1,this._addOutlines(e)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(e){e.drawOutlines&&(this.#s(e),this.#c())}#s({drawOutlines:e,drawId:t,drawingOptions:i}){this.#e=e,this._drawingOptions||=i,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),t>=0?(this._drawId=t,this.parent.drawLayer.finalizeDraw(t,e.defaultProperties)):this._drawId=this.#r(e,this.parent),this.#h(e.box)}#r(e,t){const{id:i}=t.drawLayer.draw(dt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return i}static _mergeSVGProperties(e,t){const i=new Set(Object.keys(e));for(const[r,a]of Object.entries(t))i.has(r)?Object.assign(e[r],a):e[r]=a;return e}static getDefaultDrawingOptions(e){Rt("Not implemented")}static get typesMap(){Rt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const i=this.typesMap.get(e);i&&this._defaultDrawingOptions.updateProperty(i,t),this._currentParent&&(dt.#i.updateProperty(i,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const i=this.constructor.typesMap.get(e);i&&this._updateProperty(e,i,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[i,r]of this.typesMap)e.push([i,t[r]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[i,r]of this.constructor.typesMap)e.push([i,t[r]]);return e}_updateProperty(e,t,i){const r=this._drawingOptions,a=r[t],o=c=>{r.updateProperty(t,c);const h=this.#e.updateProperty(t,c);h&&this.#h(h),this.parent?.drawLayer.updateProperties(this._drawId,r.toSVGProperties()),e===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:o.bind(this,i),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,dt._mergeSVGProperties(this.#e.getPathResizingSVGProperties(this.#f()),{bbox:this.#d()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,dt._mergeSVGProperties(this.#e.getPathResizedSVGProperties(this.#f()),{bbox:this.#d()}))}_onTranslating(e,t){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#d()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,dt._mergeSVGProperties(this.#e.getPathTranslatedSVGProperties(this.#f(),this.parentDimensions),{bbox:this.#d()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#t&&(this.#t=!1,this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){this.#o(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#c(),this.#h(this.#e.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),this.#o()):e&&(this._uiManager.addShouldRescale(this),this.#c(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),t&&this.select()}#o(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#c(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#r(this.#e,e)}}#l([e,t,i,r]){const{parentDimensions:[a,o],rotation:c}=this;switch(c){case 90:return[t,1-e,i*(o/a),r*(a/o)];case 180:return[1-e,1-t,i,r];case 270:return[1-t,e,i*(o/a),r*(a/o)];default:return[e,t,i,r]}}#f(){const{x:e,y:t,width:i,height:r,parentDimensions:[a,o],rotation:c}=this;switch(c){case 90:return[1-t,e,i*(a/o),r*(o/a)];case 180:return[1-e,1-t,i,r];case 270:return[t,1-e,i*(a/o),r*(o/a)];default:return[e,t,i,r]}}#h(e){[this.x,this.y,this.width,this.height]=this.#l(e),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#d(){const{x:e,y:t,width:i,height:r,rotation:a,parentRotation:o,parentDimensions:[c,h]}=this;switch((a*4+o)/90){case 1:return[1-t-r,e,r,i];case 2:return[1-e-i,1-t-r,i,r];case 3:return[t,1-e-i,r,i];case 4:return[e,t-i*(c/h),r*(h/c),i*(c/h)];case 5:return[1-t,e,i*(c/h),r*(h/c)];case 6:return[1-e-r*(h/c),1-t,r*(h/c),i*(c/h)];case 7:return[t-i*(c/h),1-e-r*(h/c),i*(c/h),r*(h/c)];case 8:return[e-i,t-r,i,r];case 9:return[1-t,e-i,r,i];case 10:return[1-e,1-t,i,r];case 11:return[t-r,1-e,r,i];case 12:return[e-r*(h/c),t,r*(h/c),i*(c/h)];case 13:return[1-t-i*(c/h),e-r*(h/c),i*(c/h),r*(h/c)];case 14:return[1-e,1-t-i*(c/h),r*(h/c),i*(c/h)];case 15:return[t,1-e,i*(c/h),r*(h/c)];default:return[e,t,i,r]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,dt._mergeSVGProperties({bbox:this.#d()},this.#e.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#e.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,t;this._isCopy&&(e=this.x,t=this.y);const i=super.render();i.classList.add("draw");const r=document.createElement("div");return i.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,t),i}static createDrawerInstance(e,t,i,r,a){Rt("Not implemented")}static startDrawing(e,t,i,r){const{target:a,offsetX:o,offsetY:c,pointerId:h,pointerType:f}=r;if(pt.isInitializedAndDifferentPointerType(f))return;const{viewport:{rotation:p}}=e,{width:g,height:m}=a.getBoundingClientRect(),y=dt.#n=new AbortController,w=e.combinedSignal(y);if(pt.setPointer(f,h),window.addEventListener("pointerup",_=>{pt.isSamePointerIdOrRemove(_.pointerId)&&this._endDraw(_)},{signal:w}),window.addEventListener("pointercancel",_=>{pt.isSamePointerIdOrRemove(_.pointerId)&&this._currentParent.endDrawingSession()},{signal:w}),window.addEventListener("pointerdown",_=>{pt.isSamePointerType(_.pointerType)&&(pt.initializeAndAddPointerId(_.pointerId),dt.#i.isCancellable()&&(dt.#i.removeLastElement(),dt.#i.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:w}),window.addEventListener("contextmenu",Yi,{signal:w}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:w}),a.addEventListener("touchmove",_=>{pt.isSameTimeStamp(_.timeStamp)&&Yt(_)},{signal:w}),e.toggleDrawing(),t._editorUndoBar?.hide(),dt.#i){e.drawLayer.updateProperties(this._currentDrawId,dt.#i.startNew(o,c,g,m,p));return}t.updateUIForDefaultProperties(this),dt.#i=this.createDrawerInstance(o,c,g,m,p),dt.#a=this.getDefaultDrawingOptions(),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(dt.#a.toSVGProperties(),dt.#i.defaultSVGProperties),!0,!1)}static _drawMove(e){if(pt.isSameTimeStamp(e.timeStamp),!dt.#i)return;const{offsetX:t,offsetY:i,pointerId:r}=e;if(pt.isSamePointerId(r)){if(pt.isUsingMultiplePointers()){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,dt.#i.add(t,i)),pt.setTimeStamp(e.timeStamp),Yt(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,dt.#i=null,dt.#a=null,pt.clearTimeStamp()),dt.#n&&(dt.#n.abort(),dt.#n=null,pt.clearPointerIds())}static _endDraw(e){const t=this._currentParent;if(t){if(t.toggleDrawing(!0),this._cleanup(!1),e?.target===t.div&&t.drawLayer.updateProperties(this._currentDrawId,dt.#i.end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const i=dt.#i,r=this._currentDrawId,a=i.getLastElement();t.addCommands({cmd:()=>{t.drawLayer.updateProperties(r,i.setLastElement(a))},undo:()=>{t.drawLayer.updateProperties(r,i.removeLastElement())},mustExec:!1,type:ot.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack(ot.DRAW_STEP),!dt.#i.isEmpty()){const{pageDimensions:[i,r],scale:a}=t,o=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:dt.#i.getOutlines(i*a,r*a,a,this._INNER_MARGIN),drawingOptions:dt.#a,mustBeCommitted:!e});return this._cleanup(!0),o}return t.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,i,r,a,o){Rt("Not implemented")}static async deserialize(e,t,i){const{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:c}}=t.viewport,h=this.deserializeDraw(o,c,r,a,this._INNER_MARGIN,e),f=await super.deserialize(e,t,i);return f.createDrawingOptions(e),f.#s({drawOutlines:h}),f.#c(),f.onScaleChanging(),f.rotate(),f}serializeDraw(e){const[t,i]=this.pageTranslation,[r,a]=this.pageDimensions;return this.#e.serialize([t,i,r,a],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class kk{#e=new Float64Array(6);#t;#i;#n;#a;#s;#r="";#o=0;#c=new hu;#l;#f;constructor(e,t,i,r,a,o){this.#l=i,this.#f=r,this.#n=a,this.#a=o,[e,t]=this.#h(e,t);const c=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#s=[e,t],this.#i=[{line:c,points:this.#s}],this.#e.set(c,0)}updateProperty(e,t){e==="stroke-width"&&(this.#a=t)}#h(e,t){return Me._normalizePoint(e,t,this.#l,this.#f,this.#n)}isEmpty(){return!this.#i||this.#i.length===0}isCancellable(){return this.#s.length<=10}add(e,t){[e,t]=this.#h(e,t);const[i,r,a,o]=this.#e.subarray(2,6),c=e-a,h=t-o;return Math.hypot(this.#l*c,this.#f*h)<=2?null:(this.#s.push(e,t),isNaN(i)?(this.#e.set([a,o,e,t],2),this.#t.push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(this.#e[0])&&this.#t.splice(6,6),this.#e.set([i,r,a,o,e,t],0),this.#t.push(...Me.createBezierPoints(i,r,a,o,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const i=this.add(e,t);return i||(this.#s.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,i,r,a){this.#l=i,this.#f=r,this.#n=a,[e,t]=this.#h(e,t);const o=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#s=[e,t];const c=this.#i.at(-1);return c&&(c.line=new Float32Array(c.line),c.points=new Float32Array(c.points)),this.#i.push({line:o,points:this.#s}),this.#e.set(o,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#i.at(-1)}setLastElement(e){return this.#i?(this.#i.push(e),this.#t=e.line,this.#s=e.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(e)}removeLastElement(){if(!this.#i)return this.#c.removeLastElement();this.#i.pop(),this.#r="";for(let e=0,t=this.#i.length;e<t;e++){const{line:i,points:r}=this.#i[e];this.#t=i,this.#s=r,this.#o=0,this.toSVGPath()}return{path:{d:this.#r}}}toSVGPath(){const e=Me.svgRound(this.#t[4]),t=Me.svgRound(this.#t[5]);if(this.#s.length===2)return this.#r=`${this.#r} M ${e} ${t} Z`,this.#r;if(this.#s.length<=6){const r=this.#r.lastIndexOf("M");this.#r=`${this.#r.slice(0,r)} M ${e} ${t}`,this.#o=6}if(this.#s.length===4){const r=Me.svgRound(this.#t[10]),a=Me.svgRound(this.#t[11]);return this.#r=`${this.#r} L ${r} ${a}`,this.#o=12,this.#r}const i=[];this.#o===0&&(i.push(`M ${e} ${t}`),this.#o=6);for(let r=this.#o,a=this.#t.length;r<a;r+=6){const[o,c,h,f,p,g]=this.#t.slice(r,r+6).map(Me.svgRound);i.push(`C${o} ${c} ${h} ${f} ${p} ${g}`)}return this.#r+=i.join(" "),this.#o=this.#t.length,this.#r}getOutlines(e,t,i,r){const a=this.#i.at(-1);return a.line=new Float32Array(a.line),a.points=new Float32Array(a.points),this.#c.build(this.#i,e,t,i,this.#n,this.#a,r),this.#e=null,this.#t=null,this.#i=null,this.#r=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class hu extends Me{#e;#t=0;#i;#n;#a;#s;#r;#o;#c;build(e,t,i,r,a,o,c){this.#a=t,this.#s=i,this.#r=r,this.#o=a,this.#c=o,this.#i=c??0,this.#n=e,this.#h()}get thickness(){return this.#c}setLastElement(e){return this.#n.push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#n.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of this.#n){if(e.push(`M${Me.svgRound(t[4])} ${Me.svgRound(t[5])}`),t.length===6){e.push("Z");continue}if(t.length===12&&isNaN(t[6])){e.push(`L${Me.svgRound(t[10])} ${Me.svgRound(t[11])}`);continue}for(let i=6,r=t.length;i<r;i+=6){const[a,o,c,h,f,p]=t.subarray(i,i+6).map(Me.svgRound);e.push(`C${a} ${o} ${c} ${h} ${f} ${p}`)}}return e.join("")}serialize([e,t,i,r],a){const o=[],c=[],[h,f,p,g]=this.#f();let m,y,w,_,b,E,T,S,k;switch(this.#o){case 0:k=Me._rescale,m=e,y=t+r,w=i,_=-r,b=e+h*i,E=t+(1-f-g)*r,T=e+(h+p)*i,S=t+(1-f)*r;break;case 90:k=Me._rescaleAndSwap,m=e,y=t,w=i,_=r,b=e+f*i,E=t+h*r,T=e+(f+g)*i,S=t+(h+p)*r;break;case 180:k=Me._rescale,m=e+i,y=t,w=-i,_=r,b=e+(1-h-p)*i,E=t+f*r,T=e+(1-h)*i,S=t+(f+g)*r;break;case 270:k=Me._rescaleAndSwap,m=e+i,y=t+r,w=-i,_=-r,b=e+(1-f-g)*i,E=t+(1-h-p)*r,T=e+(1-f)*i,S=t+(1-h)*r;break}for(const{line:P,points:F}of this.#n)o.push(k(P,m,y,w,_,a?new Array(P.length):null)),c.push(k(F,m,y,w,_,a?new Array(F.length):null));return{lines:o,points:c,rect:[b,E,T,S]}}static deserialize(e,t,i,r,a,{paths:{lines:o,points:c},rotation:h,thickness:f}){const p=[];let g,m,y,w,_;switch(h){case 0:_=Me._rescale,g=-e/i,m=t/r+1,y=1/i,w=-1/r;break;case 90:_=Me._rescaleAndSwap,g=-t/r,m=-e/i,y=1/r,w=1/i;break;case 180:_=Me._rescale,g=e/i+1,m=-t/r,y=-1/i,w=1/r;break;case 270:_=Me._rescaleAndSwap,g=t/r+1,m=e/i+1,y=-1/r,w=-1/i;break}if(!o){o=[];for(const E of c){const T=E.length;if(T===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1]]));continue}if(T===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1],NaN,NaN,NaN,NaN,E[2],E[3]]));continue}const S=new Float32Array(3*(T-2));o.push(S);let[k,P,F,O]=E.subarray(0,4);S.set([NaN,NaN,NaN,NaN,k,P],0);for(let G=4;G<T;G+=2){const M=E[G],W=E[G+1];S.set(Me.createBezierPoints(k,P,F,O,M,W),(G-2)*3),[k,P,F,O]=[F,O,M,W]}}}for(let E=0,T=o.length;E<T;E++)p.push({line:_(o[E].map(S=>S??NaN),g,m,y,w),points:_(c[E].map(S=>S??NaN),g,m,y,w)});const b=new this.prototype.constructor;return b.build(p,i,r,1,h,f,a),b}#l(e=this.#c){const t=this.#i+e/2*this.#r;return this.#o%180===0?[t/this.#a,t/this.#s]:[t/this.#s,t/this.#a]}#f(){const[e,t,i,r]=this.#e,[a,o]=this.#l(0);return[e+a,t+o,i-2*a,r-2*o]}#h(){const e=this.#e=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:r}of this.#n){if(r.length<=12){for(let c=4,h=r.length;c<h;c+=6)Ne.pointBoundingBox(r[c],r[c+1],e);continue}let a=r[4],o=r[5];for(let c=6,h=r.length;c<h;c+=6){const[f,p,g,m,y,w]=r.subarray(c,c+6);Ne.bezierBoundingBox(a,o,f,p,g,m,y,w,e),a=y,o=w}}const[t,i]=this.#l();e[0]=Wn(e[0]-t,0,1),e[1]=Wn(e[1]-i,0,1),e[2]=Wn(e[2]+t,0,1),e[3]=Wn(e[3]+i,0,1),e[2]-=e[0],e[3]-=e[1]}get box(){return this.#e}updateProperty(e,t){return e==="stroke-width"?this.#d(t):null}#d(e){const[t,i]=this.#l();this.#c=e;const[r,a]=this.#l(),[o,c]=[r-t,a-i],h=this.#e;return h[0]-=o,h[1]-=c,h[2]+=2*o,h[3]+=2*c,h}updateParentDimensions([e,t],i){const[r,a]=this.#l();this.#a=e,this.#s=t,this.#r=i;const[o,c]=this.#l(),h=o-r,f=c-a,p=this.#e;return p[0]-=h,p[1]-=f,p[2]+=2*h,p[3]+=2*f,p}updateRotation(e){return this.#t=e,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#e.map(Me.svgRound).join(" ")}get defaultProperties(){const[e,t]=this.#e;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Me.svgRound(e)} ${Me.svgRound(t)}`}}}get rotationTransform(){const[,,e,t]=this.#e;let i=0,r=0,a=0,o=0,c=0,h=0;switch(this.#t){case 90:r=t/e,a=-e/t,c=e;break;case 180:i=-1,o=-1,c=e,h=t;break;case 270:r=-t/e,a=e/t,h=t;break;default:return""}return`matrix(${i} ${r} ${a} ${o} ${Me.svgRound(c)} ${Me.svgRound(h)})`}getPathResizingSVGProperties([e,t,i,r]){const[a,o]=this.#l(),[c,h,f,p]=this.#e;if(Math.abs(f-a)<=Me.PRECISION||Math.abs(p-o)<=Me.PRECISION){const _=e+i/2-(c+f/2),b=t+r/2-(h+p/2);return{path:{"transform-origin":`${Me.svgRound(e)} ${Me.svgRound(t)}`,transform:`${this.rotationTransform} translate(${_} ${b})`}}}const g=(i-2*a)/(f-2*a),m=(r-2*o)/(p-2*o),y=f/i,w=p/r;return{path:{"transform-origin":`${Me.svgRound(c)} ${Me.svgRound(h)}`,transform:`${this.rotationTransform} scale(${y} ${w}) translate(${Me.svgRound(a)} ${Me.svgRound(o)}) scale(${g} ${m}) translate(${Me.svgRound(-a)} ${Me.svgRound(-o)})`}}}getPathResizedSVGProperties([e,t,i,r]){const[a,o]=this.#l(),c=this.#e,[h,f,p,g]=c;if(c[0]=e,c[1]=t,c[2]=i,c[3]=r,Math.abs(p-a)<=Me.PRECISION||Math.abs(g-o)<=Me.PRECISION){const b=e+i/2-(h+p/2),E=t+r/2-(f+g/2);for(const{line:T,points:S}of this.#n)Me._translate(T,b,E,T),Me._translate(S,b,E,S);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Me.svgRound(e)} ${Me.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const m=(i-2*a)/(p-2*a),y=(r-2*o)/(g-2*o),w=-m*(h+a)+e+a,_=-y*(f+o)+t+o;if(m!==1||y!==1||w!==0||_!==0)for(const{line:b,points:E}of this.#n)Me._rescale(b,w,_,m,y,b),Me._rescale(E,w,_,m,y,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Me.svgRound(e)} ${Me.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,t],i){const[r,a]=i,o=this.#e,c=e-o[0],h=t-o[1];if(this.#a===r&&this.#s===a)for(const{line:f,points:p}of this.#n)Me._translate(f,c,h,f),Me._translate(p,c,h,p);else{const f=this.#a/r,p=this.#s/a;this.#a=r,this.#s=a;for(const{line:g,points:m}of this.#n)Me._rescale(g,c,h,f,p,g),Me._rescale(m,c,h,f,p,m);o[2]*=f,o[3]*=p}return o[0]=e,o[1]=t,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Me.svgRound(e)} ${Me.svgRound(t)}`}}}get defaultSVGProperties(){const e=this.#e;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Me.svgRound(e[0])} ${Me.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}class Xf extends Gb{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:He._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??=this["stroke-width"],t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new Xf(this._viewParameters);return e.updateAll(this),e}}class Zg extends dt{static _type="ink";static _editorType=Ye.INK;static _defaultDrawingOptions=null;constructor(e){super({...e,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,t){He.initialize(e,t),this._defaultDrawingOptions=new Xf(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return Xe(this,"typesMap",new Map([[ot.INK_THICKNESS,"stroke-width"],[ot.INK_COLOR,"stroke"],[ot.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,i,r,a){return new kk(e,t,i,r,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,i,r,a,o){return hu.deserialize(e,t,i,r,a,o)}static async deserialize(e,t,i){let r=null;if(e instanceof Jg){const{data:{inkLists:o,rect:c,rotation:h,id:f,color:p,opacity:g,borderStyle:{rawWidth:m},popupRef:y,richText:w,contentsObj:_,creationDate:b,modificationDate:E},parent:{page:{pageNumber:T}}}=e;r=e={annotationType:Ye.INK,color:Array.from(p),thickness:m,opacity:g,paths:{points:o},boxes:null,pageIndex:T-1,rect:c.slice(0),rotation:h,annotationElementId:f,id:f,deleted:!1,popupRef:y,richText:w,comment:_?.str||null,creationDate:b,modificationDate:E}}const a=await super.deserialize(e,t,i);return a._initialData=r,e.comment&&a.setCommentData(e),a}get toolbarButtons(){return this._colorPicker||=new jc(this),[["colorPicker",this._colorPicker]]}get colorType(){return ot.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:i}=this;t.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:t,opacity:i}){this._drawingOptions=Zg.getDefaultDrawingOptions({stroke:Ne.makeHexColor(...e),"stroke-width":t,"stroke-opacity":i})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:i}=this.serializeDraw(e),{_drawingOptions:{stroke:r,"stroke-opacity":a,"stroke-width":o}}=this,c=Object.assign(super.serialize(e),{color:He._colorManager.convert(r),opacity:a,thickness:o,paths:{lines:t,points:i}});return this.addComment(c),e?(c.isCopy=!0,c):this.annotationElementId&&!this.#e(c)?null:(c.id=this.annotationElementId,c)}#e(e){const{color:t,thickness:i,opacity:r,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||e.color.some((o,c)=>o!==t[c])||e.thickness!==i||e.opacity!==r||e.pageIndex!==a}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;const{points:t,rect:i}=this.serializeDraw(!1);return e.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:t,popup:this.comment}),null}}class vg extends hu{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const Xh=8,mc=3;class zo{static#e={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#t(e,t,i,r){return i-=e,r-=t,i===0?r>0?0:4:i===1?r+6:2-r}static#i=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#n(e,t,i,r,a,o,c){const h=this.#t(i,r,a,o);for(let f=0;f<8;f++){const p=(-f+h-c+16)%8,g=this.#i[2*p],m=this.#i[2*p+1];if(e[(i+g)*t+(r+m)]!==0)return p}return-1}static#a(e,t,i,r,a,o,c){const h=this.#t(i,r,a,o);for(let f=0;f<8;f++){const p=(f+h+c+16)%8,g=this.#i[2*p],m=this.#i[2*p+1];if(e[(i+g)*t+(r+m)]!==0)return p}return-1}static#s(e,t,i,r){const a=e.length,o=new Int32Array(a);for(let p=0;p<a;p++)o[p]=e[p]<=r?1:0;for(let p=1;p<i-1;p++)o[p*t]=o[p*t+t-1]=0;for(let p=0;p<t;p++)o[p]=o[t*i-1-p]=0;let c=1,h;const f=[];for(let p=1;p<i-1;p++){h=1;for(let g=1;g<t-1;g++){const m=p*t+g,y=o[m];if(y===0)continue;let w=p,_=g;if(y===1&&o[m-1]===0)c+=1,_-=1;else if(y>=1&&o[m+1]===0)c+=1,_+=1,y>1&&(h=y);else{y!==1&&(h=Math.abs(y));continue}const b=[g,p],E=_===g+1,T={isHole:E,points:b,id:c,parent:0};f.push(T);let S;for(const Y of f)if(Y.id===h){S=Y;break}S?S.isHole?T.parent=E?S.parent:h:T.parent=E?h:S.parent:T.parent=E?h:0;const k=this.#n(o,t,p,g,w,_,0);if(k===-1){o[m]=-c,o[m]!==1&&(h=Math.abs(o[m]));continue}let P=this.#i[2*k],F=this.#i[2*k+1];const O=p+P,G=g+F;w=O,_=G;let M=p,W=g;for(;;){const Y=this.#a(o,t,M,W,w,_,1);P=this.#i[2*Y],F=this.#i[2*Y+1];const ce=M+P,ve=W+F;b.push(ve,ce);const Ce=M*t+W;if(o[Ce+1]===0?o[Ce]=-c:o[Ce]===1&&(o[Ce]=c),ce===p&&ve===g&&M===O&&W===G){o[m]!==1&&(h=Math.abs(o[m]));break}else w=M,_=W,M=ce,W=ve}}}return f}static#r(e,t,i,r){if(i-t<=4){for(let O=t;O<i-2;O+=2)r.push(e[O],e[O+1]);return}const a=e[t],o=e[t+1],c=e[i-4]-a,h=e[i-3]-o,f=Math.hypot(c,h),p=c/f,g=h/f,m=p*o-g*a,y=h/c,w=1/f,_=Math.atan(y),b=Math.cos(_),E=Math.sin(_),T=w*(Math.abs(b)+Math.abs(E)),S=w*(1-T+T**2),k=Math.max(Math.atan(Math.abs(E+b)*S),Math.atan(Math.abs(E-b)*S));let P=0,F=t;for(let O=t+2;O<i-2;O+=2){const G=Math.abs(m-p*e[O+1]+g*e[O]);G>P&&(F=O,P=G)}P>(f*k)**2?(this.#r(e,t,F+2,r),this.#r(e,F,i,r)):r.push(a,o)}static#o(e){const t=[],i=e.length;return this.#r(e,0,i,t),t.push(e[i-2],e[i-1]),t.length<=4?null:t}static#c(e,t,i,r,a,o){const c=new Float32Array(o**2),h=-2*r**2,f=o>>1;for(let _=0;_<o;_++){const b=(_-f)**2;for(let E=0;E<o;E++)c[_*o+E]=Math.exp((b+(E-f)**2)/h)}const p=new Float32Array(256),g=-2*a**2;for(let _=0;_<256;_++)p[_]=Math.exp(_**2/g);const m=e.length,y=new Uint8Array(m),w=new Uint32Array(256);for(let _=0;_<i;_++)for(let b=0;b<t;b++){const E=_*t+b,T=e[E];let S=0,k=0;for(let F=0;F<o;F++){const O=_+F-f;if(!(O<0||O>=i))for(let G=0;G<o;G++){const M=b+G-f;if(M<0||M>=t)continue;const W=e[O*t+M],Y=c[F*o+G]*p[Math.abs(W-T)];S+=W*Y,k+=Y}}const P=y[E]=Math.round(S/k);w[P]++}return[y,w]}static#l(e){const t=new Uint32Array(256);for(const i of e)t[i]++;return t}static#f(e){const t=e.length,i=new Uint8ClampedArray(t>>2);let r=-1/0,a=1/0;for(let c=0,h=i.length;c<h;c++){const f=i[c]=e[c<<2];r=Math.max(r,f),a=Math.min(a,f)}const o=255/(r-a);for(let c=0,h=i.length;c<h;c++)i[c]=(i[c]-a)*o;return i}static#h(e){let t,i=-1/0,r=-1/0;const a=e.findIndex(h=>h!==0);let o=a,c=a;for(t=a;t<256;t++){const h=e[t];h>i&&(t-o>r&&(r=t-o,c=t-1),i=h,o=t)}for(t=c-1;t>=0&&!(e[t]>e[t+1]);t--);return t}static#d(e){const t=e,{width:i,height:r}=e,{maxDim:a}=this.#e;let o=i,c=r;if(i>a||r>a){let m=i,y=r,w=Math.log2(Math.max(i,r)/a);const _=Math.floor(w);w=w===_?_-1:_;for(let E=0;E<w;E++){o=Math.ceil(m/2),c=Math.ceil(y/2);const T=new OffscreenCanvas(o,c);T.getContext("2d").drawImage(e,0,0,m,y,0,0,o,c),m=o,y=c,e!==t&&e.close(),e=T.transferToImageBitmap()}const b=Math.min(a/o,a/c);o=Math.round(o*b),c=Math.round(c*b)}const f=new OffscreenCanvas(o,c).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,o,c),f.filter="grayscale(1)",f.drawImage(e,0,0,e.width,e.height,0,0,o,c);const p=f.getImageData(0,0,o,c).data;return[this.#f(p),o,c]}static extractContoursFromText(e,{fontFamily:t,fontStyle:i,fontWeight:r},a,o,c,h){let f=new OffscreenCanvas(1,1),p=f.getContext("2d",{alpha:!1});const g=200,m=p.font=`${i} ${r} ${g}px ${t}`,{actualBoundingBoxLeft:y,actualBoundingBoxRight:w,actualBoundingBoxAscent:_,actualBoundingBoxDescent:b,fontBoundingBoxAscent:E,fontBoundingBoxDescent:T,width:S}=p.measureText(e),k=1.5,P=Math.ceil(Math.max(Math.abs(y)+Math.abs(w)||0,S)*k),F=Math.ceil(Math.max(Math.abs(_)+Math.abs(b)||g,Math.abs(E)+Math.abs(T)||g)*k);f=new OffscreenCanvas(P,F),p=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),p.font=m,p.filter="grayscale(1)",p.fillStyle="white",p.fillRect(0,0,P,F),p.fillStyle="black",p.fillText(e,P*(k-1)/2,F*(3-k)/2);const O=this.#f(p.getImageData(0,0,P,F).data),G=this.#l(O),M=this.#h(G),W=this.#s(O,P,F,M);return this.processDrawnLines({lines:{curves:W,width:P,height:F},pageWidth:a,pageHeight:o,rotation:c,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(e,t,i,r,a){const[o,c,h]=this.#d(e),[f,p]=this.#c(o,c,h,Math.hypot(c,h)*this.#e.sigmaSFactor,this.#e.sigmaR,this.#e.kernelSize),g=this.#h(p),m=this.#s(f,c,h,g);return this.processDrawnLines({lines:{curves:m,width:c,height:h},pageWidth:t,pageHeight:i,rotation:r,innerMargin:a,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:i,rotation:r,innerMargin:a,mustSmooth:o,areContours:c}){r%180!==0&&([t,i]=[i,t]);const{curves:h,width:f,height:p}=e,g=e.thickness??0,m=[],y=Math.min(t/f,i/p),w=y/t,_=y/i,b=[];for(const{points:T}of h){const S=o?this.#o(T):T;if(!S)continue;b.push(S);const k=S.length,P=new Float32Array(k),F=new Float32Array(3*(k===2?2:k-2));if(m.push({line:F,points:P}),k===2){P[0]=S[0]*w,P[1]=S[1]*_,F.set([NaN,NaN,NaN,NaN,P[0],P[1]],0);continue}let[O,G,M,W]=S;O*=w,G*=_,M*=w,W*=_,P.set([O,G,M,W],0),F.set([NaN,NaN,NaN,NaN,O,G],0);for(let Y=4;Y<k;Y+=2){const ce=P[Y]=S[Y]*w,ve=P[Y+1]=S[Y+1]*_;F.set(Me.createBezierPoints(O,G,M,W,ce,ve),(Y-2)*3),[O,G,M,W]=[M,W,ce,ve]}}if(m.length===0)return null;const E=c?new vg:new hu;return E.build(m,t,i,1,r,c?0:g,a),{outline:E,newCurves:b,areContours:c,thickness:g,width:f,height:p}}static async compressSignature({outlines:e,areContours:t,thickness:i,width:r,height:a}){let o=1/0,c=-1/0,h=0;for(const S of e){h+=S.length;for(let k=2,P=S.length;k<P;k++){const F=S[k]-S[k-2];o=Math.min(o,F),c=Math.max(c,F)}}let f;o>=-128&&c<=127?f=Int8Array:o>=-32768&&c<=32767?f=Int16Array:f=Int32Array;const p=e.length,g=Xh+mc*p,m=new Uint32Array(g);let y=0;m[y++]=g*Uint32Array.BYTES_PER_ELEMENT+(h-2*p)*f.BYTES_PER_ELEMENT,m[y++]=0,m[y++]=r,m[y++]=a,m[y++]=t?0:1,m[y++]=Math.max(0,Math.floor(i??0)),m[y++]=p,m[y++]=f.BYTES_PER_ELEMENT;for(const S of e)m[y++]=S.length-2,m[y++]=S[0],m[y++]=S[1];const w=new CompressionStream("deflate-raw"),_=w.writable.getWriter();await _.ready,_.write(m);const b=f.prototype.constructor;for(const S of e){const k=new b(S.length-2);for(let P=2,F=S.length;P<F;P++)k[P-2]=S[P]-S[P-2];_.write(k)}_.close();const E=await new Response(w.readable).arrayBuffer(),T=new Uint8Array(E);return pb(T)}static async decompressSignature(e){try{const t=qR(e),{readable:i,writable:r}=new DecompressionStream("deflate-raw"),a=r.getWriter();await a.ready,a.write(t).then(async()=>{await a.ready,await a.close()}).catch(()=>{});let o=null,c=0;for await(const S of i)o||=new Uint8Array(new Uint32Array(S.buffer,0,4)[0]),o.set(S,c),c+=S.length;const h=new Uint32Array(o.buffer,0,o.length>>2),f=h[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const p=h[2],g=h[3],m=h[4]===0,y=h[5],w=h[6],_=h[7],b=[],E=(Xh+mc*w)*Uint32Array.BYTES_PER_ELEMENT;let T;switch(_){case Int8Array.BYTES_PER_ELEMENT:T=new Int8Array(o.buffer,E);break;case Int16Array.BYTES_PER_ELEMENT:T=new Int16Array(o.buffer,E);break;case Int32Array.BYTES_PER_ELEMENT:T=new Int32Array(o.buffer,E);break}c=0;for(let S=0;S<w;S++){const k=h[mc*S+Xh],P=new Float32Array(k+2);b.push(P);for(let F=0;F<mc-1;F++)P[F]=h[mc*S+Xh+F+1];for(let F=0;F<k;F++)P[F+2]=P[F]+T[c++]}return{areContours:m,thickness:y,outlines:b,width:p,height:g}}catch(t){return We(`decompressSignature: ${t}`),null}}}class em extends Gb{constructor(){super(),super.updateProperties({fill:He._defaultLineColor,"stroke-width":0})}clone(){const e=new em;return e.updateAll(this),e}}class tm extends Xf{constructor(e){super(e),super.updateProperties({stroke:He._defaultLineColor,"stroke-width":1})}clone(){const e=new tm(this._viewParameters);return e.updateAll(this),e}}class Tr extends dt{#e=!1;#t=null;#i=null;#n=null;static _type="signature";static _editorType=Ye.SIGNATURE;static _defaultDrawingOptions=null;constructor(e){super({...e,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#i=e.signatureData||null,this.#t=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,t){He.initialize(e,t),this._defaultDrawingOptions=new em,this._defaultDrawnSignatureOptions=new tm(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!1}static get typesMap(){return Xe(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#t}}static computeTelemetryFinalData(e){const t=e.get("hasDescription");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,t;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,e=this.x,t=this.y),super.render(),this._drawId===null)if(this.#i){const{lines:r,mustSmooth:a,areContours:o,description:c,uuid:h,heightInPage:f}=this.#i,{rawDims:{pageWidth:p,pageHeight:g},rotation:m}=this.parent.viewport,y=zo.processDrawnLines({lines:r,pageWidth:p,pageHeight:g,rotation:m,innerMargin:Tr._INNER_MARGIN,mustSmooth:a,areContours:o});this.addSignature(y,f,c,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#t||""}));return i&&(this._isCopy=!0,this._moveAfterPaste(e,t)),this.div}setUuid(e){this.#n=e,this.addEditToolbar()}getUuid(){return this.#n}get description(){return this.#t}set description(e){this.#t=e,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:e})),super.addEditToolbar().then(t=>{t?.updateEditSignatureButton(e)}))}getSignaturePreview(){const{newCurves:e,areContours:t,thickness:i,width:r,height:a}=this.#i,o=Math.max(r,a),c=zo.processDrawnLines({lines:{curves:e.map(h=>({points:h})),thickness:i,width:r,height:a},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:t});return{areContours:t,outline:c.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(e,t,i,r){const{x:a,y:o}=this,{outline:c}=this.#i=e;this.#e=c instanceof vg,this.description=i;let h;this.#e?h=Tr.getDefaultDrawingOptions():(h=Tr._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":c.thickness})),this._addOutlines({drawOutlines:c,drawingOptions:h});const[,f]=this.pageDimensions;let p=t/f;p=p>=1?.5:p,this.width*=p/this.height,this.width>=1&&(p*=.9/this.width,this.width=.9),this.height=p,this.setDims(),this.x=a,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:t,pageHeight:i},rotation:r}=this.parent.viewport;return zo.process(e,t,i,r,Tr._INNER_MARGIN)}getFromText(e,t){const{rawDims:{pageWidth:i,pageHeight:r},rotation:a}=this.parent.viewport;return zo.extractContoursFromText(e,t,i,r,a,Tr._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:t,pageHeight:i},rotation:r}=this.parent.viewport;return zo.processDrawnLines({lines:e,pageWidth:t,pageHeight:i,rotation:r,innerMargin:Tr._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:e,thickness:t}){e?this._drawingOptions=Tr.getDefaultDrawingOptions():(this._drawingOptions=Tr._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":t}))}serialize(e=!1){if(this.isEmpty())return null;const{lines:t,points:i}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":r}}=this,a=Object.assign(super.serialize(e),{isSignature:!0,areContours:this.#e,color:[0,0,0],thickness:this.#e?0:r});return this.addComment(a),e?(a.paths={lines:t,points:i},a.uuid=this.#n,a.isCopy=!0):a.lines=t,this.#t&&(a.accessibilityData={type:"Figure",alt:this.#t}),a}static deserializeDraw(e,t,i,r,a,o){return o.areContours?vg.deserialize(e,t,i,r,a,o):hu.deserialize(e,t,i,r,a,o)}static async deserialize(e,t,i){const r=await super.deserialize(e,t,i);return r.#e=e.areContours,r.description=e.accessibilityData?.alt||"",r.#n=e.uuid,r}}class Dk extends He{#e=null;#t=null;#i=null;#n=null;#a=null;#s="";#r=null;#o=!1;#c=null;#l=!1;#f=!1;static _type="stamp";static _editorType=Ye.STAMP;constructor(e){super({...e,name:"stampEditor"}),this.#n=e.bitmapUrl,this.#a=e.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,t){He.initialize(e,t)}static isHandlingMimeForPasting(e){return lg.includes(e)}static paste(e,t){t.pasteEditor({mode:Ye.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){const t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#h(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#l=e.isSvg),e.file&&(this.#s=e.file.name),this.#g()}#d(){if(this.#i=null,this._uiManager.enableWaiting(!1),!!this.#r){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(e=null,t=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:a,height:o}=e||this.copyCanvas(null,null,!0).imageData,c=await i.guess({name:"altText",request:{data:r,width:a,height:o,channels:r.length/(a*o)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const h=c.output;return await this.setGuessedAltText(h),t&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}#m(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(i=>this.#h(i,!0)).finally(()=>this.#d());return}if(this.#n){const i=this.#n;this.#n=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromUrl(i).then(r=>this.#h(r)).finally(()=>this.#d());return}if(this.#a){const i=this.#a;this.#a=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromFile(i).then(r=>this.#h(r)).finally(()=>this.#d());return}const e=document.createElement("input");e.type="file",e.accept=lg.join(",");const t=this._uiManager._signal;this.#i=new Promise(i=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(r)}i()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),i()},{signal:t})}).finally(()=>this.#d()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#r?.remove(),this.#r=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#m();return}super.rebuild(),this.div!==null&&(this.#t&&this.#r===null&&this.#m(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(this.#i||this.#e||this.#n||this.#a||this.#t||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;return this._isCopy&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#e?this.#g():this.#m()),this._isCopy&&this._moveAfterPaste(e,t),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,t){const{id:i,bitmap:r}=this._uiManager.imageManager.getFromCanvas(e,t);t.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(this.#t=i,r&&(this.#e=r),this.#o=!1,this.#g())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const e=200;this.#c=setTimeout(()=>{this.#c=null,this.#p()},e)}#g(){const{div:e}=this;let{width:t,height:i}=this.#e;const[r,a]=this.pageDimensions,o=.75;if(this.width)t=this.width*r,i=this.height*a;else if(t>o*r||i>o*a){const h=Math.min(o*r/t,o*a/i);t*=h,i*=h}this._uiManager.enableWaiting(!1);const c=this.#r=document.createElement("canvas");c.setAttribute("role","img"),this.addContainer(c),this.width=t/r,this.height=i/a,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#p(),this.#f||(this.parent.addUndoableEditor(this),this.#f=!0),this._reportTelemetry({action:"inserted_image"}),this.#s&&this.div.setAttribute("aria-description",this.#s),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(e,t,i=!1){e||(e=224);const{width:r,height:a}=this.#e,o=new Or;let c=this.#e,h=r,f=a,p=null;if(t){if(r>t||a>t){const F=Math.min(t/r,t/a);h=Math.floor(r*F),f=Math.floor(a*F)}p=document.createElement("canvas");const m=p.width=Math.ceil(h*o.sx),y=p.height=Math.ceil(f*o.sy);this.#l||(c=this.#u(m,y));const w=p.getContext("2d");w.filter=this._uiManager.hcmFilter;let _="white",b="#cfcfd8";this._uiManager.hcmFilter!=="none"?b="black":QR.isDarkMode&&(_="#8f8f9d",b="#42414d");const E=15,T=E*o.sx,S=E*o.sy,k=new OffscreenCanvas(T*2,S*2),P=k.getContext("2d");P.fillStyle=_,P.fillRect(0,0,T*2,S*2),P.fillStyle=b,P.fillRect(0,0,T,S),P.fillRect(T,S,T,S),w.fillStyle=w.createPattern(k,"repeat"),w.fillRect(0,0,m,y),w.drawImage(c,0,0,c.width,c.height,0,0,m,y)}let g=null;if(i){let m,y;if(o.symmetric&&c.width<e&&c.height<e)m=c.width,y=c.height;else if(c=this.#e,r>e||a>e){const b=Math.min(e/r,e/a);m=Math.floor(r*b),y=Math.floor(a*b),this.#l||(c=this.#u(m,y))}const _=new OffscreenCanvas(m,y).getContext("2d",{willReadFrequently:!0});_.drawImage(c,0,0,c.width,c.height,0,0,m,y),g={width:m,height:y,data:_.getImageData(0,0,m,y).data}}return{canvas:p,width:h,height:f,imageData:g}}#u(e,t){const{width:i,height:r}=this.#e;let a=i,o=r,c=this.#e;for(;a>2*e||o>2*t;){const h=a,f=o;a>2*e&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const p=new OffscreenCanvas(a,o);p.getContext("2d").drawImage(c,0,0,h,f,0,0,a,o),c=p.transferToImageBitmap()}return c}#p(){const[e,t]=this.parentDimensions,{width:i,height:r}=this,a=new Or,o=Math.ceil(i*e*a.sx),c=Math.ceil(r*t*a.sy),h=this.#r;if(!h||h.width===o&&h.height===c)return;h.width=o,h.height=c;const f=this.#l?this.#e:this.#u(o,c),p=h.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(f,0,0,f.width,f.height,0,0,o,c)}#v(e){if(e){if(this.#l){const r=this._uiManager.imageManager.getSvgUrl(this.#t);if(r)return r}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#l){const[t,i]=this.pageDimensions,r=Math.round(this.width*t*ll.PDF_TO_CSS_UNITS),a=Math.round(this.height*i*ll.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(r,a);return o.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,r,a),o.transferToImageBitmap()}return structuredClone(this.#e)}static async deserialize(e,t,i){let r=null,a=!1;if(e instanceof zb){const{data:{rect:_,rotation:b,id:E,structParent:T,popupRef:S,richText:k,contentsObj:P,creationDate:F,modificationDate:O},container:G,parent:{page:{pageNumber:M}},canvas:W}=e;let Y,ce;W?(delete e.canvas,{id:Y,bitmap:ce}=i.imageManager.getFromCanvas(G.id,W),W.remove()):(a=!0,e._hasNoCanvas=!0);const ve=(await t._structTree.getAriaAttributes(`${Wo}${E}`))?.get("aria-label")||"";r=e={annotationType:Ye.STAMP,bitmapId:Y,bitmap:ce,pageIndex:M-1,rect:_.slice(0),rotation:b,annotationElementId:E,id:E,deleted:!1,accessibilityData:{decorative:!1,altText:ve},isSvg:!1,structParent:T,popupRef:S,richText:k,comment:P?.str||null,creationDate:F,modificationDate:O}}const o=await super.deserialize(e,t,i),{rect:c,bitmap:h,bitmapUrl:f,bitmapId:p,isSvg:g,accessibilityData:m}=e;a?(i.addMissingCanvas(e.id,o),o.#o=!0):p&&i.imageManager.isValidId(p)?(o.#t=p,h&&(o.#e=h)):o.#n=f,o.#l=g;const[y,w]=o.pageDimensions;return o.width=(c[2]-c[0])/y,o.height=(c[3]-c[1])/w,m&&(o.altTextData=m),o._initialData=r,e.comment&&o.setCommentData(e),o.#f=!!r,o}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Object.assign(super.serialize(e),{bitmapId:this.#t,isSvg:this.#l});if(this.addComment(i),e)return i.bitmapUrl=this.#v(!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:r,altText:a}=this.serializeAltText(!1);if(!r&&a&&(i.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const c=this.#_(i);return c.isSame?null:(c.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1,i.id=this.annotationElementId,delete i.bitmapId,i)}if(t===null)return i;t.stamps||=new Map;const o=this.#l?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:o,serialized:i}),i.bitmap=this.#v(!1);else if(this.#l){const c=t.stamps.get(this.#t);o>c.area&&(c.area=o,c.serialized.bitmap.close(),c.serialized.bitmap=this.#v(!1))}return i}#_(e){const{pageIndex:t,accessibilityData:{altText:i}}=this._initialData,r=e.pageIndex===t,a=(e.accessibilityData?.alt||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&r&&a,isSameAltText:a}}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class Jr{#e;#t=!1;#i=null;#n=null;#a=null;#s=new Map;#r=!1;#o=!1;#c=!1;#l=null;#f=null;#h=null;#d=null;#m=null;#g=-1;#u;static _initialized=!1;static#p=new Map([xn,Zg,Dk,tn,Tr].map(e=>[e._editorType,e]));constructor({uiManager:e,pageIndex:t,div:i,structTreeLayer:r,accessibilityManager:a,annotationLayer:o,drawLayer:c,textLayer:h,viewport:f,l10n:p}){const g=[...Jr.#p.values()];if(!Jr._initialized){Jr._initialized=!0;for(const m of g)m.initialize(p,e)}e.registerEditorTypes(g),this.#u=e,this.pageIndex=t,this.div=i,this.#e=a,this.#i=o,this.viewport=f,this.#h=h,this.drawLayer=c,this._structTree=r,this.#u.addLayer(this)}get isEmpty(){return this.#s.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===Ye.NONE}updateToolbar(e){this.#u.updateToolbar(e)}updateMode(e=this.#u.getMode()){switch(this.#w(),e){case Ye.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Ye.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Ye.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===Ye.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const i of Jr.#p.values())t.toggle(`${i._type}Editing`,e===i._editorType)}this.div.hidden=!1}hasTextLayer(e){return e===this.#h?.div}setEditingState(e){this.#u.setEditingState(e)}addCommands(e){this.#u.addCommands(e)}cleanUndoStack(e){this.#u.cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){this.#i?.togglePointerEvents(e)}get#v(){return this.#s.size!==0?this.#s.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#m?.abort(),this.#m=null;const e=new Set;for(const i of this.#v)i.enableEditing(),i.show(!0),i.annotationElementId&&(this.#u.removeChangedExistingAnnotation(i),e.add(i.annotationElementId));const t=this.#i;if(t)for(const i of t.getEditableAnnotations()){if(i.hide(),this.#u.isDeletedAnnotationElement(i.data.id)||e.has(i.data.id))continue;const r=await this.deserialize(i);r&&(this.addOrRebuild(r),r.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#h&&!this.#m){this.#m=new AbortController;const r=this.#u.combinedSignal(this.#m);this.#h.div.addEventListener("pointerdown",a=>{const{clientX:c,clientY:h,timeStamp:f}=a,p=this.#g;if(f-p>500){this.#g=f;return}this.#g=-1;const{classList:g}=this.div;g.toggle("getElements",!0);const m=document.elementsFromPoint(c,h);if(g.toggle("getElements",!1),!this.div.contains(m[0]))return;let y;const w=new RegExp(`^${Ic}[0-9]+$`);for(const b of m)if(w.test(b.id)){y=b.id;break}if(!y)return;const _=this.#s.get(y);_?.annotationElementId===null&&(a.stopPropagation(),a.preventDefault(),_.dblclick(a))},{signal:r,capture:!0})}const e=this.#i,t=[];if(e){const r=new Map,a=new Map;for(const c of this.#v){if(c.disableEditing(),!c.annotationElementId){t.push(c);continue}if(c.serialize()!==null){r.set(c.annotationElementId,c);continue}else a.set(c.annotationElementId,c);this.getEditableAnnotation(c.annotationElementId)?.show(),c.remove()}const o=e.getEditableAnnotations();for(const c of o){const{id:h}=c.data;if(this.#u.isDeletedAnnotationElement(h)){c.updateEdited({deleted:!0});continue}let f=a.get(h);if(f){f.resetAnnotationElement(c),f.show(!1),c.show();continue}f=r.get(h),f&&(this.#u.addChangedExistingAnnotation(f),f.renderAnnotationElement(c)&&f.show(!1)),c.show()}}this.#w(),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const r of Jr.#p.values())i.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),e?.updateFakeAnnotations(t),this.#o=!1}getEditableAnnotation(e){return this.#i?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#u.getActive()!==e&&this.#u.setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#d){this.#d=new AbortController;const e=this.#u.combinedSignal(this.#d);this.#h.div.addEventListener("pointerdown",this.#_.bind(this),{signal:e}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#d&&(this.#d.abort(),this.#d=null,this.#h.div.classList.remove("highlighting"))}#_(e){this.#u.unselectAll();const{target:t}=e;if(t===this.#h.div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&this.#h.div.contains(t)){const{isMac:i}=vn.platform;if(e.button!==0||e.ctrlKey&&i)return;this.#u.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),tn.startHighlighting(this,this.#u.direction==="ltr",{target:this.#h.div,x:e.x,y:e.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),e.preventDefault()}}enableClick(){if(this.#n)return;this.#n=new AbortController;const e=this.#u.combinedSignal(this.#n);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){this.#n?.abort(),this.#n=null}attach(e){this.#s.set(e.id,e);const{annotationElementId:t}=e;t&&this.#u.isDeletedAnnotationElement(t)&&this.#u.removeDeletedAnnotationElement(e)}detach(e){this.#s.delete(e.id),this.#e?.removePointerInTextLayer(e.contentDiv),!this.#o&&e.annotationElementId&&this.#u.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#u.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(this.#u.addDeletedAnnotationElement(e),He.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),this.#u.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!this.#c),this.#u.addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!this.#a&&(e._focusEventsAllowed=!1,this.#a=setTimeout(()=>{this.#a=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),t.focus())},0)),e._structTreeParentId=this.#e?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),i=()=>{e.remove()};this.addCommands({cmd:t,undo:i,mustExec:!1})}getEditorByUID(e){for(const t of this.#s.values())if(t.uid===e)return t;return null}getNextId(){return this.#u.getId()}get#y(){return Jr.#p.get(this.#u.getMode())}combinedSignal(e){return this.#u.combinedSignal(e)}#A(e){const t=this.#y;return t?new t.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#y?.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await this.#u.updateMode(e.mode);const{offsetX:i,offsetY:r}=this.#E(),a=this.getNextId(),o=this.#A({parent:this,id:a,x:i,y:r,uiManager:this.#u,isCentered:!0,...t});o&&this.add(o)}async deserialize(e){return await Jr.#p.get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,this.#u)||null}createAndAddNewEditor(e,t,i={}){const r=this.getNextId(),a=this.#A({parent:this,id:r,x:e.offsetX,y:e.offsetY,uiManager:this.#u,isCentered:t,...i});return a&&this.add(a),a}get boundingClientRect(){return this.div.getBoundingClientRect()}#E(){const{x:e,y:t,width:i,height:r}=this.boundingClientRect,a=Math.max(0,e),o=Math.max(0,t),c=Math.min(window.innerWidth,e+i),h=Math.min(window.innerHeight,t+r),f=(a+c)/2-e,p=(o+h)/2-t,[g,m]=this.viewport.rotation%180===0?[f,p]:[p,f];return{offsetX:g,offsetY:m}}addNewEditor(e={}){this.createAndAddNewEditor(this.#E(),!0,e)}setSelected(e){this.#u.setSelected(e)}toggleSelected(e){this.#u.toggleSelected(e)}unselect(e){this.#u.unselect(e)}pointerup(e){const{isMac:t}=vn.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!this.#r||(this.#r=!1,this.#y?.isDrawer&&this.#y.supportMultipleDrawings))return;if(!this.#t){this.#t=!0;return}const i=this.#u.getMode();if(i===Ye.STAMP||i===Ye.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){if(this.#u.getMode()===Ye.HIGHLIGHT&&this.enableTextSelection(),this.#r){this.#r=!1;return}const{isMac:t}=vn.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(this.#r=!0,this.#y?.isDrawer){this.startDrawingSession(e);return}const i=this.#u.getActive();this.#t=!i||i.isEmpty()}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),this.#l){this.#y.startDrawing(this,this.#u,!1,e);return}this.#u.setCurrentDrawingSession(this),this.#l=new AbortController;const t=this.#u.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(this.#f=null,this.commitOrRemove())},{signal:t}),this.#y.startDrawing(this,this.#u,!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&(this.#f=t);return}this.#f&&setTimeout(()=>{this.#f?.focus(),this.#f=null},0)}endDrawingSession(e=!1){return this.#l?(this.#u.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#f=null,this.#y.endDrawing(e)):null}findNewParent(e,t,i){const r=this.#u.findParent(t,i);return r===null||r===this?!1:(r.changeParent(e),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#y.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#a&&(clearTimeout(this.#a),this.#a=null);for(const e of this.#s.values())this.#e?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#s.clear(),this.#u.removeLayer(this)}#w(){for(const e of this.#s.values())e.isEmpty()&&e.remove()}render({viewport:e}){this.viewport=e,Ra(this.div,e);for(const t of this.#u.getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){this.#u.commitOrRemove(),this.#w();const t=this.viewport.rotation,i=e.rotation;if(this.viewport=e,Ra(this.div,{rotation:i}),t!==i)for(const r of this.#s.values())r.rotate(i)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return this.#u.viewParameters.realScale}}class On{#e=null;#t=new Map;#i=new Map;static#n=0;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#t.size>0)for(const t of this.#t.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return Xe(this,"_svgFactory",new _f)}static#a(e,[t,i,r,a]){const{style:o}=e;o.top=`${100*i}%`,o.left=`${100*t}%`,o.width=`${100*r}%`,o.height=`${100*a}%`}#s(){const e=On._svgFactory.create(1,1,!0);return this.#e.append(e),e.setAttribute("aria-hidden",!0),e}#r(e,t){const i=On._svgFactory.createElement("clipPath");e.append(i);const r=`clip_${t}`;i.setAttribute("id",r),i.setAttribute("clipPathUnits","objectBoundingBox");const a=On._svgFactory.createElement("use");return i.append(a),a.setAttribute("href",`#${t}`),a.classList.add("clip"),r}#o(e,t){for(const[i,r]of Object.entries(t))r===null?e.removeAttribute(i):e.setAttribute(i,r)}draw(e,t=!1,i=!1){const r=On.#n++,a=this.#s(),o=On._svgFactory.createElement("defs");a.append(o);const c=On._svgFactory.createElement("path");o.append(c);const h=`path_p${this.pageIndex}_${r}`;c.setAttribute("id",h),c.setAttribute("vector-effect","non-scaling-stroke"),t&&this.#i.set(r,c);const f=i?this.#r(o,h):null,p=On._svgFactory.createElement("use");return a.append(p),p.setAttribute("href",`#${h}`),this.updateProperties(a,e),this.#t.set(r,a),{id:r,clipPathId:`url(#${f})`}}drawOutline(e,t){const i=On.#n++,r=this.#s(),a=On._svgFactory.createElement("defs");r.append(a);const o=On._svgFactory.createElement("path");a.append(o);const c=`path_p${this.pageIndex}_${i}`;o.setAttribute("id",c),o.setAttribute("vector-effect","non-scaling-stroke");let h;if(t){const g=On._svgFactory.createElement("mask");a.append(g),h=`mask_p${this.pageIndex}_${i}`,g.setAttribute("id",h),g.setAttribute("maskUnits","objectBoundingBox");const m=On._svgFactory.createElement("rect");g.append(m),m.setAttribute("width","1"),m.setAttribute("height","1"),m.setAttribute("fill","white");const y=On._svgFactory.createElement("use");g.append(y),y.setAttribute("href",`#${c}`),y.setAttribute("stroke","none"),y.setAttribute("fill","black"),y.setAttribute("fill-rule","nonzero"),y.classList.add("mask")}const f=On._svgFactory.createElement("use");r.append(f),f.setAttribute("href",`#${c}`),h&&f.setAttribute("mask",`url(#${h})`);const p=f.cloneNode();return r.append(p),f.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(r,e),this.#t.set(i,r),i}finalizeDraw(e,t){this.#i.delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:i,bbox:r,rootClass:a,path:o}=t,c=typeof e=="number"?this.#t.get(e):e;if(c){if(i&&this.#o(c,i),r&&On.#a(c,r),a){const{classList:h}=c;for(const[f,p]of Object.entries(a))h.toggle(f,p)}if(o){const f=c.firstElementChild.firstElementChild;this.#o(f,o)}}}updateParent(e,t){if(t===this)return;const i=this.#t.get(e);i&&(t.#e.append(i),this.#t.delete(e),t.#t.set(e,i))}remove(e){this.#i.delete(e),this.#e!==null&&(this.#t.get(e).remove(),this.#t.delete(e))}destroy(){this.#e=null;for(const e of this.#t.values())e.remove();this.#t.clear(),this.#i.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:gg};globalThis.pdfjsLib={AbortException:Gs,AnnotationEditorLayer:Jr,AnnotationEditorParamsType:ot,AnnotationEditorType:Ye,AnnotationEditorUIManager:Vs,AnnotationLayer:Qg,AnnotationMode:Bs,AnnotationType:cn,applyOpacity:eO,build:ok,ColorPicker:Wi,createValidAbsoluteUrl:ub,CSSConstants:ZR,DOMSVGFactory:_f,DrawLayer:On,FeatureTest:vn,fetchData:au,findContrastColor:tO,getDocument:Mb,getFilenameFromUrl:WR,getPdfFilenameFromUrl:XR,getRGB:lu,getUuid:db,getXfaPageViewport:KR,GlobalWorkerOptions:tl,ImageKind:hf,InvalidPDFException:ag,isDataScheme:Vf,isPdfFile:zg,isValidExplicitDest:fO,MathClamp:Wn,noContextMenu:Yi,normalizeUnicode:GR,OPS:Pc,OutputScale:Or,PasswordResponses:FR,PDFDataRangeTransport:Lb,PDFDateString:og,PDFWorker:Uc,PermissionFlag:LR,PixelsPerInch:ll,RenderingCancelledException:Hg,renderRichText:mb,ResponseException:vf,setLayerDimensions:Ra,shadow:Xe,SignatureExtractor:zo,stopEvent:Yt,SupportedImageMimeTypes:lg,TextLayer:bi,TouchManager:qf,updateUrlHash:hb,Util:Ne,VerbosityLevel:zf,version:Pb,XfaLayer:gb};tl.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${Pb}/pdf.worker.min.js`;async function Nk(n){try{const e=await n.arrayBuffer(),t=await Mb({data:e}).promise,i=t.numPages;let r="";for(let a=1;a<=i;a++){const h=(await(await t.getPage(a)).getTextContent()).items.map(f=>f.str).join(" ");r+=h+`

`}return r=Mk(r),r.trim()?{success:!0,text:r,pageCount:i}:{success:!1,error:"File PDF ny c th l dng nh scan. Vui lng dng cng c OCR  chuyn sang vn bn trc."}}catch(e){return console.error("Error parsing PDF:",e),e.message?.includes("password")?{success:!1,error:"File PDF b t mt khu. Vui lng m kha trc khi upload."}:{success:!1,error:`Khng th c file PDF: ${e.message}`}}}function Mk(n){return n.replace(/\s+/g," ").replace(/^\s*\d+\s*$/gm,"").replace(/Trang \d+ \/ \d+/gi,"").replace(/Page \d+ of \d+/gi,"").replace(/\n{3,}/g,`

`).trim()}function dx(n){return n.type==="application/pdf"||n.name.toLowerCase().endsWith(".pdf")}var px;(function(n){n.STRING="string",n.NUMBER="number",n.INTEGER="integer",n.BOOLEAN="boolean",n.ARRAY="array",n.OBJECT="object"})(px||(px={}));var gx;(function(n){n.LANGUAGE_UNSPECIFIED="language_unspecified",n.PYTHON="python"})(gx||(gx={}));var mx;(function(n){n.OUTCOME_UNSPECIFIED="outcome_unspecified",n.OUTCOME_OK="outcome_ok",n.OUTCOME_FAILED="outcome_failed",n.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(mx||(mx={}));const vx=["user","model","function","system"];var yx;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(yx||(yx={}));var _x;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(_x||(_x={}));var xx;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(xx||(xx={}));var wx;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER"})(wx||(wx={}));var Sc;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.OTHER="OTHER"})(Sc||(Sc={}));var bx;(function(n){n.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",n.RETRIEVAL_QUERY="RETRIEVAL_QUERY",n.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",n.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",n.CLASSIFICATION="CLASSIFICATION",n.CLUSTERING="CLUSTERING"})(bx||(bx={}));var Ex;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE"})(Ex||(Ex={}));var Sx;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(Sx||(Sx={}));class jn extends Error{constructor(e){super(`[GoogleGenerativeAI Error]: ${e}`)}}class ko extends jn{constructor(e,t){super(e),this.response=t}}class Vb extends jn{constructor(e,t,i,r){super(e),this.status=t,this.statusText=i,this.errorDetails=r}}class $s extends jn{}class qb extends jn{}const Lk="https://generativelanguage.googleapis.com",Fk="v1beta",Ik="0.24.1",Pk="genai-js";var ka;(function(n){n.GENERATE_CONTENT="generateContent",n.STREAM_GENERATE_CONTENT="streamGenerateContent",n.COUNT_TOKENS="countTokens",n.EMBED_CONTENT="embedContent",n.BATCH_EMBED_CONTENTS="batchEmbedContents"})(ka||(ka={}));class Bk{constructor(e,t,i,r,a){this.model=e,this.task=t,this.apiKey=i,this.stream=r,this.requestOptions=a}toString(){var e,t;const i=((e=this.requestOptions)===null||e===void 0?void 0:e.apiVersion)||Fk;let a=`${((t=this.requestOptions)===null||t===void 0?void 0:t.baseUrl)||Lk}/${i}/${this.model}:${this.task}`;return this.stream&&(a+="?alt=sse"),a}}function Uk(n){const e=[];return n?.apiClient&&e.push(n.apiClient),e.push(`${Pk}/${Ik}`),e.join(" ")}async function jk(n){var e;const t=new Headers;t.append("Content-Type","application/json"),t.append("x-goog-api-client",Uk(n.requestOptions)),t.append("x-goog-api-key",n.apiKey);let i=(e=n.requestOptions)===null||e===void 0?void 0:e.customHeaders;if(i){if(!(i instanceof Headers))try{i=new Headers(i)}catch(r){throw new $s(`unable to convert customHeaders value ${JSON.stringify(i)} to Headers: ${r.message}`)}for(const[r,a]of i.entries()){if(r==="x-goog-api-key")throw new $s(`Cannot set reserved header name ${r}`);if(r==="x-goog-api-client")throw new $s(`Header name ${r} can only be set using the apiClient field`);t.append(r,a)}}return t}async function Hk(n,e,t,i,r,a){const o=new Bk(n,e,t,i,a);return{url:o.toString(),fetchOptions:Object.assign(Object.assign({},Vk(a)),{method:"POST",headers:await jk(o),body:r})}}async function fu(n,e,t,i,r,a={},o=fetch){const{url:c,fetchOptions:h}=await Hk(n,e,t,i,r,a);return zk(c,h,o)}async function zk(n,e,t=fetch){let i;try{i=await t(n,e)}catch(r){$k(r,n)}return i.ok||await Gk(i,n),i}function $k(n,e){let t=n;throw t.name==="AbortError"?(t=new qb(`Request aborted when fetching ${e.toString()}: ${n.message}`),t.stack=n.stack):n instanceof Vb||n instanceof $s||(t=new jn(`Error fetching from ${e.toString()}: ${n.message}`),t.stack=n.stack),t}async function Gk(n,e){let t="",i;try{const r=await n.json();t=r.error.message,r.error.details&&(t+=` ${JSON.stringify(r.error.details)}`,i=r.error.details)}catch{}throw new Vb(`Error fetching from ${e.toString()}: [${n.status} ${n.statusText}] ${t}`,n.status,n.statusText,i)}function Vk(n){const e={};if(n?.signal!==void 0||n?.timeout>=0){const t=new AbortController;n?.timeout>=0&&setTimeout(()=>t.abort(),n.timeout),n?.signal&&n.signal.addEventListener("abort",()=>{t.abort()}),e.signal=t.signal}return e}function nm(n){return n.text=()=>{if(n.candidates&&n.candidates.length>0){if(n.candidates.length>1&&console.warn(`This response had ${n.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),pf(n.candidates[0]))throw new ko(`${Is(n)}`,n);return qk(n)}else if(n.promptFeedback)throw new ko(`Text not available. ${Is(n)}`,n);return""},n.functionCall=()=>{if(n.candidates&&n.candidates.length>0){if(n.candidates.length>1&&console.warn(`This response had ${n.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),pf(n.candidates[0]))throw new ko(`${Is(n)}`,n);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),Ax(n)[0]}else if(n.promptFeedback)throw new ko(`Function call not available. ${Is(n)}`,n)},n.functionCalls=()=>{if(n.candidates&&n.candidates.length>0){if(n.candidates.length>1&&console.warn(`This response had ${n.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),pf(n.candidates[0]))throw new ko(`${Is(n)}`,n);return Ax(n)}else if(n.promptFeedback)throw new ko(`Function call not available. ${Is(n)}`,n)},n}function qk(n){var e,t,i,r;const a=[];if(!((t=(e=n.candidates)===null||e===void 0?void 0:e[0].content)===null||t===void 0)&&t.parts)for(const o of(r=(i=n.candidates)===null||i===void 0?void 0:i[0].content)===null||r===void 0?void 0:r.parts)o.text&&a.push(o.text),o.executableCode&&a.push("\n```"+o.executableCode.language+`
`+o.executableCode.code+"\n```\n"),o.codeExecutionResult&&a.push("\n```\n"+o.codeExecutionResult.output+"\n```\n");return a.length>0?a.join(""):""}function Ax(n){var e,t,i,r;const a=[];if(!((t=(e=n.candidates)===null||e===void 0?void 0:e[0].content)===null||t===void 0)&&t.parts)for(const o of(r=(i=n.candidates)===null||i===void 0?void 0:i[0].content)===null||r===void 0?void 0:r.parts)o.functionCall&&a.push(o.functionCall);if(a.length>0)return a}const Wk=[Sc.RECITATION,Sc.SAFETY,Sc.LANGUAGE];function pf(n){return!!n.finishReason&&Wk.includes(n.finishReason)}function Is(n){var e,t,i;let r="";if((!n.candidates||n.candidates.length===0)&&n.promptFeedback)r+="Response was blocked",!((e=n.promptFeedback)===null||e===void 0)&&e.blockReason&&(r+=` due to ${n.promptFeedback.blockReason}`),!((t=n.promptFeedback)===null||t===void 0)&&t.blockReasonMessage&&(r+=`: ${n.promptFeedback.blockReasonMessage}`);else if(!((i=n.candidates)===null||i===void 0)&&i[0]){const a=n.candidates[0];pf(a)&&(r+=`Candidate was blocked due to ${a.finishReason}`,a.finishMessage&&(r+=`: ${a.finishMessage}`))}return r}function Hc(n){return this instanceof Hc?(this.v=n,this):new Hc(n)}function Xk(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,a=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(m){i[m]&&(r[m]=function(y){return new Promise(function(w,_){a.push([m,y,w,_])>1||c(m,y)})})}function c(m,y){try{h(i[m](y))}catch(w){g(a[0][3],w)}}function h(m){m.value instanceof Hc?Promise.resolve(m.value.v).then(f,p):g(a[0][2],m)}function f(m){c("next",m)}function p(m){c("throw",m)}function g(m,y){m(y),a.shift(),a.length&&c(a[0][0],a[0][1])}}const Tx=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function Yk(n){const e=n.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),t=Qk(e),[i,r]=t.tee();return{stream:Jk(i),response:Kk(r)}}async function Kk(n){const e=[],t=n.getReader();for(;;){const{done:i,value:r}=await t.read();if(i)return nm(Zk(e));e.push(r)}}function Jk(n){return Xk(this,arguments,function*(){const t=n.getReader();for(;;){const{value:i,done:r}=yield Hc(t.read());if(r)break;yield yield Hc(nm(i))}})}function Qk(n){const e=n.getReader();return new ReadableStream({start(i){let r="";return a();function a(){return e.read().then(({value:o,done:c})=>{if(c){if(r.trim()){i.error(new jn("Failed to parse stream"));return}i.close();return}r+=o;let h=r.match(Tx),f;for(;h;){try{f=JSON.parse(h[1])}catch{i.error(new jn(`Error parsing JSON response: "${h[1]}"`));return}i.enqueue(f),r=r.substring(h[0].length),h=r.match(Tx)}return a()}).catch(o=>{let c=o;throw c.stack=o.stack,c.name==="AbortError"?c=new qb("Request aborted when reading from the stream"):c=new jn("Error reading from the stream"),c})}}})}function Zk(n){const e=n[n.length-1],t={promptFeedback:e?.promptFeedback};for(const i of n){if(i.candidates){let r=0;for(const a of i.candidates)if(t.candidates||(t.candidates=[]),t.candidates[r]||(t.candidates[r]={index:r}),t.candidates[r].citationMetadata=a.citationMetadata,t.candidates[r].groundingMetadata=a.groundingMetadata,t.candidates[r].finishReason=a.finishReason,t.candidates[r].finishMessage=a.finishMessage,t.candidates[r].safetyRatings=a.safetyRatings,a.content&&a.content.parts){t.candidates[r].content||(t.candidates[r].content={role:a.content.role||"user",parts:[]});const o={};for(const c of a.content.parts)c.text&&(o.text=c.text),c.functionCall&&(o.functionCall=c.functionCall),c.executableCode&&(o.executableCode=c.executableCode),c.codeExecutionResult&&(o.codeExecutionResult=c.codeExecutionResult),Object.keys(o).length===0&&(o.text=""),t.candidates[r].content.parts.push(o)}r++}i.usageMetadata&&(t.usageMetadata=i.usageMetadata)}return t}async function Wb(n,e,t,i){const r=await fu(e,ka.STREAM_GENERATE_CONTENT,n,!0,JSON.stringify(t),i);return Yk(r)}async function Xb(n,e,t,i){const a=await(await fu(e,ka.GENERATE_CONTENT,n,!1,JSON.stringify(t),i)).json();return{response:nm(a)}}function Yb(n){if(n!=null){if(typeof n=="string")return{role:"system",parts:[{text:n}]};if(n.text)return{role:"system",parts:[n]};if(n.parts)return n.role?n:{role:"system",parts:n.parts}}}function zc(n){let e=[];if(typeof n=="string")e=[{text:n}];else for(const t of n)typeof t=="string"?e.push({text:t}):e.push(t);return eD(e)}function eD(n){const e={role:"user",parts:[]},t={role:"function",parts:[]};let i=!1,r=!1;for(const a of n)"functionResponse"in a?(t.parts.push(a),r=!0):(e.parts.push(a),i=!0);if(i&&r)throw new jn("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!i&&!r)throw new jn("No content is provided for sending chat message.");return i?e:t}function tD(n,e){var t;let i={model:e?.model,generationConfig:e?.generationConfig,safetySettings:e?.safetySettings,tools:e?.tools,toolConfig:e?.toolConfig,systemInstruction:e?.systemInstruction,cachedContent:(t=e?.cachedContent)===null||t===void 0?void 0:t.name,contents:[]};const r=n.generateContentRequest!=null;if(n.contents){if(r)throw new $s("CountTokensRequest must have one of contents or generateContentRequest, not both.");i.contents=n.contents}else if(r)i=Object.assign(Object.assign({},i),n.generateContentRequest);else{const a=zc(n);i.contents=[a]}return{generateContentRequest:i}}function Cx(n){let e;return n.contents?e=n:e={contents:[zc(n)]},n.systemInstruction&&(e.systemInstruction=Yb(n.systemInstruction)),e}function nD(n){return typeof n=="string"||Array.isArray(n)?{content:zc(n)}:n}const Rx=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],iD={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function rD(n){let e=!1;for(const t of n){const{role:i,parts:r}=t;if(!e&&i!=="user")throw new jn(`First content should be with role 'user', got ${i}`);if(!vx.includes(i))throw new jn(`Each item should include role field. Got ${i} but valid roles are: ${JSON.stringify(vx)}`);if(!Array.isArray(r))throw new jn("Content should have 'parts' property with an array of Parts");if(r.length===0)throw new jn("Each Content should have at least one part");const a={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const c of r)for(const h of Rx)h in c&&(a[h]+=1);const o=iD[i];for(const c of Rx)if(!o.includes(c)&&a[c]>0)throw new jn(`Content with role '${i}' can't contain '${c}' part`);e=!0}}function Ox(n){var e;if(n.candidates===void 0||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;if(t===void 0||t.parts===void 0||t.parts.length===0)return!1;for(const i of t.parts)if(i===void 0||Object.keys(i).length===0||i.text!==void 0&&i.text==="")return!1;return!0}const kx="SILENT_ERROR";class sD{constructor(e,t,i,r={}){this.model=t,this.params=i,this._requestOptions=r,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=e,i?.history&&(rD(i.history),this._history=i.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e,t={}){var i,r,a,o,c,h;await this._sendPromise;const f=zc(e),p={safetySettings:(i=this.params)===null||i===void 0?void 0:i.safetySettings,generationConfig:(r=this.params)===null||r===void 0?void 0:r.generationConfig,tools:(a=this.params)===null||a===void 0?void 0:a.tools,toolConfig:(o=this.params)===null||o===void 0?void 0:o.toolConfig,systemInstruction:(c=this.params)===null||c===void 0?void 0:c.systemInstruction,cachedContent:(h=this.params)===null||h===void 0?void 0:h.cachedContent,contents:[...this._history,f]},g=Object.assign(Object.assign({},this._requestOptions),t);let m;return this._sendPromise=this._sendPromise.then(()=>Xb(this._apiKey,this.model,p,g)).then(y=>{var w;if(Ox(y.response)){this._history.push(f);const _=Object.assign({parts:[],role:"model"},(w=y.response.candidates)===null||w===void 0?void 0:w[0].content);this._history.push(_)}else{const _=Is(y.response);_&&console.warn(`sendMessage() was unsuccessful. ${_}. Inspect response object for details.`)}m=y}).catch(y=>{throw this._sendPromise=Promise.resolve(),y}),await this._sendPromise,m}async sendMessageStream(e,t={}){var i,r,a,o,c,h;await this._sendPromise;const f=zc(e),p={safetySettings:(i=this.params)===null||i===void 0?void 0:i.safetySettings,generationConfig:(r=this.params)===null||r===void 0?void 0:r.generationConfig,tools:(a=this.params)===null||a===void 0?void 0:a.tools,toolConfig:(o=this.params)===null||o===void 0?void 0:o.toolConfig,systemInstruction:(c=this.params)===null||c===void 0?void 0:c.systemInstruction,cachedContent:(h=this.params)===null||h===void 0?void 0:h.cachedContent,contents:[...this._history,f]},g=Object.assign(Object.assign({},this._requestOptions),t),m=Wb(this._apiKey,this.model,p,g);return this._sendPromise=this._sendPromise.then(()=>m).catch(y=>{throw new Error(kx)}).then(y=>y.response).then(y=>{if(Ox(y)){this._history.push(f);const w=Object.assign({},y.candidates[0].content);w.role||(w.role="model"),this._history.push(w)}else{const w=Is(y);w&&console.warn(`sendMessageStream() was unsuccessful. ${w}. Inspect response object for details.`)}}).catch(y=>{y.message!==kx&&console.error(y)}),m}}async function aD(n,e,t,i){return(await fu(e,ka.COUNT_TOKENS,n,!1,JSON.stringify(t),i)).json()}async function oD(n,e,t,i){return(await fu(e,ka.EMBED_CONTENT,n,!1,JSON.stringify(t),i)).json()}async function lD(n,e,t,i){const r=t.requests.map(o=>Object.assign(Object.assign({},o),{model:e}));return(await fu(e,ka.BATCH_EMBED_CONTENTS,n,!1,JSON.stringify({requests:r}),i)).json()}class Dx{constructor(e,t,i={}){this.apiKey=e,this._requestOptions=i,t.model.includes("/")?this.model=t.model:this.model=`models/${t.model}`,this.generationConfig=t.generationConfig||{},this.safetySettings=t.safetySettings||[],this.tools=t.tools,this.toolConfig=t.toolConfig,this.systemInstruction=Yb(t.systemInstruction),this.cachedContent=t.cachedContent}async generateContent(e,t={}){var i;const r=Cx(e),a=Object.assign(Object.assign({},this._requestOptions),t);return Xb(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(i=this.cachedContent)===null||i===void 0?void 0:i.name},r),a)}async generateContentStream(e,t={}){var i;const r=Cx(e),a=Object.assign(Object.assign({},this._requestOptions),t);return Wb(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(i=this.cachedContent)===null||i===void 0?void 0:i.name},r),a)}startChat(e){var t;return new sD(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(t=this.cachedContent)===null||t===void 0?void 0:t.name},e),this._requestOptions)}async countTokens(e,t={}){const i=tD(e,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),r=Object.assign(Object.assign({},this._requestOptions),t);return aD(this.apiKey,this.model,i,r)}async embedContent(e,t={}){const i=nD(e),r=Object.assign(Object.assign({},this._requestOptions),t);return oD(this.apiKey,this.model,i,r)}async batchEmbedContents(e,t={}){const i=Object.assign(Object.assign({},this._requestOptions),t);return lD(this.apiKey,this.model,e,i)}}class cD{constructor(e){this.apiKey=e}getGenerativeModel(e,t){if(!e.model)throw new jn("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new Dx(this.apiKey,e,t)}getGenerativeModelFromCachedContent(e,t,i){if(!e.name)throw new $s("Cached content must contain a `name` field.");if(!e.model)throw new $s("Cached content must contain a `model` field.");const r=["model","systemInstruction"];for(const o of r)if(t?.[o]&&e[o]&&t?.[o]!==e[o]){if(o==="model"){const c=t.model.startsWith("models/")?t.model.replace("models/",""):t.model,h=e.model.startsWith("models/")?e.model.replace("models/",""):e.model;if(c===h)continue}throw new $s(`Different value for "${o}" specified in modelParams (${t[o]}) and cachedContent (${e[o]})`)}const a=Object.assign(Object.assign({},t),{model:e.model,tools:e.tools,toolConfig:e.toolConfig,systemInstruction:e.systemInstruction,cachedContent:e});return new Dx(this.apiKey,a,i)}}const Kb="gemini_api_key";function im(){return localStorage.getItem(Kb)}function uD(n){localStorage.setItem(Kb,n)}function yg(){return!!im()}const hD=["gemini-2.5-flash-preview-05-20","gemini-2.0-flash","gemini-1.5-flash"],fD=`Bn l mt tr l AI chuyn nhp liu  thi. Nhim v ca bn l chuyn i vn bn th t file PDF thnh nh dng JSON chun.

VN BN U VO:
{TEXT}

YU CU OUTPUT (JSON):
{
  "title": "Tn  thi (nu tm thy)",
  "questions": [
    {
      "id": 1,
      "type": "multiple_choice", // hoc "true_false" hoc "short_answer"
      "question": "Ni dung cu hi",
      "options": ["A. La chn 1", "B. La chn 2", "C. La chn 3", "D. La chn 4"], // nu c
      "correct_answer": "A" // nu tm thy p n
    }
  ]
}

QUY TC QUAN TRNG:
1. Nu cu hi c dng "A. ... B. ...", hy gn type="multiple_choice".
2. Nu cu hi yu cu in vo ch trng hoc tnh ton, gn type="short_answer".
3. Nu cu hi dng bng ng sai, gn type="true_false" v thm sub_questions cho tng .
4. B qua cc dng khng phi cu hi (nh s trang, tiu  lp li).
5. Nu cu hi b ngt dng, hy ni li cho lin mch.
6. TUYT I ch tr v JSON thun, KHNG thm li dn, KHNG c markdown code block.
7. Nu tm thy phn P N  cui, hy in vo correct_answer cho tng cu.`;async function dD(n){const e=im();if(!e)return{success:!1,error:"Cha c API Key. Vui lng nhp API Key trong phn Ci t."};const t=new cD(e);for(const i of hD)try{const r=t.getGenerativeModel({model:i}),a=fD.replace("{TEXT}",n);let h=(await(await r.generateContent(a)).response).text();h=h.replace(/```json\n?/g,"").replace(/```\n?/g,"").trim();const f=JSON.parse(h);if(!f.questions||!Array.isArray(f.questions))throw new Error("Invalid JSON structure");const p=f.questions.map((g,m)=>({id:g.id||m+1,type:g.type||"multiple_choice",question:g.question||g.content||"",options:g.options||[],correct_answer:g.correct_answer||"",sub_questions:g.sub_questions||void 0}));return{success:!0,title:f.title||f.exam_title||" thi",questions:p}}catch(r){if(console.warn(`Model ${i} failed:`,r.message),r.message?.includes("429")||r.message?.includes("quota")||r instanceof SyntaxError)continue;continue}return{success:!1,error:"Khng th phn tch  thi. Vui lng kim tra API Key hoc th li sau."}}function Yf(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t}function pD(n,e,t,i){function r(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function c(p){try{f(i.next(p))}catch(g){o(g)}}function h(p){try{f(i.throw(p))}catch(g){o(g)}}function f(p){p.done?a(p.value):r(p.value).then(c,h)}f((i=i.apply(n,e||[])).next())})}const gD=n=>n?(...e)=>n(...e):(...e)=>fetch(...e);class rm extends Error{constructor(e,t="FunctionsError",i){super(e),this.name=t,this.context=i}}class mD extends rm{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Nx extends rm{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Mx extends rm{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var _g;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(_g||(_g={}));class vD{constructor(e,{headers:t={},customFetch:i,region:r=_g.Any}={}){this.url=e,this.headers=t,this.region=r,this.fetch=gD(i)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return pD(this,arguments,void 0,function*(t,i={}){var r;let a,o;try{const{headers:c,method:h,body:f,signal:p,timeout:g}=i;let m={},{region:y}=i;y||(y=this.region);const w=new URL(`${this.url}/${t}`);y&&y!=="any"&&(m["x-region"]=y,w.searchParams.set("forceFunctionRegion",y));let _;f&&(c&&!Object.prototype.hasOwnProperty.call(c,"Content-Type")||!c)?typeof Blob<"u"&&f instanceof Blob||f instanceof ArrayBuffer?(m["Content-Type"]="application/octet-stream",_=f):typeof f=="string"?(m["Content-Type"]="text/plain",_=f):typeof FormData<"u"&&f instanceof FormData?_=f:(m["Content-Type"]="application/json",_=JSON.stringify(f)):f&&typeof f!="string"&&!(typeof Blob<"u"&&f instanceof Blob)&&!(f instanceof ArrayBuffer)&&!(typeof FormData<"u"&&f instanceof FormData)?_=JSON.stringify(f):_=f;let b=p;g&&(o=new AbortController,a=setTimeout(()=>o.abort(),g),p?(b=o.signal,p.addEventListener("abort",()=>o.abort())):b=o.signal);const E=yield this.fetch(w.toString(),{method:h||"POST",headers:Object.assign(Object.assign(Object.assign({},m),this.headers),c),body:_,signal:b}).catch(P=>{throw new mD(P)}),T=E.headers.get("x-relay-error");if(T&&T==="true")throw new Nx(E);if(!E.ok)throw new Mx(E);let S=((r=E.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),k;return S==="application/json"?k=yield E.json():S==="application/octet-stream"||S==="application/pdf"?k=yield E.blob():S==="text/event-stream"?k=E:S==="multipart/form-data"?k=yield E.formData():k=yield E.text(),{data:k,error:null,response:E}}catch(c){return{data:null,error:c,response:c instanceof Mx||c instanceof Nx?c.context:void 0}}finally{a&&clearTimeout(a)}})}}var yD=class extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}},_D=class{constructor(n){var e,t;this.shouldThrowOnError=!1,this.method=n.method,this.url=n.url,this.headers=new Headers(n.headers),this.schema=n.schema,this.body=n.body,this.shouldThrowOnError=(e=n.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=n.signal,this.isMaybeSingle=(t=n.isMaybeSingle)!==null&&t!==void 0?t:!1,n.fetch?this.fetch=n.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(n,e){return this.headers=new Headers(this.headers),this.headers.set(n,e),this}then(n,e){var t=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const i=this.fetch;let r=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{let o=null,c=null,h=null,f=a.status,p=a.statusText;if(a.ok){var g,m;if(t.method!=="HEAD"){var y;const E=await a.text();E===""||(t.headers.get("Accept")==="text/csv"||t.headers.get("Accept")&&(!((y=t.headers.get("Accept"))===null||y===void 0)&&y.includes("application/vnd.pgrst.plan+text"))?c=E:c=JSON.parse(E))}const _=(g=t.headers.get("Prefer"))===null||g===void 0?void 0:g.match(/count=(exact|planned|estimated)/),b=(m=a.headers.get("content-range"))===null||m===void 0?void 0:m.split("/");_&&b&&b.length>1&&(h=parseInt(b[1])),t.isMaybeSingle&&t.method==="GET"&&Array.isArray(c)&&(c.length>1?(o={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,h=null,f=406,p="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{var w;const _=await a.text();try{o=JSON.parse(_),Array.isArray(o)&&a.status===404&&(c=[],o=null,f=200,p="OK")}catch{a.status===404&&_===""?(f=204,p="No Content"):o={message:_}}if(o&&t.isMaybeSingle&&(!(o==null||(w=o.details)===null||w===void 0)&&w.includes("0 rows"))&&(o=null,f=200,p="OK"),o&&t.shouldThrowOnError)throw new yD(o)}return{error:o,data:c,count:h,status:f,statusText:p}});return this.shouldThrowOnError||(r=r.catch(a=>{var o;let c="";const h=a?.cause;if(h){var f,p,g,m;const w=(f=h?.message)!==null&&f!==void 0?f:"",_=(p=h?.code)!==null&&p!==void 0?p:"";c=`${(g=a?.name)!==null&&g!==void 0?g:"FetchError"}: ${a?.message}`,c+=`

Caused by: ${(m=h?.name)!==null&&m!==void 0?m:"Error"}: ${w}`,_&&(c+=` (${_})`),h?.stack&&(c+=`
${h.stack}`)}else{var y;c=(y=a?.stack)!==null&&y!==void 0?y:""}return{error:{message:`${(o=a?.name)!==null&&o!==void 0?o:"FetchError"}: ${a?.message}`,details:c,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),r.then(n,e)}returns(){return this}overrideTypes(){return this}},xD=class extends _D{select(n){let e=!1;const t=(n??"*").split("").map(i=>/\s/.test(i)&&!e?"":(i==='"'&&(e=!e),i)).join("");return this.url.searchParams.set("select",t),this.headers.append("Prefer","return=representation"),this}order(n,{ascending:e=!0,nullsFirst:t,foreignTable:i,referencedTable:r=i}={}){const a=r?`${r}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${n}.${e?"asc":"desc"}${t===void 0?"":t?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:e,referencedTable:t=e}={}){const i=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(i,`${n}`),this}range(n,e,{foreignTable:t,referencedTable:i=t}={}){const r=typeof i>"u"?"offset":`${i}.offset`,a=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(r,`${n}`),this.url.searchParams.set(a,`${e-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:n=!1,verbose:e=!1,settings:t=!1,buffers:i=!1,wal:r=!1,format:a="text"}={}){var o;const c=[n?"analyze":null,e?"verbose":null,t?"settings":null,i?"buffers":null,r?"wal":null].filter(Boolean).join("|"),h=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${h}"; options=${c};`),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(n){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${n}`),this}};const Lx=new RegExp("[,()]");var $o=class extends xD{eq(n,e){return this.url.searchParams.append(n,`eq.${e}`),this}neq(n,e){return this.url.searchParams.append(n,`neq.${e}`),this}gt(n,e){return this.url.searchParams.append(n,`gt.${e}`),this}gte(n,e){return this.url.searchParams.append(n,`gte.${e}`),this}lt(n,e){return this.url.searchParams.append(n,`lt.${e}`),this}lte(n,e){return this.url.searchParams.append(n,`lte.${e}`),this}like(n,e){return this.url.searchParams.append(n,`like.${e}`),this}likeAllOf(n,e){return this.url.searchParams.append(n,`like(all).{${e.join(",")}}`),this}likeAnyOf(n,e){return this.url.searchParams.append(n,`like(any).{${e.join(",")}}`),this}ilike(n,e){return this.url.searchParams.append(n,`ilike.${e}`),this}ilikeAllOf(n,e){return this.url.searchParams.append(n,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(n,e){return this.url.searchParams.append(n,`ilike(any).{${e.join(",")}}`),this}regexMatch(n,e){return this.url.searchParams.append(n,`match.${e}`),this}regexIMatch(n,e){return this.url.searchParams.append(n,`imatch.${e}`),this}is(n,e){return this.url.searchParams.append(n,`is.${e}`),this}isDistinct(n,e){return this.url.searchParams.append(n,`isdistinct.${e}`),this}in(n,e){const t=Array.from(new Set(e)).map(i=>typeof i=="string"&&Lx.test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(n,`in.(${t})`),this}notIn(n,e){const t=Array.from(new Set(e)).map(i=>typeof i=="string"&&Lx.test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(n,`not.in.(${t})`),this}contains(n,e){return typeof e=="string"?this.url.searchParams.append(n,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(n,`cs.{${e.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(e)}`),this}containedBy(n,e){return typeof e=="string"?this.url.searchParams.append(n,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(n,`cd.{${e.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(e)}`),this}rangeGt(n,e){return this.url.searchParams.append(n,`sr.${e}`),this}rangeGte(n,e){return this.url.searchParams.append(n,`nxl.${e}`),this}rangeLt(n,e){return this.url.searchParams.append(n,`sl.${e}`),this}rangeLte(n,e){return this.url.searchParams.append(n,`nxr.${e}`),this}rangeAdjacent(n,e){return this.url.searchParams.append(n,`adj.${e}`),this}overlaps(n,e){return typeof e=="string"?this.url.searchParams.append(n,`ov.${e}`):this.url.searchParams.append(n,`ov.{${e.join(",")}}`),this}textSearch(n,e,{config:t,type:i}={}){let r="";i==="plain"?r="pl":i==="phrase"?r="ph":i==="websearch"&&(r="w");const a=t===void 0?"":`(${t})`;return this.url.searchParams.append(n,`${r}fts${a}.${e}`),this}match(n){return Object.entries(n).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(n,e,t){return this.url.searchParams.append(n,`not.${e}.${t}`),this}or(n,{foreignTable:e,referencedTable:t=e}={}){const i=t?`${t}.or`:"or";return this.url.searchParams.append(i,`(${n})`),this}filter(n,e,t){return this.url.searchParams.append(n,`${e}.${t}`),this}},wD=class{constructor(n,{headers:e={},schema:t,fetch:i}){this.url=n,this.headers=new Headers(e),this.schema=t,this.fetch=i}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(n,e){const{head:t=!1,count:i}=e??{},r=t?"HEAD":"GET";let a=!1;const o=(n??"*").split("").map(f=>/\s/.test(f)&&!a?"":(f==='"'&&(a=!a),f)).join(""),{url:c,headers:h}=this.cloneRequestState();return c.searchParams.set("select",o),i&&h.append("Prefer",`count=${i}`),new $o({method:r,url:c,headers:h,schema:this.schema,fetch:this.fetch})}insert(n,{count:e,defaultToNull:t=!0}={}){var i;const r="POST",{url:a,headers:o}=this.cloneRequestState();if(e&&o.append("Prefer",`count=${e}`),t||o.append("Prefer","missing=default"),Array.isArray(n)){const c=n.reduce((h,f)=>h.concat(Object.keys(f)),[]);if(c.length>0){const h=[...new Set(c)].map(f=>`"${f}"`);a.searchParams.set("columns",h.join(","))}}return new $o({method:r,url:a,headers:o,schema:this.schema,body:n,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}upsert(n,{onConflict:e,ignoreDuplicates:t=!1,count:i,defaultToNull:r=!0}={}){var a;const o="POST",{url:c,headers:h}=this.cloneRequestState();if(h.append("Prefer",`resolution=${t?"ignore":"merge"}-duplicates`),e!==void 0&&c.searchParams.set("on_conflict",e),i&&h.append("Prefer",`count=${i}`),r||h.append("Prefer","missing=default"),Array.isArray(n)){const f=n.reduce((p,g)=>p.concat(Object.keys(g)),[]);if(f.length>0){const p=[...new Set(f)].map(g=>`"${g}"`);c.searchParams.set("columns",p.join(","))}}return new $o({method:o,url:c,headers:h,schema:this.schema,body:n,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}update(n,{count:e}={}){var t;const i="PATCH",{url:r,headers:a}=this.cloneRequestState();return e&&a.append("Prefer",`count=${e}`),new $o({method:i,url:r,headers:a,schema:this.schema,body:n,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}delete({count:n}={}){var e;const t="DELETE",{url:i,headers:r}=this.cloneRequestState();return n&&r.append("Prefer",`count=${n}`),new $o({method:t,url:i,headers:r,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},bD=class Jb{constructor(e,{headers:t={},schema:i,fetch:r}={}){this.url=e,this.headers=new Headers(t),this.schemaName=i,this.fetch=r}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new wD(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Jb(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:i=!1,get:r=!1,count:a}={}){var o;let c;const h=new URL(`${this.url}/rpc/${e}`);let f;const p=y=>y!==null&&typeof y=="object"&&(!Array.isArray(y)||y.some(p)),g=i&&Object.values(t).some(p);g?(c="POST",f=t):i||r?(c=i?"HEAD":"GET",Object.entries(t).filter(([y,w])=>w!==void 0).map(([y,w])=>[y,Array.isArray(w)?`{${w.join(",")}}`:`${w}`]).forEach(([y,w])=>{h.searchParams.append(y,w)})):(c="POST",f=t);const m=new Headers(this.headers);return g?m.set("Prefer",a?`count=${a},return=minimal`:"return=minimal"):a&&m.set("Prefer",`count=${a}`),new $o({method:c,url:h,headers:m,schema:this.schemaName,body:f,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};class ED{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const t=globalThis.process;if(t){const i=t.versions;if(i&&i.node){const r=i.node,a=parseInt(r.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const i=this.getWebSocketConstructor();return new i(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const SD="2.91.0",AD=`realtime-js/${SD}`,TD="1.0.0",Qb="2.0.0",Fx=Qb,xg=1e4,CD=1e3,RD=100;var Ps;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Ps||(Ps={}));var gn;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(gn||(gn={}));var lr;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(lr||(lr={}));var wg;(function(n){n.websocket="websocket"})(wg||(wg={}));var _a;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(_a||(_a={}));class OD{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let i=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(i))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,i;const r=(i=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&i!==void 0?i:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,r)}_encodeJsonUserBroadcastPush(e){var t,i;const r=(i=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&i!==void 0?i:{},o=new TextEncoder().encode(JSON.stringify(r)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(e,t,i){var r,a;const o=e.topic,c=(r=e.ref)!==null&&r!==void 0?r:"",h=(a=e.join_ref)!==null&&a!==void 0?a:"",f=e.payload.event,p=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},g=Object.keys(p).length===0?"":JSON.stringify(p);if(h.length>255)throw new Error(`joinRef length ${h.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`ref length ${c.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`userEvent length ${f.length} exceeds maximum of 255`);if(g.length>255)throw new Error(`metadata length ${g.length} exceeds maximum of 255`);const m=this.USER_BROADCAST_PUSH_META_LENGTH+h.length+c.length+o.length+f.length+g.length,y=new ArrayBuffer(this.HEADER_LENGTH+m);let w=new DataView(y),_=0;w.setUint8(_++,this.KINDS.userBroadcastPush),w.setUint8(_++,h.length),w.setUint8(_++,c.length),w.setUint8(_++,o.length),w.setUint8(_++,f.length),w.setUint8(_++,g.length),w.setUint8(_++,t),Array.from(h,E=>w.setUint8(_++,E.charCodeAt(0))),Array.from(c,E=>w.setUint8(_++,E.charCodeAt(0))),Array.from(o,E=>w.setUint8(_++,E.charCodeAt(0))),Array.from(f,E=>w.setUint8(_++,E.charCodeAt(0))),Array.from(g,E=>w.setUint8(_++,E.charCodeAt(0)));var b=new Uint8Array(y.byteLength+i.byteLength);return b.set(new Uint8Array(y),0),b.set(new Uint8Array(i),y.byteLength),b.buffer}decode(e,t){if(this._isArrayBuffer(e)){let i=this._binaryDecode(e);return t(i)}if(typeof e=="string"){const i=JSON.parse(e),[r,a,o,c,h]=i;return t({join_ref:r,ref:a,topic:o,event:c,payload:h})}return t({})}_binaryDecode(e){const t=new DataView(e),i=t.getUint8(0),r=new TextDecoder;if(i===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,t,r)}_decodeUserBroadcast(e,t,i){const r=t.getUint8(1),a=t.getUint8(2),o=t.getUint8(3),c=t.getUint8(4);let h=this.HEADER_LENGTH+4;const f=i.decode(e.slice(h,h+r));h=h+r;const p=i.decode(e.slice(h,h+a));h=h+a;const g=i.decode(e.slice(h,h+o));h=h+o;const m=e.slice(h,e.byteLength),y=c===this.JSON_ENCODING?JSON.parse(i.decode(m)):m,w={type:this.BROADCAST_EVENT,event:p,payload:y};return o>0&&(w.meta=JSON.parse(g)),{join_ref:null,ref:null,topic:f,event:this.BROADCAST_EVENT,payload:w}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e?.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([i])=>t.includes(i)))}}class Zb{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Mt;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Mt||(Mt={}));const Ix=(n,e,t={})=>{var i;const r=(i=t.skipTypes)!==null&&i!==void 0?i:[];return e?Object.keys(e).reduce((a,o)=>(a[o]=kD(o,n,e,r),a),{}):{}},kD=(n,e,t,i)=>{const r=e.find(c=>c.name===n),a=r?.type,o=t[n];return a&&!i.includes(a)?eE(a,o):bg(o)},eE=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return LD(e,t)}switch(n){case Mt.bool:return DD(e);case Mt.float4:case Mt.float8:case Mt.int2:case Mt.int4:case Mt.int8:case Mt.numeric:case Mt.oid:return ND(e);case Mt.json:case Mt.jsonb:return MD(e);case Mt.timestamp:return FD(e);case Mt.abstime:case Mt.date:case Mt.daterange:case Mt.int4range:case Mt.int8range:case Mt.money:case Mt.reltime:case Mt.text:case Mt.time:case Mt.timestamptz:case Mt.timetz:case Mt.tsrange:case Mt.tstzrange:return bg(e);default:return bg(e)}},bg=n=>n,DD=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},ND=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},MD=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch{return n}return n},LD=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,i=n[t];if(n[0]==="{"&&i==="}"){let a;const o=n.slice(1,t);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(c=>eE(e,c))}return n},FD=n=>typeof n=="string"?n.replace(" ","T"):n,tE=n=>{const e=new URL(n);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Ip{constructor(e,t,i={},r=xg){this.channel=e,this.event=t,this.payload=i,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var i;return this._hasReceived(e)&&t((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(i=>i.status===e).forEach(i=>i.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Px;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(Px||(Px={}));class Ac{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},r=>{const{onJoin:a,onLeave:o,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ac.syncState(this.state,r,a,o),this.pendingDiffs.forEach(h=>{this.state=Ac.syncDiff(this.state,h,a,o)}),this.pendingDiffs=[],c()}),this.channel._on(i.diff,{},r=>{const{onJoin:a,onLeave:o,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=Ac.syncDiff(this.state,r,a,o),c())}),this.onJoin((r,a,o)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:a,newPresences:o})}),this.onLeave((r,a,o)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,i,r){const a=this.cloneDeep(e),o=this.transformState(t),c={},h={};return this.map(a,(f,p)=>{o[f]||(h[f]=p)}),this.map(o,(f,p)=>{const g=a[f];if(g){const m=p.map(b=>b.presence_ref),y=g.map(b=>b.presence_ref),w=p.filter(b=>y.indexOf(b.presence_ref)<0),_=g.filter(b=>m.indexOf(b.presence_ref)<0);w.length>0&&(c[f]=w),_.length>0&&(h[f]=_)}else c[f]=p}),this.syncDiff(a,{joins:c,leaves:h},i,r)}static syncDiff(e,t,i,r){const{joins:a,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return i||(i=()=>{}),r||(r=()=>{}),this.map(a,(c,h)=>{var f;const p=(f=e[c])!==null&&f!==void 0?f:[];if(e[c]=this.cloneDeep(h),p.length>0){const g=e[c].map(y=>y.presence_ref),m=p.filter(y=>g.indexOf(y.presence_ref)<0);e[c].unshift(...m)}i(c,p,h)}),this.map(o,(c,h)=>{let f=e[c];if(!f)return;const p=h.map(g=>g.presence_ref);f=f.filter(g=>p.indexOf(g.presence_ref)<0),e[c]=f,r(c,f,h),f.length===0&&delete e[c]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(i=>t(i,e[i]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,i)=>{const r=e[i];return"metas"in r?t[i]=r.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):t[i]=r,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Bx;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(Bx||(Bx={}));var Tc;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Tc||(Tc={}));var Qr;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(Qr||(Qr={}));class Ko{constructor(e,t={config:{}},i){var r,a;if(this.topic=e,this.params=t,this.socket=i,this.bindings={},this.state=gn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Ip(this,lr.join,this.params,this.timeout),this.rejoinTimer=new Zb(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=gn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=gn.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=gn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=gn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=gn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(lr.reply,{},(o,c)=>{this._trigger(this._replyEventName(c),o)}),this.presence=new Ac(this),this.broadcastEndpointURL=tE(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(r=this.params.config)===null||r===void 0?void 0:r.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var i,r,a;if(this.socket.isConnected()||this.socket.connect(),this.state==gn.closed){const{config:{broadcast:o,presence:c,private:h}}=this.params,f=(r=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(y=>y.filter))!==null&&r!==void 0?r:[],p=!!this.bindings[Tc.PRESENCE]&&this.bindings[Tc.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,g={},m={broadcast:o,presence:Object.assign(Object.assign({},c),{enabled:p}),postgres_changes:f,private:h};this.socket.accessTokenValue&&(g.access_token=this.socket.accessTokenValue),this._onError(y=>e?.(Qr.CHANNEL_ERROR,y)),this._onClose(()=>e?.(Qr.CLOSED)),this.updateJoinPayload(Object.assign({config:m},g)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:y})=>{var w;if(this.socket._isManualToken()||this.socket.setAuth(),y===void 0){e?.(Qr.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,b=(w=_?.length)!==null&&w!==void 0?w:0,E=[];for(let T=0;T<b;T++){const S=_[T],{filter:{event:k,schema:P,table:F,filter:O}}=S,G=y&&y[T];if(G&&G.event===k&&Ko.isFilterValueEqual(G.schema,P)&&Ko.isFilterValueEqual(G.table,F)&&Ko.isFilterValueEqual(G.filter,O))E.push(Object.assign(Object.assign({},S),{id:G.id}));else{this.unsubscribe(),this.state=gn.errored,e?.(Qr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=E,e&&e(Qr.SUBSCRIBED);return}}).receive("error",y=>{this.state=gn.errored,e?.(Qr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(y).join(", ")||"error")))}).receive("timeout",()=>{e?.(Qr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,i){return this.state===gn.joined&&e===Tc.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,i)}async httpSend(e,t,i={}){var r;if(t==null)return Promise.reject("Payload is required for httpSend()");const a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},c=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(r=i.timeout)!==null&&r!==void 0?r:this.timeout);if(c.status===202)return{success:!0};let h=c.statusText;try{const f=await c.json();h=f.error||f.message||h}catch{}return Promise.reject(new Error(h))}async send(e,t={}){var i,r;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:o}=e,c={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(c.Authorization=`Bearer ${this.socket.accessTokenValue}`);const h={method:"POST",headers:c,body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(i=t.timeout)!==null&&i!==void 0?i:this.timeout);return await((r=f.body)===null||r===void 0?void 0:r.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,c,h;const f=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((h=(c=(o=this.params)===null||o===void 0?void 0:o.config)===null||c===void 0?void 0:c.broadcast)===null||h===void 0)&&h.ack)&&a("ok"),f.receive("ok",()=>a("ok")),f.receive("error",()=>a("error")),f.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=gn.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(lr.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(r=>{i=new Ip(this,lr.leave,{},e),i.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=gn.closed,this.bindings={}}async _fetchWithTimeout(e,t,i){const r=new AbortController,a=setTimeout(()=>r.abort(),i),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(a),o}_push(e,t,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Ip(this,e,t,i);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>RD){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,i){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,i){var r,a;const o=e.toLocaleLowerCase(),{close:c,error:h,leave:f,join:p}=lr;if(i&&[c,h,f,p].indexOf(o)>=0&&i!==this._joinRef())return;let m=this._onMessage(o,t,i);if(t&&!m)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(y=>{var w,_,b;return((w=y.filter)===null||w===void 0?void 0:w.event)==="*"||((b=(_=y.filter)===null||_===void 0?void 0:_.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===o}).map(y=>y.callback(m,i)):(a=this.bindings[o])===null||a===void 0||a.filter(y=>{var w,_,b,E,T,S,k,P;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in y){const F=y.id,O=(w=y.filter)===null||w===void 0?void 0:w.event;return F&&((_=t.ids)===null||_===void 0?void 0:_.includes(F))&&(O==="*"||O?.toLocaleLowerCase()===((b=t.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))&&(!(!((E=y.filter)===null||E===void 0)&&E.table)||y.filter.table===((T=t.data)===null||T===void 0?void 0:T.table))}else{const F=(k=(S=y?.filter)===null||S===void 0?void 0:S.event)===null||k===void 0?void 0:k.toLocaleLowerCase();return F==="*"||F===((P=t?.event)===null||P===void 0?void 0:P.toLocaleLowerCase())}else return y.type.toLocaleLowerCase()===o}).map(y=>{if(typeof m=="object"&&"ids"in m){const w=m.data,{schema:_,table:b,commit_timestamp:E,type:T,errors:S}=w;m=Object.assign(Object.assign({},{schema:_,table:b,commit_timestamp:E,eventType:T,new:{},old:{},errors:S}),this._getPayloadRecords(w))}y.callback(m,i)})}_isClosed(){return this.state===gn.closed}_isJoined(){return this.state===gn.joined}_isJoining(){return this.state===gn.joining}_isLeaving(){return this.state===gn.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,i){const r=e.toLocaleLowerCase(),a={type:r,filter:t,callback:i};return this.bindings[r]?this.bindings[r].push(a):this.bindings[r]=[a],this}_off(e,t){const i=e.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(r=>{var a;return!(((a=r.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===i&&Ko.isEqual(r.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(e[i]!==t[i])return!1;return!0}static isFilterValueEqual(e,t){return(e??void 0)===(t??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(lr.close,{},e)}_onError(e){this._on(lr.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=gn.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Ix(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Ix(e.columns,e.old_record)),t}}const Pp=()=>{},Yh={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},ID=[1e3,2e3,5e3,1e4],PD=1e4,BD=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class UD{constructor(e,t){var i;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=xg,this.transport=null,this.heartbeatIntervalMs=Yh.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Pp,this.ref=0,this.reconnectTimer=null,this.vsn=Fx,this.logger=Pp,this.conn=null,this.sendBuffer=[],this.serializer=new OD,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=r=>r?(...a)=>r(...a):(...a)=>fetch(...a),!(!((i=t?.params)===null||i===void 0)&&i.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${wg.websocket}`,this.httpEndpoint=tE(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=ED.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const i=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(i),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,i){this.logger(e,t,i)}connectionState(){switch(this.conn&&this.conn.readyState){case Ps.connecting:return _a.Connecting;case Ps.open:return _a.Open;case Ps.closing:return _a.Closing;default:return _a.Closed}}isConnected(){return this.connectionState()===_a.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const i=`realtime:${e}`,r=this.getChannels().find(a=>a.topic===i);if(r)return r;{const a=new Ko(`realtime:${e}`,t,this);return this.channels.push(a),a}}push(e){const{topic:t,event:i,payload:r,ref:a}=e,o=()=>{this.encode(e,c=>{var h;(h=this.conn)===null||h===void 0||h.send(c)})};this.log("push",`${t} ${i} (${a})`,r),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(CD,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Yh.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(i=>i.topic===e&&(i._isJoined()||i._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply"&&t.ref&&t.ref===this.pendingHeartbeatRef){const f=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error",f)}catch(p){this.log("error","error in heartbeat callback",p)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:i,event:r,payload:a,ref:o}=t,c=o?`(${o})`:"",h=a.status||"";this.log("receive",`${h} ${i} ${r} ${c}`.trim(),a),this.channels.filter(f=>f._isMember(i)).forEach(f=>f._trigger(r,a,o)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===Ps.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Ps.open||this.conn.readyState===Ps.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this._terminateWorker()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(lr.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const i=e.match(/\?/)?"&":"?",r=new URLSearchParams(t);return`${e}${i}${r}`}_workerObjectUrl(e){let t;if(e)t=e;else{const i=new Blob([BD],{type:"application/javascript"});t=URL.createObjectURL(i)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t,i=!1;if(e)t=e,i=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(r){this.log("error","Error fetching access token from callback",r),t=this.accessTokenValue}else t=this.accessTokenValue;i?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{const a={access_token:t,version:AD};t&&r.updateJoinPayload(a),r.joinedOnce&&r._isJoined()&&r._push(lr.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(i=>{try{i(t)}catch(r){this.log("error",`error in ${e} callback`,r)}})}catch(i){this.log("error",`error triggering ${e} callbacks`,i)}}_setupReconnectionTimer(){this.reconnectTimer=new Zb(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Yh.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,i,r,a,o,c,h,f,p,g,m,y;switch(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(i=e?.timeout)!==null&&i!==void 0?i:xg,this.heartbeatIntervalMs=(r=e?.heartbeatIntervalMs)!==null&&r!==void 0?r:Yh.HEARTBEAT_INTERVAL,this.worker=(a=e?.worker)!==null&&a!==void 0?a:!1,this.accessToken=(o=e?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(c=e?.heartbeatCallback)!==null&&c!==void 0?c:Pp,this.vsn=(h=e?.vsn)!==null&&h!==void 0?h:Fx,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(f=e?.reconnectAfterMs)!==null&&f!==void 0?f:(w=>ID[w-1]||PD),this.vsn){case TD:this.encode=(p=e?.encode)!==null&&p!==void 0?p:((w,_)=>_(JSON.stringify(w))),this.decode=(g=e?.decode)!==null&&g!==void 0?g:((w,_)=>_(JSON.parse(w)));break;case Qb:this.encode=(m=e?.encode)!==null&&m!==void 0?m:this.serializer.encode.bind(this.serializer),this.decode=(y=e?.decode)!==null&&y!==void 0?y:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}var $c=class extends Error{constructor(n,e){super(n),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function jD(n,e,t){const i=new URL(e,n);if(t)for(const[r,a]of Object.entries(t))a!==void 0&&i.searchParams.set(r,a);return i.toString()}async function HD(n){return!n||n.type==="none"?{}:n.type==="bearer"?{Authorization:`Bearer ${n.token}`}:n.type==="header"?{[n.name]:n.value}:n.type==="custom"?await n.getHeaders():{}}function zD(n){const e=n.fetchImpl??globalThis.fetch;return{async request({method:t,path:i,query:r,body:a,headers:o}){const c=jD(n.baseUrl,i,r),h=await HD(n.auth),f=await e(c,{method:t,headers:{...a?{"Content-Type":"application/json"}:{},...h,...o},body:a?JSON.stringify(a):void 0}),p=await f.text(),g=(f.headers.get("content-type")||"").includes("application/json"),m=g&&p?JSON.parse(p):p;if(!f.ok){const y=g?m:void 0,w=y?.error;throw new $c(w?.message??`Request failed with status ${f.status}`,{status:f.status,icebergType:w?.type,icebergCode:w?.code,details:y})}return{status:f.status,headers:f.headers,data:m}}}}function Kh(n){return n.join("")}var $D=class{constructor(n,e=""){this.client=n,this.prefix=e}async listNamespaces(n){const e=n?{parent:Kh(n.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(i=>({namespace:i}))}async createNamespace(n,e){const t={namespace:n.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(n){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Kh(n.namespace)}`})}async loadNamespaceMetadata(n){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Kh(n.namespace)}`})).data.properties}}async namespaceExists(n){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Kh(n.namespace)}`}),!0}catch(e){if(e instanceof $c&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(n,e){try{return await this.createNamespace(n,e)}catch(t){if(t instanceof $c&&t.status===409)return;throw t}}};function Do(n){return n.join("")}var GD=class{constructor(n,e="",t){this.client=n,this.prefix=e,this.accessDelegation=t}async listTables(n){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Do(n.namespace)}/tables`})).data.identifiers}async createTable(n,e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Do(n.namespace)}/tables`,body:e,headers:t})).data.metadata}async updateTable(n,e){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Do(n.namespace)}/tables/${n.name}`,body:e});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(n,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Do(n.namespace)}/tables/${n.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(n){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Do(n.namespace)}/tables/${n.name}`,headers:e})).data.metadata}async tableExists(n){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Do(n.namespace)}/tables/${n.name}`,headers:e}),!0}catch(t){if(t instanceof $c&&t.status===404)return!1;throw t}}async createTableIfNotExists(n,e){try{return await this.createTable(n,e)}catch(t){if(t instanceof $c&&t.status===409)return await this.loadTable({namespace:n.namespace,name:e.name});throw t}}},VD=class{constructor(n){let e="v1";n.catalogName&&(e+=`/${n.catalogName}`);const t=n.baseUrl.endsWith("/")?n.baseUrl:`${n.baseUrl}/`;this.client=zD({baseUrl:t,auth:n.auth,fetchImpl:n.fetch}),this.accessDelegation=n.accessDelegation?.join(","),this.namespaceOps=new $D(this.client,e),this.tableOps=new GD(this.client,e,this.accessDelegation)}async listNamespaces(n){return this.namespaceOps.listNamespaces(n)}async createNamespace(n,e){return this.namespaceOps.createNamespace(n,e)}async dropNamespace(n){await this.namespaceOps.dropNamespace(n)}async loadNamespaceMetadata(n){return this.namespaceOps.loadNamespaceMetadata(n)}async listTables(n){return this.tableOps.listTables(n)}async createTable(n,e){return this.tableOps.createTable(n,e)}async updateTable(n,e){return this.tableOps.updateTable(n,e)}async dropTable(n,e){await this.tableOps.dropTable(n,e)}async loadTable(n){return this.tableOps.loadTable(n)}async namespaceExists(n){return this.namespaceOps.namespaceExists(n)}async tableExists(n){return this.tableOps.tableExists(n)}async createNamespaceIfNotExists(n,e){return this.namespaceOps.createNamespaceIfNotExists(n,e)}async createTableIfNotExists(n,e){return this.tableOps.createTableIfNotExists(n,e)}},Kf=class extends Error{constructor(n){super(n),this.__isStorageError=!0,this.name="StorageError"}};function $t(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}var qD=class extends Kf{constructor(n,e,t){super(n),this.name="StorageApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Eg=class extends Kf{constructor(n,e){super(n),this.name="StorageUnknownError",this.originalError=e}};const sm=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),WD=()=>Response,Sg=n=>{if(Array.isArray(n))return n.map(t=>Sg(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,i])=>{const r=t.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[r]=Sg(i)}),e},XD=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},YD=n=>!n||typeof n!="string"||n.length===0||n.length>100||n.trim()!==n||n.includes("/")||n.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(n);function Gc(n){"@babel/helpers - typeof";return Gc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gc(n)}function KD(n,e){if(Gc(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(Gc(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function JD(n){var e=KD(n,"string");return Gc(e)=="symbol"?e:e+""}function QD(n,e,t){return(e=JD(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ux(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function Ve(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ux(Object(t),!0).forEach(function(i){QD(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Ux(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}const Bp=n=>{var e;return n.msg||n.message||n.error_description||(typeof n.error=="string"?n.error:(e=n.error)===null||e===void 0?void 0:e.message)||JSON.stringify(n)},ZD=async(n,e,t)=>{n instanceof await WD()&&!t?.noResolveJson?n.json().then(i=>{const r=n.status||500,a=i?.statusCode||r+"";e(new qD(Bp(i),r,a))}).catch(i=>{e(new Eg(Bp(i),i))}):e(new Eg(Bp(n),n))},e4=(n,e,t,i)=>{const r={method:n,headers:e?.headers||{}};return n==="GET"||!i?r:(XD(i)?(r.headers=Ve({"Content-Type":"application/json"},e?.headers),r.body=JSON.stringify(i)):r.body=i,e?.duplex&&(r.duplex=e.duplex),Ve(Ve({},r),t))};async function du(n,e,t,i,r,a){return new Promise((o,c)=>{n(t,e4(e,i,r,a)).then(h=>{if(!h.ok)throw h;return i?.noResolveJson?h:h.json()}).then(h=>o(h)).catch(h=>ZD(h,c,i))})}async function Vc(n,e,t,i){return du(n,"GET",e,t,i)}async function ar(n,e,t,i,r){return du(n,"POST",e,i,r,t)}async function Ag(n,e,t,i,r){return du(n,"PUT",e,i,r,t)}async function t4(n,e,t,i){return du(n,"HEAD",e,Ve(Ve({},t),{},{noResolveJson:!0}),i)}async function am(n,e,t,i,r){return du(n,"DELETE",e,i,r,t)}var n4=class{constructor(n,e){this.downloadFn=n,this.shouldThrowOnError=e}then(n,e){return this.execute().then(n,e)}async execute(){var n=this;try{return{data:(await n.downloadFn()).body,error:null}}catch(e){if(n.shouldThrowOnError)throw e;if($t(e))return{data:null,error:e};throw e}}};let nE;nE=Symbol.toStringTag;var i4=class{constructor(n,e){this.downloadFn=n,this.shouldThrowOnError=e,this[nE]="BlobDownloadBuilder",this.promise=null}asStream(){return new n4(this.downloadFn,this.shouldThrowOnError)}then(n,e){return this.getPromise().then(n,e)}catch(n){return this.getPromise().catch(n)}finally(n){return this.getPromise().finally(n)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var n=this;try{return{data:await(await n.downloadFn()).blob(),error:null}}catch(e){if(n.shouldThrowOnError)throw e;if($t(e))return{data:null,error:e};throw e}}};const r4={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},jx={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var s4=class{constructor(n,e={},t,i){this.shouldThrowOnError=!1,this.url=n,this.headers=e,this.bucketId=t,this.fetch=sm(i)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(n,e,t,i){var r=this;try{let a;const o=Ve(Ve({},jx),i);let c=Ve(Ve({},r.headers),n==="POST"&&{"x-upsert":String(o.upsert)});const h=o.metadata;typeof Blob<"u"&&t instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),h&&a.append("metadata",r.encodeMetadata(h)),a.append("",t)):typeof FormData<"u"&&t instanceof FormData?(a=t,a.has("cacheControl")||a.append("cacheControl",o.cacheControl),h&&!a.has("metadata")&&a.append("metadata",r.encodeMetadata(h))):(a=t,c["cache-control"]=`max-age=${o.cacheControl}`,c["content-type"]=o.contentType,h&&(c["x-metadata"]=r.toBase64(r.encodeMetadata(h))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!o.duplex&&(o.duplex="half")),i?.headers&&(c=Ve(Ve({},c),i.headers));const f=r._removeEmptyFolders(e),p=r._getFinalPath(f),g=await(n=="PUT"?Ag:ar)(r.fetch,`${r.url}/object/${p}`,a,Ve({headers:c},o?.duplex?{duplex:o.duplex}:{}));return{data:{path:f,id:g.Id,fullPath:g.Key},error:null}}catch(a){if(r.shouldThrowOnError)throw a;if($t(a))return{data:null,error:a};throw a}}async upload(n,e,t){return this.uploadOrUpdate("POST",n,e,t)}async uploadToSignedUrl(n,e,t,i){var r=this;const a=r._removeEmptyFolders(n),o=r._getFinalPath(a),c=new URL(r.url+`/object/upload/sign/${o}`);c.searchParams.set("token",e);try{let h;const f=Ve({upsert:jx.upsert},i),p=Ve(Ve({},r.headers),{"x-upsert":String(f.upsert)});return typeof Blob<"u"&&t instanceof Blob?(h=new FormData,h.append("cacheControl",f.cacheControl),h.append("",t)):typeof FormData<"u"&&t instanceof FormData?(h=t,h.append("cacheControl",f.cacheControl)):(h=t,p["cache-control"]=`max-age=${f.cacheControl}`,p["content-type"]=f.contentType),{data:{path:a,fullPath:(await Ag(r.fetch,c.toString(),h,{headers:p})).Key},error:null}}catch(h){if(r.shouldThrowOnError)throw h;if($t(h))return{data:null,error:h};throw h}}async createSignedUploadUrl(n,e){var t=this;try{let i=t._getFinalPath(n);const r=Ve({},t.headers);e?.upsert&&(r["x-upsert"]="true");const a=await ar(t.fetch,`${t.url}/object/upload/sign/${i}`,{},{headers:r}),o=new URL(t.url+a.url),c=o.searchParams.get("token");if(!c)throw new Kf("No token returned by API");return{data:{signedUrl:o.toString(),path:n,token:c},error:null}}catch(i){if(t.shouldThrowOnError)throw i;if($t(i))return{data:null,error:i};throw i}}async update(n,e,t){return this.uploadOrUpdate("PUT",n,e,t)}async move(n,e,t){var i=this;try{return{data:await ar(i.fetch,`${i.url}/object/move`,{bucketId:i.bucketId,sourceKey:n,destinationKey:e,destinationBucket:t?.destinationBucket},{headers:i.headers}),error:null}}catch(r){if(i.shouldThrowOnError)throw r;if($t(r))return{data:null,error:r};throw r}}async copy(n,e,t){var i=this;try{return{data:{path:(await ar(i.fetch,`${i.url}/object/copy`,{bucketId:i.bucketId,sourceKey:n,destinationKey:e,destinationBucket:t?.destinationBucket},{headers:i.headers})).Key},error:null}}catch(r){if(i.shouldThrowOnError)throw r;if($t(r))return{data:null,error:r};throw r}}async createSignedUrl(n,e,t){var i=this;try{let r=i._getFinalPath(n),a=await ar(i.fetch,`${i.url}/object/sign/${r}`,Ve({expiresIn:e},t?.transform?{transform:t.transform}:{}),{headers:i.headers});const o=t?.download?`&download=${t.download===!0?"":t.download}`:"";return a={signedUrl:encodeURI(`${i.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(r){if(i.shouldThrowOnError)throw r;if($t(r))return{data:null,error:r};throw r}}async createSignedUrls(n,e,t){var i=this;try{const r=await ar(i.fetch,`${i.url}/object/sign/${i.bucketId}`,{expiresIn:e,paths:n},{headers:i.headers}),a=t?.download?`&download=${t.download===!0?"":t.download}`:"";return{data:r.map(o=>Ve(Ve({},o),{},{signedUrl:o.signedURL?encodeURI(`${i.url}${o.signedURL}${a}`):null})),error:null}}catch(r){if(i.shouldThrowOnError)throw r;if($t(r))return{data:null,error:r};throw r}}download(n,e){const t=typeof e?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(e?.transform||{}),r=i?`?${i}`:"",a=this._getFinalPath(n),o=()=>Vc(this.fetch,`${this.url}/${t}/${a}${r}`,{headers:this.headers,noResolveJson:!0});return new i4(o,this.shouldThrowOnError)}async info(n){var e=this;const t=e._getFinalPath(n);try{return{data:Sg(await Vc(e.fetch,`${e.url}/object/info/${t}`,{headers:e.headers})),error:null}}catch(i){if(e.shouldThrowOnError)throw i;if($t(i))return{data:null,error:i};throw i}}async exists(n){var e=this;const t=e._getFinalPath(n);try{return await t4(e.fetch,`${e.url}/object/${t}`,{headers:e.headers}),{data:!0,error:null}}catch(i){if(e.shouldThrowOnError)throw i;if($t(i)&&i instanceof Eg){const r=i.originalError;if([400,404].includes(r?.status))return{data:!1,error:i}}throw i}}getPublicUrl(n,e){const t=this._getFinalPath(n),i=[],r=e?.download?`download=${e.download===!0?"":e.download}`:"";r!==""&&i.push(r);const a=typeof e?.transform<"u"?"render/image":"object",o=this.transformOptsToQueryString(e?.transform||{});o!==""&&i.push(o);let c=i.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${t}${c}`)}}}async remove(n){var e=this;try{return{data:await am(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:n},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if($t(t))return{data:null,error:t};throw t}}async list(n,e,t){var i=this;try{const r=Ve(Ve(Ve({},r4),e),{},{prefix:n||""});return{data:await ar(i.fetch,`${i.url}/object/list/${i.bucketId}`,r,{headers:i.headers},t),error:null}}catch(r){if(i.shouldThrowOnError)throw r;if($t(r))return{data:null,error:r};throw r}}async listV2(n,e){var t=this;try{const i=Ve({},n);return{data:await ar(t.fetch,`${t.url}/object/list-v2/${t.bucketId}`,i,{headers:t.headers},e),error:null}}catch(i){if(t.shouldThrowOnError)throw i;if($t(i))return{data:null,error:i};throw i}}encodeMetadata(n){return JSON.stringify(n)}toBase64(n){return typeof Buffer<"u"?Buffer.from(n).toString("base64"):btoa(n)}_getFinalPath(n){return`${this.bucketId}/${n.replace(/^\/+/,"")}`}_removeEmptyFolders(n){return n.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(n){const e=[];return n.width&&e.push(`width=${n.width}`),n.height&&e.push(`height=${n.height}`),n.resize&&e.push(`resize=${n.resize}`),n.format&&e.push(`format=${n.format}`),n.quality&&e.push(`quality=${n.quality}`),e.join("&")}};const iE="2.91.0",rE={"X-Client-Info":`storage-js/${iE}`};var a4=class{constructor(n,e={},t,i){this.shouldThrowOnError=!1;const r=new URL(n);i?.useNewHostname&&/supabase\.(co|in|red)$/.test(r.hostname)&&!r.hostname.includes("storage.supabase.")&&(r.hostname=r.hostname.replace("supabase.","storage.supabase.")),this.url=r.href.replace(/\/$/,""),this.headers=Ve(Ve({},rE),e),this.fetch=sm(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(n){var e=this;try{const t=e.listBucketOptionsToQueryString(n);return{data:await Vc(e.fetch,`${e.url}/bucket${t}`,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if($t(t))return{data:null,error:t};throw t}}async getBucket(n){var e=this;try{return{data:await Vc(e.fetch,`${e.url}/bucket/${n}`,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if($t(t))return{data:null,error:t};throw t}}async createBucket(n,e={public:!1}){var t=this;try{return{data:await ar(t.fetch,`${t.url}/bucket`,{id:n,name:n,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}),error:null}}catch(i){if(t.shouldThrowOnError)throw i;if($t(i))return{data:null,error:i};throw i}}async updateBucket(n,e){var t=this;try{return{data:await Ag(t.fetch,`${t.url}/bucket/${n}`,{id:n,name:n,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}),error:null}}catch(i){if(t.shouldThrowOnError)throw i;if($t(i))return{data:null,error:i};throw i}}async emptyBucket(n){var e=this;try{return{data:await ar(e.fetch,`${e.url}/bucket/${n}/empty`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if($t(t))return{data:null,error:t};throw t}}async deleteBucket(n){var e=this;try{return{data:await am(e.fetch,`${e.url}/bucket/${n}`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if($t(t))return{data:null,error:t};throw t}}listBucketOptionsToQueryString(n){const e={};return n&&("limit"in n&&(e.limit=String(n.limit)),"offset"in n&&(e.offset=String(n.offset)),n.search&&(e.search=n.search),n.sortColumn&&(e.sortColumn=n.sortColumn),n.sortOrder&&(e.sortOrder=n.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},o4=class{constructor(n,e={},t){this.shouldThrowOnError=!1,this.url=n.replace(/\/$/,""),this.headers=Ve(Ve({},rE),e),this.fetch=sm(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(n){var e=this;try{return{data:await ar(e.fetch,`${e.url}/bucket`,{name:n},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if($t(t))return{data:null,error:t};throw t}}async listBuckets(n){var e=this;try{const t=new URLSearchParams;n?.limit!==void 0&&t.set("limit",n.limit.toString()),n?.offset!==void 0&&t.set("offset",n.offset.toString()),n?.sortColumn&&t.set("sortColumn",n.sortColumn),n?.sortOrder&&t.set("sortOrder",n.sortOrder),n?.search&&t.set("search",n.search);const i=t.toString(),r=i?`${e.url}/bucket?${i}`:`${e.url}/bucket`;return{data:await Vc(e.fetch,r,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if($t(t))return{data:null,error:t};throw t}}async deleteBucket(n){var e=this;try{return{data:await am(e.fetch,`${e.url}/bucket/${n}`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if($t(t))return{data:null,error:t};throw t}}from(n){var e=this;if(!YD(n))throw new Kf("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const t=new VD({baseUrl:this.url,catalogName:n,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),i=this.shouldThrowOnError;return new Proxy(t,{get(r,a){const o=r[a];return typeof o!="function"?o:async(...c)=>{try{return{data:await o.apply(r,c),error:null}}catch(h){if(i)throw h;return{data:null,error:h}}}}})}};const om={"X-Client-Info":`storage-js/${iE}`,"Content-Type":"application/json"};var sE=class extends Error{constructor(n){super(n),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Ri(n){return typeof n=="object"&&n!==null&&"__isStorageVectorsError"in n}var Up=class extends sE{constructor(n,e,t){super(n),this.name="StorageVectorsApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},l4=class extends sE{constructor(n,e){super(n),this.name="StorageVectorsUnknownError",this.originalError=e}};const lm=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),c4=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},Hx=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),u4=async(n,e,t)=>{if(n&&typeof n=="object"&&"status"in n&&"ok"in n&&typeof n.status=="number"&&!t?.noResolveJson){const i=n.status||500,r=n;if(typeof r.json=="function")r.json().then(a=>{const o=a?.statusCode||a?.code||i+"";e(new Up(Hx(a),i,o))}).catch(()=>{const a=i+"";e(new Up(r.statusText||`HTTP ${i} error`,i,a))});else{const a=i+"";e(new Up(r.statusText||`HTTP ${i} error`,i,a))}}else e(new l4(Hx(n),n))},h4=(n,e,t,i)=>{const r={method:n,headers:e?.headers||{}};return i?(c4(i)?(r.headers=Ve({"Content-Type":"application/json"},e?.headers),r.body=JSON.stringify(i)):r.body=i,Ve(Ve({},r),t)):r};async function f4(n,e,t,i,r,a){return new Promise((o,c)=>{n(t,h4(e,i,r,a)).then(h=>{if(!h.ok)throw h;if(i?.noResolveJson)return h;const f=h.headers.get("content-type");return!f||!f.includes("application/json")?{}:h.json()}).then(h=>o(h)).catch(h=>u4(h,c,i))})}async function Oi(n,e,t,i,r){return f4(n,"POST",e,i,r,t)}var d4=class{constructor(n,e={},t){this.shouldThrowOnError=!1,this.url=n.replace(/\/$/,""),this.headers=Ve(Ve({},om),e),this.fetch=lm(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(n){var e=this;try{return{data:await Oi(e.fetch,`${e.url}/CreateIndex`,n,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ri(t))return{data:null,error:t};throw t}}async getIndex(n,e){var t=this;try{return{data:await Oi(t.fetch,`${t.url}/GetIndex`,{vectorBucketName:n,indexName:e},{headers:t.headers}),error:null}}catch(i){if(t.shouldThrowOnError)throw i;if(Ri(i))return{data:null,error:i};throw i}}async listIndexes(n){var e=this;try{return{data:await Oi(e.fetch,`${e.url}/ListIndexes`,n,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ri(t))return{data:null,error:t};throw t}}async deleteIndex(n,e){var t=this;try{return{data:await Oi(t.fetch,`${t.url}/DeleteIndex`,{vectorBucketName:n,indexName:e},{headers:t.headers})||{},error:null}}catch(i){if(t.shouldThrowOnError)throw i;if(Ri(i))return{data:null,error:i};throw i}}},p4=class{constructor(n,e={},t){this.shouldThrowOnError=!1,this.url=n.replace(/\/$/,""),this.headers=Ve(Ve({},om),e),this.fetch=lm(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(n){var e=this;try{if(n.vectors.length<1||n.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Oi(e.fetch,`${e.url}/PutVectors`,n,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ri(t))return{data:null,error:t};throw t}}async getVectors(n){var e=this;try{return{data:await Oi(e.fetch,`${e.url}/GetVectors`,n,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ri(t))return{data:null,error:t};throw t}}async listVectors(n){var e=this;try{if(n.segmentCount!==void 0){if(n.segmentCount<1||n.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(n.segmentIndex!==void 0&&(n.segmentIndex<0||n.segmentIndex>=n.segmentCount))throw new Error(`segmentIndex must be between 0 and ${n.segmentCount-1}`)}return{data:await Oi(e.fetch,`${e.url}/ListVectors`,n,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ri(t))return{data:null,error:t};throw t}}async queryVectors(n){var e=this;try{return{data:await Oi(e.fetch,`${e.url}/QueryVectors`,n,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ri(t))return{data:null,error:t};throw t}}async deleteVectors(n){var e=this;try{if(n.keys.length<1||n.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Oi(e.fetch,`${e.url}/DeleteVectors`,n,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ri(t))return{data:null,error:t};throw t}}},g4=class{constructor(n,e={},t){this.shouldThrowOnError=!1,this.url=n.replace(/\/$/,""),this.headers=Ve(Ve({},om),e),this.fetch=lm(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(n){var e=this;try{return{data:await Oi(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:n},{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ri(t))return{data:null,error:t};throw t}}async getBucket(n){var e=this;try{return{data:await Oi(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:n},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ri(t))return{data:null,error:t};throw t}}async listBuckets(n={}){var e=this;try{return{data:await Oi(e.fetch,`${e.url}/ListVectorBuckets`,n,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ri(t))return{data:null,error:t};throw t}}async deleteBucket(n){var e=this;try{return{data:await Oi(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:n},{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ri(t))return{data:null,error:t};throw t}}},m4=class extends g4{constructor(n,e={}){super(n,e.headers||{},e.fetch)}from(n){return new v4(this.url,this.headers,n,this.fetch)}async createBucket(n){var e=()=>super.createBucket,t=this;return e().call(t,n)}async getBucket(n){var e=()=>super.getBucket,t=this;return e().call(t,n)}async listBuckets(n={}){var e=()=>super.listBuckets,t=this;return e().call(t,n)}async deleteBucket(n){var e=()=>super.deleteBucket,t=this;return e().call(t,n)}},v4=class extends d4{constructor(n,e,t,i){super(n,e,i),this.vectorBucketName=t}async createIndex(n){var e=()=>super.createIndex,t=this;return e().call(t,Ve(Ve({},n),{},{vectorBucketName:t.vectorBucketName}))}async listIndexes(n={}){var e=()=>super.listIndexes,t=this;return e().call(t,Ve(Ve({},n),{},{vectorBucketName:t.vectorBucketName}))}async getIndex(n){var e=()=>super.getIndex,t=this;return e().call(t,t.vectorBucketName,n)}async deleteIndex(n){var e=()=>super.deleteIndex,t=this;return e().call(t,t.vectorBucketName,n)}index(n){return new y4(this.url,this.headers,this.vectorBucketName,n,this.fetch)}},y4=class extends p4{constructor(n,e,t,i,r){super(n,e,r),this.vectorBucketName=t,this.indexName=i}async putVectors(n){var e=()=>super.putVectors,t=this;return e().call(t,Ve(Ve({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(n){var e=()=>super.getVectors,t=this;return e().call(t,Ve(Ve({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(n={}){var e=()=>super.listVectors,t=this;return e().call(t,Ve(Ve({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(n){var e=()=>super.queryVectors,t=this;return e().call(t,Ve(Ve({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(n){var e=()=>super.deleteVectors,t=this;return e().call(t,Ve(Ve({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},_4=class extends a4{constructor(n,e={},t,i){super(n,e,t,i)}from(n){return new s4(this.url,this.headers,n,this.fetch)}get vectors(){return new m4(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new o4(this.url+"/iceberg",this.headers,this.fetch)}};const aE="2.91.0",Go=30*1e3,Tg=3,jp=Tg*Go,x4="http://localhost:9999",w4="supabase.auth.token",b4={"X-Client-Info":`gotrue-js/${aE}`},Cg="X-Supabase-Api-Version",oE={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},E4=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,S4=600*1e3;class qc extends Error{constructor(e,t,i){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=i}}function Ue(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class A4 extends qc{constructor(e,t,i){super(e,t,i),this.name="AuthApiError",this.status=t,this.code=i}}function T4(n){return Ue(n)&&n.name==="AuthApiError"}class xa extends qc{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class os extends qc{constructor(e,t,i,r){super(e,i,r),this.name=t,this.status=i}}class xi extends os{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function C4(n){return Ue(n)&&n.name==="AuthSessionMissingError"}class No extends os{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Jh extends os{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Qh extends os{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function R4(n){return Ue(n)&&n.name==="AuthImplicitGrantRedirectError"}class zx extends os{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class O4 extends os{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Rg extends os{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Hp(n){return Ue(n)&&n.name==="AuthRetryableFetchError"}class $x extends os{constructor(e,t,i){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=i}}class Og extends os{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const xf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Gx=` 	
\r=`.split(""),k4=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<Gx.length;e+=1)n[Gx[e].charCodeAt(0)]=-2;for(let e=0;e<xf.length;e+=1)n[xf[e].charCodeAt(0)]=e;return n})();function Vx(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;t(xf[i]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;t(xf[i]),e.queuedBits-=6}}function lE(n,e,t){const i=k4[n];if(i>-1)for(e.queue=e.queue<<6|i,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function qx(n){const e=[],t=o=>{e.push(String.fromCodePoint(o))},i={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},a=o=>{M4(o,i,t)};for(let o=0;o<n.length;o+=1)lE(n.charCodeAt(o),r,a);return e.join("")}function D4(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function N4(n,e){for(let t=0;t<n.length;t+=1){let i=n.charCodeAt(t);if(i>55295&&i<=56319){const r=(i-55296)*1024&65535;i=(n.charCodeAt(t+1)-56320&65535|r)+65536,t+=1}D4(i,e)}}function M4(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let i=1;i<6;i+=1)if((n>>7-i&1)===0){e.utf8seq=i;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function nl(n){const e=[],t={queue:0,queuedBits:0},i=r=>{e.push(r)};for(let r=0;r<n.length;r+=1)lE(n.charCodeAt(r),t,i);return new Uint8Array(e)}function L4(n){const e=[];return N4(n,t=>e.push(t)),new Uint8Array(e)}function Ea(n){const e=[],t={queue:0,queuedBits:0},i=r=>{e.push(r)};return n.forEach(r=>Vx(r,t,i)),Vx(null,t,i),e.join("")}function F4(n){return Math.round(Date.now()/1e3)+n}function I4(){return Symbol("auth-callback")}const kn=()=>typeof window<"u"&&typeof document<"u",ma={tested:!1,writable:!1},cE=()=>{if(!kn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ma.tested)return ma.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),ma.tested=!0,ma.writable=!0}catch{ma.tested=!0,ma.writable=!1}return ma.writable};function P4(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((r,a)=>{e[a]=r})}catch{}return t.searchParams.forEach((i,r)=>{e[r]=i}),e}const uE=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),B4=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Vo=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},va=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Rn=async(n,e)=>{await n.removeItem(e)};class Jf{constructor(){this.promise=new Jf.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Jf.promiseConstructor=Promise;function zp(n){const e=n.split(".");if(e.length!==3)throw new Og("Invalid JWT structure");for(let i=0;i<e.length;i++)if(!E4.test(e[i]))throw new Og("JWT not in base64url format");return{header:JSON.parse(qx(e[0])),payload:JSON.parse(qx(e[1])),signature:nl(e[2]),raw:{header:e[0],payload:e[1]}}}async function U4(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function j4(n,e){return new Promise((i,r)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await n(a);if(!e(a,null,o)){i(o);return}}catch(o){if(!e(a,o)){r(o);return}}})()})}function H4(n){return("0"+n.toString(16)).substr(-2)}function z4(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=t.length;let r="";for(let a=0;a<56;a++)r+=t.charAt(Math.floor(Math.random()*i));return r}return crypto.getRandomValues(e),Array.from(e,H4).join("")}async function $4(n){const t=new TextEncoder().encode(n),i=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(i);return Array.from(r).map(a=>String.fromCharCode(a)).join("")}async function G4(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await $4(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Mo(n,e,t=!1){const i=z4();let r=i;t&&(r+="/PASSWORD_RECOVERY"),await Vo(n,`${e}-code-verifier`,r);const a=await G4(i);return[a,i===a?"plain":"s256"]}const V4=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function q4(n){const e=n.headers.get(Cg);if(!e||!e.match(V4))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function W4(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function X4(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Y4=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Lo(n){if(!Y4.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function $p(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const i=t.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function K4(n,e){return new Proxy(n,{get:(t,i,r)=>{if(i==="__isInsecureUserWarningProxy")return!0;if(typeof i=="symbol"){const a=i.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,i,r)}return!e.value&&typeof i=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,i,r)}})}function Wx(n){return JSON.parse(JSON.stringify(n))}const ya=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),J4=[502,503,504];async function Xx(n){var e;if(!B4(n))throw new Rg(ya(n),0);if(J4.includes(n.status))throw new Rg(ya(n),n.status);let t;try{t=await n.json()}catch(a){throw new xa(ya(a),a)}let i;const r=q4(n);if(r&&r.getTime()>=oE["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?i=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(i=t.error_code),i){if(i==="weak_password")throw new $x(ya(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(i==="session_not_found")throw new xi}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new $x(ya(t),n.status,t.weak_password.reasons);throw new A4(ya(t),n.status||500,i)}const Q4=(n,e,t,i)=>{const r={method:n,headers:e?.headers||{}};return n==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),r.body=JSON.stringify(i),Object.assign(Object.assign({},r),t))};async function Ge(n,e,t,i){var r;const a=Object.assign({},i?.headers);a[Cg]||(a[Cg]=oE["2024-01-01"].name),i?.jwt&&(a.Authorization=`Bearer ${i.jwt}`);const o=(r=i?.query)!==null&&r!==void 0?r:{};i?.redirectTo&&(o.redirect_to=i.redirectTo);const c=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",h=await Z4(n,e,t+c,{headers:a,noResolveJson:i?.noResolveJson},{},i?.body);return i?.xform?i?.xform(h):{data:Object.assign({},h),error:null}}async function Z4(n,e,t,i,r,a){const o=Q4(e,i,r,a);let c;try{c=await n(t,Object.assign({},o))}catch(h){throw console.error(h),new Rg(ya(h),0)}if(c.ok||await Xx(c),i?.noResolveJson)return c;try{return await c.json()}catch(h){await Xx(h)}}function sr(n){var e;let t=null;nN(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=F4(n.expires_in)));const i=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:i},error:null}}function Yx(n){const e=sr(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,i)=>t&&typeof i=="string",!0)&&(e.data.weak_password=n.weak_password),e}function Us(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function eN(n){return{data:n,error:null}}function tN(n){const{action_link:e,email_otp:t,hashed_token:i,redirect_to:r,verification_type:a}=n,o=Yf(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:e,email_otp:t,hashed_token:i,redirect_to:r,verification_type:a},h=Object.assign({},o);return{data:{properties:c,user:h},error:null}}function Kx(n){return n}function nN(n){return n.access_token&&n.refresh_token&&n.expires_in}const Gp=["global","local","others"];class iN{constructor({url:e="",headers:t={},fetch:i}){this.url=e,this.headers=t,this.fetch=uE(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=Gp[0]){if(Gp.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Gp.join(", ")}`);try{return await Ge(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(i){if(Ue(i))return{data:null,error:i};throw i}}async inviteUserByEmail(e,t={}){try{return await Ge(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Us})}catch(i){if(Ue(i))return{data:{user:null},error:i};throw i}}async generateLink(e){try{const{options:t}=e,i=Yf(e,["options"]),r=Object.assign(Object.assign({},i),t);return"newEmail"in i&&(r.new_email=i?.newEmail,delete r.newEmail),await Ge(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:tN,redirectTo:t?.redirectTo})}catch(t){if(Ue(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Ge(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Us})}catch(t){if(Ue(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,i,r,a,o,c,h;try{const f={nextPage:null,lastPage:0,total:0},p=await Ge(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:"",per_page:(a=(r=e?.perPage)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:""},xform:Kx});if(p.error)throw p.error;const g=await p.json(),m=(o=p.headers.get("x-total-count"))!==null&&o!==void 0?o:0,y=(h=(c=p.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&h!==void 0?h:[];return y.length>0&&(y.forEach(w=>{const _=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(w.split(";")[1].split("=")[1]);f[`${b}Page`]=_}),f.total=parseInt(m)),{data:Object.assign(Object.assign({},g),f),error:null}}catch(f){if(Ue(f))return{data:{users:[]},error:f};throw f}}async getUserById(e){Lo(e);try{return await Ge(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Us})}catch(t){if(Ue(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Lo(e);try{return await Ge(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Us})}catch(i){if(Ue(i))return{data:{user:null},error:i};throw i}}async deleteUser(e,t=!1){Lo(e);try{return await Ge(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Us})}catch(i){if(Ue(i))return{data:{user:null},error:i};throw i}}async _listFactors(e){Lo(e.userId);try{const{data:t,error:i}=await Ge(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:t,error:i}}catch(t){if(Ue(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Lo(e.userId),Lo(e.id);try{return{data:await Ge(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Ue(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,i,r,a,o,c,h;try{const f={nextPage:null,lastPage:0,total:0},p=await Ge(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:"",per_page:(a=(r=e?.perPage)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:""},xform:Kx});if(p.error)throw p.error;const g=await p.json(),m=(o=p.headers.get("x-total-count"))!==null&&o!==void 0?o:0,y=(h=(c=p.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&h!==void 0?h:[];return y.length>0&&(y.forEach(w=>{const _=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(w.split(";")[1].split("=")[1]);f[`${b}Page`]=_}),f.total=parseInt(m)),{data:Object.assign(Object.assign({},g),f),error:null}}catch(f){if(Ue(f))return{data:{clients:[]},error:f};throw f}}async _createOAuthClient(e){try{return await Ge(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Ue(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await Ge(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Ue(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await Ge(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:i=>({data:i,error:null})})}catch(i){if(Ue(i))return{data:null,error:i};throw i}}async _deleteOAuthClient(e){try{return await Ge(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(Ue(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await Ge(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Ue(t))return{data:null,error:t};throw t}}}function Jx(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}const Fo={debug:!!(globalThis&&cE()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class hE extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class rN extends hE{}async function sN(n,e,t){Fo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const i=new globalThis.AbortController;return e>0&&setTimeout(()=>{i.abort(),Fo.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async r=>{if(r){Fo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,r.name);try{return await t()}finally{Fo.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,r.name)}}else{if(e===0)throw Fo.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new rN(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Fo.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function aN(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function fE(n){if(!/^0x[a-fA-F0-9]{40}$/.test(n))throw new Error(`@supabase/auth-js: Address "${n}" is invalid.`);return n.toLowerCase()}function oN(n){return parseInt(n,16)}function lN(n){const e=new TextEncoder().encode(n);return"0x"+Array.from(e,i=>i.toString(16).padStart(2,"0")).join("")}function cN(n){var e;const{chainId:t,domain:i,expirationTime:r,issuedAt:a=new Date,nonce:o,notBefore:c,requestId:h,resources:f,scheme:p,uri:g,version:m}=n;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!i)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!g)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(m!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${m}`);if(!((e=n.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`)}const y=fE(n.address),w=p?`${p}://${i}`:i,_=n.statement?`${n.statement}
`:"",b=`${w} wants you to sign in with your Ethereum account:
${y}

${_}`;let E=`URI: ${g}
Version: ${m}
Chain ID: ${t}${o?`
Nonce: ${o}`:""}
Issued At: ${a.toISOString()}`;if(r&&(E+=`
Expiration Time: ${r.toISOString()}`),c&&(E+=`
Not Before: ${c.toISOString()}`),h&&(E+=`
Request ID: ${h}`),f){let T=`
Resources:`;for(const S of f){if(!S||typeof S!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${S}`);T+=`
- ${S}`}E+=T}return`${b}
${E}`}class un extends Error{constructor({message:e,code:t,cause:i,name:r}){var a;super(e,{cause:i}),this.__isWebAuthnError=!0,this.name=(a=r??(i instanceof Error?i.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=t}}class wf extends un{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function uN({error:n,options:e}){var t,i,r;const{publicKey:a}=e;if(!a)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new un({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else if(n.name==="ConstraintError"){if(((t=a.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new un({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:n});if(e.mediation==="conditional"&&((i=a.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new un({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:n});if(((r=a.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new un({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:n})}else{if(n.name==="InvalidStateError")return new un({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:n});if(n.name==="NotAllowedError")return new un({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="NotSupportedError")return a.pubKeyCredParams.filter(c=>c.type==="public-key").length===0?new un({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:n}):new un({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:n});if(n.name==="SecurityError"){const o=window.location.hostname;if(dE(o)){if(a.rp.id!==o)return new un({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new un({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new un({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:n})}else if(n.name==="UnknownError")return new un({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new un({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}function hN({error:n,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new un({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else{if(n.name==="NotAllowedError")return new un({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="SecurityError"){const i=window.location.hostname;if(dE(i)){if(t.rpId!==i)return new un({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new un({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="UnknownError")return new un({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new un({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}class fN{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const dN=new fN;function pN(n){if(!n)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(n);const{challenge:e,user:t,excludeCredentials:i}=n,r=Yf(n,["challenge","user","excludeCredentials"]),a=nl(e).buffer,o=Object.assign(Object.assign({},t),{id:nl(t.id).buffer}),c=Object.assign(Object.assign({},r),{challenge:a,user:o});if(i&&i.length>0){c.excludeCredentials=new Array(i.length);for(let h=0;h<i.length;h++){const f=i[h];c.excludeCredentials[h]=Object.assign(Object.assign({},f),{id:nl(f.id).buffer,type:f.type||"public-key",transports:f.transports})}}return c}function gN(n){if(!n)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(n);const{challenge:e,allowCredentials:t}=n,i=Yf(n,["challenge","allowCredentials"]),r=nl(e).buffer,a=Object.assign(Object.assign({},i),{challenge:r});if(t&&t.length>0){a.allowCredentials=new Array(t.length);for(let o=0;o<t.length;o++){const c=t[o];a.allowCredentials[o]=Object.assign(Object.assign({},c),{id:nl(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return a}function mN(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n;return{id:n.id,rawId:n.id,response:{attestationObject:Ea(new Uint8Array(n.response.attestationObject)),clientDataJSON:Ea(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function vN(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n,i=n.getClientExtensionResults(),r=n.response;return{id:n.id,rawId:n.id,response:{authenticatorData:Ea(new Uint8Array(r.authenticatorData)),clientDataJSON:Ea(new Uint8Array(r.clientDataJSON)),signature:Ea(new Uint8Array(r.signature)),userHandle:r.userHandle?Ea(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:i,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function dE(n){return n==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(n)}function Qx(){var n,e;return!!(kn()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((n=navigator?.credentials)===null||n===void 0?void 0:n.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function yN(n){try{const e=await navigator.credentials.create(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new wf("Browser returned unexpected credential type",e)}:{data:null,error:new wf("Empty credential response",e)}}catch(e){return{data:null,error:uN({error:e,options:n})}}}async function _N(n){try{const e=await navigator.credentials.get(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new wf("Browser returned unexpected credential type",e)}:{data:null,error:new wf("Empty credential response",e)}}catch(e){return{data:null,error:hN({error:e,options:n})}}}const xN={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},wN={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function bf(...n){const e=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),t=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),i={};for(const r of n)if(r)for(const a in r){const o=r[a];if(o!==void 0)if(Array.isArray(o))i[a]=o;else if(t(o))i[a]=o;else if(e(o)){const c=i[a];e(c)?i[a]=bf(c,o):i[a]=bf(o)}else i[a]=o}return i}function bN(n,e){return bf(xN,n,e||{})}function EN(n,e){return bf(wN,n,e||{})}class SN{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:i,signal:r},a){try{const{data:o,error:c}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!o)return{data:null,error:c};const h=r??dN.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:f}=o.webauthn.credential_options.publicKey;f.name||(f.name=`${f.id}:${i}`),f.displayName||(f.displayName=f.name)}switch(o.webauthn.type){case"create":{const f=bN(o.webauthn.credential_options.publicKey,a?.create),{data:p,error:g}=await yN({publicKey:f,signal:h});return p?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:p}},error:null}:{data:null,error:g}}case"request":{const f=EN(o.webauthn.credential_options.publicKey,a?.request),{data:p,error:g}=await _N(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:f,signal:h}));return p?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:p}},error:null}:{data:null,error:g}}}}catch(o){return Ue(o)?{data:null,error:o}:{data:null,error:new xa("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:t,webauthn:i}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:i})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:r}={}},a){if(!t)return{data:null,error:new qc("rpId is required for WebAuthn authentication")};try{if(!Qx())return{data:null,error:new xa("Browser does not support WebAuthn",null)};const{data:o,error:c}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:i},signal:r},{request:a});if(!o)return{data:null,error:c};const{webauthn:h}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:h.type,rpId:t,rpOrigins:i,credential_response:h.credential_response}})}catch(o){return Ue(o)?{data:null,error:o}:{data:null,error:new xa("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:r}={}},a){if(!t)return{data:null,error:new qc("rpId is required for WebAuthn registration")};try{if(!Qx())return{data:null,error:new xa("Browser does not support WebAuthn",null)};const{data:o,error:c}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(p=>{var g;return(g=p.data)===null||g===void 0?void 0:g.all.find(m=>m.factor_type==="webauthn"&&m.friendly_name===e&&m.status!=="unverified")}).then(p=>p?this.client.mfa.unenroll({factorId:p?.id}):void 0),{data:null,error:c};const{data:h,error:f}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:t,rpOrigins:i},signal:r},{create:a});return h?this._verify({factorId:o.id,challengeId:h.challengeId,webauthn:{rpId:t,rpOrigins:i,type:h.webauthn.type,credential_response:h.webauthn.credential_response}}):{data:null,error:f}}catch(o){return Ue(o)?{data:null,error:o}:{data:null,error:new xa("Unexpected error in register",o)}}}}aN();const AN={url:x4,storageKey:w4,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:b4,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function Zx(n,e,t){return await t()}const Io={};class Wc{get jwks(){var e,t;return(t=(e=Io[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Io[this.storageKey]=Object.assign(Object.assign({},Io[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Io[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Io[this.storageKey]=Object.assign(Object.assign({},Io[this.storageKey]),{cachedAt:e})}constructor(e){var t,i,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},AN),e);if(this.storageKey=a.storageKey,this.instanceID=(t=Wc.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,Wc.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&kn()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new iN({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=uE(a.fetch),this.lock=a.lock||Zx,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,this.lockAcquireTimeout=a.lockAcquireTimeout,a.lock?this.lock=a.lock:this.persistSession&&kn()&&(!((i=globalThis?.navigator)===null||i===void 0)&&i.locks)?this.lock=sN:this.lock=Zx,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new SN(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:cE()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Jx(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=Jx(this.memoryStorage)),kn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${aE}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},i="none";if(kn()&&(t=P4(window.location.href),this._isImplicitGrantCallback(t)?i="implicit":await this._isPKCECallback(t)&&(i="pkce")),kn()&&this.detectSessionInUrl&&i!=="none"){const{data:r,error:a}=await this._getSessionFromURL(t,i);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),R4(a)){const h=(e=a.details)===null||e===void 0?void 0:e.code;if(h==="identity_already_exists"||h==="identity_not_found"||h==="single_identity_not_deletable")return{error:a}}return{error:a}}const{session:o,redirectType:c}=r;return this._debug("#_initialize()","detected session in URL",o,"redirect type",c),await this._saveSession(o),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Ue(t)?this._returnResult({error:t}):this._returnResult({error:new xa("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,i,r;try{const a=await Ge(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(r=e?.options)===null||r===void 0?void 0:r.captchaToken}},xform:sr}),{data:o,error:c}=a;if(c||!o)return this._returnResult({data:{user:null,session:null},error:c});const h=o.session,f=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:f,session:h},error:null})}catch(a){if(Ue(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(e){var t,i,r;try{let a;if("email"in e){const{email:p,password:g,options:m}=e;let y=null,w=null;this.flowType==="pkce"&&([y,w]=await Mo(this.storage,this.storageKey)),a=await Ge(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:m?.emailRedirectTo,body:{email:p,password:g,data:(t=m?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:m?.captchaToken},code_challenge:y,code_challenge_method:w},xform:sr})}else if("phone"in e){const{phone:p,password:g,options:m}=e;a=await Ge(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:g,data:(i=m?.data)!==null&&i!==void 0?i:{},channel:(r=m?.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:m?.captchaToken}},xform:sr})}else throw new Jh("You must provide either an email or phone number and a password");const{data:o,error:c}=a;if(c||!o)return await Rn(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:c});const h=o.session,f=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:f,session:h},error:null})}catch(a){if(await Rn(this.storage,`${this.storageKey}-code-verifier`),Ue(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:a,password:o,options:c}=e;t=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:Yx})}else if("phone"in e){const{phone:a,password:o,options:c}=e;t=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:Yx})}else throw new Jh("You must provide either an email or phone number and a password");const{data:i,error:r}=t;if(r)return this._returnResult({data:{user:null,session:null},error:r});if(!i||!i.session||!i.user){const a=new No;return this._returnResult({data:{user:null,session:null},error:a})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:r})}catch(t){if(Ue(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,i,r,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(i=e.options)===null||i===void 0?void 0:i.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,i,r,a,o,c,h,f,p,g,m;let y,w;if("message"in e)y=e.message,w=e.signature;else{const{chain:_,wallet:b,statement:E,options:T}=e;let S;if(kn())if(typeof b=="object")S=b;else{const M=window;if("ethereum"in M&&typeof M.ethereum=="object"&&"request"in M.ethereum&&typeof M.ethereum.request=="function")S=M.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!T?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=b}const k=new URL((t=T?.url)!==null&&t!==void 0?t:window.location.href),P=await S.request({method:"eth_requestAccounts"}).then(M=>M).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!P||P.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const F=fE(P[0]);let O=(i=T?.signInWithEthereum)===null||i===void 0?void 0:i.chainId;if(!O){const M=await S.request({method:"eth_chainId"});O=oN(M)}const G={domain:k.host,address:F,statement:E,uri:k.href,version:"1",chainId:O,nonce:(r=T?.signInWithEthereum)===null||r===void 0?void 0:r.nonce,issuedAt:(o=(a=T?.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(c=T?.signInWithEthereum)===null||c===void 0?void 0:c.expirationTime,notBefore:(h=T?.signInWithEthereum)===null||h===void 0?void 0:h.notBefore,requestId:(f=T?.signInWithEthereum)===null||f===void 0?void 0:f.requestId,resources:(p=T?.signInWithEthereum)===null||p===void 0?void 0:p.resources};y=cN(G),w=await S.request({method:"personal_sign",params:[lN(y),F]})}try{const{data:_,error:b}=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:y,signature:w},!((g=e.options)===null||g===void 0)&&g.captchaToken?{gotrue_meta_security:{captcha_token:(m=e.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:sr});if(b)throw b;if(!_||!_.session||!_.user){const E=new No;return this._returnResult({data:{user:null,session:null},error:E})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:b})}catch(_){if(Ue(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async signInWithSolana(e){var t,i,r,a,o,c,h,f,p,g,m,y;let w,_;if("message"in e)w=e.message,_=e.signature;else{const{chain:b,wallet:E,statement:T,options:S}=e;let k;if(kn())if(typeof E=="object")k=E;else{const F=window;if("solana"in F&&typeof F.solana=="object"&&("signIn"in F.solana&&typeof F.solana.signIn=="function"||"signMessage"in F.solana&&typeof F.solana.signMessage=="function"))k=F.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof E!="object"||!S?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=E}const P=new URL((t=S?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in k&&k.signIn){const F=await k.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},S?.signInWithSolana),{version:"1",domain:P.host,uri:P.href}),T?{statement:T}:null));let O;if(Array.isArray(F)&&F[0]&&typeof F[0]=="object")O=F[0];else if(F&&typeof F=="object"&&"signedMessage"in F&&"signature"in F)O=F;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in O&&"signature"in O&&(typeof O.signedMessage=="string"||O.signedMessage instanceof Uint8Array)&&O.signature instanceof Uint8Array)w=typeof O.signedMessage=="string"?O.signedMessage:new TextDecoder().decode(O.signedMessage),_=O.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in k)||typeof k.signMessage!="function"||!("publicKey"in k)||typeof k!="object"||!k.publicKey||!("toBase58"in k.publicKey)||typeof k.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${P.host} wants you to sign in with your Solana account:`,k.publicKey.toBase58(),...T?["",T,""]:[""],"Version: 1",`URI: ${P.href}`,`Issued At: ${(r=(i=S?.signInWithSolana)===null||i===void 0?void 0:i.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((a=S?.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${S.signInWithSolana.notBefore}`]:[],...!((o=S?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${S.signInWithSolana.expirationTime}`]:[],...!((c=S?.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${S.signInWithSolana.chainId}`]:[],...!((h=S?.signInWithSolana)===null||h===void 0)&&h.nonce?[`Nonce: ${S.signInWithSolana.nonce}`]:[],...!((f=S?.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${S.signInWithSolana.requestId}`]:[],...!((g=(p=S?.signInWithSolana)===null||p===void 0?void 0:p.resources)===null||g===void 0)&&g.length?["Resources",...S.signInWithSolana.resources.map(O=>`- ${O}`)]:[]].join(`
`);const F=await k.signMessage(new TextEncoder().encode(w),"utf8");if(!F||!(F instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=F}}try{const{data:b,error:E}=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:Ea(_)},!((m=e.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(y=e.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:sr});if(E)throw E;if(!b||!b.session||!b.user){const T=new No;return this._returnResult({data:{user:null,session:null},error:T})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:E})}catch(b){if(Ue(b))return this._returnResult({data:{user:null,session:null},error:b});throw b}}async _exchangeCodeForSession(e){const t=await va(this.storage,`${this.storageKey}-code-verifier`),[i,r]=(t??"").split("/");try{if(!i&&this.flowType==="pkce")throw new O4;const{data:a,error:o}=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:i},xform:sr});if(await Rn(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!a||!a.session||!a.user){const c=new No;return this._returnResult({data:{user:null,session:null,redirectType:null},error:c})}return a.session&&(await this._saveSession(a.session),setTimeout(async()=>{await this._notifyAllSubscribers("SIGNED_IN",a.session)},0)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:r??null}),error:o})}catch(a){if(await Rn(this.storage,`${this.storageKey}-code-verifier`),Ue(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(e){try{const{options:t,provider:i,token:r,access_token:a,nonce:o}=e,c=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:r,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:sr}),{data:h,error:f}=c;if(f)return this._returnResult({data:{user:null,session:null},error:f});if(!h||!h.session||!h.user){const p=new No;return this._returnResult({data:{user:null,session:null},error:p})}return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),this._returnResult({data:h,error:f})}catch(t){if(Ue(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,i,r,a,o;try{if("email"in e){const{email:c,options:h}=e;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await Mo(this.storage,this.storageKey));const{error:g}=await Ge(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(t=h?.data)!==null&&t!==void 0?t:{},create_user:(i=h?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:f,code_challenge_method:p},redirectTo:h?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:g})}if("phone"in e){const{phone:c,options:h}=e,{data:f,error:p}=await Ge(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(r=h?.data)!==null&&r!==void 0?r:{},create_user:(a=h?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},channel:(o=h?.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:f?.message_id},error:p})}throw new Jh("You must provide either an email or phone number.")}catch(c){if(await Rn(this.storage,`${this.storageKey}-code-verifier`),Ue(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async verifyOtp(e){var t,i;try{let r,a;"options"in e&&(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo,a=(i=e.options)===null||i===void 0?void 0:i.captchaToken);const{data:o,error:c}=await Ge(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:r,xform:sr});if(c)throw c;if(!o)throw new Error("An error occurred on token verification.");const h=o.session,f=o.user;return h?.access_token&&(await this._saveSession(h),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",h)),this._returnResult({data:{user:f,session:h},error:null})}catch(r){if(Ue(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithSSO(e){var t,i,r,a,o;try{let c=null,h=null;this.flowType==="pkce"&&([c,h]=await Mo(this.storage,this.storageKey));const f=await Ge(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&i!==void 0?i:void 0}),!((r=e?.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:h}),headers:this.headers,xform:eN});return!((a=f.data)===null||a===void 0)&&a.url&&kn()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(f.data.url),this._returnResult(f)}catch(c){if(await Rn(this.storage,`${this.storageKey}-code-verifier`),Ue(c))return this._returnResult({data:null,error:c});throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:i}=e;if(i)throw i;if(!t)throw new xi;const{error:r}=await Ge(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:r})})}catch(e){if(Ue(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:i,type:r,options:a}=e,{error:o}=await Ge(this.fetch,"POST",t,{headers:this.headers,body:{email:i,type:r,gotrue_meta_security:{captcha_token:a?.captchaToken}},redirectTo:a?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:i,type:r,options:a}=e,{data:o,error:c}=await Ge(this.fetch,"POST",t,{headers:this.headers,body:{phone:i,type:r,gotrue_meta_security:{captcha_token:a?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o?.message_id},error:c})}throw new Jh("You must provide either an email or phone number and a type")}catch(t){if(Ue(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await i,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=t();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await va(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const i=e.expires_at?e.expires_at*1e3-Date.now()<jp:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",e.expires_at),!i){if(this.userStorage){const o=await va(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=$p()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=K4(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:r,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:r},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await Ge(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Us}):await this._useSession(async t=>{var i,r,a;const{data:o,error:c}=t;if(c)throw c;return!(!((i=o.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new xi}:await Ge(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0,xform:Us})})}catch(t){if(Ue(t))return C4(t)&&(await this._removeSession(),await Rn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async i=>{const{data:r,error:a}=i;if(a)throw a;if(!r.session)throw new xi;const o=r.session;let c=null,h=null;this.flowType==="pkce"&&e.email!=null&&([c,h]=await Mo(this.storage,this.storageKey));const{data:f,error:p}=await Ge(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:h}),jwt:o.access_token,xform:Us});if(p)throw p;return o.user=f.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(i){if(await Rn(this.storage,`${this.storageKey}-code-verifier`),Ue(i))return this._returnResult({data:{user:null},error:i});throw i}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new xi;const t=Date.now()/1e3;let i=t,r=!0,a=null;const{payload:o}=zp(e.access_token);if(o.exp&&(i=o.exp,r=i<=t),r){const{data:c,error:h}=await this._callRefreshToken(e.refresh_token);if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!c)return{data:{user:null,session:null},error:null};a=c}else{const{data:c,error:h}=await this._getUser(e.access_token);if(h)throw h;a={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:i-t,expires_at:i},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(t){if(Ue(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var i;if(!e){const{data:o,error:c}=t;if(c)throw c;e=(i=o.session)!==null&&i!==void 0?i:void 0}if(!e?.refresh_token)throw new xi;const{data:r,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):r?this._returnResult({data:{user:r.user,session:r},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(Ue(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!kn())throw new Qh("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Qh(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new zx("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Qh("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new zx("No code detected.");const{data:T,error:S}=await this._exchangeCodeForSession(e.code);if(S)throw S;const k=new URL(window.location.href);return k.searchParams.delete("code"),window.history.replaceState(window.history.state,"",k.toString()),{data:{session:T.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:r,access_token:a,refresh_token:o,expires_in:c,expires_at:h,token_type:f}=e;if(!a||!c||!o||!f)throw new Qh("No session defined in URL");const p=Math.round(Date.now()/1e3),g=parseInt(c);let m=p+g;h&&(m=parseInt(h));const y=m-p;y*1e3<=Go&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${y}s, should have been closer to ${g}s`);const w=m-g;p-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,m,p):p-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,m,p);const{data:_,error:b}=await this._getUser(a);if(b)throw b;const E={provider_token:i,provider_refresh_token:r,access_token:a,expires_in:g,expires_at:m,refresh_token:o,token_type:f,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:E,redirectType:e.type},error:null})}catch(i){if(Ue(i))return this._returnResult({data:{session:null,redirectType:null},error:i});throw i}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await va(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var i;const{data:r,error:a}=t;if(a)return this._returnResult({error:a});const o=(i=r.session)===null||i===void 0?void 0:i.access_token;if(o){const{error:c}=await this.admin.signOut(o,e);if(c&&!(T4(c)&&(c.status===404||c.status===401||c.status===403)))return this._returnResult({error:c})}return e!=="others"&&(await this._removeSession(),await Rn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=I4(),i={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,i),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:i}}}async _emitInitialSession(e){return await this._useSession(async t=>{var i,r;try{const{data:{session:a},error:o}=t;if(o)throw o;await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,t={}){let i=null,r=null;this.flowType==="pkce"&&([i,r]=await Mo(this.storage,this.storageKey,!0));try{return await Ge(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:i,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(await Rn(this.storage,`${this.storageKey}-code-verifier`),Ue(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var e;try{const{data:t,error:i}=await this.getUser();if(i)throw i;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(Ue(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:i,error:r}=await this._useSession(async a=>{var o,c,h,f,p;const{data:g,error:m}=a;if(m)throw m;const y=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(h=e.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:!0});return await Ge(this.fetch,"GET",y,{headers:this.headers,jwt:(p=(f=g.session)===null||f===void 0?void 0:f.access_token)!==null&&p!==void 0?p:void 0})});if(r)throw r;return kn()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(i?.url),this._returnResult({data:{provider:e.provider,url:i?.url},error:null})}catch(i){if(Ue(i))return this._returnResult({data:{provider:e.provider,url:null},error:i});throw i}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var i;try{const{error:r,data:{session:a}}=t;if(r)throw r;const{options:o,provider:c,token:h,access_token:f,nonce:p}=e,g=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(i=a?.access_token)!==null&&i!==void 0?i:void 0,body:{provider:c,id_token:h,access_token:f,nonce:p,link_identity:!0,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:sr}),{data:m,error:y}=g;return y?this._returnResult({data:{user:null,session:null},error:y}):!m||!m.session||!m.user?this._returnResult({data:{user:null,session:null},error:new No}):(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("USER_UPDATED",m.session)),this._returnResult({data:m,error:y}))}catch(r){if(await Rn(this.storage,`${this.storageKey}-code-verifier`),Ue(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var i,r;const{data:a,error:o}=t;if(o)throw o;return await Ge(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&r!==void 0?r:void 0})})}catch(t){if(Ue(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const i=Date.now();return await j4(async r=>(r>0&&await U4(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await Ge(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:sr})),(r,a)=>{const o=200*Math.pow(2,r);return a&&Hp(a)&&Date.now()+o-i<Go})}catch(i){if(this._debug(t,"error",i),Ue(i))return this._returnResult({data:{session:null,user:null},error:i});throw i}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const i=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",i),kn()&&!t.skipBrowserRedirect&&window.location.assign(i),{data:{provider:e,url:i},error:null}}async _recoverAndRefresh(){var e,t;const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const r=await va(this.storage,this.storageKey);if(r&&this.userStorage){let o=await va(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:r.user},await Vo(this.userStorage,this.storageKey+"-user",o)),r.user=(e=o?.user)!==null&&e!==void 0?e:$p()}else if(r&&!r.user&&!r.user){const o=await va(this.storage,this.storageKey+"-user");o&&o?.user?(r.user=o.user,await Rn(this.storage,this.storageKey+"-user"),await Vo(this.storage,this.storageKey,r)):r.user=$p()}if(this._debug(i,"session from storage",r),!this._isValidSession(r)){this._debug(i,"session is not valid"),r!==null&&await this._removeSession();return}const a=((t=r.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<jp;if(this._debug(i,`session has${a?"":" not"} expired with margin of ${jp}s`),a){if(this.autoRefreshToken&&r.refresh_token){const{error:o}=await this._callRefreshToken(r.refresh_token);o&&(console.error(o),Hp(o)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:c}=await this._getUser(r.access_token);!c&&o?.user?(r.user=o.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(i,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(i,"error",r),console.error(r);return}finally{this._debug(i,"end")}}async _callRefreshToken(e){var t,i;if(!e)throw new xi;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new Jf;const{data:a,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!a.session)throw new xi;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const c={data:a.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(a){if(this._debug(r,"error",a),Ue(a)){const o={data:null,error:a};return Hp(a)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(a),a}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,i=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(e,t)}catch(h){a.push(h)}});if(await Promise.all(o),a.length>0){for(let c=0;c<a.length;c+=1)console.error(a[c]);throw a[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Rn(this.storage,`${this.storageKey}-code-verifier`);const t=Object.assign({},e),i=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!i&&t.user&&await Vo(this.userStorage,this.storageKey+"-user",{user:t.user});const r=Object.assign({},t);delete r.user;const a=Wx(r);await Vo(this.storage,this.storageKey,a)}else{const r=Wx(t);await Vo(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Rn(this.storage,this.storageKey),await Rn(this.storage,this.storageKey+"-code-verifier"),await Rn(this.storage,this.storageKey+"-user"),this.userStorage&&await Rn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&kn()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Go);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:i}}=t;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((i.expires_at*1e3-e)/Go);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${Go}ms, refresh threshold is ${Tg} ticks`),r<=Tg&&await this._callRefreshToken(i.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof hE)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!kn()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,i){const r=[`provider=${encodeURIComponent(t)}`];if(i?.redirectTo&&r.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i?.scopes&&r.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[a,o]=await Mo(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});r.push(c.toString())}if(i?.queryParams){const a=new URLSearchParams(i.queryParams);r.push(a.toString())}return i?.skipBrowserRedirect&&r.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var i;const{data:r,error:a}=t;return a?this._returnResult({data:null,error:a}):await Ge(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(i=r?.session)===null||i===void 0?void 0:i.access_token})})}catch(t){if(Ue(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var i,r;const{data:a,error:o}=t;if(o)return this._returnResult({data:null,error:o});const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:h,error:f}=await Ge(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(i=a?.session)===null||i===void 0?void 0:i.access_token});return f?this._returnResult({data:null,error:f}):(e.factorType==="totp"&&h.type==="totp"&&(!((r=h?.totp)===null||r===void 0)&&r.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),this._returnResult({data:h,error:null}))})}catch(t){if(Ue(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var i;const{data:r,error:a}=t;if(a)return this._returnResult({data:null,error:a});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?mN(e.webauthn.credential_response):vN(e.webauthn.credential_response)})}:{code:e.code}),{data:c,error:h}=await Ge(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(i=r?.session)===null||i===void 0?void 0:i.access_token});return h?this._returnResult({data:null,error:h}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),this._returnResult({data:c,error:h}))})}catch(t){if(Ue(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var i;const{data:r,error:a}=t;if(a)return this._returnResult({data:null,error:a});const o=await Ge(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(i=r?.session)===null||i===void 0?void 0:i.access_token});if(o.error)return o;const{data:c}=o;if(c.type!=="webauthn")return{data:c,error:null};switch(c.webauthn.type){case"create":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:pN(c.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:gN(c.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(Ue(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:i}=await this._challenge({factorId:e.factorId});return i?this._returnResult({data:null,error:i}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:i}=await this.getUser();if(i)return{data:null,error:i};const r={all:[],phone:[],totp:[],webauthn:[]};for(const a of(e=t?.factors)!==null&&e!==void 0?e:[])r.all.push(a),a.status==="verified"&&r[a.factor_type].push(a);return{data:r,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:i},error:r}=await this.getSession();if(r)return this._returnResult({data:null,error:r});if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=zp(i.access_token);let o=null;a.aal&&(o=a.aal);let c=o;((t=(e=i.user.factors)===null||e===void 0?void 0:e.filter(p=>p.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(c="aal2");const f=a.amr||[];return{data:{currentLevel:o,nextLevel:c,currentAuthenticationMethods:f},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:i},error:r}=t;return r?this._returnResult({data:null,error:r}):i?await Ge(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:i.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new xi})})}catch(t){if(Ue(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async i=>{const{data:{session:r},error:a}=i;if(a)return this._returnResult({data:null,error:a});if(!r)return this._returnResult({data:null,error:new xi});const o=await Ge(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"approve"},xform:c=>({data:c,error:null})});return o.data&&o.data.redirect_url&&kn()&&!t?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(i){if(Ue(i))return this._returnResult({data:null,error:i});throw i}}async _denyAuthorization(e,t){try{return await this._useSession(async i=>{const{data:{session:r},error:a}=i;if(a)return this._returnResult({data:null,error:a});if(!r)return this._returnResult({data:null,error:new xi});const o=await Ge(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"deny"},xform:c=>({data:c,error:null})});return o.data&&o.data.redirect_url&&kn()&&!t?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(i){if(Ue(i))return this._returnResult({data:null,error:i});throw i}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:i}=e;return i?this._returnResult({data:null,error:i}):t?await Ge(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:r=>({data:r,error:null})}):this._returnResult({data:null,error:new xi})})}catch(e){if(Ue(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:i},error:r}=t;return r?this._returnResult({data:null,error:r}):i?(await Ge(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:i.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new xi})})}catch(t){if(Ue(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let i=t.keys.find(c=>c.kid===e);if(i)return i;const r=Date.now();if(i=this.jwks.keys.find(c=>c.kid===e),i&&this.jwks_cached_at+S4>r)return i;const{data:a,error:o}=await Ge(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=r,i=a.keys.find(c=>c.kid===e),!i)?null:i}async getClaims(e,t={}){try{let i=e;if(!i){const{data:y,error:w}=await this.getSession();if(w||!y.session)return this._returnResult({data:null,error:w});i=y.session.access_token}const{header:r,payload:a,signature:o,raw:{header:c,payload:h}}=zp(i);t?.allowExpired||W4(a.exp);const f=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!f){const{error:y}=await this.getUser(i);if(y)throw y;return{data:{claims:a,header:r,signature:o},error:null}}const p=X4(r.alg),g=await crypto.subtle.importKey("jwk",f,p,!0,["verify"]);if(!await crypto.subtle.verify(p,g,o,L4(`${c}.${h}`)))throw new Og("Invalid JWT signature");return{data:{claims:a,header:r,signature:o},error:null}}catch(i){if(Ue(i))return this._returnResult({data:null,error:i});throw i}}}Wc.nextInstanceID={};const TN=Wc,CN="2.91.0";let wc="";typeof Deno<"u"?wc="deno":typeof document<"u"?wc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?wc="react-native":wc="node";const RN={"X-Client-Info":`supabase-js-${wc}/${CN}`},ON={headers:RN},kN={schema:"public"},DN={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},NN={};function Xc(n){"@babel/helpers - typeof";return Xc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xc(n)}function MN(n,e){if(Xc(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(Xc(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function LN(n){var e=MN(n,"string");return Xc(e)=="symbol"?e:e+""}function FN(n,e,t){return(e=LN(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ew(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function Xt(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ew(Object(t),!0).forEach(function(i){FN(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ew(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}const IN=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),PN=()=>Headers,BN=(n,e,t)=>{const i=IN(t),r=PN();return async(a,o)=>{var c;const h=(c=await e())!==null&&c!==void 0?c:n;let f=new r(o?.headers);return f.has("apikey")||f.set("apikey",n),f.has("Authorization")||f.set("Authorization",`Bearer ${h}`),i(a,Xt(Xt({},o),{},{headers:f}))}};function UN(n){return n.endsWith("/")?n:n+"/"}function jN(n,e){var t,i;const{db:r,auth:a,realtime:o,global:c}=n,{db:h,auth:f,realtime:p,global:g}=e,m={db:Xt(Xt({},h),r),auth:Xt(Xt({},f),a),realtime:Xt(Xt({},p),o),storage:{},global:Xt(Xt(Xt({},g),c),{},{headers:Xt(Xt({},(t=g?.headers)!==null&&t!==void 0?t:{}),(i=c?.headers)!==null&&i!==void 0?i:{})}),accessToken:async()=>""};return n.accessToken?m.accessToken=n.accessToken:delete m.accessToken,m}function HN(n){const e=n?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(UN(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var zN=class extends TN{constructor(n){super(n)}},$N=class{constructor(n,e,t){var i,r;this.supabaseUrl=n,this.supabaseKey=e;const a=HN(n);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const o=`sb-${a.hostname.split(".")[0]}-auth-token`,c={db:kN,realtime:NN,auth:Xt(Xt({},DN),{},{storageKey:o}),global:ON},h=jN(t??{},c);if(this.storageKey=(i=h.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(r=h.global.headers)!==null&&r!==void 0?r:{},h.accessToken)this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(p,g)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(g)} is not possible`)}});else{var f;this.auth=this._initSupabaseAuthClient((f=h.auth)!==null&&f!==void 0?f:{},this.headers,h.global.fetch)}this.fetch=BN(e,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Xt({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(p=>this.realtime.setAuth(p)).catch(p=>console.warn("Failed to set initial Realtime auth token:",p)),this.rest=new bD(new URL("rest/v1",a).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new _4(this.storageUrl.href,this.headers,this.fetch,t?.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new vD(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(n){return this.rest.from(n)}schema(n){return this.rest.schema(n)}rpc(n,e={},t={head:!1,get:!1,count:void 0}){return this.rest.rpc(n,e,t)}channel(n,e={config:{}}){return this.realtime.channel(n,e)}getChannels(){return this.realtime.getChannels()}removeChannel(n){return this.realtime.removeChannel(n)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var n=this,e,t;if(n.accessToken)return await n.accessToken();const{data:i}=await n.auth.getSession();return(e=(t=i.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:n.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:n,persistSession:e,detectSessionInUrl:t,storage:i,userStorage:r,storageKey:a,flowType:o,lock:c,debug:h,throwOnError:f},p,g){const m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new zN({url:this.authUrl.href,headers:Xt(Xt({},m),p),storageKey:a,autoRefreshToken:n,persistSession:e,detectSessionInUrl:t,storage:i,userStorage:r,flowType:o,lock:c,debug:h,throwOnError:f,fetch:g,hasCustomAuthorizationHeader:Object.keys(this.headers).some(y=>y.toLowerCase()==="authorization")})}_initRealtimeClient(n){return new UD(this.realtimeUrl.href,Xt(Xt({},n),{},{params:Xt(Xt({},{apikey:this.supabaseKey}),n?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,e)=>{this._handleTokenChanged(n,"CLIENT",e?.access_token)})}_handleTokenChanged(n,e,t){(n==="TOKEN_REFRESHED"||n==="SIGNED_IN")&&this.changedAccessToken!==t?(this.changedAccessToken=t,this.realtime.setAuth(t)):n==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const GN=(n,e,t)=>new $N(n,e,t);function VN(){if(typeof window<"u")return!1;const n=globalThis.process;if(!n)return!1;const e=n.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}VN()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const qN="https://labpnvnfogvspsvpsbpm.supabase.co",WN="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxhYnBudm5mb2d2c3BzdnBzYnBtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg5NDYyMjksImV4cCI6MjA4NDUyMjIyOX0.X539ZMI97pGmgZ34IWeQur-mJu0k4MAR5G8RyuJl46U",Rr=GN(qN,WN);async function XN(n){const{data:e,error:t}=await Rr.from("exams").select("*").eq("room_code",n.toUpperCase()).single();return t?(console.error("Error fetching exam:",t),null):e}async function YN(n){const{data:e,error:t}=await Rr.from("exams").insert([n]).select().single();return t?(console.error("Error creating exam:",t),null):e}async function KN(n){const{data:e,error:t}=await Rr.from("students").insert([{name:n}]).select().single();return t?(console.error("Error creating student:",t),null):e}async function JN(n){const{data:e,error:t}=await Rr.from("submissions").insert([n]).select().single();return t?(console.error("Error creating submission:",t),null):e}async function Zh(n,e){const{error:t}=await Rr.from("submissions").update(e).eq("id",n);return t?(console.error("Error updating submission:",t),!1):!0}async function Vp(n){const{data:e,error:t}=await Rr.from("submissions").select("*").eq("exam_id",n).order("started_at",{ascending:!1});return t?(console.error("Error fetching submissions:",t),[]):e}function QN(){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let e="";for(let t=0;t<6;t++)e+=n.charAt(Math.floor(Math.random()*n.length));return e}function ZN(){const n=jf(),[e,t]=Z.useState(!1),[i,r]=Z.useState(null),[a,o]=Z.useState(!1),[c,h]=Z.useState(0),[f,p]=Z.useState(""),[g,m]=Z.useState(""),[y,w]=Z.useState(null),[_,b]=Z.useState([]),[E,T]=Z.useState(!0);Z.useState(()=>{async function M(){const{data:W}=await Rr.from("exams").select("*").order("created_at",{ascending:!1}).limit(10);W&&b(W),T(!1)}M()});const S=Z.useCallback(M=>{M.preventDefault(),t(!0)},[]),k=Z.useCallback(M=>{M.preventDefault(),t(!1)},[]),P=Z.useCallback(M=>{M.preventDefault(),t(!1);const W=M.dataTransfer.files[0];W&&dx(W)?(r(W),m("")):m("Vui lng chn file PDF")},[]),F=M=>{const W=M.target.files?.[0];W&&dx(W)?(r(W),m("")):m("Vui lng chn file PDF")},O=async()=>{if(i){if(!yg()){m("Vui lng nhp API Key trong phn Ci t trc");return}o(!0),h(0),m(""),w(null);try{p("ang c file PDF..."),h(20);const M=await Nk(i);if(!M.success||!M.text)throw new Error(M.error||"Khng th c file PDF");p("AI ang phn tch  thi..."),h(50);const W=await dD(M.text);if(!W.success||!W.questions)throw new Error(W.error||"Khng th phn tch  thi");p("ang to phng thi..."),h(80);const Y=QN(),ce=await YN({title:W.title||i.name.replace(".pdf",""),room_code:Y,questions:W.questions,time_limit:60});if(!ce)throw new Error("Khng th to phng thi. Kim tra kt ni database.");h(100),p("Hon tt!"),w(ce),b(ve=>[ce,...ve]),r(null)}catch(M){m(M.message||"C li xy ra")}finally{o(!1)}}},G=M=>{navigator.clipboard.writeText(M)};return C.jsx("div",{className:"page",children:C.jsxs("div",{className:"container",children:[C.jsxs("div",{className:"page-header",children:[C.jsx("h1",{children:"Dashboard Gio vin"}),C.jsx("p",{children:"Upload  thi PDF v to phng thi trc tuyn"})]}),!yg()&&C.jsxs("div",{className:"alert alert-warning mb-4",children:[C.jsx(Lc,{size:20}),C.jsxs("span",{children:["Bn cn ",C.jsx(dr,{to:"/settings",style:{fontWeight:"bold"},children:"nhp API Key"}),"  s dng tnh nng phn tch PDF"]})]}),C.jsxs("div",{className:"grid grid-2",children:[C.jsxs("div",{className:"card",children:[C.jsx("h3",{className:"mb-4",children:"Upload  Thi"}),y?C.jsxs("div",{className:"text-center",children:[C.jsxs("div",{className:"alert alert-success mb-4",children:[C.jsx(mf,{size:20}),C.jsxs("span",{children:["To phng thi thnh cng! ",y.questions.length," cu hi"]})]}),C.jsx("p",{className:"text-muted mb-2",children:"M phng thi:"}),C.jsx("div",{className:"room-code",onClick:()=>G(y.room_code),title:"Click  copy",children:y.room_code}),C.jsx("p",{className:"text-sm text-muted mt-2",children:"Click  copy"}),C.jsxs("div",{className:"flex gap-4 justify-center mt-6",children:[C.jsxs("button",{className:"btn btn-primary",onClick:()=>n(`/teacher/monitor/${y.id}`),children:[C.jsx(P_,{size:18}),"Theo di"]}),C.jsx("button",{className:"btn btn-outline",onClick:()=>w(null),children:"To  mi"})]})]}):C.jsxs(C.Fragment,{children:[C.jsxs("div",{className:`upload-area ${e?"dragging":""}`,onDragOver:S,onDragLeave:k,onDrop:P,onClick:()=>document.getElementById("file-input")?.click(),children:[C.jsx("input",{type:"file",id:"file-input",accept:".pdf",onChange:F,style:{display:"none"}}),i?C.jsxs(C.Fragment,{children:[C.jsx(aR,{size:64,className:"upload-area-icon",style:{color:"var(--primary)"}}),C.jsx("p",{className:"font-bold",children:i.name}),C.jsxs("p",{className:"text-sm text-muted",children:[(i.size/1024/1024).toFixed(2)," MB"]})]}):C.jsxs(C.Fragment,{children:[C.jsx(j_,{size:64,className:"upload-area-icon"}),C.jsx("p",{className:"font-bold",children:"Ko th file PDF vo y"}),C.jsx("p",{className:"text-muted",children:"hoc click  chn file"})]})]}),a&&C.jsxs("div",{className:"mt-4",children:[C.jsxs("div",{className:"flex justify-between mb-2",children:[C.jsx("span",{className:"text-sm text-muted",children:f}),C.jsxs("span",{className:"text-sm text-muted",children:[c,"%"]})]}),C.jsx("div",{className:"progress-bar",children:C.jsx("div",{className:"progress-bar-fill",style:{width:`${c}%`}})})]}),g&&C.jsxs("div",{className:"alert alert-danger mt-4",children:[C.jsx(Lc,{size:20}),C.jsx("span",{children:g})]}),C.jsx("button",{className:"btn btn-primary btn-lg mt-4",style:{width:"100%"},onClick:O,disabled:!i||a,children:a?C.jsxs(C.Fragment,{children:[C.jsx(fR,{size:20,className:"spinner",style:{animation:"spin 1s linear infinite"}}),"ang x l..."]}):C.jsxs(C.Fragment,{children:[C.jsx(j_,{size:20}),"To  thi"]})})]})]}),C.jsxs("div",{className:"card",children:[C.jsx("h3",{className:"mb-4",children:" thi gn y"}),E?C.jsx("div",{className:"text-center p-4",children:C.jsx("div",{className:"spinner",style:{margin:"0 auto"}})}):_.length===0?C.jsx("p",{className:"text-muted text-center p-4",children:"Cha c  thi no. Upload PDF  bt u!"}):C.jsx("div",{style:{maxHeight:"400px",overflowY:"auto"},children:_.map(M=>C.jsxs("div",{className:"flex justify-between items-center p-4",style:{background:"var(--bg-tertiary)",borderRadius:"var(--radius-md)",marginBottom:"0.5rem"},children:[C.jsxs("div",{children:[C.jsx("p",{className:"font-bold",children:M.title}),C.jsxs("p",{className:"text-sm text-muted",children:[M.questions.length," cu  M: ",M.room_code]})]}),C.jsxs("div",{className:"flex gap-2",children:[C.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>G(M.room_code),children:"Copy"}),C.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>n(`/teacher/monitor/${M.id}`),children:C.jsx(P_,{size:16})})]})]},M.id))})]})]})]})})}var Ef={};Ef.version="0.18.5";var pE=1252,e3=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],gE=function(n){e3.indexOf(n)!=-1&&(pE=n)};function t3(){gE(1252)}var Yc=function(n){gE(n)};function n3(){Yc(1200),t3()}var ef=function(e){return String.fromCharCode(e)},tw=function(e){return String.fromCharCode(e)},Sf,Hs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Kc(n){for(var e="",t=0,i=0,r=0,a=0,o=0,c=0,h=0,f=0;f<n.length;)t=n.charCodeAt(f++),a=t>>2,i=n.charCodeAt(f++),o=(t&3)<<4|i>>4,r=n.charCodeAt(f++),c=(i&15)<<2|r>>6,h=r&63,isNaN(i)?c=h=64:isNaN(r)&&(h=64),e+=Hs.charAt(a)+Hs.charAt(o)+Hs.charAt(c)+Hs.charAt(h);return e}function ss(n){var e="",t=0,i=0,r=0,a=0,o=0,c=0,h=0;n=n.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<n.length;)a=Hs.indexOf(n.charAt(f++)),o=Hs.indexOf(n.charAt(f++)),t=a<<2|o>>4,e+=String.fromCharCode(t),c=Hs.indexOf(n.charAt(f++)),i=(o&15)<<4|c>>2,c!==64&&(e+=String.fromCharCode(i)),h=Hs.indexOf(n.charAt(f++)),r=(c&3)<<6|h,h!==64&&(e+=String.fromCharCode(r));return e}var gt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ls=(function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function Da(n){return gt?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function nw(n){return gt?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var cr=function(e){return gt?ls(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function Qf(n){if(typeof ArrayBuffer>"u")return cr(n);for(var e=new ArrayBuffer(n.length),t=new Uint8Array(e),i=0;i!=n.length;++i)t[i]=n.charCodeAt(i)&255;return e}function pu(n){if(Array.isArray(n))return n.map(function(i){return String.fromCharCode(i)}).join("");for(var e=[],t=0;t<n.length;++t)e[t]=String.fromCharCode(n[t]);return e.join("")}function i3(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}var Ln=gt?function(n){return Buffer.concat(n.map(function(e){return Buffer.isBuffer(e)?e:ls(e)}))}:function(n){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<n.length;++e)t+=n[e].length;var i=new Uint8Array(t),r=0;for(e=0,t=0;e<n.length;t+=r,++e)if(r=n[e].length,n[e]instanceof Uint8Array)i.set(n[e],t);else{if(typeof n[e]=="string")throw"wtf";i.set(new Uint8Array(n[e]),t)}return i}return[].concat.apply([],n.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function r3(n){for(var e=[],t=0,i=n.length+250,r=Da(n.length+255),a=0;a<n.length;++a){var o=n.charCodeAt(a);if(o<128)r[t++]=o;else if(o<2048)r[t++]=192|o>>6&31,r[t++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var c=n.charCodeAt(++a)&1023;r[t++]=240|o>>8&7,r[t++]=128|o>>2&63,r[t++]=128|c>>6&15|(o&3)<<4,r[t++]=128|c&63}else r[t++]=224|o>>12&15,r[t++]=128|o>>6&63,r[t++]=128|o&63;t>i&&(e.push(r.slice(0,t)),t=0,r=Da(65535),i=65530)}return e.push(r.slice(0,t)),Ln(e)}var Cc=/\u0000/g,tf=/[\u0001-\u0006]/g;function il(n){for(var e="",t=n.length-1;t>=0;)e+=n.charAt(t--);return e}function ur(n,e){var t=""+n;return t.length>=e?t:Kt("0",e-t.length)+t}function cm(n,e){var t=""+n;return t.length>=e?t:Kt(" ",e-t.length)+t}function Af(n,e){var t=""+n;return t.length>=e?t:t+Kt(" ",e-t.length)}function s3(n,e){var t=""+Math.round(n);return t.length>=e?t:Kt("0",e-t.length)+t}function a3(n,e){var t=""+n;return t.length>=e?t:Kt("0",e-t.length)+t}var iw=Math.pow(2,32);function Po(n,e){if(n>iw||n<-iw)return s3(n,e);var t=Math.round(n);return a3(t,e)}function Tf(n,e){return e=e||0,n.length>=7+e&&(n.charCodeAt(e)|32)===103&&(n.charCodeAt(e+1)|32)===101&&(n.charCodeAt(e+2)|32)===110&&(n.charCodeAt(e+3)|32)===101&&(n.charCodeAt(e+4)|32)===114&&(n.charCodeAt(e+5)|32)===97&&(n.charCodeAt(e+6)|32)===108}var rw=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],qp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function o3(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"/ "hh""mm""ss" "',n}var Jt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},sw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},l3={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Cf(n,e,t){for(var i=n<0?-1:1,r=n*i,a=0,o=1,c=0,h=1,f=0,p=0,g=Math.floor(r);f<e&&(g=Math.floor(r),c=g*o+a,p=g*f+h,!(r-g<5e-8));)r=1/(r-g),a=o,o=c,h=f,f=p;if(p>e&&(f>e?(p=h,c=a):(p=f,c=o)),!t)return[0,i*c,p];var m=Math.floor(i*c/p);return[m,i*c-m*p,p]}function nf(n,e,t){if(n>2958465||n<0)return null;var i=n|0,r=Math.floor(86400*(n-i)),a=0,o=[],c={D:i,T:r,u:86400*(n-i)-r,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),e&&e.date1904&&(i+=1462),c.u>.9999&&(c.u=0,++r==86400&&(c.T=r=0,++i,++c.D)),i===60)o=t?[1317,10,29]:[1900,2,29],a=3;else if(i===0)o=t?[1317,8,29]:[1900,1,0],a=6;else{i>60&&--i;var h=new Date(1900,0,1);h.setDate(h.getDate()+i-1),o=[h.getFullYear(),h.getMonth()+1,h.getDate()],a=h.getDay(),i<60&&(a=(a+6)%7),t&&(a=g3(h,o))}return c.y=o[0],c.m=o[1],c.d=o[2],c.S=r%60,r=Math.floor(r/60),c.M=r%60,r=Math.floor(r/60),c.H=r,c.q=a,c}var mE=new Date(1899,11,31,0,0,0),c3=mE.getTime(),u3=new Date(1900,2,1,0,0,0);function vE(n,e){var t=n.getTime();return e?t-=1461*24*60*60*1e3:n>=u3&&(t+=1440*60*1e3),(t-(c3+(n.getTimezoneOffset()-mE.getTimezoneOffset())*6e4))/(1440*60*1e3)}function um(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function h3(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function f3(n){var e=n<0?12:11,t=um(n.toFixed(12));return t.length<=e||(t=n.toPrecision(10),t.length<=e)?t:n.toExponential(5)}function d3(n){var e=um(n.toFixed(11));return e.length>(n<0?12:11)||e==="0"||e==="-0"?n.toPrecision(6):e}function p3(n){var e=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),t;return e>=-4&&e<=-1?t=n.toPrecision(10+e):Math.abs(e)<=9?t=f3(n):e===10?t=n.toFixed(10).substr(0,12):t=d3(n),um(h3(t.toUpperCase()))}function kg(n,e){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):p3(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return qs(14,vE(n,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+n)}function g3(n,e){e[0]-=581;var t=n.getDay();return n<60&&(t=(t+6)%7),t}function m3(n,e,t,i){var r="",a=0,o=0,c=t.y,h,f=0;switch(n){case 98:c=t.y+543;case 121:switch(e.length){case 1:case 2:h=c%100,f=2;break;default:h=c%1e4,f=4;break}break;case 109:switch(e.length){case 1:case 2:h=t.m,f=e.length;break;case 3:return qp[t.m-1][1];case 5:return qp[t.m-1][0];default:return qp[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:h=t.d,f=e.length;break;case 3:return rw[t.q][0];default:return rw[t.q][1]}break;case 104:switch(e.length){case 1:case 2:h=1+(t.H+11)%12,f=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:h=t.H,f=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:h=t.M,f=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?ur(t.S,e.length):(i>=2?o=i===3?1e3:100:o=i===1?10:1,a=Math.round(o*(t.S+t.u)),a>=60*o&&(a=0),e==="s"?a===0?"0":""+a/o:(r=ur(a,2+i),e==="ss"?r.substr(0,2):"."+r.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":h=t.D*24+t.H;break;case"[m]":case"[mm]":h=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":h=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}f=e.length===3?1:2;break;case 101:h=c,f=1;break}var p=f>0?ur(h,f):"";return p}function zs(n){var e=3;if(n.length<=e)return n;for(var t=n.length%e,i=n.substr(0,t);t!=n.length;t+=e)i+=(i.length>0?",":"")+n.substr(t,e);return i}var yE=/%/g;function v3(n,e,t){var i=e.replace(yE,""),r=e.length-i.length;return ts(n,i,t*Math.pow(10,2*r))+Kt("%",r)}function y3(n,e,t){for(var i=e.length-1;e.charCodeAt(i-1)===44;)--i;return ts(n,e.substr(0,i),t/Math.pow(10,3*(e.length-i)))}function _E(n,e){var t,i=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+_E(n,-e);var r=n.indexOf(".");r===-1&&(r=n.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%r;if(a<0&&(a+=r),t=(e/Math.pow(10,a)).toPrecision(i+1+(r+a)%r),t.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+a):t+="E+"+(o-a);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,r)+"."+t.substr(2+r),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,h,f,p){return h+f+p.substr(0,(r+a)%r)+"."+p.substr(a)+"E"})}else t=e.toExponential(i);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var xE=/# (\?+)( ?)\/( ?)(\d+)/;function _3(n,e,t){var i=parseInt(n[4],10),r=Math.round(e*i),a=Math.floor(r/i),o=r-a*i,c=i;return t+(a===0?"":""+a)+" "+(o===0?Kt(" ",n[1].length+1+n[4].length):cm(o,n[1].length)+n[2]+"/"+n[3]+ur(c,n[4].length))}function x3(n,e,t){return t+(e===0?"":""+e)+Kt(" ",n[1].length+2+n[4].length)}var wE=/^#*0*\.([0#]+)/,bE=/\).*[0#]/,EE=/\(###\) ###\\?-####/;function Xn(n){for(var e="",t,i=0;i!=n.length;++i)switch(t=n.charCodeAt(i)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function aw(n,e){var t=Math.pow(10,e);return""+Math.round(n*t)/t}function ow(n,e){var t=n-Math.floor(n),i=Math.pow(10,e);return e<(""+Math.round(t*i)).length?0:Math.round(t*i)}function w3(n,e){return e<(""+Math.round((n-Math.floor(n))*Math.pow(10,e))).length?1:0}function b3(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function qi(n,e,t){if(n.charCodeAt(0)===40&&!e.match(bE)){var i=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?qi("n",i,t):"("+qi("n",i,-t)+")"}if(e.charCodeAt(e.length-1)===44)return y3(n,e,t);if(e.indexOf("%")!==-1)return v3(n,e,t);if(e.indexOf("E")!==-1)return _E(e,t);if(e.charCodeAt(0)===36)return"$"+qi(n,e.substr(e.charAt(1)==" "?2:1),t);var r,a,o,c,h=Math.abs(t),f=t<0?"-":"";if(e.match(/^00+$/))return f+Po(h,e.length);if(e.match(/^[#?]+$/))return r=Po(t,0),r==="0"&&(r=""),r.length>e.length?r:Xn(e.substr(0,e.length-r.length))+r;if(a=e.match(xE))return _3(a,h,f);if(e.match(/^#+0+$/))return f+Po(h,e.length-e.indexOf("0"));if(a=e.match(wE))return r=aw(t,a[1].length).replace(/^([^\.]+)$/,"$1."+Xn(a[1])).replace(/\.$/,"."+Xn(a[1])).replace(/\.(\d*)$/,function(w,_){return"."+_+Kt("0",Xn(a[1]).length-_.length)}),e.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return f+aw(h,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return f+zs(Po(h,0));if(a=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+qi(n,e,-t):zs(""+(Math.floor(t)+w3(t,a[1].length)))+"."+ur(ow(t,a[1].length),a[1].length);if(a=e.match(/^#,#*,#0/))return qi(n,e.replace(/^#,#*,/,""),t);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return r=il(qi(n,e.replace(/[\\-]/g,""),t)),o=0,il(il(e.replace(/\\/g,"")).replace(/[0#]/g,function(w){return o<r.length?r.charAt(o++):w==="0"?"0":""}));if(e.match(EE))return r=qi(n,"##########",t),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var p="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),c=Cf(h,Math.pow(10,o)-1,!1),r=""+f,p=ts("n",a[1],c[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),r+=p+a[2]+"/"+a[3],p=Af(c[2],o),p.length<a[4].length&&(p=Xn(a[4].substr(a[4].length-p.length))+p),r+=p,r;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),c=Cf(h,Math.pow(10,o)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?cm(c[1],o)+a[2]+"/"+a[3]+Af(c[2],o):Kt(" ",2*o+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return r=Po(t,0),e.length<=r.length?r:Xn(e.substr(0,e.length-r.length))+r;if(a=e.match(/^([#0?]+)\.([#0]+)$/)){r=""+t.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=r.indexOf(".");var g=e.indexOf(".")-o,m=e.length-r.length-g;return Xn(e.substr(0,g)+r+e.substr(e.length-m))}if(a=e.match(/^00,000\.([#0]*0)$/))return o=ow(t,a[1].length),t<0?"-"+qi(n,e,-t):zs(b3(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?ur(0,3-w.length):"")+w})+"."+ur(o,a[1].length);switch(e){case"###,##0.00":return qi(n,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var y=zs(Po(h,0));return y!=="0"?f+y:"";case"###,###.00":return qi(n,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return qi(n,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function E3(n,e,t){for(var i=e.length-1;e.charCodeAt(i-1)===44;)--i;return ts(n,e.substr(0,i),t/Math.pow(10,3*(e.length-i)))}function S3(n,e,t){var i=e.replace(yE,""),r=e.length-i.length;return ts(n,i,t*Math.pow(10,2*r))+Kt("%",r)}function SE(n,e){var t,i=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+SE(n,-e);var r=n.indexOf(".");r===-1&&(r=n.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%r;if(a<0&&(a+=r),t=(e/Math.pow(10,a)).toPrecision(i+1+(r+a)%r),!t.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+a):t+="E+"+(o-a),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,h,f,p){return h+f+p.substr(0,(r+a)%r)+"."+p.substr(a)+"E"})}else t=e.toExponential(i);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Sr(n,e,t){if(n.charCodeAt(0)===40&&!e.match(bE)){var i=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Sr("n",i,t):"("+Sr("n",i,-t)+")"}if(e.charCodeAt(e.length-1)===44)return E3(n,e,t);if(e.indexOf("%")!==-1)return S3(n,e,t);if(e.indexOf("E")!==-1)return SE(e,t);if(e.charCodeAt(0)===36)return"$"+Sr(n,e.substr(e.charAt(1)==" "?2:1),t);var r,a,o,c,h=Math.abs(t),f=t<0?"-":"";if(e.match(/^00+$/))return f+ur(h,e.length);if(e.match(/^[#?]+$/))return r=""+t,t===0&&(r=""),r.length>e.length?r:Xn(e.substr(0,e.length-r.length))+r;if(a=e.match(xE))return x3(a,h,f);if(e.match(/^#+0+$/))return f+ur(h,e.length-e.indexOf("0"));if(a=e.match(wE))return r=(""+t).replace(/^([^\.]+)$/,"$1."+Xn(a[1])).replace(/\.$/,"."+Xn(a[1])),r=r.replace(/\.(\d*)$/,function(w,_){return"."+_+Kt("0",Xn(a[1]).length-_.length)}),e.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return f+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return f+zs(""+h);if(a=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Sr(n,e,-t):zs(""+t)+"."+Kt("0",a[1].length);if(a=e.match(/^#,#*,#0/))return Sr(n,e.replace(/^#,#*,/,""),t);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return r=il(Sr(n,e.replace(/[\\-]/g,""),t)),o=0,il(il(e.replace(/\\/g,"")).replace(/[0#]/g,function(w){return o<r.length?r.charAt(o++):w==="0"?"0":""}));if(e.match(EE))return r=Sr(n,"##########",t),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var p="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),c=Cf(h,Math.pow(10,o)-1,!1),r=""+f,p=ts("n",a[1],c[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),r+=p+a[2]+"/"+a[3],p=Af(c[2],o),p.length<a[4].length&&(p=Xn(a[4].substr(a[4].length-p.length))+p),r+=p,r;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),c=Cf(h,Math.pow(10,o)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?cm(c[1],o)+a[2]+"/"+a[3]+Af(c[2],o):Kt(" ",2*o+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return r=""+t,e.length<=r.length?r:Xn(e.substr(0,e.length-r.length))+r;if(a=e.match(/^([#0]+)\.([#0]+)$/)){r=""+t.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=r.indexOf(".");var g=e.indexOf(".")-o,m=e.length-r.length-g;return Xn(e.substr(0,g)+r+e.substr(e.length-m))}if(a=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Sr(n,e,-t):zs(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?ur(0,3-w.length):"")+w})+"."+ur(0,a[1].length);switch(e){case"###,###":case"##,###":case"#,###":var y=zs(""+h);return y!=="0"?f+y:"";default:if(e.match(/\.[0#?]*$/))return Sr(n,e.slice(0,e.lastIndexOf(".")),t)+Xn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function ts(n,e,t){return(t|0)===t?Sr(n,e,t):qi(n,e,t)}function A3(n){for(var e=[],t=!1,i=0,r=0;i<n.length;++i)switch(n.charCodeAt(i)){case 34:t=!t;break;case 95:case 42:case 92:++i;break;case 59:e[e.length]=n.substr(r,i-r),r=i+1}if(e[e.length]=n.substr(r),t===!0)throw new Error("Format |"+n+"| unterminated string ");return e}var AE=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function TE(n){for(var e=0,t="",i="";e<n.length;)switch(t=n.charAt(e)){case"G":Tf(n,e)&&(e+=6),e++;break;case'"':for(;n.charCodeAt(++e)!==34&&e<n.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(n.charAt(e+1)==="1"||n.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(n.substr(e,3).toUpperCase()==="A/P"||n.substr(e,5).toUpperCase()==="AM/PM"||n.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(i=t;n.charAt(e++)!=="]"&&e<n.length;)i+=n.charAt(e);if(i.match(AE))return!0;break;case".":case"0":case"#":for(;e<n.length&&("0#?.,E+-%".indexOf(t=n.charAt(++e))>-1||t=="\\"&&n.charAt(e+1)=="-"&&"0#".indexOf(n.charAt(e+2))>-1););break;case"?":for(;n.charAt(++e)===t;);break;case"*":++e,(n.charAt(e)==" "||n.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<n.length&&"0123456789".indexOf(n.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function T3(n,e,t,i){for(var r=[],a="",o=0,c="",h="t",f,p,g,m="H";o<n.length;)switch(c=n.charAt(o)){case"G":if(!Tf(n,o))throw new Error("unrecognized character "+c+" in "+n);r[r.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(g=n.charCodeAt(++o))!==34&&o<n.length;)a+=String.fromCharCode(g);r[r.length]={t:"t",v:a},++o;break;case"\\":var y=n.charAt(++o),w=y==="("||y===")"?y:"t";r[r.length]={t:w,v:y},++o;break;case"_":r[r.length]={t:"t",v:" "},o+=2;break;case"@":r[r.length]={t:"T",v:e},++o;break;case"B":case"b":if(n.charAt(o+1)==="1"||n.charAt(o+1)==="2"){if(f==null&&(f=nf(e,t,n.charAt(o+1)==="2"),f==null))return"";r[r.length]={t:"X",v:n.substr(o,2)},h=c,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||f==null&&(f=nf(e,t),f==null))return"";for(a=c;++o<n.length&&n.charAt(o).toLowerCase()===c;)a+=c;c==="m"&&h.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=m),r[r.length]={t:c,v:a},h=c;break;case"A":case"a":case"":var _={t:c,v:c};if(f==null&&(f=nf(e,t)),n.substr(o,3).toUpperCase()==="A/P"?(f!=null&&(_.v=f.H>=12?"P":"A"),_.t="T",m="h",o+=3):n.substr(o,5).toUpperCase()==="AM/PM"?(f!=null&&(_.v=f.H>=12?"PM":"AM"),_.t="T",o+=5,m="h"):n.substr(o,5).toUpperCase()==="/"?(f!=null&&(_.v=f.H>=12?"":""),_.t="T",o+=5,m="h"):(_.t="t",++o),f==null&&_.t==="T")return"";r[r.length]=_,h=c;break;case"[":for(a=c;n.charAt(o++)!=="]"&&o<n.length;)a+=n.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(AE)){if(f==null&&(f=nf(e,t),f==null))return"";r[r.length]={t:"Z",v:a.toLowerCase()},h=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",TE(n)||(r[r.length]={t:"t",v:a}));break;case".":if(f!=null){for(a=c;++o<n.length&&(c=n.charAt(o))==="0";)a+=c;r[r.length]={t:"s",v:a};break}case"0":case"#":for(a=c;++o<n.length&&"0#?.,E+-%".indexOf(c=n.charAt(o))>-1;)a+=c;r[r.length]={t:"n",v:a};break;case"?":for(a=c;n.charAt(++o)===c;)a+=c;r[r.length]={t:c,v:a},h=c;break;case"*":++o,(n.charAt(o)==" "||n.charAt(o)=="*")&&++o;break;case"(":case")":r[r.length]={t:i===1?"t":c,v:c},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=c;o<n.length&&"0123456789".indexOf(n.charAt(++o))>-1;)a+=n.charAt(o);r[r.length]={t:"D",v:a};break;case" ":r[r.length]={t:c,v:c},++o;break;case"$":r[r.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+n);r[r.length]={t:"t",v:c},++o;break}var b=0,E=0,T;for(o=r.length-1,h="t";o>=0;--o)switch(r[o].t){case"h":case"H":r[o].t=m,h="h",b<1&&(b=1);break;case"s":(T=r[o].v.match(/\.0+$/))&&(E=Math.max(E,T[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":h=r[o].t;break;case"m":h==="s"&&(r[o].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&r[o].v.match(/[Hh]/)&&(b=1),b<2&&r[o].v.match(/[Mm]/)&&(b=2),b<3&&r[o].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var S="",k;for(o=0;o<r.length;++o)switch(r[o].t){case"t":case"T":case" ":case"D":break;case"X":r[o].v="",r[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":r[o].v=m3(r[o].t.charCodeAt(0),r[o].v,f,E),r[o].t="t";break;case"n":case"?":for(k=o+1;r[k]!=null&&((c=r[k].t)==="?"||c==="D"||(c===" "||c==="t")&&r[k+1]!=null&&(r[k+1].t==="?"||r[k+1].t==="t"&&r[k+1].v==="/")||r[o].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(r[k].v==="/"||r[k].v===" "&&r[k+1]!=null&&r[k+1].t=="?"));)r[o].v+=r[k].v,r[k]={v:"",t:";"},++k;S+=r[o].v,o=k-1;break;case"G":r[o].t="t",r[o].v=kg(e,t);break}var P="",F,O;if(S.length>0){S.charCodeAt(0)==40?(F=e<0&&S.charCodeAt(0)===45?-e:e,O=ts("n",S,F)):(F=e<0&&i>1?-e:e,O=ts("n",S,F),F<0&&r[0]&&r[0].t=="t"&&(O=O.substr(1),r[0].v="-"+r[0].v)),k=O.length-1;var G=r.length;for(o=0;o<r.length;++o)if(r[o]!=null&&r[o].t!="t"&&r[o].v.indexOf(".")>-1){G=o;break}var M=r.length;if(G===r.length&&O.indexOf("E")===-1){for(o=r.length-1;o>=0;--o)r[o]==null||"n?".indexOf(r[o].t)===-1||(k>=r[o].v.length-1?(k-=r[o].v.length,r[o].v=O.substr(k+1,r[o].v.length)):k<0?r[o].v="":(r[o].v=O.substr(0,k+1),k=-1),r[o].t="t",M=o);k>=0&&M<r.length&&(r[M].v=O.substr(0,k+1)+r[M].v)}else if(G!==r.length&&O.indexOf("E")===-1){for(k=O.indexOf(".")-1,o=G;o>=0;--o)if(!(r[o]==null||"n?".indexOf(r[o].t)===-1)){for(p=r[o].v.indexOf(".")>-1&&o===G?r[o].v.indexOf(".")-1:r[o].v.length-1,P=r[o].v.substr(p+1);p>=0;--p)k>=0&&(r[o].v.charAt(p)==="0"||r[o].v.charAt(p)==="#")&&(P=O.charAt(k--)+P);r[o].v=P,r[o].t="t",M=o}for(k>=0&&M<r.length&&(r[M].v=O.substr(0,k+1)+r[M].v),k=O.indexOf(".")+1,o=G;o<r.length;++o)if(!(r[o]==null||"n?(".indexOf(r[o].t)===-1&&o!==G)){for(p=r[o].v.indexOf(".")>-1&&o===G?r[o].v.indexOf(".")+1:0,P=r[o].v.substr(0,p);p<r[o].v.length;++p)k<O.length&&(P+=O.charAt(k++));r[o].v=P,r[o].t="t",M=o}}}for(o=0;o<r.length;++o)r[o]!=null&&"n?".indexOf(r[o].t)>-1&&(F=i>1&&e<0&&o>0&&r[o-1].v==="-"?-e:e,r[o].v=ts(r[o].t,r[o].v,F),r[o].t="t");var W="";for(o=0;o!==r.length;++o)r[o]!=null&&(W+=r[o].v);return W}var lw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function cw(n,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(n==t)return!0;break;case">":if(n>t)return!0;break;case"<":if(n<t)return!0;break;case"<>":if(n!=t)return!0;break;case">=":if(n>=t)return!0;break;case"<=":if(n<=t)return!0;break}return!1}function C3(n,e){var t=A3(n),i=t.length,r=t[i-1].indexOf("@");if(i<4&&r>-1&&--i,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||r>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=r>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=r>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=r>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var a=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[i,a];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var o=t[0].match(lw),c=t[1].match(lw);return cw(e,o)?[i,t[0]]:cw(e,c)?[i,t[1]]:[i,t[o!=null&&c!=null?2:1]]}return[i,a]}function qs(n,e,t){t==null&&(t={});var i="";switch(typeof n){case"string":n=="m/d/yy"&&t.dateNF?i=t.dateNF:i=n;break;case"number":n==14&&t.dateNF?i=t.dateNF:i=(t.table!=null?t.table:Jt)[n],i==null&&(i=t.table&&t.table[sw[n]]||Jt[sw[n]]),i==null&&(i=l3[n]||"General");break}if(Tf(i,0))return kg(e,t);e instanceof Date&&(e=vE(e,t.date1904));var r=C3(i,e);if(Tf(r[1]))return kg(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return T3(r[1],e,t,r[0])}function CE(n,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(Jt[t]==null){e<0&&(e=t);continue}if(Jt[t]==n){e=t;break}}e<0&&(e=391)}return Jt[e]=n,e}function Zf(n){for(var e=0;e!=392;++e)n[e]!==void 0&&CE(n[e],e)}function ed(){Jt=o3()}var RE=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function R3(n){var e=typeof n=="number"?Jt[n]:n;return e=e.replace(RE,"(\\d+)"),new RegExp("^"+e+"$")}function O3(n,e,t){var i=-1,r=-1,a=-1,o=-1,c=-1,h=-1;(e.match(RE)||[]).forEach(function(g,m){var y=parseInt(t[m+1],10);switch(g.toLowerCase().charAt(0)){case"y":i=y;break;case"d":a=y;break;case"h":o=y;break;case"s":h=y;break;case"m":o>=0?c=y:r=y;break}}),h>=0&&c==-1&&r>=0&&(c=r,r=-1);var f=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(r>=1?r:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var p=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return o==-1&&c==-1&&h==-1?f:i==-1&&r==-1&&a==-1?p:f+"T"+p}var k3=(function(){var n={};n.version="1.2.0";function e(){for(var O=0,G=new Array(256),M=0;M!=256;++M)O=M,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,G[M]=O;return typeof Int32Array<"u"?new Int32Array(G):G}var t=e();function i(O){var G=0,M=0,W=0,Y=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(W=0;W!=256;++W)Y[W]=O[W];for(W=0;W!=256;++W)for(M=O[W],G=256+W;G<4096;G+=256)M=Y[G]=M>>>8^O[M&255];var ce=[];for(W=1;W!=16;++W)ce[W-1]=typeof Int32Array<"u"?Y.subarray(W*256,W*256+256):Y.slice(W*256,W*256+256);return ce}var r=i(t),a=r[0],o=r[1],c=r[2],h=r[3],f=r[4],p=r[5],g=r[6],m=r[7],y=r[8],w=r[9],_=r[10],b=r[11],E=r[12],T=r[13],S=r[14];function k(O,G){for(var M=G^-1,W=0,Y=O.length;W<Y;)M=M>>>8^t[(M^O.charCodeAt(W++))&255];return~M}function P(O,G){for(var M=G^-1,W=O.length-15,Y=0;Y<W;)M=S[O[Y++]^M&255]^T[O[Y++]^M>>8&255]^E[O[Y++]^M>>16&255]^b[O[Y++]^M>>>24]^_[O[Y++]]^w[O[Y++]]^y[O[Y++]]^m[O[Y++]]^g[O[Y++]]^p[O[Y++]]^f[O[Y++]]^h[O[Y++]]^c[O[Y++]]^o[O[Y++]]^a[O[Y++]]^t[O[Y++]];for(W+=15;Y<W;)M=M>>>8^t[(M^O[Y++])&255];return~M}function F(O,G){for(var M=G^-1,W=0,Y=O.length,ce=0,ve=0;W<Y;)ce=O.charCodeAt(W++),ce<128?M=M>>>8^t[(M^ce)&255]:ce<2048?(M=M>>>8^t[(M^(192|ce>>6&31))&255],M=M>>>8^t[(M^(128|ce&63))&255]):ce>=55296&&ce<57344?(ce=(ce&1023)+64,ve=O.charCodeAt(W++)&1023,M=M>>>8^t[(M^(240|ce>>8&7))&255],M=M>>>8^t[(M^(128|ce>>2&63))&255],M=M>>>8^t[(M^(128|ve>>6&15|(ce&3)<<4))&255],M=M>>>8^t[(M^(128|ve&63))&255]):(M=M>>>8^t[(M^(224|ce>>12&15))&255],M=M>>>8^t[(M^(128|ce>>6&63))&255],M=M>>>8^t[(M^(128|ce&63))&255]);return~M}return n.table=t,n.bstr=k,n.buf=P,n.str=F,n})(),Tt=(function(){var e={};e.version="1.2.1";function t(R,U){for(var L=R.split("/"),I=U.split("/"),B=0,j=0,ne=Math.min(L.length,I.length);B<ne;++B){if(j=L[B].length-I[B].length)return j;if(L[B]!=I[B])return L[B]<I[B]?-1:1}return L.length-I.length}function i(R){if(R.charAt(R.length-1)=="/")return R.slice(0,-1).indexOf("/")===-1?R:i(R.slice(0,-1));var U=R.lastIndexOf("/");return U===-1?R:R.slice(0,U+1)}function r(R){if(R.charAt(R.length-1)=="/")return r(R.slice(0,-1));var U=R.lastIndexOf("/");return U===-1?R:R.slice(U+1)}function a(R,U){typeof U=="string"&&(U=new Date(U));var L=U.getHours();L=L<<6|U.getMinutes(),L=L<<5|U.getSeconds()>>>1,R.write_shift(2,L);var I=U.getFullYear()-1980;I=I<<4|U.getMonth()+1,I=I<<5|U.getDate(),R.write_shift(2,I)}function o(R){var U=R.read_shift(2)&65535,L=R.read_shift(2)&65535,I=new Date,B=L&31;L>>>=5;var j=L&15;L>>>=4,I.setMilliseconds(0),I.setFullYear(L+1980),I.setMonth(j-1),I.setDate(B);var ne=U&31;U>>>=5;var de=U&63;return U>>>=6,I.setHours(U),I.setMinutes(de),I.setSeconds(ne<<1),I}function c(R){Ai(R,0);for(var U={},L=0;R.l<=R.length-4;){var I=R.read_shift(2),B=R.read_shift(2),j=R.l+B,ne={};I===21589&&(L=R.read_shift(1),L&1&&(ne.mtime=R.read_shift(4)),B>5&&(L&2&&(ne.atime=R.read_shift(4)),L&4&&(ne.ctime=R.read_shift(4))),ne.mtime&&(ne.mt=new Date(ne.mtime*1e3))),R.l=j,U[I]=ne}return U}var h;function f(){return h||(h={})}function p(R,U){if(R[0]==80&&R[1]==75)return Ks(R,U);if((R[0]|32)==109&&(R[1]|32)==105)return Qs(R,U);if(R.length<512)throw new Error("CFB file size "+R.length+" < 512");var L=3,I=512,B=0,j=0,ne=0,de=0,ie=0,re=[],le=R.slice(0,512);Ai(le,0);var _e=g(le);switch(L=_e[0],L){case 3:I=512;break;case 4:I=4096;break;case 0:if(_e[1]==0)return Ks(R,U);default:throw new Error("Major Version: Expected 3 or 4 saw "+L)}I!==512&&(le=R.slice(0,I),Ai(le,28));var Ee=R.slice(0,I);m(le,L);var De=le.read_shift(4,"i");if(L===3&&De!==0)throw new Error("# Directory Sectors: Expected 0 saw "+De);le.l+=4,ne=le.read_shift(4,"i"),le.l+=4,le.chk("00100000","Mini Stream Cutoff Size: "),de=le.read_shift(4,"i"),B=le.read_shift(4,"i"),ie=le.read_shift(4,"i"),j=le.read_shift(4,"i");for(var xe=-1,Oe=0;Oe<109&&(xe=le.read_shift(4,"i"),!(xe<0));++Oe)re[Oe]=xe;var Ie=y(R,I);b(ie,j,Ie,I,re);var Dt=T(Ie,ne,re,I);Dt[ne].name="!Directory",B>0&&de!==ve&&(Dt[de].name="!MiniFAT"),Dt[re[0]].name="!FAT",Dt.fat_addrs=re,Dt.ssz=I;var Nt={},Bt=[],Mi=[],Zs=[];S(ne,Dt,Ie,Bt,B,Nt,Mi,de),w(Mi,Zs,Bt),Bt.shift();var us={FileIndex:Mi,FullPaths:Zs};return U&&U.raw&&(us.raw={header:Ee,sectors:Ie}),us}function g(R){if(R[R.l]==80&&R[R.l+1]==75)return[0,0];R.chk(Ce,"Header Signature: "),R.l+=16;var U=R.read_shift(2,"u");return[R.read_shift(2,"u"),U]}function m(R,U){var L=9;switch(R.l+=2,L=R.read_shift(2)){case 9:if(U!=3)throw new Error("Sector Shift: Expected 9 saw "+L);break;case 12:if(U!=4)throw new Error("Sector Shift: Expected 12 saw "+L);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+L)}R.chk("0600","Mini Sector Shift: "),R.chk("000000000000","Reserved: ")}function y(R,U){for(var L=Math.ceil(R.length/U)-1,I=[],B=1;B<L;++B)I[B-1]=R.slice(B*U,(B+1)*U);return I[L-1]=R.slice(L*U),I}function w(R,U,L){for(var I=0,B=0,j=0,ne=0,de=0,ie=L.length,re=[],le=[];I<ie;++I)re[I]=le[I]=I,U[I]=L[I];for(;de<le.length;++de)I=le[de],B=R[I].L,j=R[I].R,ne=R[I].C,re[I]===I&&(B!==-1&&re[B]!==B&&(re[I]=re[B]),j!==-1&&re[j]!==j&&(re[I]=re[j])),ne!==-1&&(re[ne]=I),B!==-1&&I!=re[I]&&(re[B]=re[I],le.lastIndexOf(B)<de&&le.push(B)),j!==-1&&I!=re[I]&&(re[j]=re[I],le.lastIndexOf(j)<de&&le.push(j));for(I=1;I<ie;++I)re[I]===I&&(j!==-1&&re[j]!==j?re[I]=re[j]:B!==-1&&re[B]!==B&&(re[I]=re[B]));for(I=1;I<ie;++I)if(R[I].type!==0){if(de=I,de!=re[de])do de=re[de],U[I]=U[de]+"/"+U[I];while(de!==0&&re[de]!==-1&&de!=re[de]);re[I]=-1}for(U[0]+="/",I=1;I<ie;++I)R[I].type!==2&&(U[I]+="/")}function _(R,U,L){for(var I=R.start,B=R.size,j=[],ne=I;L&&B>0&&ne>=0;)j.push(U.slice(ne*ce,ne*ce+ce)),B-=ce,ne=wa(L,ne*4);return j.length===0?he(0):Ln(j).slice(0,R.size)}function b(R,U,L,I,B){var j=ve;if(R===ve){if(U!==0)throw new Error("DIFAT chain shorter than expected")}else if(R!==-1){var ne=L[R],de=(I>>>2)-1;if(!ne)return;for(var ie=0;ie<de&&(j=wa(ne,ie*4))!==ve;++ie)B.push(j);b(wa(ne,I-4),U-1,L,I,B)}}function E(R,U,L,I,B){var j=[],ne=[];B||(B=[]);var de=I-1,ie=0,re=0;for(ie=U;ie>=0;){B[ie]=!0,j[j.length]=ie,ne.push(R[ie]);var le=L[Math.floor(ie*4/I)];if(re=ie*4&de,I<4+re)throw new Error("FAT boundary crossed: "+ie+" 4 "+I);if(!R[le])break;ie=wa(R[le],re)}return{nodes:j,data:vw([ne])}}function T(R,U,L,I){var B=R.length,j=[],ne=[],de=[],ie=[],re=I-1,le=0,_e=0,Ee=0,De=0;for(le=0;le<B;++le)if(de=[],Ee=le+U,Ee>=B&&(Ee-=B),!ne[Ee]){ie=[];var xe=[];for(_e=Ee;_e>=0;){xe[_e]=!0,ne[_e]=!0,de[de.length]=_e,ie.push(R[_e]);var Oe=L[Math.floor(_e*4/I)];if(De=_e*4&re,I<4+De)throw new Error("FAT boundary crossed: "+_e+" 4 "+I);if(!R[Oe]||(_e=wa(R[Oe],De),xe[_e]))break}j[Ee]={nodes:de,data:vw([ie])}}return j}function S(R,U,L,I,B,j,ne,de){for(var ie=0,re=I.length?2:0,le=U[R].data,_e=0,Ee=0,De;_e<le.length;_e+=128){var xe=le.slice(_e,_e+128);Ai(xe,64),Ee=xe.read_shift(2),De=gm(xe,0,Ee-re),I.push(De);var Oe={name:De,type:xe.read_shift(1),color:xe.read_shift(1),L:xe.read_shift(4,"i"),R:xe.read_shift(4,"i"),C:xe.read_shift(4,"i"),clsid:xe.read_shift(16),state:xe.read_shift(4,"i"),start:0,size:0},Ie=xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2);Ie!==0&&(Oe.ct=k(xe,xe.l-8));var Dt=xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2);Dt!==0&&(Oe.mt=k(xe,xe.l-8)),Oe.start=xe.read_shift(4,"i"),Oe.size=xe.read_shift(4,"i"),Oe.size<0&&Oe.start<0&&(Oe.size=Oe.type=0,Oe.start=ve,Oe.name=""),Oe.type===5?(ie=Oe.start,B>0&&ie!==ve&&(U[ie].name="!StreamData")):Oe.size>=4096?(Oe.storage="fat",U[Oe.start]===void 0&&(U[Oe.start]=E(L,Oe.start,U.fat_addrs,U.ssz)),U[Oe.start].name=Oe.name,Oe.content=U[Oe.start].data.slice(0,Oe.size)):(Oe.storage="minifat",Oe.size<0?Oe.size=0:ie!==ve&&Oe.start!==ve&&U[ie]&&(Oe.content=_(Oe,U[ie].data,(U[de]||{}).data))),Oe.content&&Ai(Oe.content,0),j[De]=Oe,ne.push(Oe)}}function k(R,U){return new Date((Ci(R,U+4)/1e7*Math.pow(2,32)+Ci(R,U)/1e7-11644473600)*1e3)}function P(R,U){return f(),p(h.readFileSync(R),U)}function F(R,U){var L=U&&U.type;switch(L||gt&&Buffer.isBuffer(R)&&(L="buffer"),L||"base64"){case"file":return P(R,U);case"base64":return p(cr(ss(R)),U);case"binary":return p(cr(R),U)}return p(R,U)}function O(R,U){var L=U||{},I=L.root||"Root Entry";if(R.FullPaths||(R.FullPaths=[]),R.FileIndex||(R.FileIndex=[]),R.FullPaths.length!==R.FileIndex.length)throw new Error("inconsistent CFB structure");R.FullPaths.length===0&&(R.FullPaths[0]=I+"/",R.FileIndex[0]={name:I,type:5}),L.CLSID&&(R.FileIndex[0].clsid=L.CLSID),G(R)}function G(R){var U="Sh33tJ5";if(!Tt.find(R,"/"+U)){var L=he(4);L[0]=55,L[1]=L[3]=50,L[2]=54,R.FileIndex.push({name:U,type:2,content:L,size:4,L:69,R:69,C:69}),R.FullPaths.push(R.FullPaths[0]+U),M(R)}}function M(R,U){O(R);for(var L=!1,I=!1,B=R.FullPaths.length-1;B>=0;--B){var j=R.FileIndex[B];switch(j.type){case 0:I?L=!0:(R.FileIndex.pop(),R.FullPaths.pop());break;case 1:case 2:case 5:I=!0,isNaN(j.R*j.L*j.C)&&(L=!0),j.R>-1&&j.L>-1&&j.R==j.L&&(L=!0);break;default:L=!0;break}}if(!(!L&&!U)){var ne=new Date(1987,1,19),de=0,ie=Object.create?Object.create(null):{},re=[];for(B=0;B<R.FullPaths.length;++B)ie[R.FullPaths[B]]=!0,R.FileIndex[B].type!==0&&re.push([R.FullPaths[B],R.FileIndex[B]]);for(B=0;B<re.length;++B){var le=i(re[B][0]);I=ie[le],I||(re.push([le,{name:r(le).replace("/",""),type:1,clsid:J,ct:ne,mt:ne,content:null}]),ie[le]=!0)}for(re.sort(function(De,xe){return t(De[0],xe[0])}),R.FullPaths=[],R.FileIndex=[],B=0;B<re.length;++B)R.FullPaths[B]=re[B][0],R.FileIndex[B]=re[B][1];for(B=0;B<re.length;++B){var _e=R.FileIndex[B],Ee=R.FullPaths[B];if(_e.name=r(Ee).replace("/",""),_e.L=_e.R=_e.C=-(_e.color=1),_e.size=_e.content?_e.content.length:0,_e.start=0,_e.clsid=_e.clsid||J,B===0)_e.C=re.length>1?1:-1,_e.size=0,_e.type=5;else if(Ee.slice(-1)=="/"){for(de=B+1;de<re.length&&i(R.FullPaths[de])!=Ee;++de);for(_e.C=de>=re.length?-1:de,de=B+1;de<re.length&&i(R.FullPaths[de])!=i(Ee);++de);_e.R=de>=re.length?-1:de,_e.type=1}else i(R.FullPaths[B+1]||"")==i(Ee)&&(_e.R=B+1),_e.type=2}}}function W(R,U){var L=U||{};if(L.fileType=="mad")return cd(R,L);if(M(R),L.fileType==="zip")return qa(R,L);var I=(function(De){for(var xe=0,Oe=0,Ie=0;Ie<De.FileIndex.length;++Ie){var Dt=De.FileIndex[Ie];if(Dt.content){var Nt=Dt.content.length;Nt>0&&(Nt<4096?xe+=Nt+63>>6:Oe+=Nt+511>>9)}}for(var Bt=De.FullPaths.length+3>>2,Mi=xe+7>>3,Zs=xe+127>>7,us=Mi+Oe+Bt+Zs,gr=us+127>>7,wl=gr<=109?0:Math.ceil((gr-109)/127);us+gr+wl+127>>7>gr;)wl=++gr<=109?0:Math.ceil((gr-109)/127);var Qn=[1,wl,gr,Zs,Bt,Oe,xe,0];return De.FileIndex[0].size=xe<<6,Qn[7]=(De.FileIndex[0].start=Qn[0]+Qn[1]+Qn[2]+Qn[3]+Qn[4]+Qn[5])+(Qn[6]+7>>3),Qn})(R),B=he(I[7]<<9),j=0,ne=0;{for(j=0;j<8;++j)B.write_shift(1,ke[j]);for(j=0;j<8;++j)B.write_shift(2,0);for(B.write_shift(2,62),B.write_shift(2,3),B.write_shift(2,65534),B.write_shift(2,9),B.write_shift(2,6),j=0;j<3;++j)B.write_shift(2,0);for(B.write_shift(4,0),B.write_shift(4,I[2]),B.write_shift(4,I[0]+I[1]+I[2]+I[3]-1),B.write_shift(4,0),B.write_shift(4,4096),B.write_shift(4,I[3]?I[0]+I[1]+I[2]-1:ve),B.write_shift(4,I[3]),B.write_shift(-4,I[1]?I[0]-1:ve),B.write_shift(4,I[1]),j=0;j<109;++j)B.write_shift(-4,j<I[2]?I[1]+j:-1)}if(I[1])for(ne=0;ne<I[1];++ne){for(;j<236+ne*127;++j)B.write_shift(-4,j<I[2]?I[1]+j:-1);B.write_shift(-4,ne===I[1]-1?ve:ne+1)}var de=function(De){for(ne+=De;j<ne-1;++j)B.write_shift(-4,j+1);De&&(++j,B.write_shift(-4,ve))};for(ne=j=0,ne+=I[1];j<ne;++j)B.write_shift(-4,ae.DIFSECT);for(ne+=I[2];j<ne;++j)B.write_shift(-4,ae.FATSECT);de(I[3]),de(I[4]);for(var ie=0,re=0,le=R.FileIndex[0];ie<R.FileIndex.length;++ie)le=R.FileIndex[ie],le.content&&(re=le.content.length,!(re<4096)&&(le.start=ne,de(re+511>>9)));for(de(I[6]+7>>3);B.l&511;)B.write_shift(-4,ae.ENDOFCHAIN);for(ne=j=0,ie=0;ie<R.FileIndex.length;++ie)le=R.FileIndex[ie],le.content&&(re=le.content.length,!(!re||re>=4096)&&(le.start=ne,de(re+63>>6)));for(;B.l&511;)B.write_shift(-4,ae.ENDOFCHAIN);for(j=0;j<I[4]<<2;++j){var _e=R.FullPaths[j];if(!_e||_e.length===0){for(ie=0;ie<17;++ie)B.write_shift(4,0);for(ie=0;ie<3;++ie)B.write_shift(4,-1);for(ie=0;ie<12;++ie)B.write_shift(4,0);continue}le=R.FileIndex[j],j===0&&(le.start=le.size?le.start-1:ve);var Ee=j===0&&L.root||le.name;if(re=2*(Ee.length+1),B.write_shift(64,Ee,"utf16le"),B.write_shift(2,re),B.write_shift(1,le.type),B.write_shift(1,le.color),B.write_shift(-4,le.L),B.write_shift(-4,le.R),B.write_shift(-4,le.C),le.clsid)B.write_shift(16,le.clsid,"hex");else for(ie=0;ie<4;++ie)B.write_shift(4,0);B.write_shift(4,le.state||0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,le.start),B.write_shift(4,le.size),B.write_shift(4,0)}for(j=1;j<R.FileIndex.length;++j)if(le=R.FileIndex[j],le.size>=4096)if(B.l=le.start+1<<9,gt&&Buffer.isBuffer(le.content))le.content.copy(B,B.l,0,le.size),B.l+=le.size+511&-512;else{for(ie=0;ie<le.size;++ie)B.write_shift(1,le.content[ie]);for(;ie&511;++ie)B.write_shift(1,0)}for(j=1;j<R.FileIndex.length;++j)if(le=R.FileIndex[j],le.size>0&&le.size<4096)if(gt&&Buffer.isBuffer(le.content))le.content.copy(B,B.l,0,le.size),B.l+=le.size+63&-64;else{for(ie=0;ie<le.size;++ie)B.write_shift(1,le.content[ie]);for(;ie&63;++ie)B.write_shift(1,0)}if(gt)B.l=B.length;else for(;B.l<B.length;)B.write_shift(1,0);return B}function Y(R,U){var L=R.FullPaths.map(function(ie){return ie.toUpperCase()}),I=L.map(function(ie){var re=ie.split("/");return re[re.length-(ie.slice(-1)=="/"?2:1)]}),B=!1;U.charCodeAt(0)===47?(B=!0,U=L[0].slice(0,-1)+U):B=U.indexOf("/")!==-1;var j=U.toUpperCase(),ne=B===!0?L.indexOf(j):I.indexOf(j);if(ne!==-1)return R.FileIndex[ne];var de=!j.match(tf);for(j=j.replace(Cc,""),de&&(j=j.replace(tf,"!")),ne=0;ne<L.length;++ne)if((de?L[ne].replace(tf,"!"):L[ne]).replace(Cc,"")==j||(de?I[ne].replace(tf,"!"):I[ne]).replace(Cc,"")==j)return R.FileIndex[ne];return null}var ce=64,ve=-2,Ce="d0cf11e0a1b11ae1",ke=[208,207,17,224,161,177,26,225],J="00000000000000000000000000000000",ae={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ve,FREESECT:-1,HEADER_SIGNATURE:Ce,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:J,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function we(R,U,L){f();var I=W(R,L);h.writeFileSync(U,I)}function Pe(R){for(var U=new Array(R.length),L=0;L<R.length;++L)U[L]=String.fromCharCode(R[L]);return U.join("")}function $e(R,U){var L=W(R,U);switch(U&&U.type||"buffer"){case"file":return f(),h.writeFileSync(U.filename,L),L;case"binary":return typeof L=="string"?L:Pe(L);case"base64":return Kc(typeof L=="string"?L:Pe(L));case"buffer":if(gt)return Buffer.isBuffer(L)?L:ls(L);case"array":return typeof L=="string"?cr(L):L}return L}var V;function N(R){try{var U=R.InflateRaw,L=new U;if(L._processChunk(new Uint8Array([3,0]),L._finishFlushFlag),L.bytesRead)V=R;else throw new Error("zlib does not expose bytesRead")}catch(I){console.error("cannot use native zlib: "+(I.message||I))}}function z(R,U){if(!V)return Eu(R,U);var L=V.InflateRaw,I=new L,B=I._processChunk(R.slice(R.l),I._finishFlushFlag);return R.l+=I.bytesRead,B}function H(R){return V?V.deflateRawSync(R):vl(R)}var q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],me=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Re(R){var U=(R<<1|R<<11)&139536|(R<<5|R<<15)&558144;return(U>>16|U>>8|U)&255}for(var be=typeof Uint8Array<"u",Te=be?new Uint8Array(256):[],it=0;it<256;++it)Te[it]=Re(it);function Je(R,U){var L=Te[R&255];return U<=8?L>>>8-U:(L=L<<8|Te[R>>8&255],U<=16?L>>>16-U:(L=L<<8|Te[R>>16&255],L>>>24-U))}function Qt(R,U){var L=U&7,I=U>>>3;return(R[I]|(L<=6?0:R[I+1]<<8))>>>L&3}function Ze(R,U){var L=U&7,I=U>>>3;return(R[I]|(L<=5?0:R[I+1]<<8))>>>L&7}function hi(R,U){var L=U&7,I=U>>>3;return(R[I]|(L<=4?0:R[I+1]<<8))>>>L&15}function kt(R,U){var L=U&7,I=U>>>3;return(R[I]|(L<=3?0:R[I+1]<<8))>>>L&31}function Le(R,U){var L=U&7,I=U>>>3;return(R[I]|(L<=1?0:R[I+1]<<8))>>>L&127}function $n(R,U,L){var I=U&7,B=U>>>3,j=(1<<L)-1,ne=R[B]>>>I;return L<8-I||(ne|=R[B+1]<<8-I,L<16-I)||(ne|=R[B+2]<<16-I,L<24-I)||(ne|=R[B+3]<<24-I),ne&j}function fi(R,U,L){var I=U&7,B=U>>>3;return I<=5?R[B]|=(L&7)<<I:(R[B]|=L<<I&255,R[B+1]=(L&7)>>8-I),U+3}function Qi(R,U,L){var I=U&7,B=U>>>3;return L=(L&1)<<I,R[B]|=L,U+1}function pr(R,U,L){var I=U&7,B=U>>>3;return L<<=I,R[B]|=L&255,L>>>=8,R[B+1]=L,U+8}function xu(R,U,L){var I=U&7,B=U>>>3;return L<<=I,R[B]|=L&255,L>>>=8,R[B+1]=L&255,R[B+2]=L>>>8,U+16}function ml(R,U){var L=R.length,I=2*L>U?2*L:U+5,B=0;if(L>=U)return R;if(gt){var j=nw(I);if(R.copy)R.copy(j);else for(;B<R.length;++B)j[B]=R[B];return j}else if(be){var ne=new Uint8Array(I);if(ne.set)ne.set(R);else for(;B<L;++B)ne[B]=R[B];return ne}return R.length=I,R}function Pt(R){for(var U=new Array(R),L=0;L<R;++L)U[L]=0;return U}function za(R,U,L){var I=1,B=0,j=0,ne=0,de=0,ie=R.length,re=be?new Uint16Array(32):Pt(32);for(j=0;j<32;++j)re[j]=0;for(j=ie;j<L;++j)R[j]=0;ie=R.length;var le=be?new Uint16Array(ie):Pt(ie);for(j=0;j<ie;++j)re[B=R[j]]++,I<B&&(I=B),le[j]=0;for(re[0]=0,j=1;j<=I;++j)re[j+16]=de=de+re[j-1]<<1;for(j=0;j<ie;++j)de=R[j],de!=0&&(le[j]=re[de+16]++);var _e=0;for(j=0;j<ie;++j)if(_e=R[j],_e!=0)for(de=Je(le[j],I)>>I-_e,ne=(1<<I+4-_e)-1;ne>=0;--ne)U[de|ne<<_e]=_e&15|j<<4;return I}var $a=be?new Uint16Array(512):Pt(512),Ga=be?new Uint16Array(32):Pt(32);if(!be){for(var Di=0;Di<512;++Di)$a[Di]=0;for(Di=0;Di<32;++Di)Ga[Di]=0}(function(){for(var R=[],U=0;U<32;U++)R.push(5);za(R,Ga,32);var L=[];for(U=0;U<=143;U++)L.push(8);for(;U<=255;U++)L.push(9);for(;U<=279;U++)L.push(7);for(;U<=287;U++)L.push(8);za(L,$a,288)})();var ad=(function(){for(var U=be?new Uint8Array(32768):[],L=0,I=0;L<me.length-1;++L)for(;I<me[L+1];++I)U[I]=L;for(;I<32768;++I)U[I]=29;var B=be?new Uint8Array(259):[];for(L=0,I=0;L<oe.length-1;++L)for(;I<oe[L+1];++I)B[I]=L;function j(de,ie){for(var re=0;re<de.length;){var le=Math.min(65535,de.length-re),_e=re+le==de.length;for(ie.write_shift(1,+_e),ie.write_shift(2,le),ie.write_shift(2,~le&65535);le-- >0;)ie[ie.l++]=de[re++]}return ie.l}function ne(de,ie){for(var re=0,le=0,_e=be?new Uint16Array(32768):[];le<de.length;){var Ee=Math.min(65535,de.length-le);if(Ee<10){for(re=fi(ie,re,+(le+Ee==de.length)),re&7&&(re+=8-(re&7)),ie.l=re/8|0,ie.write_shift(2,Ee),ie.write_shift(2,~Ee&65535);Ee-- >0;)ie[ie.l++]=de[le++];re=ie.l*8;continue}re=fi(ie,re,+(le+Ee==de.length)+2);for(var De=0;Ee-- >0;){var xe=de[le];De=(De<<5^xe)&32767;var Oe=-1,Ie=0;if((Oe=_e[De])&&(Oe|=le&-32768,Oe>le&&(Oe-=32768),Oe<le))for(;de[Oe+Ie]==de[le+Ie]&&Ie<250;)++Ie;if(Ie>2){xe=B[Ie],xe<=22?re=pr(ie,re,Te[xe+1]>>1)-1:(pr(ie,re,3),re+=5,pr(ie,re,Te[xe-23]>>5),re+=3);var Dt=xe<8?0:xe-4>>2;Dt>0&&(xu(ie,re,Ie-oe[xe]),re+=Dt),xe=U[le-Oe],re=pr(ie,re,Te[xe]>>3),re-=3;var Nt=xe<4?0:xe-2>>1;Nt>0&&(xu(ie,re,le-Oe-me[xe]),re+=Nt);for(var Bt=0;Bt<Ie;++Bt)_e[De]=le&32767,De=(De<<5^de[le])&32767,++le;Ee-=Ie-1}else xe<=143?xe=xe+48:re=Qi(ie,re,1),re=pr(ie,re,Te[xe]),_e[De]=le&32767,++le}re=pr(ie,re,0)-1}return ie.l=(re+7)/8|0,ie.l}return function(ie,re){return ie.length<8?j(ie,re):ne(ie,re)}})();function vl(R){var U=he(50+Math.floor(R.length*1.1)),L=ad(R,U);return U.slice(0,L)}var wu=be?new Uint16Array(32768):Pt(32768),bu=be?new Uint16Array(32768):Pt(32768),cs=be?new Uint16Array(128):Pt(128),Bn=1,Zi=1;function Gn(R,U){var L=kt(R,U)+257;U+=5;var I=kt(R,U)+1;U+=5;var B=hi(R,U)+4;U+=4;for(var j=0,ne=be?new Uint8Array(19):Pt(19),de=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ie=1,re=be?new Uint8Array(8):Pt(8),le=be?new Uint8Array(8):Pt(8),_e=ne.length,Ee=0;Ee<B;++Ee)ne[q[Ee]]=j=Ze(R,U),ie<j&&(ie=j),re[j]++,U+=3;var De=0;for(re[0]=0,Ee=1;Ee<=ie;++Ee)le[Ee]=De=De+re[Ee-1]<<1;for(Ee=0;Ee<_e;++Ee)(De=ne[Ee])!=0&&(de[Ee]=le[De]++);var xe=0;for(Ee=0;Ee<_e;++Ee)if(xe=ne[Ee],xe!=0){De=Te[de[Ee]]>>8-xe;for(var Oe=(1<<7-xe)-1;Oe>=0;--Oe)cs[De|Oe<<xe]=xe&7|Ee<<3}var Ie=[];for(ie=1;Ie.length<L+I;)switch(De=cs[Le(R,U)],U+=De&7,De>>>=3){case 16:for(j=3+Qt(R,U),U+=2,De=Ie[Ie.length-1];j-- >0;)Ie.push(De);break;case 17:for(j=3+Ze(R,U),U+=3;j-- >0;)Ie.push(0);break;case 18:for(j=11+Le(R,U),U+=7;j-- >0;)Ie.push(0);break;default:Ie.push(De),ie<De&&(ie=De);break}var Dt=Ie.slice(0,L),Nt=Ie.slice(L);for(Ee=L;Ee<286;++Ee)Dt[Ee]=0;for(Ee=I;Ee<30;++Ee)Nt[Ee]=0;return Bn=za(Dt,wu,286),Zi=za(Nt,bu,30),U}function od(R,U){if(R[0]==3&&!(R[1]&3))return[Da(U),2];for(var L=0,I=0,B=nw(U||1<<18),j=0,ne=B.length>>>0,de=0,ie=0;(I&1)==0;){if(I=Ze(R,L),L+=3,I>>>1)I>>1==1?(de=9,ie=5):(L=Gn(R,L),de=Bn,ie=Zi);else{L&7&&(L+=8-(L&7));var re=R[L>>>3]|R[(L>>>3)+1]<<8;if(L+=32,re>0)for(!U&&ne<j+re&&(B=ml(B,j+re),ne=B.length);re-- >0;)B[j++]=R[L>>>3],L+=8;continue}for(;;){!U&&ne<j+32767&&(B=ml(B,j+32767),ne=B.length);var le=$n(R,L,de),_e=I>>>1==1?$a[le]:wu[le];if(L+=_e&15,_e>>>=4,(_e>>>8&255)===0)B[j++]=_e;else{if(_e==256)break;_e-=257;var Ee=_e<8?0:_e-4>>2;Ee>5&&(Ee=0);var De=j+oe[_e];Ee>0&&(De+=$n(R,L,Ee),L+=Ee),le=$n(R,L,ie),_e=I>>>1==1?Ga[le]:bu[le],L+=_e&15,_e>>>=4;var xe=_e<4?0:_e-2>>1,Oe=me[_e];for(xe>0&&(Oe+=$n(R,L,xe),L+=xe),!U&&ne<De&&(B=ml(B,De+100),ne=B.length);j<De;)B[j]=B[j-Oe],++j}}}return U?[B,L+7>>>3]:[B.slice(0,j),L+7>>>3]}function Eu(R,U){var L=R.slice(R.l||0),I=od(L,U);return R.l+=I[1],I[0]}function Su(R,U){if(R)typeof console<"u"&&console.error(U);else throw new Error(U)}function Ks(R,U){var L=R;Ai(L,0);var I=[],B=[],j={FileIndex:I,FullPaths:B};O(j,{root:U.root});for(var ne=L.length-4;(L[ne]!=80||L[ne+1]!=75||L[ne+2]!=5||L[ne+3]!=6)&&ne>=0;)--ne;L.l=ne+4,L.l+=4;var de=L.read_shift(2);L.l+=6;var ie=L.read_shift(4);for(L.l=ie,ne=0;ne<de;++ne){L.l+=20;var re=L.read_shift(4),le=L.read_shift(4),_e=L.read_shift(2),Ee=L.read_shift(2),De=L.read_shift(2);L.l+=8;var xe=L.read_shift(4),Oe=c(L.slice(L.l+_e,L.l+_e+Ee));L.l+=_e+Ee+De;var Ie=L.l;L.l=xe+4,Va(L,re,le,j,Oe),L.l=Ie}return j}function Va(R,U,L,I,B){R.l+=2;var j=R.read_shift(2),ne=R.read_shift(2),de=o(R);if(j&8257)throw new Error("Unsupported ZIP encryption");for(var ie=R.read_shift(4),re=R.read_shift(4),le=R.read_shift(4),_e=R.read_shift(2),Ee=R.read_shift(2),De="",xe=0;xe<_e;++xe)De+=String.fromCharCode(R[R.l++]);if(Ee){var Oe=c(R.slice(R.l,R.l+Ee));(Oe[21589]||{}).mt&&(de=Oe[21589].mt),((B||{})[21589]||{}).mt&&(de=B[21589].mt)}R.l+=Ee;var Ie=R.slice(R.l,R.l+re);switch(ne){case 8:Ie=z(R,le);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ne)}var Dt=!1;j&8&&(ie=R.read_shift(4),ie==134695760&&(ie=R.read_shift(4),Dt=!0),re=R.read_shift(4),le=R.read_shift(4)),re!=U&&Su(Dt,"Bad compressed size: "+U+" != "+re),le!=L&&Su(Dt,"Bad uncompressed size: "+L+" != "+le),Xa(I,De,Ie,{unsafe:!0,mt:de})}function qa(R,U){var L=U||{},I=[],B=[],j=he(1),ne=L.compression?8:0,de=0,ie=0,re=0,le=0,_e=0,Ee=R.FullPaths[0],De=Ee,xe=R.FileIndex[0],Oe=[],Ie=0;for(ie=1;ie<R.FullPaths.length;++ie)if(De=R.FullPaths[ie].slice(Ee.length),xe=R.FileIndex[ie],!(!xe.size||!xe.content||De=="Sh33tJ5")){var Dt=le,Nt=he(De.length);for(re=0;re<De.length;++re)Nt.write_shift(1,De.charCodeAt(re)&127);Nt=Nt.slice(0,Nt.l),Oe[_e]=k3.buf(xe.content,0);var Bt=xe.content;ne==8&&(Bt=H(Bt)),j=he(30),j.write_shift(4,67324752),j.write_shift(2,20),j.write_shift(2,de),j.write_shift(2,ne),xe.mt?a(j,xe.mt):j.write_shift(4,0),j.write_shift(-4,Oe[_e]),j.write_shift(4,Bt.length),j.write_shift(4,xe.content.length),j.write_shift(2,Nt.length),j.write_shift(2,0),le+=j.length,I.push(j),le+=Nt.length,I.push(Nt),le+=Bt.length,I.push(Bt),j=he(46),j.write_shift(4,33639248),j.write_shift(2,0),j.write_shift(2,20),j.write_shift(2,de),j.write_shift(2,ne),j.write_shift(4,0),j.write_shift(-4,Oe[_e]),j.write_shift(4,Bt.length),j.write_shift(4,xe.content.length),j.write_shift(2,Nt.length),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(4,0),j.write_shift(4,Dt),Ie+=j.l,B.push(j),Ie+=Nt.length,B.push(Nt),++_e}return j=he(22),j.write_shift(4,101010256),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,_e),j.write_shift(2,_e),j.write_shift(4,Ie),j.write_shift(4,le),j.write_shift(2,0),Ln([Ln(I),Ln(B),j])}var Ni={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Wa(R,U){if(R.ctype)return R.ctype;var L=R.name||"",I=L.match(/\.([^\.]+)$/);return I&&Ni[I[1]]||U&&(I=(L=U).match(/[\.\\]([^\.\\])+$/),I&&Ni[I[1]])?Ni[I[1]]:"application/octet-stream"}function Js(R){for(var U=Kc(R),L=[],I=0;I<U.length;I+=76)L.push(U.slice(I,I+76));return L.join(`\r
`)+`\r
`}function ld(R){var U=R.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(re){var le=re.charCodeAt(0).toString(16).toUpperCase();return"="+(le.length==1?"0"+le:le)});U=U.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),U.charAt(0)==`
`&&(U="=0D"+U.slice(1)),U=U.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var L=[],I=U.split(`\r
`),B=0;B<I.length;++B){var j=I[B];if(j.length==0){L.push("");continue}for(var ne=0;ne<j.length;){var de=76,ie=j.slice(ne,ne+de);ie.charAt(de-1)=="="?de--:ie.charAt(de-2)=="="?de-=2:ie.charAt(de-3)=="="&&(de-=3),ie=j.slice(ne,ne+de),ne+=de,ne<j.length&&(ie+="="),L.push(ie)}}return L.join(`\r
`)}function Au(R){for(var U=[],L=0;L<R.length;++L){for(var I=R[L];L<=R.length&&I.charAt(I.length-1)=="=";)I=I.slice(0,I.length-1)+R[++L];U.push(I)}for(var B=0;B<U.length;++B)U[B]=U[B].replace(/[=][0-9A-Fa-f]{2}/g,function(j){return String.fromCharCode(parseInt(j.slice(1),16))});return cr(U.join(`\r
`))}function yl(R,U,L){for(var I="",B="",j="",ne,de=0;de<10;++de){var ie=U[de];if(!ie||ie.match(/^\s*$/))break;var re=ie.match(/^(.*?):\s*([^\s].*)$/);if(re)switch(re[1].toLowerCase()){case"content-location":I=re[2].trim();break;case"content-type":j=re[2].trim();break;case"content-transfer-encoding":B=re[2].trim();break}}switch(++de,B.toLowerCase()){case"base64":ne=cr(ss(U.slice(de).join("")));break;case"quoted-printable":ne=Au(U.slice(de));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+B)}var le=Xa(R,I.slice(L.length),ne,{unsafe:!0});j&&(le.ctype=j)}function Qs(R,U){if(Pe(R.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var L=U&&U.root||"",I=(gt&&Buffer.isBuffer(R)?R.toString("binary"):Pe(R)).split(`\r
`),B=0,j="";for(B=0;B<I.length;++B)if(j=I[B],!!/^Content-Location:/i.test(j)&&(j=j.slice(j.indexOf("file")),L||(L=j.slice(0,j.lastIndexOf("/")+1)),j.slice(0,L.length)!=L))for(;L.length>0&&(L=L.slice(0,L.length-1),L=L.slice(0,L.lastIndexOf("/")+1),j.slice(0,L.length)!=L););var ne=(I[1]||"").match(/boundary="(.*?)"/);if(!ne)throw new Error("MAD cannot find boundary");var de="--"+(ne[1]||""),ie=[],re=[],le={FileIndex:ie,FullPaths:re};O(le);var _e,Ee=0;for(B=0;B<I.length;++B){var De=I[B];De!==de&&De!==de+"--"||(Ee++&&yl(le,I.slice(_e,B),L),_e=B)}return le}function cd(R,U){var L=U||{},I=L.boundary||"SheetJS";I="------="+I;for(var B=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+I.slice(2)+'"',"","",""],j=R.FullPaths[0],ne=j,de=R.FileIndex[0],ie=1;ie<R.FullPaths.length;++ie)if(ne=R.FullPaths[ie].slice(j.length),de=R.FileIndex[ie],!(!de.size||!de.content||ne=="Sh33tJ5")){ne=ne.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ie){return"_x"+Ie.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ie){return"_u"+Ie.charCodeAt(0).toString(16)+"_"});for(var re=de.content,le=gt&&Buffer.isBuffer(re)?re.toString("binary"):Pe(re),_e=0,Ee=Math.min(1024,le.length),De=0,xe=0;xe<=Ee;++xe)(De=le.charCodeAt(xe))>=32&&De<128&&++_e;var Oe=_e>=Ee*4/5;B.push(I),B.push("Content-Location: "+(L.root||"file:///C:/SheetJS/")+ne),B.push("Content-Transfer-Encoding: "+(Oe?"quoted-printable":"base64")),B.push("Content-Type: "+Wa(de,ne)),B.push(""),B.push(Oe?ld(le):Js(le))}return B.push(I+`--\r
`),B.join(`\r
`)}function Tu(R){var U={};return O(U,R),U}function Xa(R,U,L,I){var B=I&&I.unsafe;B||O(R);var j=!B&&Tt.find(R,U);if(!j){var ne=R.FullPaths[0];U.slice(0,ne.length)==ne?ne=U:(ne.slice(-1)!="/"&&(ne+="/"),ne=(ne+U).replace("//","/")),j={name:r(U),type:2},R.FileIndex.push(j),R.FullPaths.push(ne),B||Tt.utils.cfb_gc(R)}return j.content=L,j.size=L?L.length:0,I&&(I.CLSID&&(j.clsid=I.CLSID),I.mt&&(j.mt=I.mt),I.ct&&(j.ct=I.ct)),j}function Cu(R,U){O(R);var L=Tt.find(R,U);if(L){for(var I=0;I<R.FileIndex.length;++I)if(R.FileIndex[I]==L)return R.FileIndex.splice(I,1),R.FullPaths.splice(I,1),!0}return!1}function _l(R,U,L){O(R);var I=Tt.find(R,U);if(I){for(var B=0;B<R.FileIndex.length;++B)if(R.FileIndex[B]==I)return R.FileIndex[B].name=r(L),R.FullPaths[B]=L,!0}return!1}function xl(R){M(R,!0)}return e.find=Y,e.read=F,e.parse=p,e.write=$e,e.writeFile=we,e.utils={cfb_new:Tu,cfb_add:Xa,cfb_del:Cu,cfb_mov:_l,cfb_gc:xl,ReadShift:Oc,CheckField:qE,prep_blob:Ai,bconcat:Ln,use_zlib:N,_deflateRaw:vl,_inflateRaw:Eu,consts:ae},e})();function D3(n){return typeof n=="string"?Qf(n):Array.isArray(n)?i3(n):n}function gu(n,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=Qf(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(n,e)}var i=t=="utf8"?Qc(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(i,n);if(typeof Blob<"u"){var r=new Blob([D3(i)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(r,n);if(typeof saveAs<"u")return saveAs(r,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(r);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:n,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=n,o.href=a,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(n);return c.open("w"),c.encoding="binary",Array.isArray(e)&&(e=pu(e)),c.write(e),c.close(),e}catch(h){if(!h.message||!h.message.match(/onstruct/))throw h}throw new Error("cannot save file "+n)}function Pn(n){for(var e=Object.keys(n),t=[],i=0;i<e.length;++i)Object.prototype.hasOwnProperty.call(n,e[i])&&t.push(e[i]);return t}function uw(n,e){for(var t=[],i=Pn(n),r=0;r!==i.length;++r)t[n[i[r]][e]]==null&&(t[n[i[r]][e]]=i[r]);return t}function hm(n){for(var e=[],t=Pn(n),i=0;i!==t.length;++i)e[n[t[i]]]=t[i];return e}function td(n){for(var e=[],t=Pn(n),i=0;i!==t.length;++i)e[n[t[i]]]=parseInt(t[i],10);return e}function N3(n){for(var e=[],t=Pn(n),i=0;i!==t.length;++i)e[n[t[i]]]==null&&(e[n[t[i]]]=[]),e[n[t[i]]].push(t[i]);return e}var Rf=new Date(1899,11,30,0,0,0);function ci(n,e){var t=n.getTime(),i=Rf.getTime()+(n.getTimezoneOffset()-Rf.getTimezoneOffset())*6e4;return(t-i)/(1440*60*1e3)}var OE=new Date,M3=Rf.getTime()+(OE.getTimezoneOffset()-Rf.getTimezoneOffset())*6e4,hw=OE.getTimezoneOffset();function kE(n){var e=new Date;return e.setTime(n*24*60*60*1e3+M3),e.getTimezoneOffset()!==hw&&e.setTime(e.getTime()+(e.getTimezoneOffset()-hw)*6e4),e}var fw=new Date("2017-02-19T19:06:09.000Z"),DE=isNaN(fw.getFullYear())?new Date("2/19/17"):fw,L3=DE.getFullYear()==2017;function Jn(n,e){var t=new Date(n);if(L3)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(n instanceof Date)return n;if(DE.getFullYear()==1917&&!isNaN(t.getFullYear())){var i=t.getFullYear();return n.indexOf(""+i)>-1||t.setFullYear(t.getFullYear()+100),t}var r=n.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+r[0],+r[1]-1,+r[2],+r[3]||0,+r[4]||0,+r[5]||0);return n.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function nd(n,e){if(gt&&Buffer.isBuffer(n))return n.toString("binary");if(typeof TextDecoder<"u")try{var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[]/g,function(a){return t[a]||a})}catch{}for(var i=[],r=0;r!=n.length;++r)i.push(String.fromCharCode(n[r]));return i.join("")}function ui(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=ui(n[t]));return e}function Kt(n,e){for(var t="";t.length<e;)t+=n;return t}function ns(n){var e=Number(n);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(n))return e;var t=1,i=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(i))||(i=i.replace(/[(](.*)[)]/,function(r,a){return t=-t,a}),!isNaN(e=Number(i)))?e/t:e}var F3=["january","february","march","april","may","june","july","august","september","october","november","december"];function Jc(n){var e=new Date(n),t=new Date(NaN),i=e.getYear(),r=e.getMonth(),a=e.getDate();if(isNaN(a))return t;var o=n.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&F3.indexOf(o)==-1)return t}else if(o.match(/[a-z]/))return t;return i<0||i>8099?t:(r>0||a>1)&&i!=101?e:n.match(/[^-0-9:,\/\\]/)?t:e}function et(n,e,t){if(n.FullPaths){if(typeof t=="string"){var i;return gt?i=ls(t):i=r3(t),Tt.utils.cfb_add(n,e,i)}Tt.utils.cfb_add(n,e,t)}else n.file(e,t)}function fm(){return Tt.utils.cfb_new()}var fn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,I3={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},dm=hm(I3),pm=/[&<>'"]/g,P3=/[\u0000-\u0008\u000b-\u001f]/g;function xt(n){var e=n+"";return e.replace(pm,function(t){return dm[t]}).replace(P3,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function dw(n){return xt(n).replace(/ /g,"_x0020_")}var NE=/[\u0000-\u001f]/g;function B3(n){var e=n+"";return e.replace(pm,function(t){return dm[t]}).replace(/\n/g,"<br/>").replace(NE,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function U3(n){var e=n+"";return e.replace(pm,function(t){return dm[t]}).replace(NE,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function j3(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}function H3(n){switch(n){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Wp(n){for(var e="",t=0,i=0,r=0,a=0,o=0,c=0;t<n.length;){if(i=n.charCodeAt(t++),i<128){e+=String.fromCharCode(i);continue}if(r=n.charCodeAt(t++),i>191&&i<224){o=(i&31)<<6,o|=r&63,e+=String.fromCharCode(o);continue}if(a=n.charCodeAt(t++),i<240){e+=String.fromCharCode((i&15)<<12|(r&63)<<6|a&63);continue}o=n.charCodeAt(t++),c=((i&7)<<18|(r&63)<<12|(a&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(c>>>10&1023)),e+=String.fromCharCode(56320+(c&1023))}return e}function pw(n){var e=Da(2*n.length),t,i,r=1,a=0,o=0,c;for(i=0;i<n.length;i+=r)r=1,(c=n.charCodeAt(i))<128?t=c:c<224?(t=(c&31)*64+(n.charCodeAt(i+1)&63),r=2):c<240?(t=(c&15)*4096+(n.charCodeAt(i+1)&63)*64+(n.charCodeAt(i+2)&63),r=3):(r=4,t=(c&7)*262144+(n.charCodeAt(i+1)&63)*4096+(n.charCodeAt(i+2)&63)*64+(n.charCodeAt(i+3)&63),t-=65536,o=55296+(t>>>10&1023),t=56320+(t&1023)),o!==0&&(e[a++]=o&255,e[a++]=o>>>8,o=0),e[a++]=t%256,e[a++]=t>>>8;return e.slice(0,a).toString("ucs2")}function gw(n){return ls(n,"binary").toString("utf8")}var rf="foo bar baz",Rc=gt&&(gw(rf)==Wp(rf)&&gw||pw(rf)==Wp(rf)&&pw)||Wp,Qc=gt?function(n){return ls(n,"utf8").toString("binary")}:function(n){for(var e=[],t=0,i=0,r=0;t<n.length;)switch(i=n.charCodeAt(t++),!0){case i<128:e.push(String.fromCharCode(i));break;case i<2048:e.push(String.fromCharCode(192+(i>>6))),e.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,r=n.charCodeAt(t++)-56320+(i<<10),e.push(String.fromCharCode(240+(r>>18&7))),e.push(String.fromCharCode(144+(r>>12&63))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)));break;default:e.push(String.fromCharCode(224+(i>>12))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)))}return e.join("")},z3=(function(){var n=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var i=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),r=0;r<n.length;++r)i=i.replace(n[r][0],n[r][1]);return i}})(),ME=/(^\s|\s$|\n)/;function Fn(n,e){return"<"+n+(e.match(ME)?' xml:space="preserve"':"")+">"+e+"</"+n+">"}function Zc(n){return Pn(n).map(function(e){return" "+e+'="'+n[e]+'"'}).join("")}function Se(n,e,t){return"<"+n+(t!=null?Zc(t):"")+(e!=null?(e.match(ME)?' xml:space="preserve"':"")+">"+e+"</"+n:"/")+">"}function Dg(n,e){try{return n.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function $3(n,e){switch(typeof n){case"string":var t=Se("vt:lpwstr",xt(n));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return Se((n|0)==n?"vt:i4":"vt:r8",xt(String(n)));case"boolean":return Se("vt:bool",n?"true":"false")}if(n instanceof Date)return Se("vt:filetime",Dg(n));throw new Error("Unable to serialize "+n)}var wn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},fl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ti={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function G3(n,e){for(var t=1-2*(n[e+7]>>>7),i=((n[e+7]&127)<<4)+(n[e+6]>>>4&15),r=n[e+6]&15,a=5;a>=0;--a)r=r*256+n[e+a];return i==2047?r==0?t*(1/0):NaN:(i==0?i=-1022:(i-=1023,r+=Math.pow(2,52)),t*Math.pow(2,i-52)*r)}function V3(n,e,t){var i=(e<0||1/e==-1/0?1:0)<<7,r=0,a=0,o=i?-e:e;isFinite(o)?o==0?r=a=0:(r=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-r),r<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?r=-1022:(a-=Math.pow(2,52),r+=1023)):(r=2047,a=isNaN(e)?26985:0);for(var c=0;c<=5;++c,a/=256)n[t+c]=a&255;n[t+6]=(r&15)<<4|a&15,n[t+7]=r>>4|i}var mw=function(n){for(var e=[],t=10240,i=0;i<n[0].length;++i)if(n[0][i])for(var r=0,a=n[0][i].length;r<a;r+=t)e.push.apply(e,n[0][i].slice(r,r+t));return e},vw=gt?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(e){return Buffer.isBuffer(e)?e:ls(e)})):mw(n)}:mw,yw=function(n,e,t){for(var i=[],r=e;r<t;r+=2)i.push(String.fromCharCode(bc(n,r)));return i.join("").replace(Cc,"")},gm=gt?function(n,e,t){return Buffer.isBuffer(n)?n.toString("utf16le",e,t).replace(Cc,""):yw(n,e,t)}:yw,_w=function(n,e,t){for(var i=[],r=e;r<e+t;++r)i.push(("0"+n[r].toString(16)).slice(-2));return i.join("")},LE=gt?function(n,e,t){return Buffer.isBuffer(n)?n.toString("hex",e,e+t):_w(n,e,t)}:_w,xw=function(n,e,t){for(var i=[],r=e;r<t;r++)i.push(String.fromCharCode(qo(n,r)));return i.join("")},mu=gt?function(e,t,i){return Buffer.isBuffer(e)?e.toString("utf8",t,i):xw(e,t,i)}:xw,FE=function(n,e){var t=Ci(n,e);return t>0?mu(n,e+4,e+4+t-1):""},IE=FE,PE=function(n,e){var t=Ci(n,e);return t>0?mu(n,e+4,e+4+t-1):""},BE=PE,UE=function(n,e){var t=2*Ci(n,e);return t>0?mu(n,e+4,e+4+t-1):""},jE=UE,HE=function(e,t){var i=Ci(e,t);return i>0?gm(e,t+4,t+4+i):""},zE=HE,$E=function(n,e){var t=Ci(n,e);return t>0?mu(n,e+4,e+4+t):""},GE=$E,VE=function(n,e){return G3(n,e)},Of=VE,mm=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};gt&&(IE=function(e,t){if(!Buffer.isBuffer(e))return FE(e,t);var i=e.readUInt32LE(t);return i>0?e.toString("utf8",t+4,t+4+i-1):""},BE=function(e,t){if(!Buffer.isBuffer(e))return PE(e,t);var i=e.readUInt32LE(t);return i>0?e.toString("utf8",t+4,t+4+i-1):""},jE=function(e,t){if(!Buffer.isBuffer(e))return UE(e,t);var i=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+i-1)},zE=function(e,t){if(!Buffer.isBuffer(e))return HE(e,t);var i=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+i)},GE=function(e,t){if(!Buffer.isBuffer(e))return $E(e,t);var i=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+i)},Of=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):VE(e,t)},mm=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var qo=function(n,e){return n[e]},bc=function(n,e){return n[e+1]*256+n[e]},q3=function(n,e){var t=n[e+1]*256+n[e];return t<32768?t:(65535-t+1)*-1},Ci=function(n,e){return n[e+3]*(1<<24)+(n[e+2]<<16)+(n[e+1]<<8)+n[e]},wa=function(n,e){return n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]},W3=function(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]};function Oc(n,e){var t="",i,r,a=[],o,c,h,f;switch(e){case"dbcs":if(f=this.l,gt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*n).toString("utf16le");else for(h=0;h<n;++h)t+=String.fromCharCode(bc(this,f)),f+=2;n*=2;break;case"utf8":t=mu(this,this.l,this.l+n);break;case"utf16le":n*=2,t=gm(this,this.l,this.l+n);break;case"wstr":return Oc.call(this,n,"dbcs");case"lpstr-ansi":t=IE(this,this.l),n=4+Ci(this,this.l);break;case"lpstr-cp":t=BE(this,this.l),n=4+Ci(this,this.l);break;case"lpwstr":t=jE(this,this.l),n=4+2*Ci(this,this.l);break;case"lpp4":n=4+Ci(this,this.l),t=zE(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+Ci(this,this.l),t=GE(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,t="";(o=qo(this,this.l+n++))!==0;)a.push(ef(o));t=a.join("");break;case"_wstr":for(n=0,t="";(o=bc(this,this.l+n))!==0;)a.push(ef(o)),n+=2;n+=2,t=a.join("");break;case"dbcs-cont":for(t="",f=this.l,h=0;h<n;++h){if(this.lens&&this.lens.indexOf(f)!==-1)return o=qo(this,f),this.l=f+1,c=Oc.call(this,n-h,o?"dbcs-cont":"sbcs-cont"),a.join("")+c;a.push(ef(bc(this,f))),f+=2}t=a.join(""),n*=2;break;case"cpstr":case"sbcs-cont":for(t="",f=this.l,h=0;h!=n;++h){if(this.lens&&this.lens.indexOf(f)!==-1)return o=qo(this,f),this.l=f+1,c=Oc.call(this,n-h,o?"dbcs-cont":"sbcs-cont"),a.join("")+c;a.push(ef(qo(this,f))),f+=1}t=a.join("");break;default:switch(n){case 1:return i=qo(this,this.l),this.l++,i;case 2:return i=(e==="i"?q3:bc)(this,this.l),this.l+=2,i;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(i=(n>0?wa:W3)(this,this.l),this.l+=4,i):(r=Ci(this,this.l),this.l+=4,r);case 8:case-8:if(e==="f")return n==8?r=Of(this,this.l):r=Of([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;n=8;case 16:t=LE(this,this.l,n);break}}return this.l+=n,t}var X3=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255,n[t+2]=e>>>16&255,n[t+3]=e>>>24&255},Y3=function(n,e,t){n[t]=e&255,n[t+1]=e>>8&255,n[t+2]=e>>16&255,n[t+3]=e>>24&255},K3=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255};function J3(n,e,t){var i=0,r=0;if(t==="dbcs"){for(r=0;r!=e.length;++r)K3(this,e.charCodeAt(r),this.l+2*r);i=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),r=0;r!=e.length;++r)this[this.l+r]=e.charCodeAt(r)&255;i=e.length}else if(t==="hex"){for(;r<n;++r)this[this.l++]=parseInt(e.slice(2*r,2*r+2),16)||0;return this}else if(t==="utf16le"){var a=Math.min(this.l+n,this.length);for(r=0;r<Math.min(e.length,n);++r){var o=e.charCodeAt(r);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(n){case 1:i=1,this[this.l]=e&255;break;case 2:i=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:i=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:i=4,X3(this,e,this.l);break;case 8:if(i=8,t==="f"){V3(this,e,this.l);break}case 16:break;case-4:i=4,Y3(this,e,this.l);break}return this.l+=i,this}function qE(n,e){var t=LE(this,this.l,n.length>>1);if(t!==n)throw new Error(e+"Expected "+n+" saw "+t);this.l+=n.length>>1}function Ai(n,e){n.l=e,n.read_shift=Oc,n.chk=qE,n.write_shift=J3}function kr(n,e){n.l+=e}function he(n){var e=Da(n);return Ai(e,0),e}function li(){var n=[],e=gt?256:2048,t=function(f){var p=he(f);return Ai(p,0),p},i=t(e),r=function(){i&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&n.push(i),i=null)},a=function(f){return i&&f<i.length-i.l?i:(r(),i=t(Math.max(f+1,e)))},o=function(){return r(),Ln(n)},c=function(f){r(),i=f,i.l==null&&(i.l=i.length),a(e)};return{next:a,push:c,end:o,_bufs:n}}function ye(n,e,t,i){var r=+e,a;if(!isNaN(r)){i||(i=GB[r].p||(t||[]).length||0),a=1+(r>=128?1:0)+1,i>=128&&++a,i>=16384&&++a,i>=2097152&&++a;var o=n.next(a);r<=127?o.write_shift(1,r):(o.write_shift(1,(r&127)+128),o.write_shift(1,r>>7));for(var c=0;c!=4;++c)if(i>=128)o.write_shift(1,(i&127)+128),i>>=7;else{o.write_shift(1,i);break}i>0&&mm(t)&&n.push(t)}}function kc(n,e,t){var i=ui(n);if(e.s?(i.cRel&&(i.c+=e.s.c),i.rRel&&(i.r+=e.s.r)):(i.cRel&&(i.c+=e.c),i.rRel&&(i.r+=e.r)),!t||t.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function ww(n,e,t){var i=ui(n);return i.s=kc(i.s,e.s,t),i.e=kc(i.e,e.s,t),i}function Dc(n,e){if(n.cRel&&n.c<0)for(n=ui(n);n.c<0;)n.c+=e>8?16384:256;if(n.rRel&&n.r<0)for(n=ui(n);n.r<0;)n.r+=e>8?1048576:e>5?65536:16384;var t=wt(n);return!n.cRel&&n.cRel!=null&&(t=eM(t)),!n.rRel&&n.rRel!=null&&(t=Q3(t)),t}function Xp(n,e){return n.s.r==0&&!n.s.rRel&&n.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+Hn(n.s.c)+":"+(n.e.cRel?"":"$")+Hn(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(e.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+In(n.s.r)+":"+(n.e.rRel?"":"$")+In(n.e.r):Dc(n.s,e.biff)+":"+Dc(n.e,e.biff)}function vm(n){return parseInt(Z3(n),10)-1}function In(n){return""+(n+1)}function Q3(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Z3(n){return n.replace(/\$(\d+)$/,"$1")}function ym(n){for(var e=tM(n),t=0,i=0;i!==e.length;++i)t=26*t+e.charCodeAt(i)-64;return t-1}function Hn(n){if(n<0)throw new Error("invalid column "+n);var e="";for(++n;n;n=Math.floor((n-1)/26))e=String.fromCharCode((n-1)%26+65)+e;return e}function eM(n){return n.replace(/^([A-Z])/,"$$$1")}function tM(n){return n.replace(/^\$([A-Z])/,"$1")}function nM(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function bn(n){for(var e=0,t=0,i=0;i<n.length;++i){var r=n.charCodeAt(i);r>=48&&r<=57?e=10*e+(r-48):r>=65&&r<=90&&(t=26*t+(r-64))}return{c:t-1,r:e-1}}function wt(n){for(var e=n.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(n.r+1)}function ki(n){var e=n.indexOf(":");return e==-1?{s:bn(n),e:bn(n)}:{s:bn(n.slice(0,e)),e:bn(n.slice(e+1))}}function hn(n,e){return typeof e>"u"||typeof e=="number"?hn(n.s,n.e):(typeof n!="string"&&(n=wt(n)),typeof e!="string"&&(e=wt(e)),n==e?n:n+":"+e)}function It(n){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,i=0,r=0,a=n.length;for(t=0;i<a&&!((r=n.charCodeAt(i)-64)<1||r>26);++i)t=26*t+r;for(e.s.c=--t,t=0;i<a&&!((r=n.charCodeAt(i)-48)<0||r>9);++i)t=10*t+r;if(e.s.r=--t,i===a||r!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++i,t=0;i!=a&&!((r=n.charCodeAt(i)-64)<1||r>26);++i)t=26*t+r;for(e.e.c=--t,t=0;i!=a&&!((r=n.charCodeAt(i)-48)<0||r>9);++i)t=10*t+r;return e.e.r=--t,e}function bw(n,e){var t=n.t=="d"&&e instanceof Date;if(n.z!=null)try{return n.w=qs(n.z,t?ci(e):e)}catch{}try{return n.w=qs((n.XF||{}).numFmtId||(t?14:0),t?ci(e):e)}catch{return""+e}}function as(n,e,t){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&t&&t.dateNF&&(n.z=t.dateNF),n.t=="e"?vu[n.v]||n.v:e==null?bw(n,n.v):bw(n,e))}function Pa(n,e){var t=e&&e.sheet?e.sheet:"Sheet1",i={};return i[t]=n,{SheetNames:[t],Sheets:i}}function WE(n,e,t){var i=t||{},r=n?Array.isArray(n):i.dense,a=n||(r?[]:{}),o=0,c=0;if(a&&i.origin!=null){if(typeof i.origin=="number")o=i.origin;else{var h=typeof i.origin=="string"?bn(i.origin):i.origin;o=h.r,c=h.c}a["!ref"]||(a["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var p=It(a["!ref"]);f.s.c=p.s.c,f.s.r=p.s.r,f.e.c=Math.max(f.e.c,p.e.c),f.e.r=Math.max(f.e.r,p.e.r),o==-1&&(f.e.r=o=p.e.r+1)}for(var g=0;g!=e.length;++g)if(e[g]){if(!Array.isArray(e[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=e[g].length;++m)if(!(typeof e[g][m]>"u")){var y={v:e[g][m]},w=o+g,_=c+m;if(f.s.r>w&&(f.s.r=w),f.s.c>_&&(f.s.c=_),f.e.r<w&&(f.e.r=w),f.e.c<_&&(f.e.c=_),e[g][m]&&typeof e[g][m]=="object"&&!Array.isArray(e[g][m])&&!(e[g][m]instanceof Date))y=e[g][m];else if(Array.isArray(y.v)&&(y.f=e[g][m][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(i.nullError)y.t="e",y.v=0;else if(i.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=i.dateNF||Jt[14],i.cellDates?(y.t="d",y.w=qs(y.z,ci(y.v))):(y.t="n",y.v=ci(y.v),y.w=qs(y.z,y.v))):y.t="s";if(r)a[w]||(a[w]=[]),a[w][_]&&a[w][_].z&&(y.z=a[w][_].z),a[w][_]=y;else{var b=wt({c:_,r:w});a[b]&&a[b].z&&(y.z=a[b].z),a[b]=y}}}return f.s.c<1e7&&(a["!ref"]=hn(f)),a}function dl(n,e){return WE(null,n,e)}function iM(n){return n.read_shift(4,"i")}function hr(n,e){return e||(e=he(4)),e.write_shift(4,n),e}function zn(n){var e=n.read_shift(4);return e===0?"":n.read_shift(e,"dbcs")}function En(n,e){var t=!1;return e==null&&(t=!0,e=he(4+2*n.length)),e.write_shift(4,n.length),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}function rM(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function sM(n,e){return e||(e=he(4)),e.write_shift(2,0),e.write_shift(2,0),e}function _m(n,e){var t=n.l,i=n.read_shift(1),r=zn(n),a=[],o={t:r,h:r};if((i&1)!==0){for(var c=n.read_shift(4),h=0;h!=c;++h)a.push(rM(n));o.r=a}else o.r=[{ich:0,ifnt:0}];return n.l=t+e,o}function aM(n,e){var t=!1;return e==null&&(t=!0,e=he(15+4*n.t.length)),e.write_shift(1,0),En(n.t,e),t?e.slice(0,e.l):e}var oM=_m;function lM(n,e){var t=!1;return e==null&&(t=!0,e=he(23+4*n.t.length)),e.write_shift(1,1),En(n.t,e),e.write_shift(4,1),sM({},e),t?e.slice(0,e.l):e}function Ji(n){var e=n.read_shift(4),t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:e,iStyleRef:t}}function Ba(n,e){return e==null&&(e=he(8)),e.write_shift(-4,n.c),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}function Ua(n){var e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:e}}function ja(n,e){return e==null&&(e=he(4)),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}var cM=zn,XE=En;function xm(n){var e=n.read_shift(4);return e===0||e===4294967295?"":n.read_shift(e,"dbcs")}function kf(n,e){var t=!1;return e==null&&(t=!0,e=he(127)),e.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}var uM=zn,Ng=xm,wm=kf;function YE(n){var e=n.slice(n.l,n.l+4),t=e[0]&1,i=e[0]&2;n.l+=4;var r=i===0?Of([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):wa(e,0)>>2;return t?r/100:r}function KE(n,e){e==null&&(e=he(4));var t=0,i=0,r=n*100;if(n==(n|0)&&n>=-536870912&&n<1<<29?i=1:r==(r|0)&&r>=-536870912&&r<1<<29&&(i=1,t=1),i)e.write_shift(-4,((t?r:n)<<2)+(t+2));else throw new Error("unsupported RkNumber "+n)}function JE(n){var e={s:{},e:{}};return e.s.r=n.read_shift(4),e.e.r=n.read_shift(4),e.s.c=n.read_shift(4),e.e.c=n.read_shift(4),e}function hM(n,e){return e||(e=he(16)),e.write_shift(4,n.s.r),e.write_shift(4,n.e.r),e.write_shift(4,n.s.c),e.write_shift(4,n.e.c),e}var Ha=JE,pl=hM;function gl(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function Na(n,e){return(e||he(8)).write_shift(8,n,"f")}function fM(n){var e={},t=n.read_shift(1),i=t>>>1,r=n.read_shift(1),a=n.read_shift(2,"i"),o=n.read_shift(1),c=n.read_shift(1),h=n.read_shift(1);switch(n.l++,i){case 0:e.auto=1;break;case 1:e.index=r;var f=wM[r];f&&(e.rgb=Mw(f));break;case 2:e.rgb=Mw([o,c,h]);break;case 3:e.theme=r;break}return a!=0&&(e.tint=a>0?a/32767:a/32768),e}function Df(n,e){if(e||(e=he(8)),!n||n.auto)return e.write_shift(4,0),e.write_shift(4,0),e;n.index!=null?(e.write_shift(1,2),e.write_shift(1,n.index)):n.theme!=null?(e.write_shift(1,6),e.write_shift(1,n.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=n.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!n.rgb||n.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var i=n.rgb||"FFFFFF";typeof i=="number"&&(i=("000000"+i.toString(16)).slice(-6)),e.write_shift(1,parseInt(i.slice(0,2),16)),e.write_shift(1,parseInt(i.slice(2,4),16)),e.write_shift(1,parseInt(i.slice(4,6),16)),e.write_shift(1,255)}return e}function dM(n){var e=n.read_shift(1);n.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function pM(n,e){e||(e=he(2));var t=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}var QE=2,Ei=3,sf=11,Nf=19,af=64,gM=65,mM=71,vM=4108,yM=4126,Nn=80,Ew={1:{n:"CodePage",t:QE},2:{n:"Category",t:Nn},3:{n:"PresentationFormat",t:Nn},4:{n:"ByteCount",t:Ei},5:{n:"LineCount",t:Ei},6:{n:"ParagraphCount",t:Ei},7:{n:"SlideCount",t:Ei},8:{n:"NoteCount",t:Ei},9:{n:"HiddenCount",t:Ei},10:{n:"MultimediaClipCount",t:Ei},11:{n:"ScaleCrop",t:sf},12:{n:"HeadingPairs",t:vM},13:{n:"TitlesOfParts",t:yM},14:{n:"Manager",t:Nn},15:{n:"Company",t:Nn},16:{n:"LinksUpToDate",t:sf},17:{n:"CharacterCount",t:Ei},19:{n:"SharedDoc",t:sf},22:{n:"HyperlinksChanged",t:sf},23:{n:"AppVersion",t:Ei,p:"version"},24:{n:"DigSig",t:gM},26:{n:"ContentType",t:Nn},27:{n:"ContentStatus",t:Nn},28:{n:"Language",t:Nn},29:{n:"Version",t:Nn},255:{},2147483648:{n:"Locale",t:Nf},2147483651:{n:"Behavior",t:Nf},1919054434:{}},Sw={1:{n:"CodePage",t:QE},2:{n:"Title",t:Nn},3:{n:"Subject",t:Nn},4:{n:"Author",t:Nn},5:{n:"Keywords",t:Nn},6:{n:"Comments",t:Nn},7:{n:"Template",t:Nn},8:{n:"LastAuthor",t:Nn},9:{n:"RevNumber",t:Nn},10:{n:"EditTime",t:af},11:{n:"LastPrinted",t:af},12:{n:"CreatedDate",t:af},13:{n:"ModifiedDate",t:af},14:{n:"PageCount",t:Ei},15:{n:"WordCount",t:Ei},16:{n:"CharCount",t:Ei},17:{n:"Thumbnail",t:mM},18:{n:"Application",t:Nn},19:{n:"DocSecurity",t:Ei},255:{},2147483648:{n:"Locale",t:Nf},2147483651:{n:"Behavior",t:Nf},1919054434:{}};function _M(n){return n.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var xM=_M([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),wM=ui(xM),vu={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},bM={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},of={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function ZE(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function eS(n,e){var t=N3(bM),i=[],r;i[i.length]=fn,i[i.length]=Se("Types",null,{xmlns:wn.CT,"xmlns:xsd":wn.xsd,"xmlns:xsi":wn.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(h){return Se("Default",null,{Extension:h[0],ContentType:h[1]})}));var a=function(h){n[h]&&n[h].length>0&&(r=n[h][0],i[i.length]=Se("Override",null,{PartName:(r[0]=="/"?"":"/")+r,ContentType:of[h][e.bookType]||of[h].xlsx}))},o=function(h){(n[h]||[]).forEach(function(f){i[i.length]=Se("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:of[h][e.bookType]||of[h].xlsx})})},c=function(h){(n[h]||[]).forEach(function(f){i[i.length]=Se("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:t[h][0]})})};return a("workbooks"),o("sheets"),o("charts"),c("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),o("metadata"),c("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var ht={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function tS(n){var e=n.lastIndexOf("/");return n.slice(0,e+1)+"_rels/"+n.slice(e+1)+".rels"}function rl(n){var e=[fn,Se("Relationships",null,{xmlns:wn.RELS})];return Pn(n["!id"]).forEach(function(t){e[e.length]=Se("Relationship",null,n["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function _t(n,e,t,i,r,a){if(r||(r={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),e<0)for(e=n["!idx"];n["!id"]["rId"+e];++e);if(n["!idx"]=e+1,r.Id="rId"+e,r.Type=i,r.Target=t,[ht.HLINK,ht.XPATH,ht.XMISS].indexOf(r.Type)>-1&&(r.TargetMode="External"),n["!id"][r.Id])throw new Error("Cannot rewrite rId "+e);return n["!id"][r.Id]=r,n[("/"+r.Target).replace("//","/")]=r,e}function EM(n){var e=[fn];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<n.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+n[t][0]+'" manifest:media-type="'+n[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function Aw(n,e,t){return['  <rdf:Description rdf:about="'+n+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function SM(n,e){return['  <rdf:Description rdf:about="'+n+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function AM(n){var e=[fn];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=n.length;++t)e.push(Aw(n[t][0],n[t][1])),e.push(SM("",n[t][0]));return e.push(Aw("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function nS(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Ef.version+"</meta:generator></office:meta></office:document-meta>"}var Ca=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Yp(n,e,t,i,r){r[n]!=null||e==null||e===""||(r[n]=e,e=xt(e),i[i.length]=t?Se(n,e,t):Fn(n,e))}function iS(n,e){var t=e||{},i=[fn,Se("cp:coreProperties",null,{"xmlns:cp":wn.CORE_PROPS,"xmlns:dc":wn.dc,"xmlns:dcterms":wn.dcterms,"xmlns:dcmitype":wn.dcmitype,"xmlns:xsi":wn.xsi})],r={};if(!n&&!t.Props)return i.join("");n&&(n.CreatedDate!=null&&Yp("dcterms:created",typeof n.CreatedDate=="string"?n.CreatedDate:Dg(n.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},i,r),n.ModifiedDate!=null&&Yp("dcterms:modified",typeof n.ModifiedDate=="string"?n.ModifiedDate:Dg(n.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},i,r));for(var a=0;a!=Ca.length;++a){var o=Ca[a],c=t.Props&&t.Props[o[1]]!=null?t.Props[o[1]]:n?n[o[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&Yp(o[0],c,null,i,r)}return i.length>2&&(i[i.length]="</cp:coreProperties>",i[1]=i[1].replace("/>",">")),i.join("")}var sl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],rS=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function sS(n){var e=[],t=Se;return n||(n={}),n.Application="SheetJS",e[e.length]=fn,e[e.length]=Se("Properties",null,{xmlns:wn.EXT_PROPS,"xmlns:vt":wn.vt}),sl.forEach(function(i){if(n[i[1]]!==void 0){var r;switch(i[2]){case"string":r=xt(String(n[i[1]]));break;case"bool":r=n[i[1]]?"true":"false";break}r!==void 0&&(e[e.length]=t(i[0],r))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",n.SheetNames.map(function(i){return"<vt:lpstr>"+xt(i)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function aS(n){var e=[fn,Se("Properties",null,{xmlns:wn.CUST_PROPS,"xmlns:vt":wn.vt})];if(!n)return e.join("");var t=1;return Pn(n).forEach(function(r){++t,e[e.length]=Se("property",$3(n[r]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:xt(r)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Tw={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function TM(n,e){var t=[];return Pn(Tw).map(function(i){for(var r=0;r<Ca.length;++r)if(Ca[r][1]==i)return Ca[r];for(r=0;r<sl.length;++r)if(sl[r][1]==i)return sl[r];throw i}).forEach(function(i){if(n[i[1]]!=null){var r=e&&e.Props&&e.Props[i[1]]!=null?e.Props[i[1]]:n[i[1]];i[2]==="date"&&(r=new Date(r).toISOString().replace(/\.\d*Z/,"Z")),typeof r=="number"?r=String(r):r===!0||r===!1?r=r?"1":"0":r instanceof Date&&(r=new Date(r).toISOString().replace(/\.\d*Z/,"")),t.push(Fn(Tw[i[1]]||i[1],r))}}),Se("DocumentProperties",t.join(""),{xmlns:Ti.o})}function CM(n,e){var t=["Worksheets","SheetNames"],i="CustomDocumentProperties",r=[];return n&&Pn(n).forEach(function(a){if(Object.prototype.hasOwnProperty.call(n,a)){for(var o=0;o<Ca.length;++o)if(a==Ca[o][1])return;for(o=0;o<sl.length;++o)if(a==sl[o][1])return;for(o=0;o<t.length;++o)if(a==t[o])return;var c=n[a],h="string";typeof c=="number"?(h="float",c=String(c)):c===!0||c===!1?(h="boolean",c=c?"1":"0"):c=String(c),r.push(Se(dw(a),c,{"dt:dt":h}))}}),e&&Pn(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)&&!(n&&Object.prototype.hasOwnProperty.call(n,a))){var o=e[a],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o instanceof Date?(c="dateTime.tz",o=o.toISOString()):o=String(o),r.push(Se(dw(a),o,{"dt:dt":c}))}}),"<"+i+' xmlns="'+Ti.o+'">'+r.join("")+"</"+i+">"}function RM(n){var e=typeof n=="string"?new Date(Date.parse(n)):n,t=e.getTime()/1e3+11644473600,i=t%Math.pow(2,32),r=(t-i)/Math.pow(2,32);i*=1e7,r*=1e7;var a=i/Math.pow(2,32)|0;a>0&&(i=i%Math.pow(2,32),r+=a);var o=he(8);return o.write_shift(4,i),o.write_shift(4,r),o}function Cw(n,e){var t=he(4),i=he(4);switch(t.write_shift(4,n==80?31:n),n){case 3:i.write_shift(-4,e);break;case 5:i=he(8),i.write_shift(8,e,"f");break;case 11:i.write_shift(4,e?1:0);break;case 64:i=RM(e);break;case 31:case 80:for(i=he(4+2*(e.length+1)+(e.length%2?0:2)),i.write_shift(4,e.length+1),i.write_shift(0,e,"dbcs");i.l!=i.length;)i.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+e)}return Ln([t,i])}var oS=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function OM(n){switch(typeof n){case"boolean":return 11;case"number":return(n|0)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64;break}return-1}function Rw(n,e,t){var i=he(8),r=[],a=[],o=8,c=0,h=he(8),f=he(8);if(h.write_shift(4,2),h.write_shift(4,1200),f.write_shift(4,1),a.push(h),r.push(f),o+=8+h.length,!e){f=he(8),f.write_shift(4,0),r.unshift(f);var p=[he(4)];for(p[0].write_shift(4,n.length),c=0;c<n.length;++c){var g=n[c][0];for(h=he(8+2*(g.length+1)+(g.length%2?0:2)),h.write_shift(4,c+2),h.write_shift(4,g.length+1),h.write_shift(0,g,"dbcs");h.l!=h.length;)h.write_shift(1,0);p.push(h)}h=Ln(p),a.unshift(h),o+=8+h.length}for(c=0;c<n.length;++c)if(!(e&&!e[n[c][0]])&&!(oS.indexOf(n[c][0])>-1||rS.indexOf(n[c][0])>-1)&&n[c][1]!=null){var m=n[c][1],y=0;if(e){y=+e[n[c][0]];var w=t[y];if(w.p=="version"&&typeof m=="string"){var _=m.split(".");m=(+_[0]<<16)+(+_[1]||0)}h=Cw(w.t,m)}else{var b=OM(m);b==-1&&(b=31,m=String(m)),h=Cw(b,m)}a.push(h),f=he(8),f.write_shift(4,e?y:2+c),r.push(f),o+=8+h.length}var E=8*(a.length+1);for(c=0;c<a.length;++c)r[c].write_shift(4,E),E+=a[c].length;return i.write_shift(4,o),i.write_shift(4,a.length),Ln([i].concat(r).concat(a))}function Ow(n,e,t,i,r,a){var o=he(r?68:48),c=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Tt.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,r?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,r?68:48);var h=Rw(n,t,i);if(c.push(h),r){var f=Rw(r,null,null);o.write_shift(16,a,"hex"),o.write_shift(4,68+h.length),c.push(f)}return Ln(c)}function kM(n,e){e||(e=he(n));for(var t=0;t<n;++t)e.write_shift(1,0);return e}function DM(n,e){return n.read_shift(e)===1}function Yn(n,e){return e||(e=he(2)),e.write_shift(2,+!!n),e}function lS(n){return n.read_shift(2,"u")}function Xi(n,e){return e||(e=he(2)),e.write_shift(2,n),e}function cS(n,e,t){return t||(t=he(2)),t.write_shift(1,e=="e"?+n:+!!n),t.write_shift(1,e=="e"?1:0),t}function uS(n,e,t){var i=n.read_shift(t&&t.biff>=12?2:1),r="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var a=n.read_shift(1);a&&(r="dbcs-cont")}else t.biff==12&&(r="wstr");t.biff>=2&&t.biff<=5&&(r="cpstr");var o=i?n.read_shift(i,r):"";return o}function NM(n){var e=n.t||"",t=he(3);t.write_shift(2,e.length),t.write_shift(1,1);var i=he(2*e.length);i.write_shift(2*e.length,e,"utf16le");var r=[t,i];return Ln(r)}function MM(n,e,t){var i;if(t){if(t.biff>=2&&t.biff<=5)return n.read_shift(e,"cpstr");if(t.biff>=12)return n.read_shift(e,"dbcs-cont")}var r=n.read_shift(1);return r===0?i=n.read_shift(e,"sbcs-cont"):i=n.read_shift(e,"dbcs-cont"),i}function LM(n,e,t){var i=n.read_shift(t&&t.biff==2?1:2);return i===0?(n.l++,""):MM(n,i,t)}function FM(n,e,t){if(t.biff>5)return LM(n,e,t);var i=n.read_shift(1);return i===0?(n.l++,""):n.read_shift(i,t.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function hS(n,e,t){return t||(t=he(3+2*n.length)),t.write_shift(2,n.length),t.write_shift(1,1),t.write_shift(31,n,"utf16le"),t}function kw(n,e){e||(e=he(6+n.length*2)),e.write_shift(4,1+n.length);for(var t=0;t<n.length;++t)e.write_shift(2,n.charCodeAt(t));return e.write_shift(2,0),e}function IM(n){var e=he(512),t=0,i=n.Target;i.slice(0,7)=="file://"&&(i=i.slice(7));var r=i.indexOf("#"),a=r>-1?31:23;switch(i.charAt(0)){case"#":a=28;break;case".":a&=-3;break}e.write_shift(4,2),e.write_shift(4,a);var o=[8,6815827,6619237,4849780,83];for(t=0;t<o.length;++t)e.write_shift(4,o[t]);if(a==28)i=i.slice(1),kw(i,e);else if(a&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<o.length;++t)e.write_shift(1,parseInt(o[t],16));var c=r>-1?i.slice(0,r):i;for(e.write_shift(4,2*(c.length+1)),t=0;t<c.length;++t)e.write_shift(2,c.charCodeAt(t));e.write_shift(2,0),a&8&&kw(r>-1?i.slice(r+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<o.length;++t)e.write_shift(1,parseInt(o[t],16));for(var h=0;i.slice(h*3,h*3+3)=="../"||i.slice(h*3,h*3+3)=="..\\";)++h;for(e.write_shift(2,h),e.write_shift(4,i.length-3*h+1),t=0;t<i.length-3*h;++t)e.write_shift(1,i.charCodeAt(t+3*h)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function Ma(n,e,t,i){return i||(i=he(6)),i.write_shift(2,n),i.write_shift(2,e),i.write_shift(2,t||0),i}function PM(n,e,t){var i=t.biff>8?4:2,r=n.read_shift(i),a=n.read_shift(i,"i"),o=n.read_shift(i,"i");return[r,a,o]}function BM(n){var e=n.read_shift(2),t=n.read_shift(2),i=n.read_shift(2),r=n.read_shift(2);return{s:{c:i,r:e},e:{c:r,r:t}}}function fS(n,e){return e||(e=he(8)),e.write_shift(2,n.s.r),e.write_shift(2,n.e.r),e.write_shift(2,n.s.c),e.write_shift(2,n.e.c),e}function bm(n,e,t){var i=1536,r=16;switch(t.bookType){case"biff8":break;case"biff5":i=1280,r=8;break;case"biff4":i=4,r=6;break;case"biff3":i=3,r=6;break;case"biff2":i=2,r=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=he(r);return a.write_shift(2,i),a.write_shift(2,e),r>4&&a.write_shift(2,29282),r>6&&a.write_shift(2,1997),r>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function UM(n,e){var t=!e||e.biff==8,i=he(t?112:54);for(i.write_shift(e.biff==8?2:1,7),t&&i.write_shift(1,0),i.write_shift(4,859007059),i.write_shift(4,5458548|(t?0:536870912));i.l<i.length;)i.write_shift(1,t?0:32);return i}function jM(n,e){var t=!e||e.biff>=8?2:1,i=he(8+t*n.name.length);i.write_shift(4,n.pos),i.write_shift(1,n.hs||0),i.write_shift(1,n.dt),i.write_shift(1,n.name.length),e.biff>=8&&i.write_shift(1,1),i.write_shift(t*n.name.length,n.name,e.biff<8?"sbcs":"utf16le");var r=i.slice(0,i.l);return r.l=i.l,r}function HM(n,e){var t=he(8);t.write_shift(4,n.Count),t.write_shift(4,n.Unique);for(var i=[],r=0;r<n.length;++r)i[r]=NM(n[r]);var a=Ln([t].concat(i));return a.parts=[t.length].concat(i.map(function(o){return o.length})),a}function zM(){var n=he(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}function $M(n){var e=he(18),t=1718;return n&&n.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function GM(n,e){var t=n.name||"Arial",i=e&&e.biff==5,r=i?15+t.length:16+2*t.length,a=he(r);return a.write_shift(2,n.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,t.length),i||a.write_shift(1,1),a.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le"),a}function VM(n,e,t,i){var r=he(10);return Ma(n,e,i,r),r.write_shift(4,t),r}function qM(n,e,t,i,r){var a=!r||r.biff==8,o=he(8+ +a+(1+a)*t.length);return Ma(n,e,i,o),o.write_shift(2,t.length),a&&o.write_shift(1,1),o.write_shift((1+a)*t.length,t,a?"utf16le":"sbcs"),o}function WM(n,e,t,i){var r=t&&t.biff==5;i||(i=he(r?3+e.length:5+2*e.length)),i.write_shift(2,n),i.write_shift(r?1:2,e.length),r||i.write_shift(1,1),i.write_shift((r?1:2)*e.length,e,r?"sbcs":"utf16le");var a=i.length>i.l?i.slice(0,i.l):i;return a.l==null&&(a.l=a.length),a}function XM(n,e){var t=e.biff==8||!e.biff?4:2,i=he(2*t+6);return i.write_shift(t,n.s.r),i.write_shift(t,n.e.r+1),i.write_shift(2,n.s.c),i.write_shift(2,n.e.c+1),i.write_shift(2,0),i}function Dw(n,e,t,i){var r=t&&t.biff==5;i||(i=he(r?16:20)),i.write_shift(2,0),n.style?(i.write_shift(2,n.numFmtId||0),i.write_shift(2,65524)):(i.write_shift(2,n.numFmtId||0),i.write_shift(2,e<<4));var a=0;return n.numFmtId>0&&r&&(a|=1024),i.write_shift(4,a),i.write_shift(4,0),r||i.write_shift(4,0),i.write_shift(2,0),i}function YM(n){var e=he(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function KM(n,e,t,i,r,a){var o=he(8);return Ma(n,e,i,o),cS(t,a,o),o}function JM(n,e,t,i){var r=he(14);return Ma(n,e,i,r),Na(t,r),r}function QM(n,e,t){if(t.biff<8)return ZM(n,e,t);for(var i=[],r=n.l+e,a=n.read_shift(t.biff>8?4:2);a--!==0;)i.push(PM(n,t.biff>8?12:6,t));if(n.l!=r)throw new Error("Bad ExternSheet: "+n.l+" != "+r);return i}function ZM(n,e,t){n[n.l+1]==3&&n[n.l]++;var i=uS(n,e,t);return i.charCodeAt(0)==3?i.slice(1):i}function eL(n){var e=he(2+n.length*8);e.write_shift(2,n.length);for(var t=0;t<n.length;++t)fS(n[t],e);return e}function tL(n){var e=he(24),t=bn(n[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var i="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<16;++r)e.write_shift(1,parseInt(i[r],16));return Ln([e,IM(n[1])])}function nL(n){var e=n[1].Tooltip,t=he(10+2*(e.length+1));t.write_shift(2,2048);var i=bn(n[0]);t.write_shift(2,i.r),t.write_shift(2,i.r),t.write_shift(2,i.c),t.write_shift(2,i.c);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function iL(n){return n||(n=he(4)),n.write_shift(2,1),n.write_shift(2,1),n}function rL(n,e,t){if(!t.cellStyles)return kr(n,e);var i=t&&t.biff>=12?4:2,r=n.read_shift(i),a=n.read_shift(i),o=n.read_shift(i),c=n.read_shift(i),h=n.read_shift(2);i==2&&(n.l+=2);var f={s:r,e:a,w:o,ixfe:c,flags:h};return(t.biff>=5||!t.biff)&&(f.level=h>>8&7),f}function sL(n,e){var t=he(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,n.width*256),t.write_shift(2,0);var i=0;return n.hidden&&(i|=1),t.write_shift(1,i),i=n.level||0,t.write_shift(1,i),t.write_shift(2,0),t}function aL(n){for(var e=he(2*n),t=0;t<n;++t)e.write_shift(2,t+1);return e}function oL(n,e,t){var i=he(15);return _u(i,n,e),i.write_shift(8,t,"f"),i}function lL(n,e,t){var i=he(9);return _u(i,n,e),i.write_shift(2,t),i}var cL=(function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=hm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(c,h){var f=[],p=Da(1);switch(h.type){case"base64":p=cr(ss(c));break;case"binary":p=cr(c);break;case"buffer":case"array":p=c;break}Ai(p,0);var g=p.read_shift(1),m=!!(g&136),y=!1,w=!1;switch(g){case 2:break;case 3:break;case 48:y=!0,m=!0;break;case 49:y=!0,m=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var _=0,b=521;g==2&&(_=p.read_shift(2)),p.l+=3,g!=2&&(_=p.read_shift(4)),_>1048576&&(_=1e6),g!=2&&(b=p.read_shift(2));var E=p.read_shift(2),T=h.codepage||1252;g!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(T=n[p[p.l]]),p.l+=1,p.l+=2),w&&(p.l+=36);for(var S=[],k={},P=Math.min(p.length,g==2?521:b-10-(y?264:0)),F=w?32:11;p.l<P&&p[p.l]!=13;)switch(k={},k.name=Sf.utils.decode(T,p.slice(p.l,p.l+F)).replace(/[\u0000\r\n].*$/g,""),p.l+=F,k.type=String.fromCharCode(p.read_shift(1)),g!=2&&!w&&(k.offset=p.read_shift(4)),k.len=p.read_shift(1),g==2&&(k.offset=p.read_shift(2)),k.dec=p.read_shift(1),k.name.length&&S.push(k),g!=2&&(p.l+=w?13:14),k.type){case"B":(!y||k.len!=8)&&h.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(p[p.l]!==13&&(p.l=b-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=b;var O=0,G=0;for(f[0]=[],G=0;G!=S.length;++G)f[0][G]=S[G].name;for(;_-- >0;){if(p[p.l]===42){p.l+=E;continue}for(++p.l,f[++O]=[],G=0,G=0;G!=S.length;++G){var M=p.slice(p.l,p.l+S[G].len);p.l+=S[G].len,Ai(M,0);var W=Sf.utils.decode(T,M);switch(S[G].type){case"C":W.trim().length&&(f[O][G]=W.replace(/\s+$/,""));break;case"D":W.length===8?f[O][G]=new Date(+W.slice(0,4),+W.slice(4,6)-1,+W.slice(6,8)):f[O][G]=W;break;case"F":f[O][G]=parseFloat(W.trim());break;case"+":case"I":f[O][G]=w?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(W.trim().toUpperCase()){case"Y":case"T":f[O][G]=!0;break;case"N":case"F":f[O][G]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+W+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));f[O][G]="##MEMO##"+(w?parseInt(W.trim(),10):M.read_shift(4));break;case"N":W=W.replace(/\u0000/g,"").trim(),W&&W!="."&&(f[O][G]=+W||0);break;case"@":f[O][G]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":f[O][G]=new Date((M.read_shift(4)-2440588)*864e5+M.read_shift(4));break;case"Y":f[O][G]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[O][G]=-M.read_shift(-8,"f");break;case"B":if(y&&S[G].len==8){f[O][G]=M.read_shift(8,"f");break}case"G":case"P":M.l+=S[G].len;break;case"0":if(S[G].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[G].type)}}}if(g!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return h&&h.sheetRows&&(f=f.slice(0,h.sheetRows)),h.DBF=S,f}function i(c,h){var f=h||{};f.dateNF||(f.dateNF="yyyymmdd");var p=dl(t(c,f),f);return p["!cols"]=f.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete f.DBF,p}function r(c,h){try{return Pa(i(c,h),h)}catch(f){if(h&&h.WTF)throw f}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(c,h){var f=h||{};if(+f.codepage>=0&&Yc(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var p=li(),g=Pf(c,{header:1,raw:!0,cellDates:!0}),m=g[0],y=g.slice(1),w=c["!cols"]||[],_=0,b=0,E=0,T=1;for(_=0;_<m.length;++_){if(((w[_]||{}).DBF||{}).name){m[_]=w[_].DBF.name,++E;continue}if(m[_]!=null){if(++E,typeof m[_]=="number"&&(m[_]=m[_].toString(10)),typeof m[_]!="string")throw new Error("DBF Invalid column name "+m[_]+" |"+typeof m[_]+"|");if(m.indexOf(m[_])!==_){for(b=0;b<1024;++b)if(m.indexOf(m[_]+"_"+b)==-1){m[_]+="_"+b;break}}}}var S=It(c["!ref"]),k=[],P=[],F=[];for(_=0;_<=S.e.c-S.s.c;++_){var O="",G="",M=0,W=[];for(b=0;b<y.length;++b)y[b][_]!=null&&W.push(y[b][_]);if(W.length==0||m[_]==null){k[_]="?";continue}for(b=0;b<W.length;++b){switch(typeof W[b]){case"number":G="B";break;case"string":G="C";break;case"boolean":G="L";break;case"object":G=W[b]instanceof Date?"D":"C";break;default:G="C"}M=Math.max(M,String(W[b]).length),O=O&&O!=G?"C":G}M>250&&(M=250),G=((w[_]||{}).DBF||{}).type,G=="C"&&w[_].DBF.len>M&&(M=w[_].DBF.len),O=="B"&&G=="N"&&(O="N",F[_]=w[_].DBF.dec,M=w[_].DBF.len),P[_]=O=="C"||G=="N"?M:a[O]||0,T+=P[_],k[_]=O}var Y=p.next(32);for(Y.write_shift(4,318902576),Y.write_shift(4,y.length),Y.write_shift(2,296+32*E),Y.write_shift(2,T),_=0;_<4;++_)Y.write_shift(4,0);for(Y.write_shift(4,0|(+e[pE]||3)<<8),_=0,b=0;_<m.length;++_)if(m[_]!=null){var ce=p.next(32),ve=(m[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ce.write_shift(1,ve,"sbcs"),ce.write_shift(1,k[_]=="?"?"C":k[_],"sbcs"),ce.write_shift(4,b),ce.write_shift(1,P[_]||a[k[_]]||0),ce.write_shift(1,F[_]||0),ce.write_shift(1,2),ce.write_shift(4,0),ce.write_shift(1,0),ce.write_shift(4,0),ce.write_shift(4,0),b+=P[_]||a[k[_]]||0}var Ce=p.next(264);for(Ce.write_shift(4,13),_=0;_<65;++_)Ce.write_shift(4,0);for(_=0;_<y.length;++_){var ke=p.next(T);for(ke.write_shift(1,0),b=0;b<m.length;++b)if(m[b]!=null)switch(k[b]){case"L":ke.write_shift(1,y[_][b]==null?63:y[_][b]?84:70);break;case"B":ke.write_shift(8,y[_][b]||0,"f");break;case"N":var J="0";for(typeof y[_][b]=="number"&&(J=y[_][b].toFixed(F[b]||0)),E=0;E<P[b]-J.length;++E)ke.write_shift(1,32);ke.write_shift(1,J,"sbcs");break;case"D":y[_][b]?(ke.write_shift(4,("0000"+y[_][b].getFullYear()).slice(-4),"sbcs"),ke.write_shift(2,("00"+(y[_][b].getMonth()+1)).slice(-2),"sbcs"),ke.write_shift(2,("00"+y[_][b].getDate()).slice(-2),"sbcs")):ke.write_shift(8,"00000000","sbcs");break;case"C":var ae=String(y[_][b]!=null?y[_][b]:"").slice(0,P[b]);for(ke.write_shift(1,ae,"sbcs"),E=0;E<P[b]-ae.length;++E)ke.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:r,to_sheet:i,from_sheet:o}})(),uL=(function(){var n={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Pn(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(m,y){var w=n[y];return typeof w=="number"?tw(w):w},i=function(m,y,w){var _=y.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return _==59?m:tw(_)};n["|"]=254;function r(m,y){switch(y.type){case"base64":return a(ss(m),y);case"binary":return a(m,y);case"buffer":return a(gt&&Buffer.isBuffer(m)?m.toString("binary"):pu(m),y);case"array":return a(nd(m),y)}throw new Error("Unrecognized type "+y.type)}function a(m,y){var w=m.split(/[\n\r]+/),_=-1,b=-1,E=0,T=0,S=[],k=[],P=null,F={},O=[],G=[],M=[],W=0,Y;for(+y.codepage>=0&&Yc(+y.codepage);E!==w.length;++E){W=0;var ce=w[E].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(e,t),ve=ce.replace(/;;/g,"\0").split(";").map(function(q){return q.replace(/\u0000/g,";")}),Ce=ve[0],ke;if(ce.length>0)switch(Ce){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ve[1].charAt(0)=="P"&&k.push(ce.slice(3).replace(/;;/g,";"));break;case"C":var J=!1,ae=!1,we=!1,Pe=!1,$e=-1,V=-1;for(T=1;T<ve.length;++T)switch(ve[T].charAt(0)){case"A":break;case"X":b=parseInt(ve[T].slice(1))-1,ae=!0;break;case"Y":for(_=parseInt(ve[T].slice(1))-1,ae||(b=0),Y=S.length;Y<=_;++Y)S[Y]=[];break;case"K":ke=ve[T].slice(1),ke.charAt(0)==='"'?ke=ke.slice(1,ke.length-1):ke==="TRUE"?ke=!0:ke==="FALSE"?ke=!1:isNaN(ns(ke))?isNaN(Jc(ke).getDate())||(ke=Jn(ke)):(ke=ns(ke),P!==null&&TE(P)&&(ke=kE(ke))),J=!0;break;case"E":Pe=!0;var N=lF(ve[T].slice(1),{r:_,c:b});S[_][b]=[S[_][b],N];break;case"S":we=!0,S[_][b]=[S[_][b],"S5S"];break;case"G":break;case"R":$e=parseInt(ve[T].slice(1))-1;break;case"C":V=parseInt(ve[T].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+ce)}if(J&&(S[_][b]&&S[_][b].length==2?S[_][b][0]=ke:S[_][b]=ke,P=null),we){if(Pe)throw new Error("SYLK shared formula cannot have own formula");var z=$e>-1&&S[$e][V];if(!z||!z[1])throw new Error("SYLK shared formula cannot find base");S[_][b][1]=cF(z[1],{r:_-$e,c:b-V})}break;case"F":var H=0;for(T=1;T<ve.length;++T)switch(ve[T].charAt(0)){case"X":b=parseInt(ve[T].slice(1))-1,++H;break;case"Y":for(_=parseInt(ve[T].slice(1))-1,Y=S.length;Y<=_;++Y)S[Y]=[];break;case"M":W=parseInt(ve[T].slice(1))/20;break;case"F":break;case"G":break;case"P":P=k[parseInt(ve[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(M=ve[T].slice(1).split(" "),Y=parseInt(M[0],10);Y<=parseInt(M[1],10);++Y)W=parseInt(M[2],10),G[Y-1]=W===0?{hidden:!0}:{wch:W},Em(G[Y-1]);break;case"C":b=parseInt(ve[T].slice(1))-1,G[b]||(G[b]={});break;case"R":_=parseInt(ve[T].slice(1))-1,O[_]||(O[_]={}),W>0?(O[_].hpt=W,O[_].hpx=vS(W)):W===0&&(O[_].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+ce)}H<1&&(P=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+ce)}}return O.length>0&&(F["!rows"]=O),G.length>0&&(F["!cols"]=G),y&&y.sheetRows&&(S=S.slice(0,y.sheetRows)),[S,F]}function o(m,y){var w=r(m,y),_=w[0],b=w[1],E=dl(_,y);return Pn(b).forEach(function(T){E[T]=b[T]}),E}function c(m,y){return Pa(o(m,y),y)}function h(m,y,w,_){var b="C;Y"+(w+1)+";X"+(_+1)+";K";switch(m.t){case"n":b+=m.v||0,m.f&&!m.F&&(b+=";E"+Am(m.f,{r:w,c:_}));break;case"b":b+=m.v?"TRUE":"FALSE";break;case"e":b+=m.w||m.v;break;case"d":b+='"'+(m.w||m.v)+'"';break;case"s":b+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function f(m,y){y.forEach(function(w,_){var b="F;W"+(_+1)+" "+(_+1)+" ";w.hidden?b+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=Mf(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=Lf(w.wpx)),typeof w.wch=="number"&&(b+=Math.round(w.wch))),b.charAt(b.length-1)!=" "&&m.push(b)})}function p(m,y){y.forEach(function(w,_){var b="F;";w.hidden?b+="M0;":w.hpt?b+="M"+20*w.hpt+";":w.hpx&&(b+="M"+20*Ff(w.hpx)+";"),b.length>2&&m.push(b+"R"+(_+1))})}function g(m,y){var w=["ID;PWXL;N;E"],_=[],b=It(m["!ref"]),E,T=Array.isArray(m),S=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),m["!cols"]&&f(w,m["!cols"]),m["!rows"]&&p(w,m["!rows"]),w.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var k=b.s.r;k<=b.e.r;++k)for(var P=b.s.c;P<=b.e.c;++P){var F=wt({r:k,c:P});E=T?(m[k]||[])[P]:m[F],!(!E||E.v==null&&(!E.f||E.F))&&_.push(h(E,m,k,P))}return w.join(S)+S+_.join(S)+S+"E"+S}return{to_workbook:c,to_sheet:o,from_sheet:g}})(),hL=(function(){function n(a,o){switch(o.type){case"base64":return e(ss(a),o);case"binary":return e(a,o);case"buffer":return e(gt&&Buffer.isBuffer(a)?a.toString("binary"):pu(a),o);case"array":return e(nd(a),o)}throw new Error("Unrecognized type "+o.type)}function e(a,o){for(var c=a.split(`
`),h=-1,f=-1,p=0,g=[];p!==c.length;++p){if(c[p].trim()==="BOT"){g[++h]=[],f=0;continue}if(!(h<0)){var m=c[p].trim().split(","),y=m[0],w=m[1];++p;for(var _=c[p]||"";(_.match(/["]/g)||[]).length&1&&p<c.length-1;)_+=`
`+c[++p];switch(_=_.trim(),+y){case-1:if(_==="BOT"){g[++h]=[],f=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?g[h][f]=!0:_==="FALSE"?g[h][f]=!1:isNaN(ns(w))?isNaN(Jc(w).getDate())?g[h][f]=w:g[h][f]=Jn(w):g[h][f]=ns(w),++f;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),g[h][f++]=_!==""?_:null;break}if(_==="EOD")break}}return o&&o.sheetRows&&(g=g.slice(0,o.sheetRows)),g}function t(a,o){return dl(n(a,o),o)}function i(a,o){return Pa(t(a,o),o)}var r=(function(){var a=function(h,f,p,g,m){h.push(f),h.push(p+","+g),h.push('"'+m.replace(/"/g,'""')+'"')},o=function(h,f,p,g){h.push(f+","+p),h.push(f==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(h){var f=[],p=It(h["!ref"]),g,m=Array.isArray(h);a(f,"TABLE",0,1,"sheetjs"),a(f,"VECTORS",0,p.e.r-p.s.r+1,""),a(f,"TUPLES",0,p.e.c-p.s.c+1,""),a(f,"DATA",0,0,"");for(var y=p.s.r;y<=p.e.r;++y){o(f,-1,0,"BOT");for(var w=p.s.c;w<=p.e.c;++w){var _=wt({r:y,c:w});if(g=m?(h[y]||[])[w]:h[_],!g){o(f,1,0,"");continue}switch(g.t){case"n":var b=g.w;!b&&g.v!=null&&(b=g.v),b==null?g.f&&!g.F?o(f,1,0,"="+g.f):o(f,1,0,""):o(f,0,b,"V");break;case"b":o(f,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":o(f,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=qs(g.z||Jt[14],ci(Jn(g.v)))),o(f,0,g.w,"V");break;default:o(f,1,0,"")}}}o(f,-1,0,"EOD");var E=`\r
`,T=f.join(E);return T}})();return{to_workbook:i,to_sheet:t,from_sheet:r}})(),dS=(function(){function n(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(g,m){for(var y=g.split(`
`),w=-1,_=-1,b=0,E=[];b!==y.length;++b){var T=y[b].trim().split(":");if(T[0]==="cell"){var S=bn(T[1]);if(E.length<=S.r)for(w=E.length;w<=S.r;++w)E[w]||(E[w]=[]);switch(w=S.r,_=S.c,T[2]){case"t":E[w][_]=n(T[3]);break;case"v":E[w][_]=+T[3];break;case"vtf":var k=T[T.length-1];case"vtc":T[3]==="nl"?E[w][_]=!!+T[4]:E[w][_]=+T[4],T[2]=="vtf"&&(E[w][_]=[E[w][_],k])}}}return m&&m.sheetRows&&(E=E.slice(0,m.sheetRows)),E}function i(g,m){return dl(t(g,m),m)}function r(g,m){return Pa(i(g,m),m)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function f(g){if(!g||!g["!ref"])return"";for(var m=[],y=[],w,_="",b=ki(g["!ref"]),E=Array.isArray(g),T=b.s.r;T<=b.e.r;++T)for(var S=b.s.c;S<=b.e.c;++S)if(_=wt({r:T,c:S}),w=E?(g[T]||[])[S]:g[_],!(!w||w.v==null||w.t==="z")){switch(y=["cell",_,"t"],w.t){case"s":case"str":y.push(e(w.v));break;case"n":w.f?(y[2]="vtf",y[3]="n",y[4]=w.v,y[5]=e(w.f)):(y[2]="v",y[3]=w.v);break;case"b":y[2]="vt"+(w.f?"f":"c"),y[3]="nl",y[4]=w.v?"1":"0",y[5]=e(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var k=ci(Jn(w.v));y[2]="vtc",y[3]="nd",y[4]=""+k,y[5]=w.w||qs(w.z||Jt[14],k);break;case"e":continue}m.push(y.join(":"))}return m.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function p(g){return[a,o,c,o,f(g),h].join(`
`)}return{to_workbook:r,to_sheet:i,from_sheet:p}})(),fL=(function(){function n(p,g,m,y,w){w.raw?g[m][y]=p:p===""||(p==="TRUE"?g[m][y]=!0:p==="FALSE"?g[m][y]=!1:isNaN(ns(p))?isNaN(Jc(p).getDate())?g[m][y]=p:g[m][y]=Jn(p):g[m][y]=ns(p))}function e(p,g){var m=g||{},y=[];if(!p||p.length===0)return y;for(var w=p.split(/[\r\n]/),_=w.length-1;_>=0&&w[_].length===0;)--_;for(var b=10,E=0,T=0;T<=_;++T)E=w[T].indexOf(" "),E==-1?E=w[T].length:E++,b=Math.max(b,E);for(T=0;T<=_;++T){y[T]=[];var S=0;for(n(w[T].slice(0,b).trim(),y,T,S,m),S=1;S<=(w[T].length-b)/10+1;++S)n(w[T].slice(b+(S-1)*10,b+S*10).trim(),y,T,S,m)}return m.sheetRows&&(y=y.slice(0,m.sheetRows)),y}var t={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function r(p){for(var g={},m=!1,y=0,w=0;y<p.length;++y)(w=p.charCodeAt(y))==34?m=!m:!m&&w in t&&(g[w]=(g[w]||0)+1);w=[];for(y in g)Object.prototype.hasOwnProperty.call(g,y)&&w.push([g[y],y]);if(!w.length){g=i;for(y in g)Object.prototype.hasOwnProperty.call(g,y)&&w.push([g[y],y])}return w.sort(function(_,b){return _[0]-b[0]||i[_[1]]-i[b[1]]}),t[w.pop()[1]]||44}function a(p,g){var m=g||{},y="",w=m.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(y=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(y=p.charAt(4),p=p.slice(6)):y=r(p.slice(0,1024)):m&&m.FS?y=m.FS:y=r(p.slice(0,1024));var b=0,E=0,T=0,S=0,k=0,P=y.charCodeAt(0),F=!1,O=0,G=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var M=m.dateNF!=null?R3(m.dateNF):null;function W(){var Y=p.slice(S,k),ce={};if(Y.charAt(0)=='"'&&Y.charAt(Y.length-1)=='"'&&(Y=Y.slice(1,-1).replace(/""/g,'"')),Y.length===0)ce.t="z";else if(m.raw)ce.t="s",ce.v=Y;else if(Y.trim().length===0)ce.t="s",ce.v=Y;else if(Y.charCodeAt(0)==61)Y.charCodeAt(1)==34&&Y.charCodeAt(Y.length-1)==34?(ce.t="s",ce.v=Y.slice(2,-1).replace(/""/g,'"')):uF(Y)?(ce.t="n",ce.f=Y.slice(1)):(ce.t="s",ce.v=Y);else if(Y=="TRUE")ce.t="b",ce.v=!0;else if(Y=="FALSE")ce.t="b",ce.v=!1;else if(!isNaN(T=ns(Y)))ce.t="n",m.cellText!==!1&&(ce.w=Y),ce.v=T;else if(!isNaN(Jc(Y).getDate())||M&&Y.match(M)){ce.z=m.dateNF||Jt[14];var ve=0;M&&Y.match(M)&&(Y=O3(Y,m.dateNF,Y.match(M)||[]),ve=1),m.cellDates?(ce.t="d",ce.v=Jn(Y,ve)):(ce.t="n",ce.v=ci(Jn(Y,ve))),m.cellText!==!1&&(ce.w=qs(ce.z,ce.v instanceof Date?ci(ce.v):ce.v)),m.cellNF||delete ce.z}else ce.t="s",ce.v=Y;if(ce.t=="z"||(m.dense?(w[b]||(w[b]=[]),w[b][E]=ce):w[wt({c:E,r:b})]=ce),S=k+1,G=p.charCodeAt(S),_.e.c<E&&(_.e.c=E),_.e.r<b&&(_.e.r=b),O==P)++E;else if(E=0,++b,m.sheetRows&&m.sheetRows<=b)return!0}e:for(;k<p.length;++k)switch(O=p.charCodeAt(k)){case 34:G===34&&(F=!F);break;case P:case 10:case 13:if(!F&&W())break e;break}return k-S>0&&W(),w["!ref"]=hn(_),w}function o(p,g){return!(g&&g.PRN)||g.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?a(p,g):dl(e(p,g),g)}function c(p,g){var m="",y=g.type=="string"?[0,0,0,0]:S6(p,g);switch(g.type){case"base64":m=ss(p);break;case"binary":m=p;break;case"buffer":g.codepage==65001?m=p.toString("utf8"):g.codepage&&typeof Sf<"u"||(m=gt&&Buffer.isBuffer(p)?p.toString("binary"):pu(p));break;case"array":m=nd(p);break;case"string":m=p;break;default:throw new Error("Unrecognized type "+g.type)}return y[0]==239&&y[1]==187&&y[2]==191?m=Rc(m.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?m=Rc(m):g.type=="binary"&&typeof Sf<"u",m.slice(0,19)=="socialcalc:version:"?dS.to_sheet(g.type=="string"?m:Rc(m),g):o(m,g)}function h(p,g){return Pa(c(p,g),g)}function f(p){for(var g=[],m=It(p["!ref"]),y,w=Array.isArray(p),_=m.s.r;_<=m.e.r;++_){for(var b=[],E=m.s.c;E<=m.e.c;++E){var T=wt({r:_,c:E});if(y=w?(p[_]||[])[E]:p[T],!y||y.v==null){b.push("          ");continue}for(var S=(y.w||(as(y),y.w)||"").slice(0,10);S.length<10;)S+=" ";b.push(S+(E===0?" ":""))}g.push(b.join(""))}return g.join(`
`)}return{to_workbook:h,to_sheet:c,from_sheet:f}})(),Nw=(function(){function n(N,z,H){if(N){Ai(N,N.l||0);for(var q=H.Enum||$e;N.l<N.length;){var oe=N.read_shift(2),me=q[oe]||q[65535],Re=N.read_shift(2),be=N.l+Re,Te=me.f&&me.f(N,Re,H);if(N.l=be,z(Te,me,oe))return}}}function e(N,z){switch(z.type){case"base64":return t(cr(ss(N)),z);case"binary":return t(cr(N),z);case"buffer":case"array":return t(N,z)}throw"Unsupported type "+z.type}function t(N,z){if(!N)return N;var H=z||{},q=H.dense?[]:{},oe="Sheet1",me="",Re=0,be={},Te=[],it=[],Je={s:{r:0,c:0},e:{r:0,c:0}},Qt=H.sheetRows||0;if(N[2]==0&&(N[3]==8||N[3]==9)&&N.length>=16&&N[14]==5&&N[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(N[2]==2)H.Enum=$e,n(N,function(Le,$n,fi){switch(fi){case 0:H.vers=Le,Le>=4096&&(H.qpro=!0);break;case 6:Je=Le;break;case 204:Le&&(me=Le);break;case 222:me=Le;break;case 15:case 51:H.qpro||(Le[1].v=Le[1].v.slice(1));case 13:case 14:case 16:fi==14&&(Le[2]&112)==112&&(Le[2]&15)>1&&(Le[2]&15)<15&&(Le[1].z=H.dateNF||Jt[14],H.cellDates&&(Le[1].t="d",Le[1].v=kE(Le[1].v))),H.qpro&&Le[3]>Re&&(q["!ref"]=hn(Je),be[oe]=q,Te.push(oe),q=H.dense?[]:{},Je={s:{r:0,c:0},e:{r:0,c:0}},Re=Le[3],oe=me||"Sheet"+(Re+1),me="");var Qi=H.dense?(q[Le[0].r]||[])[Le[0].c]:q[wt(Le[0])];if(Qi){Qi.t=Le[1].t,Qi.v=Le[1].v,Le[1].z!=null&&(Qi.z=Le[1].z),Le[1].f!=null&&(Qi.f=Le[1].f);break}H.dense?(q[Le[0].r]||(q[Le[0].r]=[]),q[Le[0].r][Le[0].c]=Le[1]):q[wt(Le[0])]=Le[1];break}},H);else if(N[2]==26||N[2]==14)H.Enum=V,N[2]==14&&(H.qpro=!0,N.l=0),n(N,function(Le,$n,fi){switch(fi){case 204:oe=Le;break;case 22:Le[1].v=Le[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Le[3]>Re&&(q["!ref"]=hn(Je),be[oe]=q,Te.push(oe),q=H.dense?[]:{},Je={s:{r:0,c:0},e:{r:0,c:0}},Re=Le[3],oe="Sheet"+(Re+1)),Qt>0&&Le[0].r>=Qt)break;H.dense?(q[Le[0].r]||(q[Le[0].r]=[]),q[Le[0].r][Le[0].c]=Le[1]):q[wt(Le[0])]=Le[1],Je.e.c<Le[0].c&&(Je.e.c=Le[0].c),Je.e.r<Le[0].r&&(Je.e.r=Le[0].r);break;case 27:Le[14e3]&&(it[Le[14e3][0]]=Le[14e3][1]);break;case 1537:it[Le[0]]=Le[1],Le[0]==Re&&(oe=Le[1]);break}},H);else throw new Error("Unrecognized LOTUS BOF "+N[2]);if(q["!ref"]=hn(Je),be[me||oe]=q,Te.push(me||oe),!it.length)return{SheetNames:Te,Sheets:be};for(var Ze={},hi=[],kt=0;kt<it.length;++kt)be[Te[kt]]?(hi.push(it[kt]||Te[kt]),Ze[it[kt]]=be[it[kt]]||be[Te[kt]]):(hi.push(it[kt]),Ze[it[kt]]={"!ref":"A1"});return{SheetNames:hi,Sheets:Ze}}function i(N,z){var H=z||{};if(+H.codepage>=0&&Yc(+H.codepage),H.type=="string")throw new Error("Cannot write WK1 to JS string");var q=li(),oe=It(N["!ref"]),me=Array.isArray(N),Re=[];Ae(q,0,a(1030)),Ae(q,6,h(oe));for(var be=Math.min(oe.e.r,8191),Te=oe.s.r;Te<=be;++Te)for(var it=In(Te),Je=oe.s.c;Je<=oe.e.c;++Je){Te===oe.s.r&&(Re[Je]=Hn(Je));var Qt=Re[Je]+it,Ze=me?(N[Te]||[])[Je]:N[Qt];if(!(!Ze||Ze.t=="z"))if(Ze.t=="n")(Ze.v|0)==Ze.v&&Ze.v>=-32768&&Ze.v<=32767?Ae(q,13,y(Te,Je,Ze.v)):Ae(q,14,_(Te,Je,Ze.v));else{var hi=as(Ze);Ae(q,15,g(Te,Je,hi.slice(0,239)))}}return Ae(q,1),q.end()}function r(N,z){var H=z||{};if(+H.codepage>=0&&Yc(+H.codepage),H.type=="string")throw new Error("Cannot write WK3 to JS string");var q=li();Ae(q,0,o(N));for(var oe=0,me=0;oe<N.SheetNames.length;++oe)(N.Sheets[N.SheetNames[oe]]||{})["!ref"]&&Ae(q,27,Pe(N.SheetNames[oe],me++));var Re=0;for(oe=0;oe<N.SheetNames.length;++oe){var be=N.Sheets[N.SheetNames[oe]];if(!(!be||!be["!ref"])){for(var Te=It(be["!ref"]),it=Array.isArray(be),Je=[],Qt=Math.min(Te.e.r,8191),Ze=Te.s.r;Ze<=Qt;++Ze)for(var hi=In(Ze),kt=Te.s.c;kt<=Te.e.c;++kt){Ze===Te.s.r&&(Je[kt]=Hn(kt));var Le=Je[kt]+hi,$n=it?(be[Ze]||[])[kt]:be[Le];if(!(!$n||$n.t=="z"))if($n.t=="n")Ae(q,23,W(Ze,kt,Re,$n.v));else{var fi=as($n);Ae(q,22,O(Ze,kt,Re,fi.slice(0,239)))}}++Re}}return Ae(q,1),q.end()}function a(N){var z=he(2);return z.write_shift(2,N),z}function o(N){var z=he(26);z.write_shift(2,4096),z.write_shift(2,4),z.write_shift(4,0);for(var H=0,q=0,oe=0,me=0;me<N.SheetNames.length;++me){var Re=N.SheetNames[me],be=N.Sheets[Re];if(!(!be||!be["!ref"])){++oe;var Te=ki(be["!ref"]);H<Te.e.r&&(H=Te.e.r),q<Te.e.c&&(q=Te.e.c)}}return H>8191&&(H=8191),z.write_shift(2,H),z.write_shift(1,oe),z.write_shift(1,q),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(1,1),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(4,0),z}function c(N,z,H){var q={s:{c:0,r:0},e:{c:0,r:0}};return z==8&&H.qpro?(q.s.c=N.read_shift(1),N.l++,q.s.r=N.read_shift(2),q.e.c=N.read_shift(1),N.l++,q.e.r=N.read_shift(2),q):(q.s.c=N.read_shift(2),q.s.r=N.read_shift(2),z==12&&H.qpro&&(N.l+=2),q.e.c=N.read_shift(2),q.e.r=N.read_shift(2),z==12&&H.qpro&&(N.l+=2),q.s.c==65535&&(q.s.c=q.e.c=q.s.r=q.e.r=0),q)}function h(N){var z=he(8);return z.write_shift(2,N.s.c),z.write_shift(2,N.s.r),z.write_shift(2,N.e.c),z.write_shift(2,N.e.r),z}function f(N,z,H){var q=[{c:0,r:0},{t:"n",v:0},0,0];return H.qpro&&H.vers!=20768?(q[0].c=N.read_shift(1),q[3]=N.read_shift(1),q[0].r=N.read_shift(2),N.l+=2):(q[2]=N.read_shift(1),q[0].c=N.read_shift(2),q[0].r=N.read_shift(2)),q}function p(N,z,H){var q=N.l+z,oe=f(N,z,H);if(oe[1].t="s",H.vers==20768){N.l++;var me=N.read_shift(1);return oe[1].v=N.read_shift(me,"utf8"),oe}return H.qpro&&N.l++,oe[1].v=N.read_shift(q-N.l,"cstr"),oe}function g(N,z,H){var q=he(7+H.length);q.write_shift(1,255),q.write_shift(2,z),q.write_shift(2,N),q.write_shift(1,39);for(var oe=0;oe<q.length;++oe){var me=H.charCodeAt(oe);q.write_shift(1,me>=128?95:me)}return q.write_shift(1,0),q}function m(N,z,H){var q=f(N,z,H);return q[1].v=N.read_shift(2,"i"),q}function y(N,z,H){var q=he(7);return q.write_shift(1,255),q.write_shift(2,z),q.write_shift(2,N),q.write_shift(2,H,"i"),q}function w(N,z,H){var q=f(N,z,H);return q[1].v=N.read_shift(8,"f"),q}function _(N,z,H){var q=he(13);return q.write_shift(1,255),q.write_shift(2,z),q.write_shift(2,N),q.write_shift(8,H,"f"),q}function b(N,z,H){var q=N.l+z,oe=f(N,z,H);if(oe[1].v=N.read_shift(8,"f"),H.qpro)N.l=q;else{var me=N.read_shift(2);k(N.slice(N.l,N.l+me),oe),N.l+=me}return oe}function E(N,z,H){var q=z&32768;return z&=-32769,z=(q?N:0)+(z>=8192?z-16384:z),(q?"":"$")+(H?Hn(z):In(z))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(N,z){Ai(N,0);for(var H=[],q=0,oe="",me="",Re="",be="";N.l<N.length;){var Te=N[N.l++];switch(Te){case 0:H.push(N.read_shift(8,"f"));break;case 1:me=E(z[0].c,N.read_shift(2),!0),oe=E(z[0].r,N.read_shift(2),!1),H.push(me+oe);break;case 2:{var it=E(z[0].c,N.read_shift(2),!0),Je=E(z[0].r,N.read_shift(2),!1);me=E(z[0].c,N.read_shift(2),!0),oe=E(z[0].r,N.read_shift(2),!1),H.push(it+Je+":"+me+oe)}break;case 3:if(N.l<N.length){console.error("WK1 premature formula end");return}break;case 4:H.push("("+H.pop()+")");break;case 5:H.push(N.read_shift(2));break;case 6:{for(var Qt="";Te=N[N.l++];)Qt+=String.fromCharCode(Te);H.push('"'+Qt.replace(/"/g,'""')+'"')}break;case 8:H.push("-"+H.pop());break;case 23:H.push("+"+H.pop());break;case 22:H.push("NOT("+H.pop()+")");break;case 20:case 21:be=H.pop(),Re=H.pop(),H.push(["AND","OR"][Te-20]+"("+Re+","+be+")");break;default:if(Te<32&&S[Te])be=H.pop(),Re=H.pop(),H.push(Re+S[Te]+be);else if(T[Te]){if(q=T[Te][1],q==69&&(q=N[N.l++]),q>H.length){console.error("WK1 bad formula parse 0x"+Te.toString(16)+":|"+H.join("|")+"|");return}var Ze=H.slice(-q);H.length-=q,H.push(T[Te][0]+"("+Ze.join(",")+")")}else return Te<=7?console.error("WK1 invalid opcode "+Te.toString(16)):Te<=24?console.error("WK1 unsupported op "+Te.toString(16)):Te<=30?console.error("WK1 invalid opcode "+Te.toString(16)):Te<=115?console.error("WK1 unsupported function opcode "+Te.toString(16)):console.error("WK1 unrecognized opcode "+Te.toString(16))}}H.length==1?z[1].f=""+H[0]:console.error("WK1 bad formula parse |"+H.join("|")+"|")}function P(N){var z=[{c:0,r:0},{t:"n",v:0},0];return z[0].r=N.read_shift(2),z[3]=N[N.l++],z[0].c=N[N.l++],z}function F(N,z){var H=P(N);return H[1].t="s",H[1].v=N.read_shift(z-4,"cstr"),H}function O(N,z,H,q){var oe=he(6+q.length);oe.write_shift(2,N),oe.write_shift(1,H),oe.write_shift(1,z),oe.write_shift(1,39);for(var me=0;me<q.length;++me){var Re=q.charCodeAt(me);oe.write_shift(1,Re>=128?95:Re)}return oe.write_shift(1,0),oe}function G(N,z){var H=P(N);H[1].v=N.read_shift(2);var q=H[1].v>>1;if(H[1].v&1)switch(q&7){case 0:q=(q>>3)*5e3;break;case 1:q=(q>>3)*500;break;case 2:q=(q>>3)/20;break;case 3:q=(q>>3)/200;break;case 4:q=(q>>3)/2e3;break;case 5:q=(q>>3)/2e4;break;case 6:q=(q>>3)/16;break;case 7:q=(q>>3)/64;break}return H[1].v=q,H}function M(N,z){var H=P(N),q=N.read_shift(4),oe=N.read_shift(4),me=N.read_shift(2);if(me==65535)return q===0&&oe===3221225472?(H[1].t="e",H[1].v=15):q===0&&oe===3489660928?(H[1].t="e",H[1].v=42):H[1].v=0,H;var Re=me&32768;return me=(me&32767)-16446,H[1].v=(1-Re*2)*(oe*Math.pow(2,me+32)+q*Math.pow(2,me)),H}function W(N,z,H,q){var oe=he(14);if(oe.write_shift(2,N),oe.write_shift(1,H),oe.write_shift(1,z),q==0)return oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(2,65535),oe;var me=0,Re=0,be=0,Te=0;return q<0&&(me=1,q=-q),Re=Math.log2(q)|0,q/=Math.pow(2,Re-31),Te=q>>>0,(Te&2147483648)==0&&(q/=2,++Re,Te=q>>>0),q-=Te,Te|=2147483648,Te>>>=0,q*=Math.pow(2,32),be=q>>>0,oe.write_shift(4,be),oe.write_shift(4,Te),Re+=16383+(me?32768:0),oe.write_shift(2,Re),oe}function Y(N,z){var H=M(N);return N.l+=z-14,H}function ce(N,z){var H=P(N),q=N.read_shift(4);return H[1].v=q>>6,H}function ve(N,z){var H=P(N),q=N.read_shift(8,"f");return H[1].v=q,H}function Ce(N,z){var H=ve(N);return N.l+=z-10,H}function ke(N,z){return N[N.l+z-1]==0?N.read_shift(z,"cstr"):""}function J(N,z){var H=N[N.l++];H>z-1&&(H=z-1);for(var q="";q.length<H;)q+=String.fromCharCode(N[N.l++]);return q}function ae(N,z,H){if(!(!H.qpro||z<21)){var q=N.read_shift(1);N.l+=17,N.l+=1,N.l+=2;var oe=N.read_shift(z-21,"cstr");return[q,oe]}}function we(N,z){for(var H={},q=N.l+z;N.l<q;){var oe=N.read_shift(2);if(oe==14e3){for(H[oe]=[0,""],H[oe][0]=N.read_shift(2);N[N.l];)H[oe][1]+=String.fromCharCode(N[N.l]),N.l++;N.l++}}return H}function Pe(N,z){var H=he(5+N.length);H.write_shift(2,14e3),H.write_shift(2,z);for(var q=0;q<N.length;++q){var oe=N.charCodeAt(q);H[H.l++]=oe>127?95:oe}return H[H.l++]=0,H}var $e={0:{n:"BOF",f:lS},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ke},222:{n:"SHEETNAMELP",f:J},65535:{n:""}},V={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:F},23:{n:"NUMBER17",f:M},24:{n:"NUMBER18",f:G},25:{n:"FORMULA19",f:Y},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:we},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ce},38:{n:"??"},39:{n:"NUMBER27",f:ve},40:{n:"FORMULA28",f:Ce},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ke},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ae},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:i,book_to_wk3:r,to_workbook:e}})(),dL=/^\s|\s$|[\t\n\r]/;function pS(n,e){if(!e.bookSST)return"";var t=[fn];t[t.length]=Se("sst",null,{xmlns:fl[0],count:n.Count,uniqueCount:n.Unique});for(var i=0;i!=n.length;++i)if(n[i]!=null){var r=n[i],a="<si>";r.r?a+=r.r:(a+="<t",r.t||(r.t=""),r.t.match(dL)&&(a+=' xml:space="preserve"'),a+=">"+xt(r.t)+"</t>"),a+="</si>",t[t.length]=a}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function pL(n){return[n.read_shift(4),n.read_shift(4)]}function gL(n,e){return e||(e=he(8)),e.write_shift(4,n.Count),e.write_shift(4,n.Unique),e}var mL=aM;function vL(n){var e=li();ye(e,159,gL(n));for(var t=0;t<n.length;++t)ye(e,19,mL(n[t]));return ye(e,160),e.end()}function yL(n){for(var e=[],t=n.split(""),i=0;i<t.length;++i)e[i]=t[i].charCodeAt(0);return e}function gS(n){var e=0,t,i=yL(n),r=i.length+1,a,o,c,h,f;for(t=Da(r),t[0]=i.length,a=1;a!=r;++a)t[a]=i[a-1];for(a=r-1;a>=0;--a)o=t[a],c=(e&16384)===0?0:1,h=e<<1&32767,f=c|h,e=f^o;return e^52811}var _L=(function(){function n(r,a){switch(a.type){case"base64":return e(ss(r),a);case"binary":return e(r,a);case"buffer":return e(gt&&Buffer.isBuffer(r)?r.toString("binary"):pu(r),a);case"array":return e(nd(r),a)}throw new Error("Unrecognized type "+a.type)}function e(r,a){var o=a||{},c=o.dense?[]:{},h=r.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(p,g){Array.isArray(c)&&(c[g]=[]);for(var m=/\\\w+\b/g,y=0,w,_=-1;w=m.exec(p);){switch(w[0]){case"\\cell":var b=p.slice(y,m.lastIndex-w[0].length);if(b[0]==" "&&(b=b.slice(1)),++_,b.length){var E={v:b,t:"s"};Array.isArray(c)?c[g][_]=E:c[wt({r:g,c:_})]=E}break}y=m.lastIndex}_>f.e.c&&(f.e.c=_)}),c["!ref"]=hn(f),c}function t(r,a){return Pa(n(r,a),a)}function i(r){for(var a=["{\\rtf1\\ansi"],o=It(r["!ref"]),c,h=Array.isArray(r),f=o.s.r;f<=o.e.r;++f){a.push("\\trowd\\trautofit1");for(var p=o.s.c;p<=o.e.c;++p)a.push("\\cellx"+(p+1));for(a.push("\\pard\\intbl"),p=o.s.c;p<=o.e.c;++p){var g=wt({r:f,c:p});c=h?(r[f]||[])[p]:r[g],!(!c||c.v==null&&(!c.f||c.F))&&(a.push(" "+(c.w||(as(c),c.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:t,to_sheet:n,from_sheet:i}})();function Mw(n){for(var e=0,t=1;e!=3;++e)t=t*256+(n[e]>255?255:n[e]<0?0:n[e]);return t.toString(16).toUpperCase().slice(1)}var xL=6,is=xL;function Mf(n){return Math.floor((n+Math.round(128/is)/256)*is)}function Lf(n){return Math.floor((n-5)/is*100+.5)/100}function Mg(n){return Math.round((n*is+5)/is*256)/256}function Em(n){n.width?(n.wpx=Mf(n.width),n.wch=Lf(n.wpx),n.MDW=is):n.wpx?(n.wch=Lf(n.wpx),n.width=Mg(n.wch),n.MDW=is):typeof n.wch=="number"&&(n.width=Mg(n.wch),n.wpx=Mf(n.width),n.MDW=is),n.customWidth&&delete n.customWidth}var wL=96,mS=wL;function Ff(n){return n*96/mS}function vS(n){return n*mS/96}function bL(n){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var i=t[0];i<=t[1];++i)n[i]!=null&&(e[e.length]=Se("numFmt",null,{numFmtId:i,formatCode:xt(n[i])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Se("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function EL(n){var e=[];return e[e.length]=Se("cellXfs",null),n.forEach(function(t){e[e.length]=Se("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Se("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function yS(n,e){var t=[fn,Se("styleSheet",null,{xmlns:fl[0],"xmlns:vt":wn.vt})],i;return n.SSF&&(i=bL(n.SSF))!=null&&(t[t.length]=i),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=EL(e.cellXfs))&&(t[t.length]=i),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function SL(n,e){var t=n.read_shift(2),i=zn(n);return[t,i]}function AL(n,e,t){t||(t=he(6+4*e.length)),t.write_shift(2,n),En(e,t);var i=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),i}function TL(n,e,t){var i={};i.sz=n.read_shift(2)/20;var r=dM(n);r.fItalic&&(i.italic=1),r.fCondense&&(i.condense=1),r.fExtend&&(i.extend=1),r.fShadow&&(i.shadow=1),r.fOutline&&(i.outline=1),r.fStrikeout&&(i.strike=1);var a=n.read_shift(2);switch(a===700&&(i.bold=1),n.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var o=n.read_shift(1);o!=0&&(i.underline=o);var c=n.read_shift(1);c>0&&(i.family=c);var h=n.read_shift(1);switch(h>0&&(i.charset=h),n.l++,i.color=fM(n),n.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=zn(n),i}function CL(n,e){e||(e=he(153)),e.write_shift(2,n.sz*20),pM(n,e),e.write_shift(2,n.bold?700:400);var t=0;n.vertAlign=="superscript"?t=1:n.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,n.underline||0),e.write_shift(1,n.family||0),e.write_shift(1,n.charset||0),e.write_shift(1,0),Df(n.color,e);var i=0;return i=2,e.write_shift(1,i),En(n.name,e),e.length>e.l?e.slice(0,e.l):e}var RL=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Kp,OL=kr;function Lw(n,e){e||(e=he(84)),Kp||(Kp=hm(RL));var t=Kp[n.patternType];t==null&&(t=40),e.write_shift(4,t);var i=0;if(t!=40)for(Df({auto:1},e),Df({auto:1},e);i<12;++i)e.write_shift(4,0);else{for(;i<4;++i)e.write_shift(4,0);for(;i<12;++i)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function kL(n,e){var t=n.l+e,i=n.read_shift(2),r=n.read_shift(2);return n.l=t,{ixfe:i,numFmtId:r}}function _S(n,e,t){t||(t=he(16)),t.write_shift(2,e||0),t.write_shift(2,n.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var i=0;return t.write_shift(1,i),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function vc(n,e){return e||(e=he(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var DL=kr;function NL(n,e){return e||(e=he(51)),e.write_shift(1,0),vc(null,e),vc(null,e),vc(null,e),vc(null,e),vc(null,e),e.length>e.l?e.slice(0,e.l):e}function ML(n,e){return e||(e=he(52)),e.write_shift(4,n.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),kf(n.name||"",e),e.length>e.l?e.slice(0,e.l):e}function LL(n,e,t){var i=he(2052);return i.write_shift(4,n),kf(e,i),kf(t,i),i.length>i.l?i.slice(0,i.l):i}function FL(n,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var r=i[0];r<=i[1];++r)e[r]!=null&&++t}),t!=0&&(ye(n,615,hr(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var r=i[0];r<=i[1];++r)e[r]!=null&&ye(n,44,AL(r,e[r]))}),ye(n,616))}}function IL(n){var e=1;ye(n,611,hr(e)),ye(n,43,CL({sz:12,color:{theme:1},name:"Calibri",family:2})),ye(n,612)}function PL(n){var e=2;ye(n,603,hr(e)),ye(n,45,Lw({patternType:"none"})),ye(n,45,Lw({patternType:"gray125"})),ye(n,604)}function BL(n){var e=1;ye(n,613,hr(e)),ye(n,46,NL()),ye(n,614)}function UL(n){var e=1;ye(n,626,hr(e)),ye(n,47,_S({numFmtId:0},65535)),ye(n,627)}function jL(n,e){ye(n,617,hr(e.length)),e.forEach(function(t){ye(n,47,_S(t,0))}),ye(n,618)}function HL(n){var e=1;ye(n,619,hr(e)),ye(n,48,ML({xfId:0,name:"Normal"})),ye(n,620)}function zL(n){var e=0;ye(n,505,hr(e)),ye(n,506)}function $L(n){var e=0;ye(n,508,LL(e,"TableStyleMedium9","PivotStyleMedium4")),ye(n,509)}function GL(n,e){var t=li();return ye(t,278),FL(t,n.SSF),IL(t),PL(t),BL(t),UL(t),jL(t,e.cellXfs),HL(t),zL(t),$L(t),ye(t,279),t.end()}function xS(n,e){if(e&&e.themeXLSX)return e.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var t=[fn];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function VL(n,e){return{flags:n.read_shift(4),version:n.read_shift(4),name:zn(n)}}function qL(n){var e=he(12+2*n.name.length);return e.write_shift(4,n.flags),e.write_shift(4,n.version),En(n.name,e),e.slice(0,e.l)}function WL(n){for(var e=[],t=n.read_shift(4);t-- >0;)e.push([n.read_shift(4),n.read_shift(4)]);return e}function XL(n){var e=he(4+8*n.length);e.write_shift(4,n.length);for(var t=0;t<n.length;++t)e.write_shift(4,n[t][0]),e.write_shift(4,n[t][1]);return e}function YL(n,e){var t=he(8+2*e.length);return t.write_shift(4,n),En(e,t),t.slice(0,t.l)}function KL(n){return n.l+=4,n.read_shift(4)!=0}function JL(n,e){var t=he(8);return t.write_shift(4,n),t.write_shift(4,1),t}function QL(){var n=li();return ye(n,332),ye(n,334,hr(1)),ye(n,335,qL({name:"XLDAPR",version:12e4,flags:3496657072})),ye(n,336),ye(n,339,YL(1,"XLDAPR")),ye(n,52),ye(n,35,hr(514)),ye(n,4096,hr(0)),ye(n,4097,Xi(1)),ye(n,36),ye(n,53),ye(n,340),ye(n,337,JL(1)),ye(n,51,XL([[1,0]])),ye(n,338),ye(n,333),n.end()}function wS(){var n=[fn];return n.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),n.join("")}function ZL(n){var e={};e.i=n.read_shift(4);var t={};t.r=n.read_shift(4),t.c=n.read_shift(4),e.r=wt(t);var i=n.read_shift(1);return i&2&&(e.l="1"),i&8&&(e.a="1"),e}var Jo=1024;function bS(n,e){for(var t=[21600,21600],i=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),r=[Se("xml",null,{"xmlns:v":Ti.v,"xmlns:o":Ti.o,"xmlns:x":Ti.x,"xmlns:mv":Ti.mv}).replace(/\/>/,">"),Se("o:shapelayout",Se("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"}),Se("v:shapetype",[Se("v:stroke",null,{joinstyle:"miter"}),Se("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:i})];Jo<n*1e3;)Jo+=1e3;return e.forEach(function(a){var o=bn(a[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var h=c.type=="gradient"?Se("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=Se("v:fill",h,c),p={on:"t",obscured:"t"};++Jo,r=r.concat(["<v:shape"+Zc({id:"_x0000_s"+Jo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,Se("v:shadow",null,p),Se("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Fn("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Fn("x:AutoFill","False"),Fn("x:Row",String(o.r)),Fn("x:Column",String(o.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),r.push("</xml>"),r.join("")}function ES(n){var e=[fn,Se("comments",null,{xmlns:fl[0]})],t=[];return e.push("<authors>"),n.forEach(function(i){i[1].forEach(function(r){var a=xt(r.a);t.indexOf(a)==-1&&(t.push(a),e.push("<author>"+a+"</author>")),r.T&&r.ID&&t.indexOf("tc="+r.ID)==-1&&(t.push("tc="+r.ID),e.push("<author>tc="+r.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),n.forEach(function(i){var r=0,a=[];if(i[1][0]&&i[1][0].T&&i[1][0].ID?r=t.indexOf("tc="+i[1][0].ID):i[1].forEach(function(h){h.a&&(r=t.indexOf(xt(h.a))),a.push(h.t||"")}),e.push('<comment ref="'+i[0]+'" authorId="'+r+'"><text>'),a.length<=1)e.push(Fn("t",xt(a[0]||"")));else{for(var o=`Comment:
    `+a[0]+`
`,c=1;c<a.length;++c)o+=`Reply:
    `+a[c]+`
`;e.push(Fn("t",xt(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function eF(n,e,t){var i=[fn,Se("ThreadedComments",null,{xmlns:wn.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(r){var a="";(r[1]||[]).forEach(function(o,c){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var h={ref:r[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};c==0?a=h.id:h.parentId=a,o.ID=h.id,o.a&&(h.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),i.push(Se("threadedComment",Fn("text",o.t||""),h))})}),i.push("</ThreadedComments>"),i.join("")}function tF(n){var e=[fn,Se("personList",null,{xmlns:wn.TCMNT,"xmlns:x":fl[0]}).replace(/[\/]>/,">")];return n.forEach(function(t,i){e.push(Se("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function nF(n){var e={};e.iauthor=n.read_shift(4);var t=Ha(n);return e.rfx=t.s,e.ref=wt(t.s),n.l+=16,e}function iF(n,e){return e==null&&(e=he(36)),e.write_shift(4,n[1].iauthor),pl(n[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var rF=zn;function sF(n){return En(n.slice(0,54))}function aF(n){var e=li(),t=[];return ye(e,628),ye(e,630),n.forEach(function(i){i[1].forEach(function(r){t.indexOf(r.a)>-1||(t.push(r.a.slice(0,54)),ye(e,632,sF(r.a)))})}),ye(e,631),ye(e,633),n.forEach(function(i){i[1].forEach(function(r){r.iauthor=t.indexOf(r.a);var a={s:bn(i[0]),e:bn(i[0])};ye(e,635,iF([a,r])),r.t&&r.t.length>0&&ye(e,637,lM(r)),ye(e,636),delete r.iauthor})}),ye(e,634),ye(e,629),e.end()}function oF(n,e){e.FullPaths.forEach(function(t,i){if(i!=0){var r=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");r.slice(-1)!=="/"&&Tt.utils.cfb_add(n,r,e.FileIndex[i].content)}})}var SS=["xlsb","xlsm","xlam","biff8","xla"],lF=(function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(i,r,a,o){var c=!1,h=!1;a.length==0?h=!0:a.charAt(0)=="["&&(h=!0,a=a.slice(1,-1)),o.length==0?c=!0:o.charAt(0)=="["&&(c=!0,o=o.slice(1,-1));var f=a.length>0?parseInt(a,10)|0:0,p=o.length>0?parseInt(o,10)|0:0;return c?p+=e.c:--p,h?f+=e.r:--f,r+(c?"":"$")+Hn(p)+(h?"":"$")+In(f)}return function(r,a){return e=a,r.replace(n,t)}})(),Sm=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Am=(function(){return function(e,t){return e.replace(Sm,function(i,r,a,o,c,h){var f=ym(o)-(a?0:t.c),p=vm(h)-(c?0:t.r),g=p==0?"":c?p+1:"["+p+"]",m=f==0?"":a?f+1:"["+f+"]";return r+"R"+g+"C"+m})}})();function cF(n,e){return n.replace(Sm,function(t,i,r,a,o,c){return i+(r=="$"?r+a:Hn(ym(a)+e.c))+(o=="$"?o+c:In(vm(c)+e.r))})}function uF(n){return n.length!=1}function ln(n){n.l+=1}function Ws(n,e){var t=n.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function AS(n,e,t){var i=2;if(t){if(t.biff>=2&&t.biff<=5)return TS(n);t.biff==12&&(i=4)}var r=n.read_shift(i),a=n.read_shift(i),o=Ws(n),c=Ws(n);return{s:{r,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:c[0],cRel:c[1],rRel:c[2]}}}function TS(n){var e=Ws(n),t=Ws(n),i=n.read_shift(1),r=n.read_shift(1);return{s:{r:e[0],c:i,cRel:e[1],rRel:e[2]},e:{r:t[0],c:r,cRel:t[1],rRel:t[2]}}}function hF(n,e,t){if(t.biff<8)return TS(n);var i=n.read_shift(t.biff==12?4:2),r=n.read_shift(t.biff==12?4:2),a=Ws(n),o=Ws(n);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r,c:o[0],cRel:o[1],rRel:o[2]}}}function CS(n,e,t){if(t&&t.biff>=2&&t.biff<=5)return fF(n);var i=n.read_shift(t&&t.biff==12?4:2),r=Ws(n);return{r:i,c:r[0],cRel:r[1],rRel:r[2]}}function fF(n){var e=Ws(n),t=n.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function dF(n){var e=n.read_shift(2),t=n.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function pF(n,e,t){var i=t&&t.biff?t.biff:8;if(i>=2&&i<=5)return gF(n);var r=n.read_shift(i>=12?4:2),a=n.read_shift(2),o=(a&16384)>>14,c=(a&32768)>>15;if(a&=16383,c==1)for(;r>524287;)r-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r,c:a,cRel:o,rRel:c}}function gF(n){var e=n.read_shift(2),t=n.read_shift(1),i=(e&32768)>>15,r=(e&16384)>>14;return e&=16383,i==1&&e>=8192&&(e=e-16384),r==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:r,rRel:i}}function mF(n,e,t){var i=(n[n.l++]&96)>>5,r=AS(n,t.biff>=2&&t.biff<=5?6:8,t);return[i,r]}function vF(n,e,t){var i=(n[n.l++]&96)>>5,r=n.read_shift(2,"i"),a=8;if(t)switch(t.biff){case 5:n.l+=12,a=6;break;case 12:a=12;break}var o=AS(n,a,t);return[i,r,o]}function yF(n,e,t){var i=(n[n.l++]&96)>>5;return n.l+=t&&t.biff>8?12:t.biff<8?6:8,[i]}function _F(n,e,t){var i=(n[n.l++]&96)>>5,r=n.read_shift(2),a=8;if(t)switch(t.biff){case 5:n.l+=12,a=6;break;case 12:a=12;break}return n.l+=a,[i,r]}function xF(n,e,t){var i=(n[n.l++]&96)>>5,r=hF(n,e-1,t);return[i,r]}function wF(n,e,t){var i=(n[n.l++]&96)>>5;return n.l+=t.biff==2?6:t.biff==12?14:7,[i]}function Fw(n){var e=n[n.l+1]&1,t=1;return n.l+=4,[e,t]}function bF(n,e,t){n.l+=2;for(var i=n.read_shift(t&&t.biff==2?1:2),r=[],a=0;a<=i;++a)r.push(n.read_shift(t&&t.biff==2?1:2));return r}function EF(n,e,t){var i=n[n.l+1]&255?1:0;return n.l+=2,[i,n.read_shift(t&&t.biff==2?1:2)]}function SF(n,e,t){var i=n[n.l+1]&255?1:0;return n.l+=2,[i,n.read_shift(t&&t.biff==2?1:2)]}function AF(n){var e=n[n.l+1]&255?1:0;return n.l+=2,[e,n.read_shift(2)]}function TF(n,e,t){var i=n[n.l+1]&255?1:0;return n.l+=t&&t.biff==2?3:4,[i]}function RS(n){var e=n.read_shift(1),t=n.read_shift(1);return[e,t]}function CF(n){return n.read_shift(2),RS(n)}function RF(n){return n.read_shift(2),RS(n)}function OF(n,e,t){var i=(n[n.l]&96)>>5;n.l+=1;var r=CS(n,0,t);return[i,r]}function kF(n,e,t){var i=(n[n.l]&96)>>5;n.l+=1;var r=pF(n,0,t);return[i,r]}function DF(n,e,t){var i=(n[n.l]&96)>>5;n.l+=1;var r=n.read_shift(2);t&&t.biff==5&&(n.l+=12);var a=CS(n,0,t);return[i,r,a]}function NF(n,e,t){var i=(n[n.l]&96)>>5;n.l+=1;var r=n.read_shift(t&&t.biff<=3?1:2);return[NI[r],DS[r],i]}function MF(n,e,t){var i=n[n.l++],r=n.read_shift(1),a=t&&t.biff<=3?[i==88?-1:0,n.read_shift(1)]:LF(n);return[r,(a[0]===0?DS:DI)[a[1]]]}function LF(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function FF(n,e,t){n.l+=t&&t.biff==2?3:4}function IF(n,e,t){if(n.l++,t&&t.biff==12)return[n.read_shift(4,"i"),0];var i=n.read_shift(2),r=n.read_shift(t&&t.biff==2?1:2);return[i,r]}function PF(n){return n.l++,vu[n.read_shift(1)]}function BF(n){return n.l++,n.read_shift(2)}function UF(n){return n.l++,n.read_shift(1)!==0}function jF(n){return n.l++,gl(n)}function HF(n,e,t){return n.l++,uS(n,e-1,t)}function zF(n,e){var t=[n.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=DM(n,1)?"TRUE":"FALSE",e!=12&&(n.l+=7);break;case 37:case 16:t[1]=vu[n[n.l]],n.l+=e==12?4:8;break;case 0:n.l+=8;break;case 1:t[1]=gl(n);break;case 2:t[1]=FM(n,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function $F(n,e,t){for(var i=n.read_shift(t.biff==12?4:2),r=[],a=0;a!=i;++a)r.push((t.biff==12?Ha:BM)(n));return r}function GF(n,e,t){var i=0,r=0;t.biff==12?(i=n.read_shift(4),r=n.read_shift(4)):(r=1+n.read_shift(1),i=1+n.read_shift(2)),t.biff>=2&&t.biff<8&&(--i,--r==0&&(r=256));for(var a=0,o=[];a!=i&&(o[a]=[]);++a)for(var c=0;c!=r;++c)o[a][c]=zF(n,t.biff);return o}function VF(n,e,t){var i=n.read_shift(1)>>>5&3,r=!t||t.biff>=8?4:2,a=n.read_shift(r);switch(t.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[i,0,a]}function qF(n,e,t){if(t.biff==5)return WF(n);var i=n.read_shift(1)>>>5&3,r=n.read_shift(2),a=n.read_shift(4);return[i,r,a]}function WF(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2,"i");n.l+=8;var i=n.read_shift(2);return n.l+=12,[e,t,i]}function XF(n,e,t){var i=n.read_shift(1)>>>5&3;n.l+=t&&t.biff==2?3:4;var r=n.read_shift(t&&t.biff==2?1:2);return[i,r]}function YF(n,e,t){var i=n.read_shift(1)>>>5&3,r=n.read_shift(t&&t.biff==2?1:2);return[i,r]}function KF(n,e,t){var i=n.read_shift(1)>>>5&3;return n.l+=4,t.biff<8&&n.l--,t.biff==12&&(n.l+=2),[i]}function JF(n,e,t){var i=(n[n.l++]&96)>>5,r=n.read_shift(2),a=4;if(t)switch(t.biff){case 5:a=15;break;case 12:a=6;break}return n.l+=a,[i,r]}var QF=kr,ZF=kr,eI=kr;function yu(n,e,t){return n.l+=2,[dF(n)]}function Tm(n){return n.l+=6,[]}var tI=yu,nI=Tm,iI=Tm,rI=yu;function OS(n){return n.l+=2,[lS(n),n.read_shift(2)&1]}var sI=yu,aI=OS,oI=Tm,lI=yu,cI=yu,uI=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function hI(n){n.l+=2;var e=n.read_shift(2),t=n.read_shift(2),i=n.read_shift(4),r=n.read_shift(2),a=n.read_shift(2),o=uI[t>>2&31];return{ixti:e,coltype:t&3,rt:o,idx:i,c:r,C:a}}function fI(n){return n.l+=2,[n.read_shift(4)]}function dI(n,e,t){return n.l+=5,n.l+=2,n.l+=t.biff==2?1:4,["PTGSHEET"]}function pI(n,e,t){return n.l+=t.biff==2?4:5,["PTGENDSHEET"]}function gI(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function mI(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function vI(n){return n.l+=4,[0,0]}var Iw={1:{n:"PtgExp",f:IF},2:{n:"PtgTbl",f:eI},3:{n:"PtgAdd",f:ln},4:{n:"PtgSub",f:ln},5:{n:"PtgMul",f:ln},6:{n:"PtgDiv",f:ln},7:{n:"PtgPower",f:ln},8:{n:"PtgConcat",f:ln},9:{n:"PtgLt",f:ln},10:{n:"PtgLe",f:ln},11:{n:"PtgEq",f:ln},12:{n:"PtgGe",f:ln},13:{n:"PtgGt",f:ln},14:{n:"PtgNe",f:ln},15:{n:"PtgIsect",f:ln},16:{n:"PtgUnion",f:ln},17:{n:"PtgRange",f:ln},18:{n:"PtgUplus",f:ln},19:{n:"PtgUminus",f:ln},20:{n:"PtgPercent",f:ln},21:{n:"PtgParen",f:ln},22:{n:"PtgMissArg",f:ln},23:{n:"PtgStr",f:HF},26:{n:"PtgSheet",f:dI},27:{n:"PtgEndSheet",f:pI},28:{n:"PtgErr",f:PF},29:{n:"PtgBool",f:UF},30:{n:"PtgInt",f:BF},31:{n:"PtgNum",f:jF},32:{n:"PtgArray",f:wF},33:{n:"PtgFunc",f:NF},34:{n:"PtgFuncVar",f:MF},35:{n:"PtgName",f:VF},36:{n:"PtgRef",f:OF},37:{n:"PtgArea",f:mF},38:{n:"PtgMemArea",f:XF},39:{n:"PtgMemErr",f:QF},40:{n:"PtgMemNoMem",f:ZF},41:{n:"PtgMemFunc",f:YF},42:{n:"PtgRefErr",f:KF},43:{n:"PtgAreaErr",f:yF},44:{n:"PtgRefN",f:kF},45:{n:"PtgAreaN",f:xF},46:{n:"PtgMemAreaN",f:gI},47:{n:"PtgMemNoMemN",f:mI},57:{n:"PtgNameX",f:qF},58:{n:"PtgRef3d",f:DF},59:{n:"PtgArea3d",f:vF},60:{n:"PtgRefErr3d",f:JF},61:{n:"PtgAreaErr3d",f:_F},255:{}},yI={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},_I={1:{n:"PtgElfLel",f:OS},2:{n:"PtgElfRw",f:lI},3:{n:"PtgElfCol",f:tI},6:{n:"PtgElfRwV",f:cI},7:{n:"PtgElfColV",f:rI},10:{n:"PtgElfRadical",f:sI},11:{n:"PtgElfRadicalS",f:oI},13:{n:"PtgElfColS",f:nI},15:{n:"PtgElfColSV",f:iI},16:{n:"PtgElfRadicalLel",f:aI},25:{n:"PtgList",f:hI},29:{n:"PtgSxName",f:fI},255:{}},xI={0:{n:"PtgAttrNoop",f:vI},1:{n:"PtgAttrSemi",f:TF},2:{n:"PtgAttrIf",f:SF},4:{n:"PtgAttrChoose",f:bF},8:{n:"PtgAttrGoto",f:EF},16:{n:"PtgAttrSum",f:FF},32:{n:"PtgAttrBaxcel",f:Fw},33:{n:"PtgAttrBaxcel",f:Fw},64:{n:"PtgAttrSpace",f:CF},65:{n:"PtgAttrSpaceSemi",f:RF},128:{n:"PtgAttrIfError",f:AF},255:{}};function wI(n,e,t,i){if(i.biff<8)return kr(n,e);for(var r=n.l+e,a=[],o=0;o!==t.length;++o)switch(t[o][0]){case"PtgArray":t[o][1]=GF(n,0,i),a.push(t[o][1]);break;case"PtgMemArea":t[o][2]=$F(n,t[o][1],i),a.push(t[o][2]);break;case"PtgExp":i&&i.biff==12&&(t[o][1][1]=n.read_shift(4),a.push(t[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[o][0]}return e=r-n.l,e!==0&&a.push(kr(n,e)),a}function bI(n,e,t){for(var i=n.l+e,r,a,o=[];i!=n.l;)e=i-n.l,a=n[n.l],r=Iw[a]||Iw[yI[a]],(a===24||a===25)&&(r=(a===24?_I:xI)[n[n.l+1]]),!r||!r.f?kr(n,e):o.push([r.n,r.f(n,e,t)]);return o}function EI(n){for(var e=[],t=0;t<n.length;++t){for(var i=n[t],r=[],a=0;a<i.length;++a){var o=i[a];o?o[0]===2?r.push('"'+o[1].replace(/"/g,'""')+'"'):r.push(o[1]):r.push("")}e.push(r.join(","))}return e.join(";")}var SI={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function AI(n,e){if(!n&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n+"'":n}function kS(n,e,t){if(!n)return"SH33TJSERR0";if(t.biff>8&&(!n.XTI||!n.XTI[e]))return n.SheetNames[e];if(!n.XTI)return"SH33TJSERR6";var i=n.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":n.XTI[e-1];if(!i)return"SH33TJSERR1";var r="";if(t.biff>8)switch(n[i[0]][0]){case 357:return r=i[1]==-1?"#REF":n.SheetNames[i[1]],i[1]==i[2]?r:r+":"+n.SheetNames[i[2]];case 358:return t.SID!=null?n.SheetNames[t.SID]:"SH33TJSSAME"+n[i[0]][0];default:return"SH33TJSSRC"+n[i[0]][0]}switch(n[i[0]][0][0]){case 1025:return r=i[1]==-1?"#REF":n.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?r:r+":"+n.SheetNames[i[2]];case 14849:return n[i[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return n[i[0]][0][3]?(r=i[1]==-1?"#REF":n[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?r:r+":"+n[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function Pw(n,e,t){var i=kS(n,e,t);return i=="#REF"?i:AI(i,t)}function cl(n,e,t,i,r){var a=r&&r.biff||8,o={s:{c:0,r:0}},c=[],h,f,p,g=0,m=0,y,w="";if(!n[0]||!n[0][0])return"";for(var _=-1,b="",E=0,T=n[0].length;E<T;++E){var S=n[0][E];switch(S[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=c.pop(),f=c.pop(),_>=0){switch(n[0][_][1][0]){case 0:b=Kt(" ",n[0][_][1][1]);break;case 1:b=Kt("\r",n[0][_][1][1]);break;default:if(b="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][_][1][0])}f=f+b,_=-1}c.push(f+SI[S[0]]+h);break;case"PtgIsect":h=c.pop(),f=c.pop(),c.push(f+" "+h);break;case"PtgUnion":h=c.pop(),f=c.pop(),c.push(f+","+h);break;case"PtgRange":h=c.pop(),f=c.pop(),c.push(f+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=kc(S[1][1],o,r),c.push(Dc(p,a));break;case"PtgRefN":p=t?kc(S[1][1],t,r):S[1][1],c.push(Dc(p,a));break;case"PtgRef3d":g=S[1][1],p=kc(S[1][2],o,r),w=Pw(i,g,r),c.push(w+"!"+Dc(p,a));break;case"PtgFunc":case"PtgFuncVar":var k=S[1][0],P=S[1][1];k||(k=0),k&=127;var F=k==0?[]:c.slice(-k);c.length-=k,P==="User"&&(P=F.shift()),c.push(P+"("+F.join(",")+")");break;case"PtgBool":c.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(S[1]);break;case"PtgNum":c.push(String(S[1]));break;case"PtgStr":c.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(S[1]);break;case"PtgAreaN":y=ww(S[1][1],t?{s:t}:o,r),c.push(Xp(y,r));break;case"PtgArea":y=ww(S[1][1],o,r),c.push(Xp(y,r));break;case"PtgArea3d":g=S[1][1],y=S[1][2],w=Pw(i,g,r),c.push(w+"!"+Xp(y,r));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=S[1][2];var O=(i.names||[])[m-1]||(i[0]||[])[m],G=O?O.Name:"SH33TJSNAME"+String(m);G&&G.slice(0,6)=="_xlfn."&&!r.xlfn&&(G=G.slice(6)),c.push(G);break;case"PtgNameX":var M=S[1][1];m=S[1][2];var W;if(r.biff<=5)M<0&&(M=-M),i[M]&&(W=i[M][m]);else{var Y="";if(((i[M]||[])[0]||[])[0]==14849||(((i[M]||[])[0]||[])[0]==1025?i[M][m]&&i[M][m].itab>0&&(Y=i.SheetNames[i[M][m].itab-1]+"!"):Y=i.SheetNames[m-1]+"!"),i[M]&&i[M][m])Y+=i[M][m].Name;else if(i[0]&&i[0][m])Y+=i[0][m].Name;else{var ce=(kS(i,M,r)||"").split(";;");ce[m-1]?Y=ce[m-1]:Y+="SH33TJSERRX"}c.push(Y);break}W||(W={Name:"SH33TJSERRY"}),c.push(W.Name);break;case"PtgParen":var ve="(",Ce=")";if(_>=0){switch(b="",n[0][_][1][0]){case 2:ve=Kt(" ",n[0][_][1][1])+ve;break;case 3:ve=Kt("\r",n[0][_][1][1])+ve;break;case 4:Ce=Kt(" ",n[0][_][1][1])+Ce;break;case 5:Ce=Kt("\r",n[0][_][1][1])+Ce;break;default:if(r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][_][1][0])}_=-1}c.push(ve+c.pop()+Ce);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":p={c:S[1][1],r:S[1][0]};var ke={c:t.c,r:t.r};if(i.sharedf[wt(p)]){var J=i.sharedf[wt(p)];c.push(cl(J,o,ke,i,r))}else{var ae=!1;for(h=0;h!=i.arrayf.length;++h)if(f=i.arrayf[h],!(p.c<f[0].s.c||p.c>f[0].e.c)&&!(p.r<f[0].s.r||p.r>f[0].e.r)){c.push(cl(f[1],o,ke,i,r)),ae=!0;break}ae||c.push(S[1])}break;case"PtgArray":c.push("{"+EI(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var we=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(r.biff!=3&&_>=0&&we.indexOf(n[0][E][0])==-1){S=n[0][_];var Pe=!0;switch(S[1][0]){case 4:Pe=!1;case 0:b=Kt(" ",S[1][1]);break;case 5:Pe=!1;case 1:b=Kt("\r",S[1][1]);break;default:if(b="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}c.push((Pe?b:"")+c.pop()+(Pe?"":b)),_=-1}}if(c.length>1&&r.WTF)throw new Error("bad formula stack");return c[0]}function TI(n){if(n==null){var e=he(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof n=="number")return Na(n);return Na(0)}function CI(n,e,t,i,r){var a=Ma(e,t,r),o=TI(n.v),c=he(6),h=33;c.write_shift(2,h),c.write_shift(4,0);for(var f=he(n.bf.length),p=0;p<n.bf.length;++p)f[p]=n.bf[p];var g=Ln([a,o,c,f]);return g}function id(n,e,t){var i=n.read_shift(4),r=bI(n,i,t),a=n.read_shift(4),o=a>0?wI(n,a,r,t):null;return[r,o]}var RI=id,rd=id,OI=id,kI=id,DI={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},DS={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},NI={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function MI(n){var e="of:="+n.replace(Sm,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function LI(n){return n.replace(/\./,"!")}var Nc=typeof Map<"u";function Cm(n,e,t){var i=0,r=n.length;if(t){if(Nc?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var a=Nc?t.get(e):t[e];i<a.length;++i)if(n[a[i]].t===e)return n.Count++,a[i]}}else for(;i<r;++i)if(n[i].t===e)return n.Count++,i;return n[r]={t:e},n.Count++,n.Unique++,t&&(Nc?(t.has(e)||t.set(e,[]),t.get(e).push(r)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(r))),r}function sd(n,e){var t={min:n+1,max:n+1},i=-1;return e.MDW&&(is=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?i=Lf(e.wpx):e.wch!=null&&(i=e.wch),i>-1?(t.width=Mg(i),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function NS(n,e){if(n){var t=[.7,.7,.75,.75,.3,.3];n.left==null&&(n.left=t[0]),n.right==null&&(n.right=t[1]),n.top==null&&(n.top=t[2]),n.bottom==null&&(n.bottom=t[3]),n.header==null&&(n.header=t[4]),n.footer==null&&(n.footer=t[5])}}function Ys(n,e,t){var i=t.revssf[e.z!=null?e.z:"General"],r=60,a=n.length;if(i==null&&t.ssf){for(;r<392;++r)if(t.ssf[r]==null){CE(e.z,r),t.ssf[r]=e.z,t.revssf[e.z]=i=r;break}}for(r=0;r!=a;++r)if(n[r].numFmtId===i)return r;return n[a]={numFmtId:i,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function FI(n,e,t){if(n&&n["!ref"]){var i=It(n["!ref"]);if(i.e.c<i.s.c||i.e.r<i.s.r)throw new Error("Bad range ("+t+"): "+n["!ref"])}}function II(n){if(n.length===0)return"";for(var e='<mergeCells count="'+n.length+'">',t=0;t!=n.length;++t)e+='<mergeCell ref="'+hn(n[t])+'"/>';return e+"</mergeCells>"}function PI(n,e,t,i,r){var a=!1,o={},c=null;if(i.bookType!=="xlsx"&&e.vbaraw){var h=e.SheetNames[t];try{e.Workbook&&(h=e.Workbook.Sheets[t].CodeName||h)}catch{}a=!0,o.codeName=Qc(xt(h))}if(n&&n["!outline"]){var f={summaryBelow:1,summaryRight:1};n["!outline"].above&&(f.summaryBelow=0),n["!outline"].left&&(f.summaryRight=0),c=(c||"")+Se("outlinePr",null,f)}!a&&!c||(r[r.length]=Se("sheetPr",c,o))}var BI=["objects","scenarios","selectLockedCells","selectUnlockedCells"],UI=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function jI(n){var e={sheet:1};return BI.forEach(function(t){n[t]!=null&&n[t]&&(e[t]="1")}),UI.forEach(function(t){n[t]!=null&&!n[t]&&(e[t]="0")}),n.password&&(e.password=gS(n.password).toString(16).toUpperCase()),Se("sheetProtection",null,e)}function HI(n){return NS(n),Se("pageMargins",null,n)}function zI(n,e){for(var t=["<cols>"],i,r=0;r!=e.length;++r)(i=e[r])&&(t[t.length]=Se("col",null,sd(r,i)));return t[t.length]="</cols>",t.join("")}function $I(n,e,t,i){var r=typeof n.ref=="string"?n.ref:hn(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var a=t.Workbook.Names,o=ki(r);o.s.r==o.e.r&&(o.e.r=ki(e["!ref"]).e.r,r=hn(o));for(var c=0;c<a.length;++c){var h=a[c];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==i){h.Ref="'"+t.SheetNames[i]+"'!"+r;break}}return c==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+t.SheetNames[i]+"'!"+r}),Se("autoFilter",null,{ref:r})}function GI(n,e,t,i){var r={workbookViewId:"0"};return(((i||{}).Workbook||{}).Views||[])[0]&&(r.rightToLeft=i.Workbook.Views[0].RTL?"1":"0"),Se("sheetViews",Se("sheetView",null,r),{})}function VI(n,e,t,i){if(n.c&&t["!comments"].push([e,n.c]),n.v===void 0&&typeof n.f!="string"||n.t==="z"&&!n.f)return"";var r="",a=n.t,o=n.v;if(n.t!=="z")switch(n.t){case"b":r=n.v?"1":"0";break;case"n":r=""+n.v;break;case"e":r=vu[n.v];break;case"d":i&&i.cellDates?r=Jn(n.v,-1).toISOString():(n=ui(n),n.t="n",r=""+(n.v=ci(Jn(n.v)))),typeof n.z>"u"&&(n.z=Jt[14]);break;default:r=n.v;break}var c=Fn("v",xt(r)),h={r:e},f=Ys(i.cellXfs,n,i);switch(f!==0&&(h.s=f),n.t){case"n":break;case"d":h.t="d";break;case"b":h.t="b";break;case"e":h.t="e";break;case"z":break;default:if(n.v==null){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(i&&i.bookSST){c=Fn("v",""+Cm(i.Strings,n.v,i.revStrings)),h.t="s";break}h.t="str";break}if(n.t!=a&&(n.t=a,n.v=o),typeof n.f=="string"&&n.f){var p=n.F&&n.F.slice(0,e.length)==e?{t:"array",ref:n.F}:null;c=Se("f",xt(n.f),p)+(n.v!=null?c:"")}return n.l&&t["!links"].push([e,n.l]),n.D&&(h.cm=1),Se("c",c,h)}function qI(n,e,t,i){var r=[],a=[],o=It(n["!ref"]),c="",h,f="",p=[],g=0,m=0,y=n["!rows"],w=Array.isArray(n),_={r:f},b,E=-1;for(m=o.s.c;m<=o.e.c;++m)p[m]=Hn(m);for(g=o.s.r;g<=o.e.r;++g){for(a=[],f=In(g),m=o.s.c;m<=o.e.c;++m){h=p[m]+f;var T=w?(n[g]||[])[m]:n[h];T!==void 0&&(c=VI(T,h,n,e))!=null&&a.push(c)}(a.length>0||y&&y[g])&&(_={r:f},y&&y[g]&&(b=y[g],b.hidden&&(_.hidden=1),E=-1,b.hpx?E=Ff(b.hpx):b.hpt&&(E=b.hpt),E>-1&&(_.ht=E,_.customHeight=1),b.level&&(_.outlineLevel=b.level)),r[r.length]=Se("row",a.join(""),_))}if(y)for(;g<y.length;++g)y&&y[g]&&(_={r:g+1},b=y[g],b.hidden&&(_.hidden=1),E=-1,b.hpx?E=Ff(b.hpx):b.hpt&&(E=b.hpt),E>-1&&(_.ht=E,_.customHeight=1),b.level&&(_.outlineLevel=b.level),r[r.length]=Se("row","",_));return r.join("")}function MS(n,e,t,i){var r=[fn,Se("worksheet",null,{xmlns:fl[0],"xmlns:r":wn.r})],a=t.SheetNames[n],o=0,c="",h=t.Sheets[a];h==null&&(h={});var f=h["!ref"]||"A1",p=It(f);if(p.e.c>16383||p.e.r>1048575){if(e.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575),f=hn(p)}i||(i={}),h["!comments"]=[];var g=[];PI(h,t,n,e,r),r[r.length]=Se("dimension",null,{ref:f}),r[r.length]=GI(h,e,n,t),e.sheetFormat&&(r[r.length]=Se("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),h["!cols"]!=null&&h["!cols"].length>0&&(r[r.length]=zI(h,h["!cols"])),r[o=r.length]="<sheetData/>",h["!links"]=[],h["!ref"]!=null&&(c=qI(h,e),c.length>0&&(r[r.length]=c)),r.length>o+1&&(r[r.length]="</sheetData>",r[o]=r[o].replace("/>",">")),h["!protect"]&&(r[r.length]=jI(h["!protect"])),h["!autofilter"]!=null&&(r[r.length]=$I(h["!autofilter"],h,t,n)),h["!merges"]!=null&&h["!merges"].length>0&&(r[r.length]=II(h["!merges"]));var m=-1,y,w=-1;return h["!links"].length>0&&(r[r.length]="<hyperlinks>",h["!links"].forEach(function(_){_[1].Target&&(y={ref:_[0]},_[1].Target.charAt(0)!="#"&&(w=_t(i,-1,xt(_[1].Target).replace(/#.*$/,""),ht.HLINK),y["r:id"]="rId"+w),(m=_[1].Target.indexOf("#"))>-1&&(y.location=xt(_[1].Target.slice(m+1))),_[1].Tooltip&&(y.tooltip=xt(_[1].Tooltip)),r[r.length]=Se("hyperlink",null,y))}),r[r.length]="</hyperlinks>"),delete h["!links"],h["!margins"]!=null&&(r[r.length]=HI(h["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(r[r.length]=Fn("ignoredErrors",Se("ignoredError",null,{numberStoredAsText:1,sqref:f}))),g.length>0&&(w=_t(i,-1,"../drawings/drawing"+(n+1)+".xml",ht.DRAW),r[r.length]=Se("drawing",null,{"r:id":"rId"+w}),h["!drawing"]=g),h["!comments"].length>0&&(w=_t(i,-1,"../drawings/vmlDrawing"+(n+1)+".vml",ht.VML),r[r.length]=Se("legacyDrawing",null,{"r:id":"rId"+w}),h["!legacy"]=w),r.length>1&&(r[r.length]="</worksheet>",r[1]=r[1].replace("/>",">")),r.join("")}function WI(n,e){var t={},i=n.l+e;t.r=n.read_shift(4),n.l+=4;var r=n.read_shift(2);n.l+=1;var a=n.read_shift(1);return n.l=i,a&7&&(t.level=a&7),a&16&&(t.hidden=!0),a&32&&(t.hpt=r/20),t}function XI(n,e,t){var i=he(145),r=(t["!rows"]||[])[n]||{};i.write_shift(4,n),i.write_shift(4,0);var a=320;r.hpx?a=Ff(r.hpx)*20:r.hpt&&(a=r.hpt*20),i.write_shift(2,a),i.write_shift(1,0);var o=0;r.level&&(o|=r.level),r.hidden&&(o|=16),(r.hpx||r.hpt)&&(o|=32),i.write_shift(1,o),i.write_shift(1,0);var c=0,h=i.l;i.l+=4;for(var f={r:n,c:0},p=0;p<16;++p)if(!(e.s.c>p+1<<10||e.e.c<p<<10)){for(var g=-1,m=-1,y=p<<10;y<p+1<<10;++y){f.c=y;var w=Array.isArray(t)?(t[f.r]||[])[f.c]:t[wt(f)];w&&(g<0&&(g=y),m=y)}g<0||(++c,i.write_shift(4,g),i.write_shift(4,m))}var _=i.l;return i.l=h,i.write_shift(4,c),i.l=_,i.length>i.l?i.slice(0,i.l):i}function YI(n,e,t,i){var r=XI(i,t,e);(r.length>17||(e["!rows"]||[])[i])&&ye(n,0,r)}var KI=Ha,JI=pl;function QI(){}function ZI(n,e){var t={},i=n[n.l];return++n.l,t.above=!(i&64),t.left=!(i&128),n.l+=18,t.name=cM(n),t}function eP(n,e,t){t==null&&(t=he(84+4*n.length));var i=192;e&&(e.above&&(i&=-65),e.left&&(i&=-129)),t.write_shift(1,i);for(var r=1;r<3;++r)t.write_shift(1,0);return Df({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),XE(n,t),t.slice(0,t.l)}function tP(n){var e=Ji(n);return[e]}function nP(n,e,t){return t==null&&(t=he(8)),Ba(e,t)}function iP(n){var e=Ua(n);return[e]}function rP(n,e,t){return t==null&&(t=he(4)),ja(e,t)}function sP(n){var e=Ji(n),t=n.read_shift(1);return[e,t,"b"]}function aP(n,e,t){return t==null&&(t=he(9)),Ba(e,t),t.write_shift(1,n.v?1:0),t}function oP(n){var e=Ua(n),t=n.read_shift(1);return[e,t,"b"]}function lP(n,e,t){return t==null&&(t=he(5)),ja(e,t),t.write_shift(1,n.v?1:0),t}function cP(n){var e=Ji(n),t=n.read_shift(1);return[e,t,"e"]}function uP(n,e,t){return t==null&&(t=he(9)),Ba(e,t),t.write_shift(1,n.v),t}function hP(n){var e=Ua(n),t=n.read_shift(1);return[e,t,"e"]}function fP(n,e,t){return t==null&&(t=he(8)),ja(e,t),t.write_shift(1,n.v),t.write_shift(2,0),t.write_shift(1,0),t}function dP(n){var e=Ji(n),t=n.read_shift(4);return[e,t,"s"]}function pP(n,e,t){return t==null&&(t=he(12)),Ba(e,t),t.write_shift(4,e.v),t}function gP(n){var e=Ua(n),t=n.read_shift(4);return[e,t,"s"]}function mP(n,e,t){return t==null&&(t=he(8)),ja(e,t),t.write_shift(4,e.v),t}function vP(n){var e=Ji(n),t=gl(n);return[e,t,"n"]}function yP(n,e,t){return t==null&&(t=he(16)),Ba(e,t),Na(n.v,t),t}function _P(n){var e=Ua(n),t=gl(n);return[e,t,"n"]}function xP(n,e,t){return t==null&&(t=he(12)),ja(e,t),Na(n.v,t),t}function wP(n){var e=Ji(n),t=YE(n);return[e,t,"n"]}function bP(n,e,t){return t==null&&(t=he(12)),Ba(e,t),KE(n.v,t),t}function EP(n){var e=Ua(n),t=YE(n);return[e,t,"n"]}function SP(n,e,t){return t==null&&(t=he(8)),ja(e,t),KE(n.v,t),t}function AP(n){var e=Ji(n),t=_m(n);return[e,t,"is"]}function TP(n){var e=Ji(n),t=zn(n);return[e,t,"str"]}function CP(n,e,t){return t==null&&(t=he(12+4*n.v.length)),Ba(e,t),En(n.v,t),t.length>t.l?t.slice(0,t.l):t}function RP(n){var e=Ua(n),t=zn(n);return[e,t,"str"]}function OP(n,e,t){return t==null&&(t=he(8+4*n.v.length)),ja(e,t),En(n.v,t),t.length>t.l?t.slice(0,t.l):t}function kP(n,e,t){var i=n.l+e,r=Ji(n);r.r=t["!row"];var a=n.read_shift(1),o=[r,a,"b"];if(t.cellFormula){n.l+=2;var c=rd(n,i-n.l,t);o[3]=cl(c,null,r,t.supbooks,t)}else n.l=i;return o}function DP(n,e,t){var i=n.l+e,r=Ji(n);r.r=t["!row"];var a=n.read_shift(1),o=[r,a,"e"];if(t.cellFormula){n.l+=2;var c=rd(n,i-n.l,t);o[3]=cl(c,null,r,t.supbooks,t)}else n.l=i;return o}function NP(n,e,t){var i=n.l+e,r=Ji(n);r.r=t["!row"];var a=gl(n),o=[r,a,"n"];if(t.cellFormula){n.l+=2;var c=rd(n,i-n.l,t);o[3]=cl(c,null,r,t.supbooks,t)}else n.l=i;return o}function MP(n,e,t){var i=n.l+e,r=Ji(n);r.r=t["!row"];var a=zn(n),o=[r,a,"str"];if(t.cellFormula){n.l+=2;var c=rd(n,i-n.l,t);o[3]=cl(c,null,r,t.supbooks,t)}else n.l=i;return o}var LP=Ha,FP=pl;function IP(n,e){return e==null&&(e=he(4)),e.write_shift(4,n),e}function PP(n,e){var t=n.l+e,i=Ha(n),r=xm(n),a=zn(n),o=zn(n),c=zn(n);n.l=t;var h={rfx:i,relId:r,loc:a,display:c};return o&&(h.Tooltip=o),h}function BP(n,e){var t=he(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));pl({s:bn(n[0]),e:bn(n[0])},t),wm("rId"+e,t);var i=n[1].Target.indexOf("#"),r=i==-1?"":n[1].Target.slice(i+1);return En(r||"",t),En(n[1].Tooltip||"",t),En("",t),t.slice(0,t.l)}function UP(){}function jP(n,e,t){var i=n.l+e,r=JE(n),a=n.read_shift(1),o=[r];if(o[2]=a,t.cellFormula){var c=RI(n,i-n.l,t);o[1]=c}else n.l=i;return o}function HP(n,e,t){var i=n.l+e,r=Ha(n),a=[r];if(t.cellFormula){var o=kI(n,i-n.l,t);a[1]=o,n.l=i}else n.l=i;return a}function zP(n,e,t){t==null&&(t=he(18));var i=sd(n,e);t.write_shift(-4,n),t.write_shift(-4,n),t.write_shift(4,(i.width||10)*256),t.write_shift(4,0);var r=0;return e.hidden&&(r|=1),typeof i.width=="number"&&(r|=2),e.level&&(r|=e.level<<8),t.write_shift(2,r),t}var LS=["left","right","top","bottom","header","footer"];function $P(n){var e={};return LS.forEach(function(t){e[t]=gl(n)}),e}function GP(n,e){return e==null&&(e=he(48)),NS(n),LS.forEach(function(t){Na(n[t],e)}),e}function VP(n){var e=n.read_shift(2);return n.l+=28,{RTL:e&32}}function qP(n,e,t){t==null&&(t=he(30));var i=924;return(((e||{}).Views||[])[0]||{}).RTL&&(i|=32),t.write_shift(2,i),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function WP(n){var e=he(24);return e.write_shift(4,4),e.write_shift(4,1),pl(n,e),e}function XP(n,e){return e==null&&(e=he(66)),e.write_shift(2,n.password?gS(n.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,n[t[0]]!=null&&!n[t[0]]?1:0):e.write_shift(4,n[t[0]]!=null&&n[t[0]]?0:1)}),e}function YP(){}function KP(){}function JP(n,e,t,i,r,a,o){if(e.v===void 0)return!1;var c="";switch(e.t){case"b":c=e.v?"1":"0";break;case"d":e=ui(e),e.z=e.z||Jt[14],e.v=ci(Jn(e.v)),e.t="n";break;case"n":case"e":c=""+e.v;break;default:c=e.v;break}var h={r:t,c:i};switch(h.s=Ys(r.cellXfs,e,r),e.l&&a["!links"].push([wt(h),e.l]),e.c&&a["!comments"].push([wt(h),e.c]),e.t){case"s":case"str":return r.bookSST?(c=Cm(r.Strings,e.v,r.revStrings),h.t="s",h.v=c,o?ye(n,18,mP(e,h)):ye(n,7,pP(e,h))):(h.t="str",o?ye(n,17,OP(e,h)):ye(n,6,CP(e,h))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?ye(n,13,SP(e,h)):ye(n,2,bP(e,h)):o?ye(n,16,xP(e,h)):ye(n,5,yP(e,h)),!0;case"b":return h.t="b",o?ye(n,15,lP(e,h)):ye(n,4,aP(e,h)),!0;case"e":return h.t="e",o?ye(n,14,fP(e,h)):ye(n,3,uP(e,h)),!0}return o?ye(n,12,rP(e,h)):ye(n,1,nP(e,h)),!0}function QP(n,e,t,i){var r=It(e["!ref"]||"A1"),a,o="",c=[];ye(n,145);var h=Array.isArray(e),f=r.e.r;e["!rows"]&&(f=Math.max(r.e.r,e["!rows"].length-1));for(var p=r.s.r;p<=f;++p){o=In(p),YI(n,e,r,p);var g=!1;if(p<=r.e.r)for(var m=r.s.c;m<=r.e.c;++m){p===r.s.r&&(c[m]=Hn(m)),a=c[m]+o;var y=h?(e[p]||[])[m]:e[a];if(!y){g=!1;continue}g=JP(n,y,p,m,i,e,g)}}ye(n,146)}function ZP(n,e){!e||!e["!merges"]||(ye(n,177,IP(e["!merges"].length)),e["!merges"].forEach(function(t){ye(n,176,FP(t))}),ye(n,178))}function eB(n,e){!e||!e["!cols"]||(ye(n,390),e["!cols"].forEach(function(t,i){t&&ye(n,60,zP(i,t))}),ye(n,391))}function tB(n,e){!e||!e["!ref"]||(ye(n,648),ye(n,649,WP(It(e["!ref"]))),ye(n,650))}function nB(n,e,t){e["!links"].forEach(function(i){if(i[1].Target){var r=_t(t,-1,i[1].Target.replace(/#.*$/,""),ht.HLINK);ye(n,494,BP(i,r))}}),delete e["!links"]}function iB(n,e,t,i){if(e["!comments"].length>0){var r=_t(i,-1,"../drawings/vmlDrawing"+(t+1)+".vml",ht.VML);ye(n,551,wm("rId"+r)),e["!legacy"]=r}}function rB(n,e,t,i){if(e["!autofilter"]){var r=e["!autofilter"],a=typeof r.ref=="string"?r.ref:hn(r.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var o=t.Workbook.Names,c=ki(a);c.s.r==c.e.r&&(c.e.r=ki(e["!ref"]).e.r,a=hn(c));for(var h=0;h<o.length;++h){var f=o[h];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==i){f.Ref="'"+t.SheetNames[i]+"'!"+a;break}}h==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+t.SheetNames[i]+"'!"+a}),ye(n,161,pl(It(a))),ye(n,162)}}function sB(n,e,t){ye(n,133),ye(n,137,qP(e,t)),ye(n,138),ye(n,134)}function aB(n,e){e["!protect"]&&ye(n,535,XP(e["!protect"]))}function oB(n,e,t,i){var r=li(),a=t.SheetNames[n],o=t.Sheets[a]||{},c=a;try{t&&t.Workbook&&(c=t.Workbook.Sheets[n].CodeName||c)}catch{}var h=It(o["!ref"]||"A1");if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],ye(r,129),(t.vbaraw||o["!outline"])&&ye(r,147,eP(c,o["!outline"])),ye(r,148,JI(h)),sB(r,o,t.Workbook),eB(r,o),QP(r,o,n,e),aB(r,o),rB(r,o,t,n),ZP(r,o),nB(r,o,i),o["!margins"]&&ye(r,476,GP(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&tB(r,o),iB(r,o,n,i),ye(r,130),r.end()}function lB(n,e){n.l+=10;var t=zn(n);return{name:t}}var cB=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function uB(n){return!n.Workbook||!n.Workbook.WBProps?"false":H3(n.Workbook.WBProps.date1904)?"true":"false"}var hB="][*?/\\".split("");function FS(n,e){if(n.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return hB.forEach(function(i){if(n.indexOf(i)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function fB(n,e,t){n.forEach(function(i,r){FS(i);for(var a=0;a<r;++a)if(i==n[a])throw new Error("Duplicate Sheet Name: "+i);if(t){var o=e&&e[r]&&e[r].CodeName||i;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function dB(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var e=n.Workbook&&n.Workbook.Sheets||[];fB(n.SheetNames,e,!!n.vbaraw);for(var t=0;t<n.SheetNames.length;++t)FI(n.Sheets[n.SheetNames[t]],n.SheetNames[t],t)}function IS(n){var e=[fn];e[e.length]=Se("workbook",null,{xmlns:fl[0],"xmlns:r":wn.r});var t=n.Workbook&&(n.Workbook.Names||[]).length>0,i={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&(cB.forEach(function(c){n.Workbook.WBProps[c[0]]!=null&&n.Workbook.WBProps[c[0]]!=c[1]&&(i[c[0]]=n.Workbook.WBProps[c[0]])}),n.Workbook.WBProps.CodeName&&(i.codeName=n.Workbook.WBProps.CodeName,delete i.CodeName)),e[e.length]=Se("workbookPr",null,i);var r=n.Workbook&&n.Workbook.Sheets||[],a=0;if(r&&r[0]&&r[0].Hidden){for(e[e.length]="<bookViews>",a=0;a!=n.SheetNames.length&&!(!r[a]||!r[a].Hidden);++a);a==n.SheetNames.length&&(a=0),e[e.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",a=0;a!=n.SheetNames.length;++a){var o={name:xt(n.SheetNames[a].slice(0,31))};if(o.sheetId=""+(a+1),o["r:id"]="rId"+(a+1),r[a])switch(r[a].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=Se("sheet",null,o)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(c){var h={name:c.Name};c.Comment&&(h.comment=c.Comment),c.Sheet!=null&&(h.localSheetId=""+c.Sheet),c.Hidden&&(h.hidden="1"),c.Ref&&(e[e.length]=Se("definedName",xt(c.Ref),h))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function pB(n,e){var t={};return t.Hidden=n.read_shift(4),t.iTabID=n.read_shift(4),t.strRelID=Ng(n),t.name=zn(n),t}function gB(n,e){return e||(e=he(127)),e.write_shift(4,n.Hidden),e.write_shift(4,n.iTabID),wm(n.strRelID,e),En(n.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function mB(n,e){var t={},i=n.read_shift(4);t.defaultThemeVersion=n.read_shift(4);var r=e>8?zn(n):"";return r.length>0&&(t.CodeName=r),t.autoCompressPictures=!!(i&65536),t.backupFile=!!(i&64),t.checkCompatibility=!!(i&4096),t.date1904=!!(i&1),t.filterPrivacy=!!(i&8),t.hidePivotFieldList=!!(i&1024),t.promptedSolutions=!!(i&16),t.publishItems=!!(i&2048),t.refreshAllConnections=!!(i&262144),t.saveExternalLinkValues=!!(i&128),t.showBorderUnselectedTables=!!(i&4),t.showInkAnnotation=!!(i&32),t.showObjects=["all","placeholders","none"][i>>13&3],t.showPivotChartFilter=!!(i&32768),t.updateLinks=["userSet","never","always"][i>>8&3],t}function vB(n,e){e||(e=he(72));var t=0;return n&&n.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),XE(n&&n.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function yB(n,e,t){var i=n.l+e;n.l+=4,n.l+=1;var r=n.read_shift(4),a=uM(n),o=OI(n,0,t),c=xm(n);n.l=i;var h={Name:a,Ptg:o};return r<268435455&&(h.Sheet=r),c&&(h.Comment=c),h}function _B(n,e){ye(n,143);for(var t=0;t!=e.SheetNames.length;++t){var i=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,r={Hidden:i,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};ye(n,156,gB(r))}ye(n,144)}function xB(n,e){e||(e=he(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return En("SheetJS",e),En(Ef.version,e),En(Ef.version,e),En("7262",e),e.length>e.l?e.slice(0,e.l):e}function wB(n,e){e||(e=he(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,n),e.write_shift(4,n);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function bB(n,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,i=0,r=-1,a=-1;i<t.length;++i)!t[i]||!t[i].Hidden&&r==-1?r=i:t[i].Hidden==1&&a==-1&&(a=i);a>r||(ye(n,135),ye(n,158,wB(r)),ye(n,136))}}function EB(n,e){var t=li();return ye(t,131),ye(t,128,xB()),ye(t,153,vB(n.Workbook&&n.Workbook.WBProps||null)),bB(t,n),_B(t,n),ye(t,132),t.end()}function SB(n,e,t){return(e.slice(-4)===".bin"?EB:IS)(n)}function AB(n,e,t,i,r){return(e.slice(-4)===".bin"?oB:MS)(n,t,i,r)}function TB(n,e,t){return(e.slice(-4)===".bin"?GL:yS)(n,t)}function CB(n,e,t){return(e.slice(-4)===".bin"?vL:pS)(n,t)}function RB(n,e,t){return(e.slice(-4)===".bin"?aF:ES)(n)}function OB(n){return(n.slice(-4)===".bin"?QL:wS)()}function kB(n,e){var t=[];return n.Props&&t.push(TM(n.Props,e)),n.Custprops&&t.push(CM(n.Props,n.Custprops)),t.join("")}function DB(){return""}function NB(n,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(i,r){var a=[];a.push(Se("NumberFormat",null,{"ss:Format":xt(Jt[i.numFmtId])}));var o={"ss:ID":"s"+(21+r)};t.push(Se("Style",a.join(""),o))}),Se("Styles",t.join(""))}function PS(n){return Se("NamedRange",null,{"ss:Name":n.Name,"ss:RefersTo":"="+Am(n.Ref,{r:0,c:0})})}function MB(n){if(!((n||{}).Workbook||{}).Names)return"";for(var e=n.Workbook.Names,t=[],i=0;i<e.length;++i){var r=e[i];r.Sheet==null&&(r.Name.match(/^_xlfn\./)||t.push(PS(r)))}return Se("Names",t.join(""))}function LB(n,e,t,i){if(!n||!((i||{}).Workbook||{}).Names)return"";for(var r=i.Workbook.Names,a=[],o=0;o<r.length;++o){var c=r[o];c.Sheet==t&&(c.Name.match(/^_xlfn\./)||a.push(PS(c)))}return a.join("")}function FB(n,e,t,i){if(!n)return"";var r=[];if(n["!margins"]&&(r.push("<PageSetup>"),n["!margins"].header&&r.push(Se("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&r.push(Se("Footer",null,{"x:Margin":n["!margins"].footer})),r.push(Se("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),r.push("</PageSetup>")),i&&i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[t])if(i.Workbook.Sheets[t].Hidden)r.push(Se("Visible",i.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<t&&!(i.Workbook.Sheets[a]&&!i.Workbook.Sheets[a].Hidden);++a);a==t&&r.push("<Selected/>")}return((((i||{}).Workbook||{}).Views||[])[0]||{}).RTL&&r.push("<DisplayRightToLeft/>"),n["!protect"]&&(r.push(Fn("ProtectContents","True")),n["!protect"].objects&&r.push(Fn("ProtectObjects","True")),n["!protect"].scenarios&&r.push(Fn("ProtectScenarios","True")),n["!protect"].selectLockedCells!=null&&!n["!protect"].selectLockedCells?r.push(Fn("EnableSelection","NoSelection")):n["!protect"].selectUnlockedCells!=null&&!n["!protect"].selectUnlockedCells&&r.push(Fn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){n["!protect"][o[0]]&&r.push("<"+o[1]+"/>")})),r.length==0?"":Se("WorksheetOptions",r.join(""),{xmlns:Ti.x})}function IB(n){return n.map(function(e){var t=j3(e.t||""),i=Se("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Se("Comment",i,{"ss:Author":e.a})}).join("")}function PB(n,e,t,i,r,a,o){if(!n||n.v==null&&n.f==null)return"";var c={};if(n.f&&(c["ss:Formula"]="="+xt(Am(n.f,o))),n.F&&n.F.slice(0,e.length)==e){var h=bn(n.F.slice(e.length+1));c["ss:ArrayRange"]="RC:R"+(h.r==o.r?"":"["+(h.r-o.r)+"]")+"C"+(h.c==o.c?"":"["+(h.c-o.c)+"]")}if(n.l&&n.l.Target&&(c["ss:HRef"]=xt(n.l.Target),n.l.Tooltip&&(c["x:HRefScreenTip"]=xt(n.l.Tooltip))),t["!merges"])for(var f=t["!merges"],p=0;p!=f.length;++p)f[p].s.c!=o.c||f[p].s.r!=o.r||(f[p].e.c>f[p].s.c&&(c["ss:MergeAcross"]=f[p].e.c-f[p].s.c),f[p].e.r>f[p].s.r&&(c["ss:MergeDown"]=f[p].e.r-f[p].s.r));var g="",m="";switch(n.t){case"z":if(!i.sheetStubs)return"";break;case"n":g="Number",m=String(n.v);break;case"b":g="Boolean",m=n.v?"1":"0";break;case"e":g="Error",m=vu[n.v];break;case"d":g="DateTime",m=new Date(n.v).toISOString(),n.z==null&&(n.z=n.z||Jt[14]);break;case"s":g="String",m=U3(n.v||"");break}var y=Ys(i.cellXfs,n,i);c["ss:StyleID"]="s"+(21+y),c["ss:Index"]=o.c+1;var w=n.v!=null?m:"",_=n.t=="z"?"":'<Data ss:Type="'+g+'">'+w+"</Data>";return(n.c||[]).length>0&&(_+=IB(n.c)),Se("Cell",_,c)}function BB(n,e){var t='<Row ss:Index="'+(n+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=vS(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function UB(n,e,t,i){if(!n["!ref"])return"";var r=It(n["!ref"]),a=n["!merges"]||[],o=0,c=[];n["!cols"]&&n["!cols"].forEach(function(b,E){Em(b);var T=!!b.width,S=sd(E,b),k={"ss:Index":E+1};T&&(k["ss:Width"]=Mf(S.width)),b.hidden&&(k["ss:Hidden"]="1"),c.push(Se("Column",null,k))});for(var h=Array.isArray(n),f=r.s.r;f<=r.e.r;++f){for(var p=[BB(f,(n["!rows"]||[])[f])],g=r.s.c;g<=r.e.c;++g){var m=!1;for(o=0;o!=a.length;++o)if(!(a[o].s.c>g)&&!(a[o].s.r>f)&&!(a[o].e.c<g)&&!(a[o].e.r<f)){(a[o].s.c!=g||a[o].s.r!=f)&&(m=!0);break}if(!m){var y={r:f,c:g},w=wt(y),_=h?(n[f]||[])[g]:n[w];p.push(PB(_,w,n,e,t,i,y))}}p.push("</Row>"),p.length>2&&c.push(p.join(""))}return c.join("")}function jB(n,e,t){var i=[],r=t.SheetNames[n],a=t.Sheets[r],o=a?LB(a,e,n,t):"";return o.length>0&&i.push("<Names>"+o+"</Names>"),o=a?UB(a,e,n,t):"",o.length>0&&i.push("<Table>"+o+"</Table>"),i.push(FB(a,e,n,t)),i.join("")}function HB(n,e){e||(e={}),n.SSF||(n.SSF=ui(Jt)),n.SSF&&(ed(),Zf(n.SSF),e.revssf=td(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF,e.cellXfs=[],Ys(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(kB(n,e)),t.push(DB()),t.push(""),t.push("");for(var i=0;i<n.SheetNames.length;++i)t.push(Se("Worksheet",jB(i,e,n),{"ss:Name":xt(n.SheetNames[i])}));return t[2]=NB(n,e),t[3]=MB(n),fn+Se("Workbook",t.join(""),{xmlns:Ti.ss,"xmlns:o":Ti.o,"xmlns:x":Ti.x,"xmlns:ss":Ti.ss,"xmlns:dt":Ti.dt,"xmlns:html":Ti.html})}var Jp={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function zB(n,e){var t=[],i=[],r=[],a=0,o,c=uw(Ew,"n"),h=uw(Sw,"n");if(n.Props)for(o=Pn(n.Props),a=0;a<o.length;++a)(Object.prototype.hasOwnProperty.call(c,o[a])?t:Object.prototype.hasOwnProperty.call(h,o[a])?i:r).push([o[a],n.Props[o[a]]]);if(n.Custprops)for(o=Pn(n.Custprops),a=0;a<o.length;++a)Object.prototype.hasOwnProperty.call(n.Props||{},o[a])||(Object.prototype.hasOwnProperty.call(c,o[a])?t:Object.prototype.hasOwnProperty.call(h,o[a])?i:r).push([o[a],n.Custprops[o[a]]]);var f=[];for(a=0;a<r.length;++a)oS.indexOf(r[a][0])>-1||rS.indexOf(r[a][0])>-1||r[a][1]!=null&&f.push(r[a]);i.length&&Tt.utils.cfb_add(e,"/SummaryInformation",Ow(i,Jp.SI,h,Sw)),(t.length||f.length)&&Tt.utils.cfb_add(e,"/DocumentSummaryInformation",Ow(t,Jp.DSI,c,Ew,f.length?f:null,Jp.UDI))}function $B(n,e){var t=e||{},i=Tt.utils.cfb_new({root:"R"}),r="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":r="/Workbook",t.biff=8;break;case"biff5":r="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Tt.utils.cfb_add(i,r,BS(n,t)),t.biff==8&&(n.Props||n.Custprops)&&zB(n,i),t.biff==8&&n.vbaraw&&oF(i,Tt.read(n.vbaraw,{type:typeof n.vbaraw=="string"?"binary":"buffer"})),i}var GB={0:{f:WI},1:{f:tP},2:{f:wP},3:{f:cP},4:{f:sP},5:{f:vP},6:{f:TP},7:{f:dP},8:{f:MP},9:{f:NP},10:{f:kP},11:{f:DP},12:{f:iP},13:{f:EP},14:{f:hP},15:{f:oP},16:{f:_P},17:{f:RP},18:{f:gP},19:{f:_m},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:yB},40:{},42:{},43:{f:TL},44:{f:SL},45:{f:OL},46:{f:DL},47:{f:kL},48:{},49:{f:iM},50:{},51:{f:WL},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:rL},62:{f:AP},63:{f:ZL},64:{f:YP},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:kr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:VP},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:ZI},148:{f:KI,p:16},151:{f:UP},152:{},153:{f:mB},154:{},155:{},156:{f:pB},157:{},158:{},159:{T:1,f:pL},160:{T:-1},161:{T:1,f:Ha},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:LP},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:VL},336:{T:-1},337:{f:KL,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ng},357:{},358:{},359:{},360:{T:1},361:{},362:{f:QM},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:jP},427:{f:HP},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:$P},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:QI},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:PP},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ng},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:rF},633:{T:1},634:{T:-1},635:{T:1,f:nF},636:{T:-1},637:{f:oM},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:lB},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:KP},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Ae(n,e,t,i){var r=e;if(!isNaN(r)){var a=i||(t||[]).length||0,o=n.next(4);o.write_shift(2,r),o.write_shift(2,a),a>0&&mm(t)&&n.push(t)}}function VB(n,e,t,i){var r=(t||[]).length||0;if(r<=8224)return Ae(n,e,t,r);var a=e;if(!isNaN(a)){for(var o=t.parts||[],c=0,h=0,f=0;f+(o[c]||8224)<=8224;)f+=o[c]||8224,c++;var p=n.next(4);for(p.write_shift(2,a),p.write_shift(2,f),n.push(t.slice(h,h+f)),h+=f;h<r;){for(p=n.next(4),p.write_shift(2,60),f=0;f+(o[c]||8224)<=8224;)f+=o[c]||8224,c++;p.write_shift(2,f),n.push(t.slice(h,h+f)),h+=f}}}function _u(n,e,t){return n||(n=he(7)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,0),n.write_shift(1,0),n}function qB(n,e,t,i){var r=he(9);return _u(r,n,e),cS(t,i||"b",r),r}function WB(n,e,t){var i=he(8+2*t.length);return _u(i,n,e),i.write_shift(1,t.length),i.write_shift(t.length,t,"sbcs"),i.l<i.length?i.slice(0,i.l):i}function XB(n,e,t,i){if(e.v!=null)switch(e.t){case"d":case"n":var r=e.t=="d"?ci(Jn(e.v)):e.v;r==(r|0)&&r>=0&&r<65536?Ae(n,2,lL(t,i,r)):Ae(n,3,oL(t,i,r));return;case"b":case"e":Ae(n,5,qB(t,i,e.v,e.t));return;case"s":case"str":Ae(n,4,WB(t,i,(e.v||"").slice(0,255)));return}Ae(n,1,_u(null,t,i))}function YB(n,e,t,i){var r=Array.isArray(e),a=It(e["!ref"]||"A1"),o,c="",h=[];if(a.e.c>255||a.e.r>16383){if(i.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),o=hn(a)}for(var f=a.s.r;f<=a.e.r;++f){c=In(f);for(var p=a.s.c;p<=a.e.c;++p){f===a.s.r&&(h[p]=Hn(p)),o=h[p]+c;var g=r?(e[f]||[])[p]:e[o];g&&XB(n,g,f,p)}}}function KB(n,e){for(var t=e||{},i=li(),r=0,a=0;a<n.SheetNames.length;++a)n.SheetNames[a]==t.sheet&&(r=a);if(r==0&&t.sheet&&n.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return Ae(i,t.biff==4?1033:t.biff==3?521:9,bm(n,16,t)),YB(i,n.Sheets[n.SheetNames[r]],r,t),Ae(i,10),i.end()}function JB(n,e,t){Ae(n,49,GM({sz:12,name:"Arial"},t))}function QB(n,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var r=i[0];r<=i[1];++r)e[r]!=null&&Ae(n,1054,WM(r,e[r],t))})}function ZB(n,e){var t=he(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Ae(n,2151,t),t=he(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),fS(It(e["!ref"]||"A1"),t),t.write_shift(4,4),Ae(n,2152,t)}function e6(n,e){for(var t=0;t<16;++t)Ae(n,224,Dw({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(i){Ae(n,224,Dw(i,0,e))})}function t6(n,e){for(var t=0;t<e["!links"].length;++t){var i=e["!links"][t];Ae(n,440,tL(i)),i[1].Tooltip&&Ae(n,2048,nL(i))}delete e["!links"]}function n6(n,e){if(e){var t=0;e.forEach(function(i,r){++t<=256&&i&&Ae(n,125,sL(sd(r,i),r))})}}function i6(n,e,t,i,r){var a=16+Ys(r.cellXfs,e,r);if(e.v==null&&!e.bf){Ae(n,513,Ma(t,i,a));return}if(e.bf)Ae(n,6,CI(e,t,i,r,a));else switch(e.t){case"d":case"n":var o=e.t=="d"?ci(Jn(e.v)):e.v;Ae(n,515,JM(t,i,o,a));break;case"b":case"e":Ae(n,517,KM(t,i,e.v,a,r,e.t));break;case"s":case"str":if(r.bookSST){var c=Cm(r.Strings,e.v,r.revStrings);Ae(n,253,VM(t,i,c,a))}else Ae(n,516,qM(t,i,(e.v||"").slice(0,255),a,r));break;default:Ae(n,513,Ma(t,i,a))}}function r6(n,e,t){var i=li(),r=t.SheetNames[n],a=t.Sheets[r]||{},o=(t||{}).Workbook||{},c=(o.Sheets||[])[n]||{},h=Array.isArray(a),f=e.biff==8,p,g="",m=[],y=It(a["!ref"]||"A1"),w=f?65536:16384;if(y.e.c>255||y.e.r>=w){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,w-1)}Ae(i,2057,bm(t,16,e)),Ae(i,13,Xi(1)),Ae(i,12,Xi(100)),Ae(i,15,Yn(!0)),Ae(i,17,Yn(!1)),Ae(i,16,Na(.001)),Ae(i,95,Yn(!0)),Ae(i,42,Yn(!1)),Ae(i,43,Yn(!1)),Ae(i,130,Xi(1)),Ae(i,128,YM()),Ae(i,131,Yn(!1)),Ae(i,132,Yn(!1)),f&&n6(i,a["!cols"]),Ae(i,512,XM(y,e)),f&&(a["!links"]=[]);for(var _=y.s.r;_<=y.e.r;++_){g=In(_);for(var b=y.s.c;b<=y.e.c;++b){_===y.s.r&&(m[b]=Hn(b)),p=m[b]+g;var E=h?(a[_]||[])[b]:a[p];E&&(i6(i,E,_,b,e),f&&E.l&&a["!links"].push([p,E.l]))}}var T=c.CodeName||c.name||r;return f&&Ae(i,574,$M((o.Views||[])[0])),f&&(a["!merges"]||[]).length&&Ae(i,229,eL(a["!merges"])),f&&t6(i,a),Ae(i,442,hS(T)),f&&ZB(i,a),Ae(i,10),i.end()}function s6(n,e,t){var i=li(),r=(n||{}).Workbook||{},a=r.Sheets||[],o=r.WBProps||{},c=t.biff==8,h=t.biff==5;if(Ae(i,2057,bm(n,5,t)),t.bookType=="xla"&&Ae(i,135),Ae(i,225,c?Xi(1200):null),Ae(i,193,kM(2)),h&&Ae(i,191),h&&Ae(i,192),Ae(i,226),Ae(i,92,UM("SheetJS",t)),Ae(i,66,Xi(c?1200:1252)),c&&Ae(i,353,Xi(0)),c&&Ae(i,448),Ae(i,317,aL(n.SheetNames.length)),c&&n.vbaraw&&Ae(i,211),c&&n.vbaraw){var f=o.CodeName||"ThisWorkbook";Ae(i,442,hS(f))}Ae(i,156,Xi(17)),Ae(i,25,Yn(!1)),Ae(i,18,Yn(!1)),Ae(i,19,Xi(0)),c&&Ae(i,431,Yn(!1)),c&&Ae(i,444,Xi(0)),Ae(i,61,zM()),Ae(i,64,Yn(!1)),Ae(i,141,Xi(0)),Ae(i,34,Yn(uB(n)=="true")),Ae(i,14,Yn(!0)),c&&Ae(i,439,Yn(!1)),Ae(i,218,Xi(0)),JB(i,n,t),QB(i,n.SSF,t),e6(i,t),c&&Ae(i,352,Yn(!1));var p=i.end(),g=li();c&&Ae(g,140,iL()),c&&t.Strings&&VB(g,252,HM(t.Strings)),Ae(g,10);var m=g.end(),y=li(),w=0,_=0;for(_=0;_<n.SheetNames.length;++_)w+=(c?12:11)+(c?2:1)*n.SheetNames[_].length;var b=p.length+w+m.length;for(_=0;_<n.SheetNames.length;++_){var E=a[_]||{};Ae(y,133,jM({pos:b,hs:E.Hidden||0,dt:0,name:n.SheetNames[_]},t)),b+=e[_].length}var T=y.end();if(w!=T.length)throw new Error("BS8 "+w+" != "+T.length);var S=[];return p.length&&S.push(p),T.length&&S.push(T),m.length&&S.push(m),Ln(S)}function a6(n,e){var t=e||{},i=[];n&&!n.SSF&&(n.SSF=ui(Jt)),n&&n.SSF&&(ed(),Zf(n.SSF),t.revssf=td(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Rm(t),t.cellXfs=[],Ys(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var r=0;r<n.SheetNames.length;++r)i[i.length]=r6(r,t,n);return i.unshift(s6(n,i,t)),Ln(i)}function BS(n,e){for(var t=0;t<=n.SheetNames.length;++t){var i=n.Sheets[n.SheetNames[t]];if(!(!i||!i["!ref"])){var r=ki(i["!ref"]);r.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var a=e||{};switch(a.biff||2){case 8:case 5:return a6(n,e);case 4:case 3:case 2:return KB(n,e)}throw new Error("invalid type "+a.bookType+" for BIFF")}function o6(n,e,t,i){for(var r=n["!merges"]||[],a=[],o=e.s.c;o<=e.e.c;++o){for(var c=0,h=0,f=0;f<r.length;++f)if(!(r[f].s.r>t||r[f].s.c>o)&&!(r[f].e.r<t||r[f].e.c<o)){if(r[f].s.r<t||r[f].s.c<o){c=-1;break}c=r[f].e.r-r[f].s.r+1,h=r[f].e.c-r[f].s.c+1;break}if(!(c<0)){var p=wt({r:t,c:o}),g=i.dense?(n[t]||[])[o]:n[p],m=g&&g.v!=null&&(g.h||B3(g.w||(as(g),g.w)||""))||"",y={};c>1&&(y.rowspan=c),h>1&&(y.colspan=h),i.editable?m='<span contenteditable="true">'+m+"</span>":g&&(y["data-t"]=g&&g.t||"z",g.v!=null&&(y["data-v"]=g.v),g.z!=null&&(y["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+g.l.Target+'">'+m+"</a>")),y.id=(i.id||"sjs")+"-"+p,a.push(Se("td",m,y))}}var w="<tr>";return w+a.join("")+"</tr>"}var l6='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',c6="</body></html>";function u6(n,e,t){var i=[];return i.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function US(n,e){var t=e||{},i=t.header!=null?t.header:l6,r=t.footer!=null?t.footer:c6,a=[i],o=ki(n["!ref"]);t.dense=Array.isArray(n),a.push(u6(n,o,t));for(var c=o.s.r;c<=o.e.r;++c)a.push(o6(n,o,c,t));return a.push("</table>"+r),a.join("")}function jS(n,e,t){var i=t||{},r=0,a=0;if(i.origin!=null)if(typeof i.origin=="number")r=i.origin;else{var o=typeof i.origin=="string"?bn(i.origin):i.origin;r=o.r,a=o.c}var c=e.getElementsByTagName("tr"),h=Math.min(i.sheetRows||1e7,c.length),f={s:{r:0,c:0},e:{r,c:a}};if(n["!ref"]){var p=ki(n["!ref"]);f.s.r=Math.min(f.s.r,p.s.r),f.s.c=Math.min(f.s.c,p.s.c),f.e.r=Math.max(f.e.r,p.e.r),f.e.c=Math.max(f.e.c,p.e.c),r==-1&&(f.e.r=r=p.e.r+1)}var g=[],m=0,y=n["!rows"]||(n["!rows"]=[]),w=0,_=0,b=0,E=0,T=0,S=0;for(n["!cols"]||(n["!cols"]=[]);w<c.length&&_<h;++w){var k=c[w];if(Bw(k)){if(i.display)continue;y[_]={hidden:!0}}var P=k.children;for(b=E=0;b<P.length;++b){var F=P[b];if(!(i.display&&Bw(F))){var O=F.hasAttribute("data-v")?F.getAttribute("data-v"):F.hasAttribute("v")?F.getAttribute("v"):z3(F.innerHTML),G=F.getAttribute("data-z")||F.getAttribute("z");for(m=0;m<g.length;++m){var M=g[m];M.s.c==E+a&&M.s.r<_+r&&_+r<=M.e.r&&(E=M.e.c+1-a,m=-1)}S=+F.getAttribute("colspan")||1,((T=+F.getAttribute("rowspan")||1)>1||S>1)&&g.push({s:{r:_+r,c:E+a},e:{r:_+r+(T||1)-1,c:E+a+(S||1)-1}});var W={t:"s",v:O},Y=F.getAttribute("data-t")||F.getAttribute("t")||"";O!=null&&(O.length==0?W.t=Y||"z":i.raw||O.trim().length==0||Y=="s"||(O==="TRUE"?W={t:"b",v:!0}:O==="FALSE"?W={t:"b",v:!1}:isNaN(ns(O))?isNaN(Jc(O).getDate())||(W={t:"d",v:Jn(O)},i.cellDates||(W={t:"n",v:ci(W.v)}),W.z=i.dateNF||Jt[14]):W={t:"n",v:ns(O)})),W.z===void 0&&G!=null&&(W.z=G);var ce="",ve=F.getElementsByTagName("A");if(ve&&ve.length)for(var Ce=0;Ce<ve.length&&!(ve[Ce].hasAttribute("href")&&(ce=ve[Ce].getAttribute("href"),ce.charAt(0)!="#"));++Ce);ce&&ce.charAt(0)!="#"&&(W.l={Target:ce}),i.dense?(n[_+r]||(n[_+r]=[]),n[_+r][E+a]=W):n[wt({c:E+a,r:_+r})]=W,f.e.c<E+a&&(f.e.c=E+a),E+=S}}++_}return g.length&&(n["!merges"]=(n["!merges"]||[]).concat(g)),f.e.r=Math.max(f.e.r,_-1+r),n["!ref"]=hn(f),_>=h&&(n["!fullref"]=hn((f.e.r=c.length-w+_-1+r,f))),n}function HS(n,e){var t=e||{},i=t.dense?[]:{};return jS(i,n,e)}function h6(n,e){return Pa(HS(n,e),e)}function Bw(n){var e="",t=f6(n);return t&&(e=t(n).getPropertyValue("display")),e||(e=n.style&&n.style.display),e==="none"}function f6(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var d6=(function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Zc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return fn+e}})(),Uw=(function(){var n=function(a){return xt(a).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,i=function(a,o,c){var h=[];h.push('      <table:table table:name="'+xt(o.SheetNames[c])+`" table:style-name="ta1">
`);var f=0,p=0,g=ki(a["!ref"]||"A1"),m=a["!merges"]||[],y=0,w=Array.isArray(a);if(a["!cols"])for(p=0;p<=g.e.c;++p)h.push("        <table:table-column"+(a["!cols"][p]?' table:style-name="co'+a["!cols"][p].ods+'"':"")+`></table:table-column>
`);var _="",b=a["!rows"]||[];for(f=0;f<g.s.r;++f)_=b[f]?' table:style-name="ro'+b[f].ods+'"':"",h.push("        <table:table-row"+_+`></table:table-row>
`);for(;f<=g.e.r;++f){for(_=b[f]?' table:style-name="ro'+b[f].ods+'"':"",h.push("        <table:table-row"+_+`>
`),p=0;p<g.s.c;++p)h.push(e);for(;p<=g.e.c;++p){var E=!1,T={},S="";for(y=0;y!=m.length;++y)if(!(m[y].s.c>p)&&!(m[y].s.r>f)&&!(m[y].e.c<p)&&!(m[y].e.r<f)){(m[y].s.c!=p||m[y].s.r!=f)&&(E=!0),T["table:number-columns-spanned"]=m[y].e.c-m[y].s.c+1,T["table:number-rows-spanned"]=m[y].e.r-m[y].s.r+1;break}if(E){h.push(t);continue}var k=wt({r:f,c:p}),P=w?(a[f]||[])[p]:a[k];if(P&&P.f&&(T["table:formula"]=xt(MI(P.f)),P.F&&P.F.slice(0,k.length)==k)){var F=ki(P.F);T["table:number-matrix-columns-spanned"]=F.e.c-F.s.c+1,T["table:number-matrix-rows-spanned"]=F.e.r-F.s.r+1}if(!P){h.push(e);continue}switch(P.t){case"b":S=P.v?"TRUE":"FALSE",T["office:value-type"]="boolean",T["office:boolean-value"]=P.v?"true":"false";break;case"n":S=P.w||String(P.v||0),T["office:value-type"]="float",T["office:value"]=P.v||0;break;case"s":case"str":S=P.v==null?"":P.v,T["office:value-type"]="string";break;case"d":S=P.w||Jn(P.v).toISOString(),T["office:value-type"]="date",T["office:date-value"]=Jn(P.v).toISOString(),T["table:style-name"]="ce1";break;default:h.push(e);continue}var O=n(S);if(P.l&&P.l.Target){var G=P.l.Target;G=G.charAt(0)=="#"?"#"+LI(G.slice(1)):G,G.charAt(0)!="#"&&!G.match(/^\w+:/)&&(G="../"+G),O=Se("text:a",O,{"xlink:href":G.replace(/&/g,"&amp;")})}h.push("          "+Se("table:table-cell",Se("text:p",O,{}),T)+`
`)}h.push(`        </table:table-row>
`)}return h.push(`      </table:table>
`),h.join("")},r=function(a,o){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var c=0;o.SheetNames.map(function(f){return o.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var p=0;p<f["!cols"].length;++p)if(f["!cols"][p]){var g=f["!cols"][p];if(g.width==null&&g.wpx==null&&g.wch==null)continue;Em(g),g.ods=c;var m=f["!cols"][p].wpx+"px";a.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),a.push(`  </style:style>
`),++c}}});var h=0;o.SheetNames.map(function(f){return o.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var p=0;p<f["!rows"].length;++p)if(f["!rows"][p]){f["!rows"][p].ods=h;var g=f["!rows"][p].hpx+"px";a.push('  <style:style style:name="ro'+h+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+g+`"/>
`),a.push(`  </style:style>
`),++h}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(o,c){var h=[fn],f=Zc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=Zc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(h.push("<office:document"+f+p+`>
`),h.push(nS().replace(/office:document-meta/g,"office:meta"))):h.push("<office:document-content"+f+`>
`),r(h,o),h.push(`  <office:body>
`),h.push(`    <office:spreadsheet>
`);for(var g=0;g!=o.SheetNames.length;++g)h.push(i(o.Sheets[o.SheetNames[g]],o,g));return h.push(`    </office:spreadsheet>
`),h.push(`  </office:body>
`),c.bookType=="fods"?h.push("</office:document>"):h.push("</office:document-content>"),h.join("")}})();function zS(n,e){if(e.bookType=="fods")return Uw(n,e);var t=fm(),i="",r=[],a=[];return i="mimetype",et(t,i,"application/vnd.oasis.opendocument.spreadsheet"),i="content.xml",et(t,i,Uw(n,e)),r.push([i,"text/xml"]),a.push([i,"ContentFile"]),i="styles.xml",et(t,i,d6(n,e)),r.push([i,"text/xml"]),a.push([i,"StylesFile"]),i="meta.xml",et(t,i,fn+nS()),r.push([i,"text/xml"]),a.push([i,"MetadataFile"]),i="manifest.rdf",et(t,i,AM(a)),r.push([i,"application/rdf+xml"]),i="META-INF/manifest.xml",et(t,i,EM(r)),t}function If(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function p6(n){return typeof TextEncoder<"u"?new TextEncoder().encode(n):cr(Qc(n))}function g6(n,e){e:for(var t=0;t<=n.length-e.length;++t){for(var i=0;i<e.length;++i)if(n[t+i]!=e[i])continue e;return!0}return!1}function Xs(n){var e=n.reduce(function(r,a){return r+a.length},0),t=new Uint8Array(e),i=0;return n.forEach(function(r){t.set(r,i),i+=r.length}),t}function m6(n,e,t){var i=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,r=t/Math.pow(10,i-6176);n[e+15]|=i>>7,n[e+14]|=(i&127)<<1;for(var a=0;r>=1;++a,r/=256)n[e+a]=r&255;n[e+15]|=t>=0?0:128}function eu(n,e){var t=e?e[0]:0,i=n[t]&127;e:if(n[t++]>=128&&(i|=(n[t]&127)<<7,n[t++]<128||(i|=(n[t]&127)<<14,n[t++]<128)||(i|=(n[t]&127)<<21,n[t++]<128)||(i+=(n[t]&127)*Math.pow(2,28),++t,n[t++]<128)||(i+=(n[t]&127)*Math.pow(2,35),++t,n[t++]<128)||(i+=(n[t]&127)*Math.pow(2,42),++t,n[t++]<128)))break e;return e&&(e[0]=t),i}function yt(n){var e=new Uint8Array(7);e[0]=n&127;var t=1;e:if(n>127){if(e[t-1]|=128,e[t]=n>>7&127,++t,n<=16383||(e[t-1]|=128,e[t]=n>>14&127,++t,n<=2097151)||(e[t-1]|=128,e[t]=n>>21&127,++t,n<=268435455)||(e[t-1]|=128,e[t]=n/256>>>21&127,++t,n<=34359738367)||(e[t-1]|=128,e[t]=n/65536>>>21&127,++t,n<=4398046511103))break e;e[t-1]|=128,e[t]=n/16777216>>>21&127,++t}return e.slice(0,t)}function al(n){var e=0,t=n[e]&127;e:if(n[e++]>=128){if(t|=(n[e]&127)<<7,n[e++]<128||(t|=(n[e]&127)<<14,n[e++]<128)||(t|=(n[e]&127)<<21,n[e++]<128))break e;t|=(n[e]&127)<<28}return t}function mn(n){for(var e=[],t=[0];t[0]<n.length;){var i=t[0],r=eu(n,t),a=r&7;r=Math.floor(r/8);var o=0,c;if(r==0)break;switch(a){case 0:{for(var h=t[0];n[t[0]++]>=128;);c=n.slice(h,t[0])}break;case 5:o=4,c=n.slice(t[0],t[0]+o),t[0]+=o;break;case 1:o=8,c=n.slice(t[0],t[0]+o),t[0]+=o;break;case 2:o=eu(n,t),c=n.slice(t[0],t[0]+o),t[0]+=o;break;default:throw new Error("PB Type ".concat(a," for Field ").concat(r," at offset ").concat(i))}var f={data:c,type:a};e[r]==null?e[r]=[f]:e[r].push(f)}return e}function Dn(n){var e=[];return n.forEach(function(t,i){t.forEach(function(r){r.data&&(e.push(yt(i*8+r.type)),r.type==2&&e.push(yt(r.data.length)),e.push(r.data))})}),Xs(e)}function ir(n){for(var e,t=[],i=[0];i[0]<n.length;){var r=eu(n,i),a=mn(n.slice(i[0],i[0]+r));i[0]+=r;var o={id:al(a[1][0].data),messages:[]};a[2].forEach(function(c){var h=mn(c.data),f=al(h[3][0].data);o.messages.push({meta:h,data:n.slice(i[0],i[0]+f)}),i[0]+=f}),(e=a[3])!=null&&e[0]&&(o.merge=al(a[3][0].data)>>>0>0),t.push(o)}return t}function Bo(n){var e=[];return n.forEach(function(t){var i=[];i[1]=[{data:yt(t.id),type:0}],i[2]=[],t.merge!=null&&(i[3]=[{data:yt(+!!t.merge),type:0}]);var r=[];t.messages.forEach(function(o){r.push(o.data),o.meta[3]=[{type:0,data:yt(o.data.length)}],i[2].push({data:Dn(o.meta),type:2})});var a=Dn(i);e.push(yt(a.length)),e.push(a),r.forEach(function(o){return e.push(o)})}),Xs(e)}function v6(n,e){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var t=[0],i=eu(e,t),r=[];t[0]<e.length;){var a=e[t[0]]&3;if(a==0){var o=e[t[0]++]>>2;if(o<60)++o;else{var c=o-59;o=e[t[0]],c>1&&(o|=e[t[0]+1]<<8),c>2&&(o|=e[t[0]+2]<<16),c>3&&(o|=e[t[0]+3]<<24),o>>>=0,o++,t[0]+=c}r.push(e.slice(t[0],t[0]+o)),t[0]+=o;continue}else{var h=0,f=0;if(a==1?(f=(e[t[0]]>>2&7)+4,h=(e[t[0]++]&224)<<3,h|=e[t[0]++]):(f=(e[t[0]++]>>2)+1,a==2?(h=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(h=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),r=[Xs(r)],h==0)throw new Error("Invalid offset 0");if(h>r[0].length)throw new Error("Invalid offset beyond length");if(f>=h)for(r.push(r[0].slice(-h)),f-=h;f>=r[r.length-1].length;)r.push(r[r.length-1]),f-=r[r.length-1].length;r.push(r[0].slice(-h,-h+f))}}var p=Xs(r);if(p.length!=i)throw new Error("Unexpected length: ".concat(p.length," != ").concat(i));return p}function rr(n){for(var e=[],t=0;t<n.length;){var i=n[t++],r=n[t]|n[t+1]<<8|n[t+2]<<16;t+=3,e.push(v6(i,n.slice(t,t+r))),t+=r}if(t!==n.length)throw new Error("data is not a valid framed stream!");return Xs(e)}function Uo(n){for(var e=[],t=0;t<n.length;){var i=Math.min(n.length-t,268435455),r=new Uint8Array(4);e.push(r);var a=yt(i),o=a.length;e.push(a),i<=60?(o++,e.push(new Uint8Array([i-1<<2]))):i<=256?(o+=2,e.push(new Uint8Array([240,i-1&255]))):i<=65536?(o+=3,e.push(new Uint8Array([244,i-1&255,i-1>>8&255]))):i<=16777216?(o+=4,e.push(new Uint8Array([248,i-1&255,i-1>>8&255,i-1>>16&255]))):i<=4294967296&&(o+=5,e.push(new Uint8Array([252,i-1&255,i-1>>8&255,i-1>>16&255,i-1>>>24&255]))),e.push(n.slice(t,t+i)),o+=i,r[0]=0,r[1]=o&255,r[2]=o>>8&255,r[3]=o>>16&255,t+=i}return Xs(e)}function Qp(n,e){var t=new Uint8Array(32),i=If(t),r=12,a=0;switch(t[0]=5,n.t){case"n":t[1]=2,m6(t,r,n.v),a|=1,r+=16;break;case"b":t[1]=6,i.setFloat64(r,n.v?1:0,!0),a|=2,r+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[1]=3,i.setUint32(r,e.indexOf(n.v),!0),a|=8,r+=4;break;default:throw"unsupported cell type "+n.t}return i.setUint32(8,a,!0),t.slice(0,r)}function Zp(n,e){var t=new Uint8Array(32),i=If(t),r=12,a=0;switch(t[0]=3,n.t){case"n":t[2]=2,i.setFloat64(r,n.v,!0),a|=32,r+=8;break;case"b":t[2]=6,i.setFloat64(r,n.v?1:0,!0),a|=32,r+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[2]=3,i.setUint32(r,e.indexOf(n.v),!0),a|=16,r+=4;break;default:throw"unsupported cell type "+n.t}return i.setUint32(4,a,!0),t.slice(0,r)}function Ls(n){var e=mn(n);return eu(e[1][0].data)}function y6(n,e,t){var i,r,a,o;if(!((i=n[6])!=null&&i[0])||!((r=n[7])!=null&&r[0]))throw"Mutation only works on post-BNC storages!";var c=((o=(a=n[8])==null?void 0:a[0])==null?void 0:o.data)&&al(n[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var h=0,f=If(n[7][0].data),p=0,g=[],m=If(n[4][0].data),y=0,w=[],_=0;_<e.length;++_){if(e[_]==null){f.setUint16(_*2,65535,!0),m.setUint16(_*2,65535);continue}f.setUint16(_*2,p,!0),m.setUint16(_*2,y,!0);var b,E;switch(typeof e[_]){case"string":b=Qp({t:"s",v:e[_]},t),E=Zp({t:"s",v:e[_]},t);break;case"number":b=Qp({t:"n",v:e[_]},t),E=Zp({t:"n",v:e[_]},t);break;case"boolean":b=Qp({t:"b",v:e[_]},t),E=Zp({t:"b",v:e[_]},t);break;default:throw new Error("Unsupported value "+e[_])}g.push(b),p+=b.length,w.push(E),y+=E.length,++h}for(n[2][0].data=yt(h);_<n[7][0].data.length/2;++_)f.setUint16(_*2,65535,!0),m.setUint16(_*2,65535,!0);return n[6][0].data=Xs(g),n[3][0].data=Xs(w),h}function _6(n,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=n.Sheets[n.SheetNames[0]];n.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var i=ki(t["!ref"]);i.s.r=i.s.c=0;var r=!1;i.e.c>9&&(r=!0,i.e.c=9),i.e.r>49&&(r=!0,i.e.r=49),r&&console.error("The Numbers writer is currently limited to ".concat(hn(i)));var a=Pf(t,{range:i,header:1}),o=["~Sh33tJ5~"];a.forEach(function(z){return z.forEach(function(H){typeof H=="string"&&o.push(H)})});var c={},h=[],f=Tt.read(e.numbers,{type:"base64"});f.FileIndex.map(function(z,H){return[z,f.FullPaths[H]]}).forEach(function(z){var H=z[0],q=z[1];if(H.type==2&&H.name.match(/\.iwa/)){var oe=H.content,me=rr(oe),Re=ir(me);Re.forEach(function(be){h.push(be.id),c[be.id]={deps:[],location:q,type:al(be.messages[0].meta[1][0].data)}})}}),h.sort(function(z,H){return z-H});var p=h.filter(function(z){return z>1}).map(function(z){return[z,yt(z)]});f.FileIndex.map(function(z,H){return[z,f.FullPaths[H]]}).forEach(function(z){var H=z[0];if(z[1],!!H.name.match(/\.iwa/)){var q=ir(rr(H.content));q.forEach(function(oe){oe.messages.forEach(function(me){p.forEach(function(Re){oe.messages.some(function(be){return al(be.meta[1][0].data)!=11006&&g6(be.data,Re[1])})&&c[Re[0]].deps.push(oe.id)})})})}});for(var g=Tt.find(f,c[1].location),m=ir(rr(g.content)),y,w=0;w<m.length;++w){var _=m[w];_.id==1&&(y=_)}var b=Ls(mn(y.messages[0].data)[1][0].data);for(g=Tt.find(f,c[b].location),m=ir(rr(g.content)),w=0;w<m.length;++w)_=m[w],_.id==b&&(y=_);for(b=Ls(mn(y.messages[0].data)[2][0].data),g=Tt.find(f,c[b].location),m=ir(rr(g.content)),w=0;w<m.length;++w)_=m[w],_.id==b&&(y=_);for(b=Ls(mn(y.messages[0].data)[2][0].data),g=Tt.find(f,c[b].location),m=ir(rr(g.content)),w=0;w<m.length;++w)_=m[w],_.id==b&&(y=_);var E=mn(y.messages[0].data);{E[6][0].data=yt(i.e.r+1),E[7][0].data=yt(i.e.c+1);var T=Ls(E[46][0].data),S=Tt.find(f,c[T].location),k=ir(rr(S.content));{for(var P=0;P<k.length&&k[P].id!=T;++P);if(k[P].id!=T)throw"Bad ColumnRowUIDMapArchive";var F=mn(k[P].messages[0].data);F[1]=[],F[2]=[],F[3]=[];for(var O=0;O<=i.e.c;++O){var G=[];G[1]=G[2]=[{type:0,data:yt(O+420690)}],F[1].push({type:2,data:Dn(G)}),F[2].push({type:0,data:yt(O)}),F[3].push({type:0,data:yt(O)})}F[4]=[],F[5]=[],F[6]=[];for(var M=0;M<=i.e.r;++M)G=[],G[1]=G[2]=[{type:0,data:yt(M+726270)}],F[4].push({type:2,data:Dn(G)}),F[5].push({type:0,data:yt(M)}),F[6].push({type:0,data:yt(M)});k[P].messages[0].data=Dn(F)}S.content=Uo(Bo(k)),S.size=S.content.length,delete E[46];var W=mn(E[4][0].data);{W[7][0].data=yt(i.e.r+1);var Y=mn(W[1][0].data),ce=Ls(Y[2][0].data);S=Tt.find(f,c[ce].location),k=ir(rr(S.content));{if(k[0].id!=ce)throw"Bad HeaderStorageBucket";var ve=mn(k[0].messages[0].data);for(M=0;M<a.length;++M){var Ce=mn(ve[2][0].data);Ce[1][0].data=yt(M),Ce[4][0].data=yt(a[M].length),ve[2][M]={type:ve[2][0].type,data:Dn(Ce)}}k[0].messages[0].data=Dn(ve)}S.content=Uo(Bo(k)),S.size=S.content.length;var ke=Ls(W[2][0].data);S=Tt.find(f,c[ke].location),k=ir(rr(S.content));{if(k[0].id!=ke)throw"Bad HeaderStorageBucket";for(ve=mn(k[0].messages[0].data),O=0;O<=i.e.c;++O)Ce=mn(ve[2][0].data),Ce[1][0].data=yt(O),Ce[4][0].data=yt(i.e.r+1),ve[2][O]={type:ve[2][0].type,data:Dn(Ce)};k[0].messages[0].data=Dn(ve)}S.content=Uo(Bo(k)),S.size=S.content.length;var J=Ls(W[4][0].data);(function(){for(var z=Tt.find(f,c[J].location),H=ir(rr(z.content)),q,oe=0;oe<H.length;++oe){var me=H[oe];me.id==J&&(q=me)}var Re=mn(q.messages[0].data);{Re[3]=[];var be=[];o.forEach(function(Je,Qt){be[1]=[{type:0,data:yt(Qt)}],be[2]=[{type:0,data:yt(1)}],be[3]=[{type:2,data:p6(Je)}],Re[3].push({type:2,data:Dn(be)})})}q.messages[0].data=Dn(Re);var Te=Bo(H),it=Uo(Te);z.content=it,z.size=z.content.length})();var ae=mn(W[3][0].data);{var we=ae[1][0];delete ae[2];var Pe=mn(we.data);{var $e=Ls(Pe[2][0].data);(function(){for(var z=Tt.find(f,c[$e].location),H=ir(rr(z.content)),q,oe=0;oe<H.length;++oe){var me=H[oe];me.id==$e&&(q=me)}var Re=mn(q.messages[0].data);{delete Re[6],delete ae[7];var be=new Uint8Array(Re[5][0].data);Re[5]=[];for(var Te=0,it=0;it<=i.e.r;++it){var Je=mn(be);Te+=y6(Je,a[it],o),Je[1][0].data=yt(it),Re[5].push({data:Dn(Je),type:2})}Re[1]=[{type:0,data:yt(i.e.c+1)}],Re[2]=[{type:0,data:yt(i.e.r+1)}],Re[3]=[{type:0,data:yt(Te)}],Re[4]=[{type:0,data:yt(i.e.r+1)}]}q.messages[0].data=Dn(Re);var Qt=Bo(H),Ze=Uo(Qt);z.content=Ze,z.size=z.content.length})()}we.data=Dn(Pe)}W[3][0].data=Dn(ae)}E[4][0].data=Dn(W)}y.messages[0].data=Dn(E);var V=Bo(m),N=Uo(V);return g.content=N,g.size=g.content.length,f}function x6(n){return function(t){for(var i=0;i!=n.length;++i){var r=n[i];t[r[0]]===void 0&&(t[r[0]]=r[1]),r[2]==="n"&&(t[r[0]]=Number(t[r[0]]))}}}function Rm(n){x6([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function w6(n,e){return e.bookType=="ods"?zS(n,e):e.bookType=="numbers"?_6(n,e):e.bookType=="xlsb"?b6(n,e):E6(n,e)}function b6(n,e){Jo=1024,n&&!n.SSF&&(n.SSF=ui(Jt)),n&&n.SSF&&(ed(),Zf(n.SSF),e.revssf=td(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Nc?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",i=SS.indexOf(e.bookType)>-1,r=ZE();Rm(e=e||{});var a=fm(),o="",c=0;if(e.cellXfs=[],Ys(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),o="docProps/core.xml",et(a,o,iS(n.Props,e)),r.coreprops.push(o),_t(e.rels,2,o,ht.CORE_PROPS),o="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var h=[],f=0;f<n.SheetNames.length;++f)(n.Workbook.Sheets[f]||{}).Hidden!=2&&h.push(n.SheetNames[f]);n.Props.SheetNames=h}for(n.Props.Worksheets=n.Props.SheetNames.length,et(a,o,sS(n.Props)),r.extprops.push(o),_t(e.rels,3,o,ht.EXT_PROPS),n.Custprops!==n.Props&&Pn(n.Custprops||{}).length>0&&(o="docProps/custom.xml",et(a,o,aS(n.Custprops)),r.custprops.push(o),_t(e.rels,4,o,ht.CUST_PROPS)),c=1;c<=n.SheetNames.length;++c){var p={"!id":{}},g=n.Sheets[n.SheetNames[c-1]],m=(g||{})["!type"]||"sheet";if(o="xl/worksheets/sheet"+c+"."+t,et(a,o,AB(c-1,o,e,n,p)),r.sheets.push(o),_t(e.wbrels,-1,"worksheets/sheet"+c+"."+t,ht.WS[0]),g){var y=g["!comments"],w=!1,_="";y&&y.length>0&&(_="xl/comments"+c+"."+t,et(a,_,RB(y,_)),r.comments.push(_),_t(p,-1,"../comments"+c+"."+t,ht.CMNT),w=!0),g["!legacy"]&&w&&et(a,"xl/drawings/vmlDrawing"+c+".vml",bS(c,g["!comments"])),delete g["!comments"],delete g["!legacy"]}p["!id"].rId1&&et(a,tS(o),rl(p))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+t,et(a,o,CB(e.Strings,o,e)),r.strs.push(o),_t(e.wbrels,-1,"sharedStrings."+t,ht.SST)),o="xl/workbook."+t,et(a,o,SB(n,o)),r.workbooks.push(o),_t(e.rels,1,o,ht.WB),o="xl/theme/theme1.xml",et(a,o,xS(n.Themes,e)),r.themes.push(o),_t(e.wbrels,-1,"theme/theme1.xml",ht.THEME),o="xl/styles."+t,et(a,o,TB(n,o,e)),r.styles.push(o),_t(e.wbrels,-1,"styles."+t,ht.STY),n.vbaraw&&i&&(o="xl/vbaProject.bin",et(a,o,n.vbaraw),r.vba.push(o),_t(e.wbrels,-1,"vbaProject.bin",ht.VBA)),o="xl/metadata."+t,et(a,o,OB(o)),r.metadata.push(o),_t(e.wbrels,-1,"metadata."+t,ht.XLMETA),et(a,"[Content_Types].xml",eS(r,e)),et(a,"_rels/.rels",rl(e.rels)),et(a,"xl/_rels/workbook."+t+".rels",rl(e.wbrels)),delete e.revssf,delete e.ssf,a}function E6(n,e){Jo=1024,n&&!n.SSF&&(n.SSF=ui(Jt)),n&&n.SSF&&(ed(),Zf(n.SSF),e.revssf=td(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Nc?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",i=SS.indexOf(e.bookType)>-1,r=ZE();Rm(e=e||{});var a=fm(),o="",c=0;if(e.cellXfs=[],Ys(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),o="docProps/core.xml",et(a,o,iS(n.Props,e)),r.coreprops.push(o),_t(e.rels,2,o,ht.CORE_PROPS),o="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var h=[],f=0;f<n.SheetNames.length;++f)(n.Workbook.Sheets[f]||{}).Hidden!=2&&h.push(n.SheetNames[f]);n.Props.SheetNames=h}n.Props.Worksheets=n.Props.SheetNames.length,et(a,o,sS(n.Props)),r.extprops.push(o),_t(e.rels,3,o,ht.EXT_PROPS),n.Custprops!==n.Props&&Pn(n.Custprops||{}).length>0&&(o="docProps/custom.xml",et(a,o,aS(n.Custprops)),r.custprops.push(o),_t(e.rels,4,o,ht.CUST_PROPS));var p=["SheetJ5"];for(e.tcid=0,c=1;c<=n.SheetNames.length;++c){var g={"!id":{}},m=n.Sheets[n.SheetNames[c-1]],y=(m||{})["!type"]||"sheet";if(o="xl/worksheets/sheet"+c+"."+t,et(a,o,MS(c-1,e,n,g)),r.sheets.push(o),_t(e.wbrels,-1,"worksheets/sheet"+c+"."+t,ht.WS[0]),m){var w=m["!comments"],_=!1,b="";if(w&&w.length>0){var E=!1;w.forEach(function(T){T[1].forEach(function(S){S.T==!0&&(E=!0)})}),E&&(b="xl/threadedComments/threadedComment"+c+"."+t,et(a,b,eF(w,p,e)),r.threadedcomments.push(b),_t(g,-1,"../threadedComments/threadedComment"+c+"."+t,ht.TCMNT)),b="xl/comments"+c+"."+t,et(a,b,ES(w)),r.comments.push(b),_t(g,-1,"../comments"+c+"."+t,ht.CMNT),_=!0}m["!legacy"]&&_&&et(a,"xl/drawings/vmlDrawing"+c+".vml",bS(c,m["!comments"])),delete m["!comments"],delete m["!legacy"]}g["!id"].rId1&&et(a,tS(o),rl(g))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+t,et(a,o,pS(e.Strings,e)),r.strs.push(o),_t(e.wbrels,-1,"sharedStrings."+t,ht.SST)),o="xl/workbook."+t,et(a,o,IS(n)),r.workbooks.push(o),_t(e.rels,1,o,ht.WB),o="xl/theme/theme1.xml",et(a,o,xS(n.Themes,e)),r.themes.push(o),_t(e.wbrels,-1,"theme/theme1.xml",ht.THEME),o="xl/styles."+t,et(a,o,yS(n,e)),r.styles.push(o),_t(e.wbrels,-1,"styles."+t,ht.STY),n.vbaraw&&i&&(o="xl/vbaProject.bin",et(a,o,n.vbaraw),r.vba.push(o),_t(e.wbrels,-1,"vbaProject.bin",ht.VBA)),o="xl/metadata."+t,et(a,o,wS()),r.metadata.push(o),_t(e.wbrels,-1,"metadata."+t,ht.XLMETA),p.length>1&&(o="xl/persons/person.xml",et(a,o,tF(p)),r.people.push(o),_t(e.wbrels,-1,"persons/person.xml",ht.PEOPLE)),et(a,"[Content_Types].xml",eS(r,e)),et(a,"_rels/.rels",rl(e.rels)),et(a,"xl/_rels/workbook."+t+".rels",rl(e.wbrels)),delete e.revssf,delete e.ssf,a}function S6(n,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":t=ss(n.slice(0,12));break;case"binary":t=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function $S(n,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return gu(e.file,Tt.write(n,{type:gt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Tt.write(n,e)}function A6(n,e){var t=ui(e||{}),i=w6(n,t);return T6(i,t)}function T6(n,e){var t={},i=gt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=i;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=i;break;default:throw new Error("Unrecognized type "+e.type)}var r=n.FullPaths?Tt.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):n.generate(t);if(typeof Deno<"u"&&typeof r=="string"){if(e.type=="binary"||e.type=="base64")return r;r=new Uint8Array(Qf(r))}return e.password&&typeof encrypt_agile<"u"?$S(encrypt_agile(r,e.password),e):e.type==="file"?gu(e.file,r):e.type=="string"?Rc(r):r}function C6(n,e){var t=e||{},i=$B(n,t);return $S(i,t)}function Ar(n,e,t){t||(t="");var i=t+n;switch(e.type){case"base64":return Kc(Qc(i));case"binary":return Qc(i);case"string":return n;case"file":return gu(e.file,i,"utf8");case"buffer":return gt?ls(i,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(i):Ar(i,{type:"binary"}).split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function R6(n,e){switch(e.type){case"base64":return Kc(n);case"binary":return n;case"string":return n;case"file":return gu(e.file,n,"binary");case"buffer":return gt?ls(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function lf(n,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",i=0;i<n.length;++i)t+=String.fromCharCode(n[i]);return e.type=="base64"?Kc(t):e.type=="string"?Rc(t):t;case"file":return gu(e.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+e.type)}}function GS(n,e){n3(),dB(n);var t=ui(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var i=GS(n,t);return t.type="array",Qf(i)}var r=0;if(t.sheet&&(typeof t.sheet=="number"?r=t.sheet:r=n.SheetNames.indexOf(t.sheet),!n.SheetNames[r]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Ar(HB(n,t),t);case"slk":case"sylk":return Ar(uL.from_sheet(n.Sheets[n.SheetNames[r]],t),t);case"htm":case"html":return Ar(US(n.Sheets[n.SheetNames[r]],t),t);case"txt":return R6(VS(n.Sheets[n.SheetNames[r]],t),t);case"csv":return Ar(Om(n.Sheets[n.SheetNames[r]],t),t,"\uFEFF");case"dif":return Ar(hL.from_sheet(n.Sheets[n.SheetNames[r]],t),t);case"dbf":return lf(cL.from_sheet(n.Sheets[n.SheetNames[r]],t),t);case"prn":return Ar(fL.from_sheet(n.Sheets[n.SheetNames[r]],t),t);case"rtf":return Ar(_L.from_sheet(n.Sheets[n.SheetNames[r]],t),t);case"eth":return Ar(dS.from_sheet(n.Sheets[n.SheetNames[r]],t),t);case"fods":return Ar(zS(n,t),t);case"wk1":return lf(Nw.sheet_to_wk1(n.Sheets[n.SheetNames[r]],t),t);case"wk3":return lf(Nw.book_to_wk3(n,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),lf(BS(n,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),C6(n,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return A6(n,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function O6(n){if(!n.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=n.file.slice(n.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(n.bookType=t.slice(1)),n.bookType=e[n.bookType]||n.bookType}}function k6(n,e,t){var i={};return i.type="file",i.file=e,O6(i),GS(n,i)}function D6(n,e,t,i,r,a,o,c){var h=In(t),f=c.defval,p=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),g=!0,m=r===1?[]:{};if(r!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:t,enumerable:!1})}catch{m.__rowNum__=t}else m.__rowNum__=t;if(!o||n[t])for(var y=e.s.c;y<=e.e.c;++y){var w=o?n[t][y]:n[i[y]+h];if(w===void 0||w.t===void 0){if(f===void 0)continue;a[y]!=null&&(m[a[y]]=f);continue}var _=w.v;switch(w.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(a[y]!=null){if(_==null)if(w.t=="e"&&_===null)m[a[y]]=null;else if(f!==void 0)m[a[y]]=f;else if(p&&_===null)m[a[y]]=null;else continue;else m[a[y]]=p&&(w.t!=="n"||w.t==="n"&&c.rawNumbers!==!1)?_:as(w,_,c);_!=null&&(g=!1)}}return{row:m,isempty:g}}function Pf(n,e){if(n==null||n["!ref"]==null)return[];var t={t:"n",v:0},i=0,r=1,a=[],o=0,c="",h={s:{r:0,c:0},e:{r:0,c:0}},f=e||{},p=f.range!=null?f.range:n["!ref"];switch(f.header===1?i=1:f.header==="A"?i=2:Array.isArray(f.header)?i=3:f.header==null&&(i=0),typeof p){case"string":h=It(p);break;case"number":h=It(n["!ref"]),h.s.r=p;break;default:h=p}i>0&&(r=0);var g=In(h.s.r),m=[],y=[],w=0,_=0,b=Array.isArray(n),E=h.s.r,T=0,S={};b&&!n[E]&&(n[E]=[]);var k=f.skipHidden&&n["!cols"]||[],P=f.skipHidden&&n["!rows"]||[];for(T=h.s.c;T<=h.e.c;++T)if(!(k[T]||{}).hidden)switch(m[T]=Hn(T),t=b?n[E][T]:n[m[T]+g],i){case 1:a[T]=T-h.s.c;break;case 2:a[T]=m[T];break;case 3:a[T]=f.header[T-h.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),c=o=as(t,null,f),_=S[o]||0,!_)S[o]=1;else{do c=o+"_"+_++;while(S[c]);S[o]=_,S[c]=1}a[T]=c}for(E=h.s.r+r;E<=h.e.r;++E)if(!(P[E]||{}).hidden){var F=D6(n,h,E,m,i,a,b,f);(F.isempty===!1||(i===1?f.blankrows!==!1:f.blankrows))&&(y[w++]=F.row)}return y.length=w,y}var jw=/"/g;function N6(n,e,t,i,r,a,o,c){for(var h=!0,f=[],p="",g=In(t),m=e.s.c;m<=e.e.c;++m)if(i[m]){var y=c.dense?(n[t]||[])[m]:n[i[m]+g];if(y==null)p="";else if(y.v!=null){h=!1,p=""+(c.rawNumbers&&y.t=="n"?y.v:as(y,null,c));for(var w=0,_=0;w!==p.length;++w)if((_=p.charCodeAt(w))===r||_===a||_===34||c.forceQuotes){p='"'+p.replace(jw,'""')+'"';break}p=="ID"&&(p='"ID"')}else y.f!=null&&!y.F?(h=!1,p="="+y.f,p.indexOf(",")>=0&&(p='"'+p.replace(jw,'""')+'"')):p="";f.push(p)}return c.blankrows===!1&&h?null:f.join(o)}function Om(n,e){var t=[],i=e??{};if(n==null||n["!ref"]==null)return"";var r=It(n["!ref"]),a=i.FS!==void 0?i.FS:",",o=a.charCodeAt(0),c=i.RS!==void 0?i.RS:`
`,h=c.charCodeAt(0),f=new RegExp((a=="|"?"\\|":a)+"+$"),p="",g=[];i.dense=Array.isArray(n);for(var m=i.skipHidden&&n["!cols"]||[],y=i.skipHidden&&n["!rows"]||[],w=r.s.c;w<=r.e.c;++w)(m[w]||{}).hidden||(g[w]=Hn(w));for(var _=0,b=r.s.r;b<=r.e.r;++b)(y[b]||{}).hidden||(p=N6(n,r,b,g,o,h,a,i),p!=null&&(i.strip&&(p=p.replace(f,"")),(p||i.blankrows!==!1)&&t.push((_++?c:"")+p)));return delete i.dense,t.join("")}function VS(n,e){e||(e={}),e.FS="	",e.RS=`
`;var t=Om(n,e);return t}function M6(n){var e="",t,i="";if(n==null||n["!ref"]==null)return[];var r=It(n["!ref"]),a="",o=[],c,h=[],f=Array.isArray(n);for(c=r.s.c;c<=r.e.c;++c)o[c]=Hn(c);for(var p=r.s.r;p<=r.e.r;++p)for(a=In(p),c=r.s.c;c<=r.e.c;++c)if(e=o[c]+a,t=f?(n[p]||[])[c]:n[e],i="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;i=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)i=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)i=""+t.v;else if(t.t=="b")i=t.v?"TRUE":"FALSE";else if(t.w!==void 0)i="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?i="'"+t.v:i=""+t.v}}h[h.length]=e+"="+i}return h}function qS(n,e,t){var i=t||{},r=+!i.skipHeader,a=n||{},o=0,c=0;if(a&&i.origin!=null)if(typeof i.origin=="number")o=i.origin;else{var h=typeof i.origin=="string"?bn(i.origin):i.origin;o=h.r,c=h.c}var f,p={s:{c:0,r:0},e:{c,r:o+e.length-1+r}};if(a["!ref"]){var g=It(a["!ref"]);p.e.c=Math.max(p.e.c,g.e.c),p.e.r=Math.max(p.e.r,g.e.r),o==-1&&(o=g.e.r+1,p.e.r=o+e.length-1+r)}else o==-1&&(o=0,p.e.r=e.length-1+r);var m=i.header||[],y=0;e.forEach(function(_,b){Pn(_).forEach(function(E){(y=m.indexOf(E))==-1&&(m[y=m.length]=E);var T=_[E],S="z",k="",P=wt({c:c+y,r:o+b+r});f=tu(a,P),T&&typeof T=="object"&&!(T instanceof Date)?a[P]=T:(typeof T=="number"?S="n":typeof T=="boolean"?S="b":typeof T=="string"?S="s":T instanceof Date?(S="d",i.cellDates||(S="n",T=ci(T)),k=i.dateNF||Jt[14]):T===null&&i.nullError&&(S="e",T=0),f?(f.t=S,f.v=T,delete f.w,delete f.R,k&&(f.z=k)):a[P]=f={t:S,v:T},k&&(f.z=k))})}),p.e.c=Math.max(p.e.c,c+m.length-1);var w=In(o);if(r)for(y=0;y<m.length;++y)a[Hn(y+c)+w]={t:"s",v:m[y]};return a["!ref"]=hn(p),a}function L6(n,e){return qS(null,n,e)}function tu(n,e,t){if(typeof e=="string"){if(Array.isArray(n)){var i=bn(e);return n[i.r]||(n[i.r]=[]),n[i.r][i.c]||(n[i.r][i.c]={t:"z"})}return n[e]||(n[e]={t:"z"})}return typeof e!="number"?tu(n,wt(e)):tu(n,wt({r:e,c:t||0}))}function F6(n,e){if(typeof e=="number"){if(e>=0&&n.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=n.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function I6(){return{SheetNames:[],Sheets:{}}}function P6(n,e,t,i){var r=1;if(!t)for(;r<=65535&&n.SheetNames.indexOf(t="Sheet"+r)!=-1;++r,t=void 0);if(!t||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&n.SheetNames.indexOf(t)>=0){var a=t.match(/(^.*?)(\d+)$/);r=a&&+a[2]||0;var o=a&&a[1]||t;for(++r;r<=65535&&n.SheetNames.indexOf(t=o+r)!=-1;++r);}if(FS(t),n.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return n.SheetNames.push(t),n.Sheets[t]=e,t}function B6(n,e,t){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var i=F6(n,e);switch(n.Workbook.Sheets[i]||(n.Workbook.Sheets[i]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}n.Workbook.Sheets[i].Hidden=t}function U6(n,e){return n.z=e,n}function WS(n,e,t){return e?(n.l={Target:e},t&&(n.l.Tooltip=t)):delete n.l,n}function j6(n,e,t){return WS(n,"#"+e,t)}function H6(n,e,t){n.c||(n.c=[]),n.c.push({t:e,a:t||"SheetJS"})}function z6(n,e,t,i){for(var r=typeof e!="string"?e:It(e),a=typeof e=="string"?e:hn(e),o=r.s.r;o<=r.e.r;++o)for(var c=r.s.c;c<=r.e.c;++c){var h=tu(n,o,c);h.t="n",h.F=a,delete h.v,o==r.s.r&&c==r.s.c&&(h.f=t,i&&(h.D=!0))}return n}var eg={encode_col:Hn,encode_row:In,encode_cell:wt,encode_range:hn,decode_col:ym,decode_row:vm,split_cell:nM,decode_cell:bn,decode_range:ki,format_cell:as,sheet_add_aoa:WE,sheet_add_json:qS,sheet_add_dom:jS,aoa_to_sheet:dl,json_to_sheet:L6,table_to_sheet:HS,table_to_book:h6,sheet_to_csv:Om,sheet_to_txt:VS,sheet_to_json:Pf,sheet_to_html:US,sheet_to_formulae:M6,sheet_to_row_object_array:Pf,sheet_get_cell:tu,book_new:I6,book_append_sheet:P6,book_set_sheet_visibility:B6,cell_set_number_format:U6,cell_set_hyperlink:WS,cell_set_internal_link:j6,cell_add_comment:H6,sheet_set_array_formula:z6,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function $6(){const{examId:n}=eb(),[e,t]=Z.useState(null),[i,r]=Z.useState([]),[a,o]=Z.useState(!0);Z.useEffect(()=>{async function y(){if(!n)return;const{data:w}=await Rr.from("exams").select("*").eq("id",n).single();w&&t(w);const _=await Vp(n);r(_),o(!1)}y()},[n]),Z.useEffect(()=>{if(!n)return;const y=Rr.channel("submissions-changes").on("postgres_changes",{event:"*",schema:"public",table:"submissions",filter:`exam_id=eq.${n}`},async()=>{const w=await Vp(n);r(w)}).subscribe();return()=>{Rr.removeChannel(y)}},[n]);const c=y=>{const w=Math.floor(y/60),_=y%60;return`${w}:${_.toString().padStart(2,"0")}`},h=()=>{if(!e)return;const y=i.map(b=>({"Tn hc sinh":b.student_name,"Trng thi":b.status==="submitted"?" np":"ang lm",im:b.score,"Tng cu":b.total_questions,"S ln thot":b.exit_count,"Thi gian lm":c(b.time_spent),"Bt u":new Date(b.started_at).toLocaleString("vi-VN"),"Np bi":b.submitted_at?new Date(b.submitted_at).toLocaleString("vi-VN"):"-"})),w=eg.json_to_sheet(y),_=eg.book_new();eg.book_append_sheet(_,w,"Kt qu"),k6(_,`${e.title}_ketqua.xlsx`)},f=async()=>{if(!n)return;o(!0);const y=await Vp(n);r(y),o(!1)};if(a)return C.jsx("div",{className:"page flex items-center justify-center",children:C.jsx("div",{className:"spinner"})});if(!e)return C.jsx("div",{className:"page",children:C.jsxs("div",{className:"container text-center",children:[C.jsx("h2",{children:"Khng tm thy  thi"}),C.jsxs(dr,{to:"/teacher",className:"btn btn-primary mt-4",children:[C.jsx(L_,{size:18}),"Quay li"]})]})});const p=i.filter(y=>y.status==="in_progress").length,g=i.filter(y=>y.status==="submitted").length,m=g>0?Math.round(i.filter(y=>y.status==="submitted").reduce((y,w)=>y+w.score,0)/g):0;return C.jsx("div",{className:"page",children:C.jsxs("div",{className:"container",children:[C.jsxs("div",{className:"flex justify-between items-center mb-6",style:{flexWrap:"wrap",gap:"1rem"},children:[C.jsxs("div",{children:[C.jsxs(dr,{to:"/teacher",className:"text-muted text-sm flex items-center gap-1 mb-2",children:[C.jsx(L_,{size:16}),"Quay li Dashboard"]}),C.jsx("h1",{children:e.title}),C.jsxs("p",{className:"text-muted",children:["M phng: ",C.jsx("span",{className:"font-bold",style:{color:"var(--primary-light)"},children:e.room_code}),"  ",e.questions.length," cu hi"]})]}),C.jsxs("div",{className:"flex gap-2",children:[C.jsxs("button",{className:"btn btn-outline",onClick:f,children:[C.jsx(gR,{size:18}),"Lm mi"]}),C.jsxs("button",{className:"btn btn-primary",onClick:h,disabled:i.length===0,children:[C.jsx(I_,{size:18}),"Xut Excel"]})]})]}),C.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:[C.jsxs("div",{className:"card text-center",children:[C.jsx(ig,{size:32,style:{color:"var(--primary)"}}),C.jsx("p",{className:"text-3xl font-bold mt-2",children:i.length}),C.jsx("p",{className:"text-muted",children:"Tng hc sinh"})]}),C.jsxs("div",{className:"card text-center",children:[C.jsx(jg,{size:32,style:{color:"var(--warning)"}}),C.jsx("p",{className:"text-3xl font-bold mt-2",children:p}),C.jsx("p",{className:"text-muted",children:"ang lm bi"})]}),C.jsxs("div",{className:"card text-center",children:[C.jsx(I_,{size:32,style:{color:"var(--success)"}}),C.jsx("p",{className:"text-3xl font-bold mt-2",children:g}),C.jsx("p",{className:"text-muted",children:" np bi"})]}),C.jsxs("div",{className:"card text-center",children:[C.jsx(Fc,{size:32,style:{color:"var(--danger)"}}),C.jsxs("p",{className:"text-3xl font-bold mt-2",children:[m,"%"]}),C.jsx("p",{className:"text-muted",children:"im trung bnh"})]})]}),C.jsxs("div",{className:"card",children:[C.jsx("h3",{className:"mb-4",children:"Danh sch hc sinh"}),i.length===0?C.jsxs("p",{className:"text-center text-muted p-6",children:["Cha c hc sinh no vo phng thi.",C.jsx("br",{}),"Chia s m phng ",C.jsx("span",{className:"font-bold",children:e.room_code})," cho hc sinh."]}):C.jsx("div",{className:"table-container",children:C.jsxs("table",{children:[C.jsx("thead",{children:C.jsxs("tr",{children:[C.jsx("th",{children:"Hc sinh"}),C.jsx("th",{children:"Trng thi"}),C.jsx("th",{children:"Cu hin ti"}),C.jsx("th",{children:"im"}),C.jsx("th",{children:"Thot mn hnh"}),C.jsx("th",{children:"Thi gian"})]})}),C.jsx("tbody",{children:i.map(y=>C.jsxs("tr",{children:[C.jsx("td",{className:"font-bold",children:y.student_name}),C.jsx("td",{children:C.jsx("span",{className:`badge ${y.status==="submitted"?"badge-success":"badge-warning"}`,children:y.status==="submitted"?" np":"ang lm"})}),C.jsx("td",{children:y.status==="in_progress"?`${y.current_question+1}/${e.questions.length}`:"-"}),C.jsx("td",{children:y.status==="submitted"?C.jsxs("span",{className:"font-bold",children:[y.score,"/",y.total_questions]}):"-"}),C.jsx("td",{children:y.exit_count>0?C.jsxs("span",{className:"badge badge-danger",children:[C.jsx(Fc,{size:14}),y.exit_count]}):C.jsx("span",{className:"text-muted",children:"0"})}),C.jsx("td",{className:"text-muted",children:c(y.time_spent)})]},y.id))})]})})]})]})})}function G6(){const n=jf(),[e,t]=Z.useState(""),[i,r]=Z.useState(""),[a,o]=Z.useState(!1),[c,h]=Z.useState(""),f=async p=>{if(p.preventDefault(),!e.trim()){h("Vui lng nhp m phng thi");return}if(!i.trim()){h("Vui lng nhp tn ca bn");return}o(!0),h("");try{const g=await XN(e.toUpperCase());if(!g){h("Khng tm thy phng thi. Kim tra li m phng."),o(!1);return}if(!g.is_active){h("Phng thi ny  ng"),o(!1);return}const m=await KN(i.trim());if(!m){h("Khng th to thng tin hc sinh"),o(!1);return}const y=await JN({exam_id:g.id,student_id:m.id,student_name:i.trim(),answers:{},score:0,total_questions:g.questions.length,exit_count:0,time_spent:0,status:"in_progress",current_question:0});if(!y){h("Khng th bt u bi thi"),o(!1);return}localStorage.setItem("currentExam",JSON.stringify(g)),localStorage.setItem("currentSubmission",JSON.stringify(y)),n(`/student/exam/${y.id}`)}catch(g){h(g.message||"C li xy ra")}finally{o(!1)}};return C.jsx("div",{className:"page flex items-center justify-center",style:{minHeight:"calc(100vh - 80px)"},children:C.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"450px"},children:[C.jsxs("div",{className:"text-center mb-6",children:[C.jsx("div",{style:{width:"80px",height:"80px",borderRadius:"50%",background:"linear-gradient(135deg, var(--secondary), var(--secondary-dark))",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem"},children:C.jsx(U_,{size:40})}),C.jsx("h2",{children:"Vo Phng Thi"}),C.jsx("p",{className:"text-muted",children:"Nhp m phng v tn  bt u"})]}),C.jsxs("form",{onSubmit:f,children:[C.jsxs("div",{className:"input-group",children:[C.jsxs("label",{className:"flex items-center gap-2",children:[C.jsx(cb,{size:16}),"M phng thi"]}),C.jsx("input",{type:"text",className:"input input-lg",placeholder:"VD: ABC123",value:e,onChange:p=>t(p.target.value.toUpperCase()),maxLength:6,style:{textAlign:"center",letterSpacing:"0.2em",fontWeight:"bold",fontSize:"1.5rem"}})]}),C.jsxs("div",{className:"input-group",children:[C.jsxs("label",{className:"flex items-center gap-2",children:[C.jsx(CR,{size:16}),"Tn ca bn"]}),C.jsx("input",{type:"text",className:"input",placeholder:"Nhp h v tn...",value:i,onChange:p=>r(p.target.value)})]}),c&&C.jsxs("div",{className:"alert alert-danger",children:[C.jsx(Lc,{size:20}),C.jsx("span",{children:c})]}),C.jsx("button",{type:"submit",className:"btn btn-secondary btn-lg",style:{width:"100%",marginTop:"1rem"},disabled:a,children:a?C.jsxs(C.Fragment,{children:[C.jsx("div",{className:"spinner",style:{width:"20px",height:"20px"}}),"ang vo phng..."]}):C.jsxs(C.Fragment,{children:[C.jsx(U_,{size:20}),"Vo Phng Thi"]})})]}),C.jsx("div",{className:"text-center mt-6",children:C.jsx("p",{className:"text-sm text-muted",children:"Hy nhp chnh xc m phng m gio vin  cung cp"})})]})})}function V6(){const{submissionId:n}=eb(),e=jf(),[t,i]=Z.useState(null),[r,a]=Z.useState(null),[o,c]=Z.useState(0),[h,f]=Z.useState({}),[p,g]=Z.useState(0),[m,y]=Z.useState(0),[w,_]=Z.useState(!1),[b,E]=Z.useState(!1);Z.useEffect(()=>{const M=localStorage.getItem("currentExam"),W=localStorage.getItem("currentSubmission");if(M&&W){i(JSON.parse(M));const Y=JSON.parse(W);a(Y),f(Y.answers||{}),g(Y.time_spent||0),y(Y.exit_count||0)}else e("/student")},[n,e]),Z.useEffect(()=>{const M=setInterval(()=>{g(W=>W+1)},1e3);return()=>clearInterval(M)},[]),Z.useEffect(()=>{if(!n)return;const M=setInterval(async()=>{await Zh(n,{answers:h,time_spent:p,current_question:o,exit_count:m})},5e3);return()=>clearInterval(M)},[n,h,p,o,m]),Z.useEffect(()=>{const M=async()=>{if(document.hidden){const Y=m+1;y(Y),_(!0),n&&await Zh(n,{exit_count:Y})}},W=async()=>{const Y=m+1;y(Y),_(!0),n&&await Zh(n,{exit_count:Y})};return document.addEventListener("visibilitychange",M),window.addEventListener("blur",W),()=>{document.removeEventListener("visibilitychange",M),window.removeEventListener("blur",W)}},[m,n]);const T=Z.useCallback((M,W)=>{f(Y=>({...Y,[M]:W}))},[]),S=M=>{const W=Math.floor(M/60),Y=M%60;return`${W.toString().padStart(2,"0")}:${Y.toString().padStart(2,"0")}`},k=()=>{if(!t)return 0;let M=0;return t.questions.forEach(W=>{const Y=h[W.id];Y&&W.correct_answer&&(Array.isArray(W.correct_answer)?JSON.stringify(Y)===JSON.stringify(W.correct_answer)&&M++:String(Y).toUpperCase()===String(W.correct_answer).toUpperCase()&&M++)}),M},P=async()=>{if(!n||!t||!window.confirm("Bn c chc mun np bi? Khng th sa sau khi np."))return;E(!0);const W=k();await Zh(n,{answers:h,score:W,total_questions:t.questions.length,time_spent:p,exit_count:m,status:"submitted",submitted_at:new Date().toISOString()}),localStorage.setItem("examResult",JSON.stringify({score:W,total:t.questions.length,timeSpent:p,exitCount:m,answers:h,questions:t.questions})),e(`/student/result/${n}`)};if(!t||!r)return C.jsx("div",{className:"page flex items-center justify-center",children:C.jsx("div",{className:"spinner"})});const F=t.questions[o],O=(o+1)/t.questions.length*100,G=Object.keys(h).length;return C.jsxs("div",{className:"page",style:{paddingBottom:"100px"},children:[w&&C.jsx("div",{className:"modal-overlay",onClick:()=>_(!1),children:C.jsx("div",{className:"modal",onClick:M=>M.stopPropagation(),children:C.jsxs("div",{className:"text-center",children:[C.jsx("div",{style:{width:"80px",height:"80px",borderRadius:"50%",background:"rgba(239, 68, 68, 0.2)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem"},children:C.jsx(Fc,{size:40,style:{color:"var(--danger)"}})}),C.jsx("h2",{className:"mb-2",children:"Cnh bo!"}),C.jsxs("p",{className:"text-muted mb-4",children:["Bn  ri khi mn hnh thi.",C.jsx("br",{}),"Hnh vi ny  c ghi nhn (",m," ln)."]}),C.jsx("button",{className:"btn btn-primary",onClick:()=>_(!1),children:"Tip tc lm bi"})]})})}),C.jsxs("div",{className:"container",style:{maxWidth:"800px"},children:[C.jsxs("div",{className:"flex justify-between items-center mb-4",style:{flexWrap:"wrap",gap:"1rem"},children:[C.jsxs("div",{children:[C.jsx("h2",{children:t.title}),C.jsxs("p",{className:"text-muted text-sm",children:["Cu ",o+1,"/",t.questions.length,"   tr li: ",G]})]}),C.jsxs("div",{className:"flex gap-4 items-center",children:[m>0&&C.jsxs("span",{className:"badge badge-danger",children:[C.jsx(Fc,{size:14}),m," ln thot"]}),C.jsxs("div",{className:"timer",children:[C.jsx(jg,{size:18}),S(p)]})]})]}),C.jsx("div",{className:"progress-bar mb-6",children:C.jsx("div",{className:"progress-bar-fill",style:{width:`${O}%`}})}),C.jsxs("div",{className:"question-card",children:[C.jsxs("div",{className:"question-card-header",children:[C.jsxs("span",{className:"question-number",children:["Cu hi ",o+1]}),C.jsx("span",{className:"badge badge-primary",children:F.type==="multiple_choice"?"Trc nghim":F.type==="true_false"?"ng/Sai":"Tr li ngn"})]}),C.jsx("p",{className:"question-text",children:F.question}),F.type==="multiple_choice"&&F.options&&C.jsx("div",{className:"options-list",children:F.options.map((M,W)=>{const Y=M.charAt(0),ce=h[F.id]===Y;return C.jsxs("div",{className:`option ${ce?"selected":""}`,onClick:()=>T(F.id,Y),children:[C.jsx("div",{className:"option-radio"}),C.jsx("span",{className:"option-text",children:M})]},W)})}),F.type==="short_answer"&&C.jsx("input",{type:"text",className:"input input-lg",placeholder:"Nhp cu tr li...",value:h[F.id]||"",onChange:M=>T(F.id,M.target.value)}),F.type==="true_false"&&F.sub_questions&&C.jsx("div",{className:"options-list",children:F.sub_questions.map((M,W)=>{const Y=h[F.id]||[],ce=Y[W]==="true",ve=Y[W]==="false";return C.jsxs("div",{className:"flex gap-4 items-center p-4",style:{background:"var(--bg-tertiary)",borderRadius:"var(--radius-md)"},children:[C.jsx("span",{style:{flex:1},children:M.content}),C.jsx("button",{className:`btn btn-sm ${ce?"btn-secondary":"btn-outline"}`,onClick:()=>{const Ce=[...Y];Ce[W]="true",T(F.id,Ce)},children:"ng"}),C.jsx("button",{className:`btn btn-sm ${ve?"btn-danger":"btn-outline"}`,onClick:()=>{const Ce=[...Y];Ce[W]="false",T(F.id,Ce)},children:"Sai"})]},W)})})]}),C.jsxs("div",{className:"flex justify-between mt-6",style:{flexWrap:"wrap",gap:"1rem"},children:[C.jsxs("button",{className:"btn btn-outline",onClick:()=>c(M=>M-1),disabled:o===0,children:[C.jsx(KC,{size:20}),"Cu trc"]}),C.jsx("div",{className:"flex gap-2",children:t.questions.map((M,W)=>C.jsx("button",{className:"btn btn-sm",style:{minWidth:"40px",background:h[t.questions[W].id]?"var(--secondary)":W===o?"var(--primary)":"var(--bg-tertiary)"},onClick:()=>c(W),children:W+1},W))}),o===t.questions.length-1?C.jsx("button",{className:"btn btn-secondary",onClick:P,disabled:b,children:b?C.jsxs(C.Fragment,{children:[C.jsx("div",{className:"spinner",style:{width:"20px",height:"20px"}}),"ang np..."]}):C.jsxs(C.Fragment,{children:[C.jsx(vR,{size:20}),"Np bi"]})}):C.jsxs("button",{className:"btn btn-primary",onClick:()=>c(M=>M+1),children:["Cu sau",C.jsx(QC,{size:20})]})]})]})]})}function q6(){const[n,e]=Z.useState(null);Z.useEffect(()=>{const o=localStorage.getItem("examResult");o&&e(JSON.parse(o))},[]);const t=o=>{const c=Math.floor(o/60),h=o%60;return`${c} pht ${h} giy`},i=(o,c)=>{const h=o/c*100;return h>=80?"var(--success)":h>=60?"var(--warning)":"var(--danger)"},r=(o,c)=>!c||!o.correct_answer?!1:Array.isArray(o.correct_answer)?JSON.stringify(c)===JSON.stringify(o.correct_answer):String(c).toUpperCase()===String(o.correct_answer).toUpperCase();if(!n)return C.jsx("div",{className:"page flex items-center justify-center",children:C.jsxs("div",{className:"text-center",children:[C.jsx("h2",{children:"Khng c kt qu"}),C.jsxs(dr,{to:"/student",className:"btn btn-primary mt-4",children:[C.jsx(B_,{size:18}),"V trang ch"]})]})});const a=Math.round(n.score/n.total*100);return C.jsx("div",{className:"page",children:C.jsxs("div",{className:"container",style:{maxWidth:"800px"},children:[C.jsxs("div",{className:"card text-center mb-6",children:[C.jsx("div",{style:{width:"100px",height:"100px",borderRadius:"50%",background:`linear-gradient(135deg, ${i(n.score,n.total)}, ${i(n.score,n.total)}80)`,display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem"},children:C.jsx(SR,{size:50})}),C.jsx("h1",{className:"mb-2",children:"Hon thnh!"}),C.jsxs("div",{className:"score-display",children:[C.jsxs("div",{className:"score-number",style:{color:i(n.score,n.total)},children:[n.score,"/",n.total]}),C.jsxs("div",{className:"score-label",children:["im s: ",a,"%"]})]}),C.jsxs("div",{className:"flex gap-6 justify-center mt-6",style:{flexWrap:"wrap"},children:[C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx(jg,{size:20,style:{color:"var(--primary)"}}),C.jsx("span",{children:t(n.timeSpent)})]}),n.exitCount>0&&C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx(Fc,{size:20,style:{color:"var(--danger)"}}),C.jsxs("span",{children:[n.exitCount," ln thot mn hnh"]})]})]})]}),C.jsxs("div",{className:"card",children:[C.jsx("h3",{className:"mb-4",children:"Chi tit bi lm"}),C.jsx("div",{className:"flex flex-col gap-4",children:n.questions.map((o,c)=>{const h=n.answers[o.id],f=r(o,h);return C.jsxs("div",{className:"p-4",style:{background:"var(--bg-tertiary)",borderRadius:"var(--radius-md)",borderLeft:`4px solid ${f?"var(--success)":"var(--danger)"}`},children:[C.jsxs("div",{className:"flex justify-between items-start mb-2",children:[C.jsxs("span",{className:"text-sm text-muted",children:["Cu ",c+1]}),f?C.jsxs("span",{className:"badge badge-success",children:[C.jsx(mf,{size:14}),"ng"]}):C.jsxs("span",{className:"badge badge-danger",children:[C.jsx(kR,{size:14}),"Sai"]})]}),C.jsx("p",{className:"font-bold mb-2",children:o.question}),C.jsxs("div",{className:"text-sm",children:[C.jsxs("p",{children:[C.jsx("span",{className:"text-muted",children:"p n ca bn: "}),C.jsx("span",{style:{color:f?"var(--success)":"var(--danger)"},children:Array.isArray(h)?h.join(", "):h||"Cha tr li"})]}),!f&&o.correct_answer&&C.jsxs("p",{children:[C.jsx("span",{className:"text-muted",children:"p n ng: "}),C.jsx("span",{style:{color:"var(--success)"},children:Array.isArray(o.correct_answer)?o.correct_answer.join(", "):o.correct_answer})]})]})]},o.id)})})]}),C.jsx("div",{className:"flex gap-4 justify-center mt-6",children:C.jsxs(dr,{to:"/student",className:"btn btn-primary btn-lg",children:[C.jsx(B_,{size:20}),"Lm bi thi khc"]})})]})})}function W6(){const[n,e]=Z.useState(im()||""),[t,i]=Z.useState(!1),[r,a]=Z.useState(""),o=()=>{if(!n.trim()){a("Vui lng nhp API Key");return}uD(n.trim()),i(!0),a(""),setTimeout(()=>i(!1),3e3)};return C.jsx("div",{className:"page",children:C.jsxs("div",{className:"container",style:{maxWidth:"600px"},children:[C.jsxs("div",{className:"page-header",children:[C.jsx("h1",{children:"Ci t"}),C.jsx("p",{children:"Cu hnh API Key  s dng tnh nng AI"})]}),C.jsxs("div",{className:"card",children:[C.jsx("div",{className:"card-header",children:C.jsxs("h3",{className:"flex items-center gap-2",children:[C.jsx(cb,{size:24}),"Gemini API Key"]})}),!yg()&&C.jsxs("div",{className:"alert alert-warning mb-4",children:[C.jsx(Lc,{size:20}),C.jsx("span",{children:"Bn cn nhp API Key  s dng tnh nng phn tch PDF"})]}),C.jsxs("div",{className:"input-group",children:[C.jsx("label",{children:"API Key"}),C.jsx("input",{type:"password",className:"input",placeholder:"Nhp Gemini API Key...",value:n,onChange:c=>e(c.target.value)})]}),r&&C.jsxs("div",{className:"alert alert-danger",children:[C.jsx(Lc,{size:20}),C.jsx("span",{children:r})]}),t&&C.jsxs("div",{className:"alert alert-success",children:[C.jsx(mf,{size:20}),C.jsx("span",{children:" lu API Key thnh cng!"})]}),C.jsxs("div",{className:"flex gap-4",style:{marginTop:"1rem"},children:[C.jsxs("button",{onClick:o,className:"btn btn-primary",children:[C.jsx(mf,{size:18}),"Lu API Key"]}),C.jsxs("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"btn btn-outline",children:[C.jsx(iR,{size:18}),"Ly API Key min ph"]})]}),C.jsxs("div",{style:{marginTop:"2rem",padding:"1rem",background:"var(--bg-tertiary)",borderRadius:"var(--radius-md)"},children:[C.jsx("h4",{className:"mb-2",children:"Hng dn ly API Key:"}),C.jsxs("ol",{style:{paddingLeft:"1.25rem",lineHeight:"1.8"},className:"text-muted",children:[C.jsxs("li",{children:["Truy cp ",C.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",children:"Google AI Studio"})]}),C.jsx("li",{children:"ng nhp bng ti khon Google"}),C.jsx("li",{children:'Nhn "Create API Key"'}),C.jsx("li",{children:"Copy key v dn vo  trn"})]})]})]})]})})}function X6(){return C.jsx(DC,{children:C.jsxs("div",{className:"app",children:[C.jsxs("nav",{className:"navbar",children:[C.jsxs(dr,{to:"/",className:"navbar-brand",children:[C.jsx(lR,{size:32}),C.jsx("span",{children:"ExamApp"})]}),C.jsx("div",{className:"navbar-nav",children:C.jsxs(dr,{to:"/settings",className:"btn btn-outline btn-sm",children:[C.jsx(_R,{size:18}),"Ci t"]})})]}),C.jsxs(oC,{children:[C.jsx(Fs,{path:"/",element:C.jsx(MR,{})}),C.jsx(Fs,{path:"/teacher",element:C.jsx(ZN,{})}),C.jsx(Fs,{path:"/teacher/monitor/:examId",element:C.jsx($6,{})}),C.jsx(Fs,{path:"/student",element:C.jsx(G6,{})}),C.jsx(Fs,{path:"/student/exam/:submissionId",element:C.jsx(V6,{})}),C.jsx(Fs,{path:"/student/result/:submissionId",element:C.jsx(q6,{})}),C.jsx(Fs,{path:"/settings",element:C.jsx(W6,{})})]})]})})}u2.createRoot(document.getElementById("root")).render(C.jsx(Z.StrictMode,{children:C.jsx(X6,{})}));
